#include "proto.h"


//----- (004F5F30) --------------------------------------------------------
int __cdecl sub_4F5F30(int *a1)
{
  unsigned __int8 *v1; // esi
  int result; // eax
  unsigned __int8 v3; // cl
  unsigned __int8 v4; // al
  unsigned __int8 v5; // bl
  unsigned __int8 v6; // al
  int v7; // [esp+Ch] [ebp-94h]
  unsigned __int8 v8; // [esp+12h] [ebp-8Eh]
  unsigned __int8 v9; // [esp+13h] [ebp-8Dh]
  int v10; // [esp+14h] [ebp-8Ch]
  char v11; // [esp+1Ah] [ebp-86h]
  char v12; // [esp+1Bh] [ebp-85h]
  int v13; // [esp+1Ch] [ebp-84h]
  char v14[128]; // [esp+20h] [ebp-80h]

  v1 = (unsigned __int8 *)a1[184];
  v13 = a1[34];
  v10 = 60;
  sub_426AC0(&v10, 2u);
  if ( (__int16)v10 > 60 )
    return 0;
  result = sub_4F4530(a1, (__int16)v10);
  if ( result )
  {
    if ( (__int16)v10 >= 31 )
    {
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      {
        if ( (__int16)v10 >= 41 )
        {
          sub_426AC0(&v7, 1u);
          if ( (unsigned __int8)v7 >= 0x80u )
            return 0;
          sub_426AC0(v14, (unsigned __int8)v7);
          v14[(unsigned __int8)v7] = 0;
          *v1 = sub_4243F0(v14);
        }
        else
        {
          sub_426AC0(&v7, 1u);
          if ( (unsigned __int8)v7 >= 0x80u )
            return 0;
          sub_426AC0(v14, (unsigned __int8)v7);
          v14[(unsigned __int8)v7] = 0;
          sub_4243F0(v14);
          sub_426AC0(&v7, 1u);
          if ( (unsigned __int8)v7 >= 0x80u )
            return 0;
          sub_426AC0(v14, (unsigned __int8)v7);
          v14[(unsigned __int8)v7] = 0;
          v5 = sub_4243F0(v14);
          sub_426AC0(&v7, 1u);
          if ( (unsigned __int8)v7 >= 0x80u )
            return 0;
          sub_426AC0(v14, (unsigned __int8)v7);
          v14[(unsigned __int8)v7] = 0;
          v6 = sub_4243F0(v14);
          *v1 = v5;
          if ( v6 )
            *v1 = v6;
        }
        goto LABEL_28;
      }
    }
    else if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      sub_426AC0(&v12, 1u);
      sub_426AC0(&v9, 1u);
      sub_426AC0(&v8, 1u);
      v3 = v9;
      if ( v9 >= 0x89u )
      {
        v3 = 0;
        v9 = 0;
      }
      v4 = v8;
      if ( v8 >= 0x89u )
      {
        v4 = 0;
        v8 = 0;
      }
      *v1 = v3;
      if ( v4 )
        *v1 = v4;
      if ( (_WORD)v10 == 10 )
        sub_426AC0(&v11, 1u);
      goto LABEL_28;
    }
    strcpy(v14, sub_424870(*v1));
    LOBYTE(v7) = strlen(v14);
    sub_426AC0(&v7, 1u);
    sub_426AC0(v14, (unsigned __int8)v7);
LABEL_28:
    if ( !a1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(v10, (int)a1, a1[34])) != 0 )
    {
      a1[34] = v13;
      result = 1;
    }
  }
  return result;
}
// 4F5F30: using guessed type char var_80[128];

//----- (004F6240) --------------------------------------------------------
int __cdecl sub_4F6240(int *a1)
{
  _BYTE *v1; // ebp
  int result; // eax
  int v3; // [esp+8h] [ebp-8Ch]
  int v4; // [esp+Ch] [ebp-88h]
  int v5; // [esp+10h] [ebp-84h]
  char v6[128]; // [esp+14h] [ebp-80h]

  v1 = (_BYTE *)a1[184];
  v5 = a1[34];
  v4 = 61;
  sub_426AC0(&v4, 2u);
  if ( (__int16)v4 > 61 )
    return 0;
  result = sub_4F4530(a1, (__int16)v4);
  if ( result )
  {
    strcpy(v6, sub_425250((unsigned __int8)*v1));
    LOBYTE(v3) = strlen(v6);
    sub_426AC0(&v3, 1u);
    if ( (unsigned __int8)v3 < 0x80u )
    {
      sub_426AC0(v6, (unsigned __int8)v3);
      v6[(unsigned __int8)v3] = 0;
      *v1 = sub_424D80(v6);
      if ( !a1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(v4, (int)a1, a1[34])) != 0 )
      {
        a1[34] = v5;
        result = 1;
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}
// 4F6240: using guessed type char var_80[128];

//----- (004F6390) --------------------------------------------------------
int __cdecl sub_4F6390(int *a1)
{
  int *v1; // esi
  char *v2; // ebx
  int v3; // ebp
  int result; // eax
  int v5; // [esp+Ch] [ebp-4h]

  v1 = a1;
  v2 = (char *)a1[184];
  v3 = a1[34];
  v5 = 60;
  sub_426AC0(&v5, 2u);
  if ( (__int16)v5 > 60 )
    return 0;
  result = sub_4F4530(v1, (__int16)v5);
  if ( result )
  {
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      sub_426AC0(&a1, 1u);
      if ( (unsigned __int8)a1 >= 0x40u )
        return 0;
      sub_426AC0(v2, (unsigned __int8)a1);
      v2[(unsigned __int8)a1] = 0;
    }
    else
    {
      LOBYTE(a1) = strlen(v2);
      sub_426AC0(&a1, 1u);
      sub_426AC0(v2, (unsigned __int8)a1);
    }
    if ( !v1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(v5, (int)v1, v1[34])) != 0 )
    {
      v1[34] = v3;
      result = 1;
    }
  }
  return result;
}

//----- (004F64A0) --------------------------------------------------------
int __cdecl sub_4F64A0(int a1)
{
  int result; // eax
  const char ***v2; // esi
  int v3; // ebx
  int v4; // esi
  char *v5; // edi
  int v6; // eax
  int v7; // ecx
  int v8; // esi
  unsigned __int8 v9; // bl
  int v10; // edi
  int v11; // eax
  size_t v12; // eax
  _DWORD *v13; // eax
  unsigned __int8 v14; // [esp+12h] [ebp-126h]
  unsigned __int8 v15; // [esp+13h] [ebp-125h]
  int v16; // [esp+14h] [ebp-124h]
  int v17; // [esp+18h] [ebp-120h]
  int v18; // [esp+1Ch] [ebp-11Ch]
  int v19; // [esp+20h] [ebp-118h]
  char v20[20]; // [esp+24h] [ebp-114h]
  char v21[256]; // [esp+38h] [ebp-100h]

  v19 = *(_DWORD *)(a1 + 136);
  v17 = 64;
  sub_426AC0(&v17, 2u);
  if ( (__int16)v17 > 64 )
    return 0;
  result = sub_4F4530((int *)a1, (__int16)v17);
  if ( !result )
    return result;
  if ( (__int16)v17 < 11 && *(_DWORD *)&byte_5D4594[3803300] == 1 )
  {
    *(_DWORD *)v20 = 0;
    *(_DWORD *)&v20[4] = 0;
    *(_DWORD *)&v20[8] = 0;
    *(_DWORD *)&v20[12] = 0;
    sub_4E4990(a1, (int *)v20);
    return 1;
  }
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    v4 = 0;
    v5 = v20;
    while ( 1 )
    {
      sub_426AC0(&v18, 1u);
      if ( (int)(unsigned __int8)v18 >= 256 )
        return 0;
      sub_426AC0(v21, (unsigned __int8)v18);
      v21[(unsigned __int8)v18] = 0;
      v6 = sub_413290(v21);
      *(_DWORD *)v5 = sub_413330(v6);
      ++v4;
      v5 += 4;
      if ( v4 >= 4 )
      {
        *(_WORD *)&v20[16] = -1;
        *(_WORD *)&v20[18] = -1;
        sub_4E4990(a1, (int *)v20);
        goto LABEL_18;
      }
    }
  }
  v2 = *(const char ****)(a1 + 692);
  v3 = 4;
  do
  {
    if ( *v2 )
    {
      LOBYTE(v18) = strlen(**v2);
      sub_426AC0(&v18, 1u);
      sub_426AC0(**v2, (unsigned __int8)v18);
    }
    else
    {
      LOBYTE(v18) = 0;
      sub_426AC0(&v18, 1u);
    }
    ++v2;
    --v3;
  }
  while ( v3 );
LABEL_18:
  if ( (__int16)v17 >= 41 )
  {
    v7 = 0;
    if ( *(_DWORD *)(a1 + 8) & 0x1000 && *(_DWORD *)(a1 + 12) & 0x47F0000 )
      v7 = 1;
    if ( ((__int16)v17 >= 62 || !(*(_DWORD *)(a1 + 8) & 0x1000) || !(*(_DWORD *)(a1 + 12) & 0x4000000)) && v7 )
    {
      v8 = *(_DWORD *)(a1 + 736);
      v14 = *(_BYTE *)(v8 + 108);
      v15 = *(_BYTE *)(v8 + 109);
      v9 = v15;
      v16 = *(_DWORD *)(v8 + 112);
      v10 = v16;
      v14 = *(_BYTE *)(v8 + 108);
      sub_426AC0(&v14, 1u);
      v15 = *(_BYTE *)(v8 + 109);
      sub_426AC0(&v15, 1u);
      if ( (__int16)v17 >= 61 )
      {
        v16 = *(_DWORD *)(v8 + 112);
        sub_426AC0(&v16, 4u);
      }
      if ( !sub_40A5C0(4096) )
      {
        *(_BYTE *)(v8 + 108) = v14;
        goto LABEL_36;
      }
      if ( v14 <= v9 && v16 >= 0 && v16 <= v10 && v9 == v15 )
      {
        *(_BYTE *)(v8 + 108) = v14;
LABEL_36:
        *(_BYTE *)(v8 + 109) = v15;
        *(_DWORD *)(v8 + 112) = v16;
        goto LABEL_37;
      }
      *(_BYTE *)(v8 + 108) = 0;
      *(_BYTE *)(v8 + 109) = v9;
      *(_DWORD *)(v8 + 112) = 0;
    }
  }
LABEL_37:
  if ( (__int16)v17 >= 42 )
  {
    LOWORD(v11) = sub_4EE780(a1);
    v16 = v11;
    v12 = sub_426AC0(&v16, 2u);
    LOWORD(v12) = *(_WORD *)(*(_DWORD *)(a1 + 556) + 4);
    if ( (unsigned __int16)v16 > (unsigned __int16)v12 )
      v16 = v12;
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      if ( sub_4DB240() == 1 || sub_4DB250() == 1 || sub_40A5C0(4096) && sub_419EA0() )
      {
        sub_4E4560(a1, v16);
      }
      else
      {
        v13 = sub_413250(*(unsigned __int16 *)(a1 + 4));
        if ( v13 )
        {
          *(_WORD *)(*(_DWORD *)(a1 + 556) + 4) = *((_WORD *)v13 + 26);
          *(_WORD *)(*(_DWORD *)(a1 + 556) + 2) = *((_WORD *)v13 + 26);
          sub_4E4560(a1, *((_WORD *)v13 + 26));
        }
      }
    }
  }
  if ( (_WORD)v17 == 63 )
    sub_426AC0(&v14, 1u);
  if ( (__int16)v17 >= 64 )
    sub_426AC0((_BYTE *)(*(_DWORD *)(a1 + 748) + 4), 4u);
  if ( *(_DWORD *)(a1 + 136) && *(_DWORD *)&byte_5D4594[3803300] == 1 && !sub_4F3E30(v17, a1, *(_DWORD *)(a1 + 136)) )
    return 0;
  *(_DWORD *)(a1 + 136) = v19;
  return 1;
}
// 4F673C: variable 'v11' is possibly undefined
// 4F64A0: using guessed type char var_100[256];

//----- (004F6860) --------------------------------------------------------
int __cdecl sub_4F6860(int a1)
{
  int result; // eax
  const char ***v2; // esi
  int v3; // ebx
  int v4; // esi
  char *v5; // edi
  int v6; // eax
  int v7; // eax
  size_t v8; // eax
  _DWORD *v9; // eax
  int v10; // [esp+Ch] [ebp-128h]
  int v11; // [esp+10h] [ebp-124h]
  size_t v12; // [esp+14h] [ebp-120h]
  char v13; // [esp+1Bh] [ebp-119h]
  int v14; // [esp+1Ch] [ebp-118h]
  char v15[20]; // [esp+20h] [ebp-114h]
  char v16[256]; // [esp+34h] [ebp-100h]

  v14 = *(_DWORD *)(a1 + 136);
  v10 = 62;
  sub_426AC0(&v10, 2u);
  if ( (__int16)v10 > 62 )
    return 0;
  result = sub_4F4530((int *)a1, (__int16)v10);
  if ( result )
  {
    if ( (__int16)v10 < 11 && *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      *(_DWORD *)v15 = 0;
      *(_DWORD *)&v15[4] = 0;
      *(_DWORD *)&v15[8] = 0;
      *(_DWORD *)&v15[12] = 0;
      sub_4E4990(a1, (int *)v15);
      return 1;
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      v4 = 0;
      v5 = v15;
      while ( 1 )
      {
        sub_426AC0(&v11, 1u);
        if ( (int)(unsigned __int8)v11 >= 256 )
          return 0;
        sub_426AC0(v16, (unsigned __int8)v11);
        v16[(unsigned __int8)v11] = 0;
        v6 = sub_413290(v16);
        *(_DWORD *)v5 = sub_413330(v6);
        ++v4;
        v5 += 4;
        if ( v4 >= 4 )
        {
          *(_WORD *)&v15[16] = -1;
          *(_WORD *)&v15[18] = -1;
          sub_4E4990(a1, (int *)v15);
          goto LABEL_18;
        }
      }
    }
    v2 = *(const char ****)(a1 + 692);
    v3 = 4;
    do
    {
      if ( *v2 )
      {
        LOBYTE(v11) = strlen(**v2);
        sub_426AC0(&v11, 1u);
        sub_426AC0(**v2, (unsigned __int8)v11);
      }
      else
      {
        LOBYTE(v11) = 0;
        sub_426AC0(&v11, 1u);
      }
      ++v2;
      --v3;
    }
    while ( v3 );
LABEL_18:
    if ( (__int16)v10 >= 41 )
    {
      LOWORD(v7) = sub_4EE780(a1);
      v12 = v7;
      v8 = sub_426AC0(&v12, 2u);
      LOWORD(v8) = *(_WORD *)(*(_DWORD *)(a1 + 556) + 4);
      if ( (unsigned __int16)v12 > (unsigned __int16)v8 )
        v12 = v8;
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      {
        if ( sub_4DB240() == 1 || sub_4DB250() == 1 || sub_40A5C0(4096) && sub_419EA0() )
        {
          sub_4E4560(a1, v12);
        }
        else
        {
          v9 = sub_413270(*(unsigned __int16 *)(a1 + 4));
          if ( v9 )
          {
            *(_WORD *)(*(_DWORD *)(a1 + 556) + 4) = *((_WORD *)v9 + 26);
            *(_WORD *)(*(_DWORD *)(a1 + 556) + 2) = *((_WORD *)v9 + 26);
            sub_4E4560(a1, *((_WORD *)v9 + 26));
          }
        }
      }
    }
    if ( (_WORD)v10 == 61 )
      sub_426AC0(&v13, 1u);
    if ( (__int16)v10 >= 62 )
      sub_426AC0((_BYTE *)(*(_DWORD *)(a1 + 748) + 4), 4u);
    if ( *(_DWORD *)(a1 + 136) && *(_DWORD *)&byte_5D4594[3803300] == 1 && !sub_4F3E30(v10, a1, *(_DWORD *)(a1 + 136)) )
      return 0;
    *(_DWORD *)(a1 + 136) = v14;
    result = 1;
  }
  return result;
}
// 4F69F8: variable 'v7' is possibly undefined
// 4F6860: using guessed type char var_100[256];

//----- (004F6B20) --------------------------------------------------------
int __cdecl sub_4F6B20(int *a1)
{
  int v1; // ecx
  int result; // eax
  const char ***v3; // esi
  int v4; // ebp
  char *v5; // esi
  int v6; // esi
  char *v7; // edi
  int v8; // eax
  bool v9; // zf
  char *v10; // eax
  char v11; // cl
  char v12; // [esp+Eh] [ebp-126h]
  char v13; // [esp+Fh] [ebp-125h]
  int v14; // [esp+10h] [ebp-124h]
  char *v15; // [esp+14h] [ebp-120h]
  int v16; // [esp+18h] [ebp-11Ch]
  int v17; // [esp+1Ch] [ebp-118h]
  char v18[20]; // [esp+20h] [ebp-114h]
  char v19[256]; // [esp+34h] [ebp-100h]

  v1 = a1[34];
  v15 = (char *)a1[184];
  v17 = v1;
  v16 = 60;
  sub_426AC0(&v16, 2u);
  if ( (__int16)v16 > 60 )
    return 0;
  result = sub_4F4530(a1, (__int16)v16);
  if ( result )
  {
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      v6 = 0;
      v7 = v18;
      while ( 1 )
      {
        sub_426AC0(&v14, 1u);
        if ( (int)(unsigned __int8)v14 >= 256 )
          return 0;
        sub_426AC0(v19, (unsigned __int8)v14);
        v19[(unsigned __int8)v14] = 0;
        v8 = sub_413290(v19);
        *(_DWORD *)v7 = sub_413330(v8);
        ++v6;
        v7 += 4;
        if ( v6 >= 4 )
        {
          *(_WORD *)&v18[16] = -1;
          *(_WORD *)&v18[18] = -1;
          sub_4E4990((int)a1, (int *)v18);
          sub_426AC0(&v13, 1u);
          sub_426AC0(&v12, 1u);
          v9 = !sub_40A5C0(4096);
          v10 = v15;
          if ( !v9 )
            v15[2] = 0;
          v11 = v12;
          v10[1] = v13;
          *v10 = v11;
          goto LABEL_17;
        }
      }
    }
    v3 = (const char ***)a1[173];
    v4 = 4;
    do
    {
      if ( *v3 )
      {
        LOBYTE(v14) = strlen(**v3);
        sub_426AC0(&v14, 1u);
        sub_426AC0(**v3, (unsigned __int8)v14);
      }
      else
      {
        LOBYTE(v14) = 0;
        sub_426AC0(&v14, 1u);
      }
      ++v3;
      --v4;
    }
    while ( v4 );
    v5 = v15;
    sub_426AC0(v15 + 1, 1u);
    sub_426AC0(v5, 1u);
LABEL_17:
    if ( a1[34] && *(_DWORD *)&byte_5D4594[3803300] == 1 && !sub_4F3E30(v16, (int)a1, a1[34]) )
      return 0;
    a1[34] = v17;
    result = 1;
  }
  return result;
}
// 4F6B20: using guessed type char var_100[256];

//----- (004F6D20) --------------------------------------------------------
int __cdecl sub_4F6D20(int *a1)
{
  int result; // eax
  const char ***v2; // esi
  int v3; // ebx
  char *v4; // esi
  int v5; // edi
  int v6; // eax
  _DWORD *v7; // edx
  int v8; // [esp+4h] [ebp-120h]
  int v9; // [esp+8h] [ebp-11Ch]
  int v10; // [esp+Ch] [ebp-118h]
  char v11[20]; // [esp+10h] [ebp-114h]
  char v12[256]; // [esp+24h] [ebp-100h]

  v10 = a1[34];
  v9 = 60;
  sub_426AC0(&v9, 2u);
  if ( (__int16)v9 > 60 )
    return 0;
  result = sub_4F4530(a1, (__int16)v9);
  if ( result )
  {
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      v4 = v11;
      v5 = 4;
      do
      {
        sub_426AC0(&v8, 1u);
        sub_426AC0(v12, (unsigned __int8)v8);
        v12[(unsigned __int8)v8] = 0;
        v6 = sub_413290(v12);
        *(_DWORD *)v4 = sub_413330(v6);
        v4 += 4;
        --v5;
      }
      while ( v5 );
      *(_WORD *)&v11[16] = -1;
      *(_WORD *)&v11[18] = -1;
      sub_4E4990((int)a1, (int *)v11);
      if ( a1[2] & 0x10000000 )
      {
        v7 = (_DWORD *)a1[187];
        *v7 = a1[14];
        v7[1] = a1[15];
      }
    }
    else
    {
      v2 = (const char ***)a1[173];
      v3 = 4;
      do
      {
        if ( *v2 )
        {
          LOBYTE(v8) = strlen(**v2);
          sub_426AC0(&v8, 1u);
          sub_426AC0(**v2, (unsigned __int8)v8);
        }
        else
        {
          LOBYTE(v8) = 0;
          sub_426AC0(&v8, 1u);
        }
        ++v2;
        --v3;
      }
      while ( v3 );
    }
    if ( !a1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(v9, (int)a1, a1[34])) != 0 )
    {
      a1[34] = v10;
      result = 1;
    }
  }
  return result;
}
// 4F6D20: using guessed type char var_100[256];

//----- (004F6EC0) --------------------------------------------------------
int __cdecl sub_4F6EC0(int a1)
{
  int *v1; // esi
  _BYTE *v2; // edi
  int v3; // ebx
  int result; // eax

  v1 = (int *)a1;
  v2 = *(_BYTE **)(a1 + 692);
  v3 = *(_DWORD *)(a1 + 136);
  a1 = 60;
  sub_426AC0(&a1, 2u);
  if ( (__int16)a1 > 60 )
    return 0;
  result = sub_4F4530(v1, (__int16)a1);
  if ( result )
  {
    sub_426AC0(v2, 4u);
    if ( !v1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(a1, (int)v1, v1[34])) != 0 )
    {
      v1[34] = v3;
      result = 1;
    }
  }
  return result;
}

//----- (004F6F60) --------------------------------------------------------
int __cdecl sub_4F6F60(int *a1)
{
  int *v1; // esi
  _BYTE *v2; // edi
  int v3; // ebp
  int result; // eax
  _DWORD *v5; // edi
  int v6; // eax
  float v7; // [esp+0h] [ebp-18h]
  int v8; // [esp+10h] [ebp-8h]
  int v9; // [esp+14h] [ebp-4h]

  v1 = a1;
  v2 = (_BYTE *)a1[187];
  v3 = a1[34];
  v8 = 61;
  sub_426AC0(&v8, 2u);
  if ( (__int16)v8 > 61 )
    return 0;
  result = sub_4F4530(v1, (__int16)v8);
  if ( result )
  {
    if ( (__int16)v8 >= 61 )
    {
      LOBYTE(a1) = 0;
      sub_426AC0(v2, 4u);
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      {
        v9 = 80 * *(_DWORD *)v2 / 50;
        v7 = (double)v9;
        nullsub_35(v1, LODWORD(v7));
      }
      if ( sub_40A5C0(2048) )
      {
        v5 = sub_45A720(v1[10]);
        if ( v5 )
        {
          v6 = sub_459EB0();
          if ( v6 )
          {
            while ( (_DWORD *)v6 != v5 )
            {
              v6 = sub_459EC0(v6);
              if ( !v6 )
                goto LABEL_14;
            }
            LOBYTE(a1) = 1;
          }
        }
      }
LABEL_14:
      sub_426AC0(&a1, 1u);
    }
    if ( !v1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || (result = sub_4F3E30(v8, (int)v1, v1[34])) != 0 )
    {
      v1[34] = v3;
      result = 1;
    }
  }
  return result;
}
// 4E4770: using guessed type void __cdecl nullsub_35(_DWORD, _DWORD);

//----- (004F70A0) --------------------------------------------------------
int __cdecl sub_4F70A0(int a1)
{
  int *v1; // esi
  _BYTE *v2; // edi
  int v3; // ebx

  v1 = (int *)a1;
  v2 = *(_BYTE **)(a1 + 748);
  v3 = *(_DWORD *)(a1 + 136);
  a1 = 61;
  sub_426AC0(&a1, 2u);
  if ( (__int16)a1 > 61 )
    return 0;
  if ( (__int16)a1 <= 0 )
    return 0;
  if ( !sub_4F4530(v1, (__int16)a1) )
    return 0;
  sub_426AC0(v2, 4u);
  if ( v1[34] )
  {
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 && !sub_4F3E30(a1, (int)v1, v1[34]) )
      return 0;
  }
  v1[34] = v3;
  return 1;
}

//----- (004F7130) --------------------------------------------------------
int __cdecl sub_4F7130(int *a1)
{
  _BYTE *v1; // ebx
  int v2; // eax
  int v3; // edi
  int v4; // esi
  _BYTE *v5; // ebp
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // edi
  int *v10; // ebp
  char v11; // cl
  int *v12; // ebx
  int v13; // eax
  int v14; // esi
  _BYTE *v15; // eax
  int v16; // ebp
  int v17; // edi
  _DWORD *v18; // esi
  int v19; // ecx
  bool v20; // cc
  int v21; // esi
  _BYTE *v22; // edi
  size_t v24; // [esp-4h] [ebp-138h]
  char v25; // [esp+13h] [ebp-121h]
  int v26; // [esp+14h] [ebp-120h]
  int v27; // [esp+18h] [ebp-11Ch]
  int v28; // [esp+1Ch] [ebp-118h]
  int v29; // [esp+20h] [ebp-114h]
  int v30; // [esp+24h] [ebp-110h]
  int v31; // [esp+28h] [ebp-10Ch]
  _BYTE *v32; // [esp+2Ch] [ebp-108h]
  int v33; // [esp+30h] [ebp-104h]
  char v34[256]; // [esp+34h] [ebp-100h]

  v1 = (_BYTE *)a1[187];
  v2 = a1[34];
  v3 = a1[189];
  v32 = (_BYTE *)a1[187];
  v33 = v2;
  v29 = 63;
  sub_426AC0(&v29, 2u);
  if ( (__int16)v29 <= 63 && (__int16)v29 > 0 && sub_4F4530(a1, (__int16)v29) )
  {
    LOBYTE(v31) = 3;
    sub_426AC0(&v31, 1u);
    v4 = 0;
    if ( (_BYTE)v31 )
    {
      v5 = v1 + 80;
      do
      {
        sub_426AC0(v5, 1u);
        ++v4;
        ++v5;
      }
      while ( v4 < (unsigned __int8)v31 );
    }
    sub_426AC0(v1 + 86, 1u);
    sub_426AC0(v1 + 87, 1u);
    sub_426AC0(v1 + 88, 4u);
    if ( v3 )
      v6 = (char *)(v3 + 1920);
    else
      v6 = 0;
    sub_4F5580((int)(v1 + 48), v6);
    if ( v3 )
      v7 = (char *)(v3 + 2048);
    else
      v7 = 0;
    sub_4F5580((int)(v1 + 56), v7);
    if ( v3 )
      v8 = (char *)(v3 + 2176);
    else
      v8 = 0;
    sub_4F5580((int)(v1 + 72), v8);
    if ( v3 )
      v9 = (char *)(v3 + 2304);
    else
      v9 = 0;
    sub_4F5580((int)(v1 + 64), v9);
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      sub_426AC0(&v27, 1u);
      v16 = 0;
      if ( (_BYTE)v27 )
      {
        while ( 1 )
        {
          sub_426AC0(&v30, 1u);
          v17 = 0;
          if ( (_BYTE)v30 )
            break;
LABEL_36:
          if ( ++v16 >= (unsigned __int8)v27 )
            goto LABEL_37;
        }
        while ( 1 )
        {
          sub_426AC0(&v28, 1u);
          sub_426AC0(v34, (unsigned __int8)v28);
          v34[(unsigned __int8)v28] = 0;
          v18 = sub_4E3810(v34);
          if ( !v18 )
            return 0;
          sub_426AC0(&v26, 2u);
          sub_426C20(&v32, 4u);
          if ( !((int (__cdecl *)(_DWORD *, _DWORD))v18[176])(v18, 0) )
            return 0;
          v19 = v17++ + 4 * v16;
          v20 = v17 < (unsigned __int8)v30;
          *(_DWORD *)&v1[4 * v19] = v18;
          if ( !v20 )
            goto LABEL_36;
        }
      }
    }
    else
    {
      LOBYTE(v26) = 3;
      sub_426AC0(&v26, 1u);
      v10 = (int *)v1;
      v28 = 3;
      do
      {
        v11 = 0;
        v12 = v10;
        v25 = 0;
        v13 = 4;
        do
        {
          if ( *v12 )
            ++v11;
          ++v12;
          --v13;
        }
        while ( v13 );
        v25 = v11;
        sub_426AC0(&v25, 1u);
        v30 = 4;
        do
        {
          v14 = *v10;
          if ( *v10 )
          {
            LOBYTE(v27) = strlen((const char *)sub_4E39D0(*v10));
            sub_426AC0(&v27, 1u);
            v24 = (unsigned __int8)v27;
            v15 = (_BYTE *)sub_4E39D0(v14);
            sub_426AC0(v15, v24);
            sub_51DF90(v14);
          }
          ++v10;
          --v30;
        }
        while ( v30 );
        v10 = v12;
        --v28;
      }
      while ( v28 );
      v1 = v32;
    }
LABEL_37:
    if ( (__int16)v29 >= 62 )
    {
      LOBYTE(v26) = 3;
      sub_426AC0(&v26, 1u);
      v21 = 0;
      if ( (_BYTE)v26 )
      {
        v22 = v1 + 83;
        do
        {
          sub_426AC0(v22, 1u);
          ++v21;
          ++v22;
        }
        while ( v21 < (unsigned __int8)v26 );
      }
    }
    if ( (__int16)v29 >= 63 )
      sub_426AC0(v1 + 92, 4u);
    if ( !a1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || sub_4F3E30(v29, (int)a1, a1[34]) )
    {
      a1[34] = v33;
      return 1;
    }
  }
  return 0;
}
// 4F7130: using guessed type char var_100[256];

//----- (004F74D0) --------------------------------------------------------
int __cdecl sub_4F74D0(int *a1)
{
  _BYTE *v1; // esi
  int v2; // ebp
  int i; // eax
  char *v4; // eax
  int v5; // edi
  int v6; // eax
  int v7; // edi
  int v8; // eax
  int v9; // ebp
  char *v10; // eax
  int v11; // eax
  int v12; // edi
  int v13; // eax
  int v14; // ebp
  char *v15; // eax
  int v16; // eax
  size_t v18; // [esp-4h] [ebp-124h]
  size_t v19; // [esp-4h] [ebp-124h]
  size_t v20; // [esp-4h] [ebp-124h]
  int v21; // [esp+10h] [ebp-110h]
  int v22; // [esp+14h] [ebp-10Ch]
  int v23; // [esp+18h] [ebp-108h]
  int v24; // [esp+1Ch] [ebp-104h]
  char v25[256]; // [esp+20h] [ebp-100h]

  v1 = (_BYTE *)a1[173];
  v24 = a1[34];
  v23 = 63;
  sub_426AC0(&v23, 2u);
  if ( (__int16)v23 <= 63 )
  {
    v2 = 0;
    if ( (__int16)v23 > 0 )
    {
      if ( sub_4F4530(a1, (__int16)v23) )
      {
        sub_426AC0(v1, 4u);
        sub_426AC0(v1 + 4, 4u);
        v22 = 0;
        for ( i = 0; i < 137; ++i )
        {
          if ( v1[i + 8] == 1 )
            ++v22;
        }
        sub_426AC0(&v22, 2u);
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          v5 = 0;
          if ( (_WORD)v22 )
          {
            do
            {
              sub_426AC0(&v21, 1u);
              sub_426AC0(v25, (unsigned __int8)v21);
              v25[(unsigned __int8)v21] = 0;
              v6 = sub_4243F0(v25);
              if ( !v6 )
                return 0;
              v1[v6 + 8] = 1;
            }
            while ( ++v5 < (unsigned __int16)v22 );
          }
        }
        else
        {
          do
          {
            if ( v1[v2 + 8] )
            {
              LOBYTE(v21) = strlen(sub_424870(v2));
              sub_426AC0(&v21, 1u);
              v18 = (unsigned __int8)v21;
              v4 = sub_424870(v2);
              sub_426AC0(v4, v18);
            }
            ++v2;
          }
          while ( v2 < 137 );
        }
        v7 = 0;
        v8 = 0;
        v22 = 0;
        do
        {
          if ( v1[v8 + 145] == 1 )
            ++v22;
          ++v8;
        }
        while ( v8 < 6 );
        sub_426AC0(&v22, 2u);
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          if ( (_WORD)v22 )
          {
            do
            {
              sub_426AC0(&v21, 1u);
              sub_426AC0(v25, (unsigned __int8)v21);
              v25[(unsigned __int8)v21] = 0;
              v11 = sub_424D80(v25);
              if ( !v11 )
                return 0;
              v1[v11 + 145] = 1;
            }
            while ( ++v7 < (unsigned __int16)v22 );
          }
        }
        else
        {
          v9 = 0;
          do
          {
            if ( v1[v9 + 145] )
            {
              LOBYTE(v21) = strlen(sub_425250(v9));
              sub_426AC0(&v21, 1u);
              v19 = (unsigned __int8)v21;
              v10 = sub_425250(v9);
              sub_426AC0(v10, v19);
            }
            ++v9;
          }
          while ( v9 < 6 );
        }
        v12 = 0;
        v13 = 0;
        v22 = 0;
        do
        {
          if ( v1[v13 + 151] == 1 )
            ++v22;
          ++v13;
        }
        while ( v13 < 41 );
        sub_426AC0(&v22, 2u);
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          if ( (_WORD)v22 )
          {
            do
            {
              sub_426AC0(&v21, 1u);
              sub_426AC0(v25, (unsigned __int8)v21);
              v25[(unsigned __int8)v21] = 0;
              v16 = sub_427010(v25);
              if ( !v16 )
                return 0;
              v1[v16 + 151] = 1;
            }
            while ( ++v12 < (unsigned __int16)v22 );
          }
        }
        else
        {
          v14 = 0;
          do
          {
            if ( v1[v14 + 151] )
            {
              LOBYTE(v21) = strlen(sub_427230(v14));
              sub_426AC0(&v21, 1u);
              v20 = (unsigned __int8)v21;
              v15 = sub_427230(v14);
              sub_426AC0(v15, v20);
            }
            ++v14;
          }
          while ( v14 < 41 );
        }
        sub_426AC0(v1 + 196, 4u);
        sub_426AC0(v1 + 192, 4u);
        sub_426AC0(v1 + 200, 4u);
        sub_426AC0(v1 + 204, 4u);
        sub_426AC0(v1 + 208, 4u);
        if ( (__int16)v23 >= 62 )
          sub_426AC0(v1 + 212, 4u);
        if ( (__int16)v23 >= 63 )
          sub_426AC0(v1 + 216, 1u);
        if ( !a1[34] || *(_DWORD *)&byte_5D4594[3803300] != 1 || sub_4F3E30(v23, (int)a1, a1[34]) )
        {
          a1[34] = v24;
          return 1;
        }
      }
    }
  }
  return 0;
}
// 4F74D0: using guessed type char var_100[256];

//----- (004F78D0) --------------------------------------------------------
void sub_4F78D0()
{
  srand(0x4E34u);
}

//----- (004F78E0) --------------------------------------------------------
int __cdecl sub_4F78E0(int a1, int a2)
{
  int v2; // eax

  if ( *(_DWORD *)(a2 + 492) != a1 )
    return 0;
  v2 = *(_DWORD *)(a1 + 504);
  if ( !v2 )
    return 0;
  while ( v2 != a2 )
  {
    v2 = *(_DWORD *)(v2 + 496);
    if ( !v2 )
      return 0;
  }
  return 1;
}

//----- (004F7920) --------------------------------------------------------
int __cdecl sub_4F7920(int a1, int a2)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 504);
  if ( !result )
    return 0;
  while ( *(_DWORD *)(result + 36) != a2 )
  {
    result = *(_DWORD *)(result + 496);
    if ( !result )
      return 0;
  }
  return result;
}

//----- (004F7950) --------------------------------------------------------
void __cdecl sub_4F7950(int a1)
{
  int v1; // ebp
  int v2; // edi
  int *v3; // esi

  v1 = *(_DWORD *)(a1 + 748);
  v2 = 3;
  v3 = (int *)(v1 + 168);
  do
  {
    if ( *v3 )
      sub_4E5CC0(*v3);
    *v3 = 0;
    ++v3;
    --v2;
  }
  while ( v2 );
  *(_BYTE *)(v1 + 181) = 0;
  *(_BYTE *)(v1 + 180) = 0;
}

//----- (004F79A0) --------------------------------------------------------
void __cdecl sub_4F79A0(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // eax
  float2 v5; // [esp+8h] [ebp-8h]

  v3 = *(_DWORD *)(a1 + 748);
  if ( !(*(_BYTE *)(*(_DWORD *)(v3 + 276) + 3680) & 3) )
  {
    v4 = *(_DWORD *)(v3 + 4 * *(unsigned __int8 *)(v3 + 180) + 168);
    if ( v4 )
    {
      LODWORD(v5.field_0) = a2;
      LODWORD(v5.field_4) = a3;
      sub_4E7010(v4, &v5);
    }
    else
    {
      *(_DWORD *)(v3 + 4 * *(unsigned __int8 *)(v3 + 180) + 168) = sub_4E3810((CHAR *)&byte_587000[215932]);
      sub_4DAA50(*(_DWORD *)(v3 + 4 * *(unsigned __int8 *)(v3 + 180) + 168), a1, *(float *)&a2, *(float *)&a3);
    }
  }
}

//----- (004F7A40) --------------------------------------------------------
int __cdecl sub_4F7A40(int a1)
{
  int v1; // edi
  int v2; // ecx
  signed int v3; // edx
  int v4; // edi

  v1 = *(__int16 *)(a1 + 126);
  v2 = (unsigned __int8)sub_4FF570(a1, 3);
  v3 = (*(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)(a1 + 36)) % 0x28u;
  if ( v3 > 20 )
    v3 = 40 - v3;
  v4 = (v2 + 3) * (v3 - 10) + v1;
  if ( v4 < 0 )
    v4 += (unsigned int)(255 - v4) >> 8 << 8;
  if ( v4 >= 256 )
    v4 += -256 * ((unsigned int)v4 >> 8);
  return v4;
}

//----- (004F7AB0) --------------------------------------------------------
_DWORD *__cdecl sub_4F7AB0(float2 *a1, int a2)
{
  _DWORD *result; // eax
  int v3; // ebp
  int v4; // ebx
  float2 *v5; // edi
  int v6; // esi
  int j; // ebx
  int v8; // ebp
  int v9; // edi
  int i; // esi
  double v11; // st7
  double v12; // st6
  double v13; // st5
  int v14; // esi
  float v15; // [esp+10h] [ebp-10h]
  int v16; // [esp+14h] [ebp-Ch]
  float v17; // [esp+18h] [ebp-8h]
  int v18; // [esp+1Ch] [ebp-4h]

  result = *(_DWORD **)&byte_5D4594[1568868];
  v3 = 0;
  v16 = 0;
  if ( !*(_DWORD *)&byte_5D4594[1568868] )
  {
    result = (_DWORD *)sub_4E3AA0((CHAR *)&byte_587000[215948]);
    *(_DWORD *)&byte_5D4594[1568868] = result;
  }
  if ( a2 )
  {
    if ( sub_419130(a2 + 48) )
    {
      v16 = *(unsigned __int8 *)(a2 + 52);
      sub_418AB0(v16);
      v3 = v16;
    }
    v4 = 0;
    v5 = 0;
    v6 = sub_4DA790();
    if ( !v6 )
      goto LABEL_13;
    do
    {
      if ( *(unsigned __int16 *)(v6 + 4) == *(_DWORD *)&byte_5D4594[1568868] )
      {
        v5 = (float2 *)v6;
        if ( sub_4F7CE0(v6, v3) )
          ++v4;
      }
      v6 = sub_4DA7A0(v6);
    }
    while ( v6 );
    v18 = v4;
    if ( v4 )
    {
      v17 = 0.0;
      j = 0;
      v8 = 1;
      v9 = sub_4DA790();
      if ( !v9 )
        goto LABEL_39;
      do
      {
        if ( *(unsigned __int16 *)(v9 + 4) == *(_DWORD *)&byte_5D4594[1568868] && sub_4F7CE0(v9, v16) )
        {
          v15 = 10000000.0;
          for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
          {
            if ( i != a2 && sub_5330C0(a2, i) )
            {
              v11 = *(float *)(v9 + 56) - *(float *)(i + 56);
              v12 = *(float *)(v9 + 60) - *(float *)(i + 60);
              v13 = v12 * v12 + v11 * v11;
              if ( v13 < v15 )
                v15 = v13;
              v8 = 0;
            }
          }
          if ( v15 > (double)v17 )
          {
            j = v9;
            v17 = v15;
          }
        }
        v9 = sub_4DA7A0(v9);
      }
      while ( v9 );
      if ( v8 || !j )
      {
LABEL_39:
        v14 = sub_415FA0(0, v18 - 1);
        for ( j = sub_4DA790(); j; j = sub_4DA7A0(j) )
        {
          if ( *(unsigned __int16 *)(j + 4) == *(_DWORD *)&byte_5D4594[1568868] && sub_4F7CE0(j, v16) )
          {
            if ( !v14 )
              break;
            --v14;
          }
        }
      }
      result = (_DWORD *)&a1->field_0;
      *a1 = *(float2 *)(j + 56);
    }
    else
    {
      if ( !v5 )
      {
LABEL_13:
        result = (_DWORD *)&a1->field_0;
        a1->field_0 = 2000.0;
        a1->field_4 = 2000.0;
        return result;
      }
      result = (_DWORD *)&a1->field_0;
      *a1 = v5[7];
    }
  }
  return result;
}

//----- (004F7CE0) --------------------------------------------------------
BOOL __cdecl sub_4F7CE0(int a1, int a2)
{
  return *(_DWORD *)(a1 + 16) & 0x1000000 && (!a2 || !sub_419130(a1 + 48) || sub_419180(a1 + 48, a2));
}

//----- (004F7D30) --------------------------------------------------------
int __cdecl sub_4F7D30(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  int v5; // esi

  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 & 4 )
  {
    v3 = *(_DWORD *)(a1 + 748);
    if ( *(unsigned __int8 *)(v3 + 91) >= a2 )
    {
      *(_BYTE *)(v3 + 91) -= a2;
      sub_4D8800(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), a1);
      return 1;
    }
  }
  else
  {
    if ( !(v2 & 2) )
      return 1;
    v5 = *(_DWORD *)(a1 + 748);
    if ( *(unsigned __int8 *)(v5 + 1128) >= a2 )
    {
      *(_BYTE *)(v5 + 1128) -= a2;
      return 1;
    }
  }
  return 0;
}

//----- (004F7DB0) --------------------------------------------------------
void __cdecl sub_4F7DB0(int a1, char a2)
{
  int v2; // eax

  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v2 = *(_DWORD *)(a1 + 748);
    *(_BYTE *)(v2 + 91) -= a2;
    sub_4D8800(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), a1);
  }
}

//----- (004F7DF0) --------------------------------------------------------
int __cdecl sub_4F7DF0(int a1)
{
  int v1; // eax
  int v2; // esi
  int v4; // eax

  v1 = *(_DWORD *)&byte_5D4594[1568872];
  if ( !*(_DWORD *)&byte_5D4594[1568872] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[216008]);
    *(_DWORD *)&byte_5D4594[1568872] = v1;
  }
  v2 = *(_DWORD *)(a1 + 516);
  if ( !v2 )
    return 0;
  while ( *(unsigned __int16 *)(v2 + 4) != v1 )
  {
    v2 = *(_DWORD *)(v2 + 512);
    if ( !v2 )
      return 0;
  }
  v4 = *(_DWORD *)(v2 + 16);
  LOBYTE(v4) = v4 & 0xBF;
  *(_DWORD *)(v2 + 16) = v4;
  sub_52DF80(a1 + 56, v2, 100.0);
  *(_DWORD *)(v2 + 520) = 0;
  sub_4EC300(v2);
  sub_501960(926, a1, 0, 0);
  sub_4E8290(1, 0);
  return 1;
}

//----- (004F7E80) --------------------------------------------------------
int __cdecl sub_4F7E80(int a1)
{
  if ( a1 & 0x200 )
    return 70;
  if ( a1 & 0x4000 )
    return 100;
  if ( a1 & 0x800 )
    return 50;
  if ( a1 & 0x100 )
    return 45;
  if ( a1 & 0x1000 )
    return 75;
  if ( a1 & 0x2000 )
    return 100;
  if ( a1 & 0x7FF8000 )
    return 45;
  return (a1 & 0x400) != 0 ? 75 : 10;
}

//----- (004F7EF0) --------------------------------------------------------
__int16 __cdecl sub_4F7EF0(int a1)
{
  char *v1; // eax
  char *v2; // ebp
  _DWORD *v3; // edi
  int v4; // ebx
  float v5; // edx
  int v6; // edi
  int v7; // eax
  float2 v9; // [esp+10h] [ebp-8h]

  v1 = sub_416640();
  v2 = v1;
  if ( a1 )
  {
    v3 = *(_DWORD **)(a1 + 748);
    v4 = v3[69];
    if ( !sub_40A5C0(4096) || (v1 = (char *)v3[137]) == 0 )
    {
      if ( v4 )
        *(_DWORD *)(v4 + 4700) = 0;
      if ( sub_40A5C0(4096) )
      {
        sub_4EF7D0(a1, 1, 1);
        *((_BYTE *)v3 + *(unsigned __int8 *)(v3[69] + 2064) + 452) = -6;
        sub_4DA2C0(a1, (const char *)&byte_587000[216020], 0);
      }
      else
      {
        sub_4EF7D0(a1, 1, 0);
      }
      if ( sub_40A5C0(4096) )
        sub_501960(1006, a1, 0, 0);
      else
        sub_501960(148, a1, 0, 0);
      if ( !*(_DWORD *)&byte_5D4594[2650652] || *(_DWORD *)(v2 + 58) )
        sub_53FBC0((float *)(a1 + 56), *(__int16 *)(a1 + 124));
      v5 = *(float *)(a1 + 60);
      v9.field_0 = *(float *)(a1 + 56);
      v9.field_4 = v5;
      if ( sub_40A5C0(4096) && (v6 = v3[77]) != 0 )
        sub_4F80C0(v6, &v9);
      else
        sub_4F7AB0(&v9, a1);
      sub_4E7010(a1, &v9);
      if ( sub_40A5C0(16) )
      {
        if ( sub_417DA0(4) )
        {
          v7 = *((_DWORD *)sub_418AB0(*(unsigned __int8 *)(*(_DWORD *)(v4 + 2056) + 52)) + 19);
          if ( v7 )
          {
            if ( !*(_DWORD *)(v7 + 492) )
              sub_4F3400(*(_DWORD *)(v4 + 2056), v7, 1);
          }
        }
      }
      v1 = (char *)sub_40A5C0(0x2000);
      if ( v1 )
        LOWORD(v1) = sub_4FF380(a1, 23, 5 * *(_WORD *)&byte_5D4594[2649704], 5);
    }
  }
  return (__int16)v1;
}

//----- (004F80C0) --------------------------------------------------------
BOOL __cdecl sub_4F80C0(int a1, float2 *a3)
{
  int v2; // ebx
  BOOL result; // eax

  *a3 = *(float2 *)(a1 + 56);
  v2 = 32;
  do
  {
    sub_4ED970(60.0, (float2 *)(a1 + 56), a3);
    result = sub_411A90(a3);
    if ( !result )
      break;
    --v2;
  }
  while ( v2 );
  return result;
}

//----- (004F8100) --------------------------------------------------------
char __cdecl sub_4F8100(_DWORD *a1)
{
  _DWORD *v1; // edi
  int v2; // ebx
  int v3; // edx
  int v4; // esi
  _WORD *v5; // ebp
  int v6; // eax
  int v7; // eax
  __int16 v8; // ax
  _DWORD *v9; // eax
  int v10; // ecx
  __int16 v11; // ax
  __int16 v12; // ax
  int v13; // eax
  int v14; // eax
  unsigned __int8 v15; // cl
  int v16; // eax
  double v17; // st7
  int v18; // eax
  float v20; // [esp+0h] [ebp-14h]
  float v21; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = 0;
  v3 = 4;
  v4 = a1[187];
  v5 = (_WORD *)a1[139];
  v6 = v4 + 116;
  do
  {
    if ( *(_DWORD *)v6 && *(_BYTE *)(*(_DWORD *)v6 + 16) & 0x20 )
      *(_DWORD *)v6 = 0;
    v6 += 4;
    --v3;
  }
  while ( v3 );
  if ( !(a1[4] & 0x20) )
  {
    if ( sub_40A5C0(4096) && *(_DWORD *)(v4 + 280) )
    {
      a1[22] = 0;
      a1[23] = 0;
      a1[20] = 0;
      a1[21] = 0;
    }
    if ( sub_40A5C0(4096)
      && (v7 = *(_DWORD *)(v4 + 548)) != 0
      && *(_BYTE *)(*(_DWORD *)(v4 + 276) + 2064) != 31
      && *(_DWORD *)&byte_5D4594[2598000] - v7 > (unsigned int)(30 * *(_DWORD *)&byte_5D4594[2649704]) )
    {
      LOBYTE(v6) = sub_4DCFB0((int)a1);
    }
    else
    {
      v8 = *(_WORD *)(v4 + 78);
      if ( v8 )
      {
        *(_WORD *)(v4 + 78) = v8 - 1;
      }
      else
      {
        if ( *(_WORD *)(v4 + 76) )
          v2 = 1000 * (*(unsigned __int16 *)(v4 + 76) - (unsigned __int16)*v5) / *(unsigned __int16 *)(v4 + 76);
        *(_WORD *)(v4 + 76) = *v5;
        if ( v2 > 0 )
          *(_WORD *)(v4 + 78) = 7;
      }
      if ( sub_40A5C0(0x4000000) )
        sub_4F9E70((int)a1);
      sub_4F9ED0(a1);
      v9 = *(_DWORD **)(v4 + 276);
      v10 = v9[907];
      if ( !v10 )
        v10 = v9[514];
      v9[908] = *(_DWORD *)(v10 + 56);
      v9[909] = *(_DWORD *)(v10 + 60);
      v11 = *(_WORD *)(v4 + 160);
      if ( v11 )
        *(_WORD *)(v4 + 160) = v11 - 1;
      sub_4E44F0((int)a1);
      v12 = *(_WORD *)(v4 + 82);
      if ( v12 )
        *(_WORD *)(v4 + 82) = v12 - 1;
      v13 = a1[4];
      if ( (v13 & 0x8000) == 0 )
      {
        if ( v2 > 0 )
        {
          v14 = a1[131];
          if ( *(_BYTE *)(*(_DWORD *)(v4 + 276) + 2252) )
          {
            if ( v14 == 5 )
            {
              sub_501960(330, (int)a1, 0, 0);
            }
            else if ( v2 <= 450 )
            {
              if ( v2 <= 70 )
                sub_501960(327, (int)a1, 0, 0);
              else
                sub_501960(328, (int)a1, 0, 0);
            }
            else
            {
              sub_501960(329, (int)a1, 0, 0);
            }
          }
          else if ( v14 == 5 )
          {
            sub_501960(320, (int)a1, 0, 0);
          }
          else if ( v2 <= 450 )
          {
            if ( v2 <= 70 )
              sub_501960(317, (int)a1, 0, 0);
            else
              sub_501960(318, (int)a1, 0, 0);
          }
          else
          {
            sub_501960(319, (int)a1, 0, 0);
          }
        }
        v15 = *(_BYTE *)(v4 + 91);
        if ( v15 < 0x64u )
          *(_BYTE *)(v4 + 91) = v15 + 0x64u / *(_DWORD *)&byte_5D4594[2649704];
      }
      v16 = *(_DWORD *)(v4 + 216);
      if ( v16
        && !*(_BYTE *)(v4 + 188)
        && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v16) > *(int *)&byte_5D4594[2614260] )
      {
        sub_4FB2A0((int)a1);
        *(_DWORD *)(v4 + 216) = 0;
      }
      sub_4F8420((int)a1);
      sub_4F8460((int)a1);
      if ( sub_4FF350((int)a1, 8) && *(_BYTE *)(v4 + 88) != 1 )
        sub_4FA020(a1, 5);
      sub_421C70((int)a1);
      v6 = *(_DWORD *)(v4 + 132);
      if ( v6 )
      {
        v17 = sub_419D40(&byte_587000[216044]);
        v18 = *(_DWORD *)(v4 + 132);
        if ( *(_BYTE *)(v18 + 16) & 0x20 )
        {
          LOBYTE(v6) = (unsigned int)sub_537520(a1);
        }
        else
        {
          sub_4E7540((int)a1, v18);
          v21 = v17;
          v20 = -v21;
          LOBYTE(v6) = sub_52DF80((int)(v1 + 14), *(_DWORD *)(v4 + 132), v20);
        }
      }
    }
  }
  return v6;
}

//----- (004F8420) --------------------------------------------------------
void __cdecl sub_4F8420(int a1)
{
  _DWORD *i; // esi
  int v2; // eax
  int v3; // eax

  for ( i = *(_DWORD **)(a1 + 504); i; i = (_DWORD *)i[124] )
  {
    v2 = i[4];
    if ( v2 & 0x100 )
    {
      LOBYTE(v3) = sub_4F3180(a1, (int)i);
      if ( !v3 )
        sub_4ED930(a1, i);
    }
  }
}
// 4F8444: variable 'v3' is possibly undefined

//----- (004F8460) --------------------------------------------------------
void __cdecl sub_4F8460(int a1)
{
  int v1; // esi
  int v2; // edi
  char v3; // al
  int v4; // edx
  unsigned __int8 *v5; // ebp
  int v6; // ecx
  int v7; // eax
  unsigned __int8 v8; // al
  int v9; // ecx
  unsigned int v10; // eax
  int v11; // ebx
  unsigned __int8 v12; // al
  int v13; // ecx
  unsigned __int8 v14; // cl
  int v15; // kr00_4
  int v16; // ebx
  unsigned int v17; // ecx
  unsigned __int8 v18; // cl
  bool v19; // cc
  int v20; // ecx
  int v21; // eax
  double v22; // st7
  double v23; // st6
  double v24; // st7
  signed int v25; // ebx
  int v26; // eax
  unsigned int v27; // eax
  int v28; // eax
  int v29; // eax
  int v30; // eax
  unsigned int v31; // ecx
  unsigned int v32; // ebx
  unsigned int v33; // ebp
  int v34; // eax
  unsigned int v35; // eax
  int v36; // eax
  int v37; // eax
  int v38; // ecx
  int v39; // esi
  int v40; // edi
  __int16 v41; // ax
  int v42; // ecx
  int j; // edi
  char *v44; // eax
  int i; // edi
  char *v46; // eax
  int v47; // eax
  unsigned __int8 *v48; // eax
  signed int v49; // edi
  int v50; // eax
  double v51; // st7
  int v52; // eax
  int v53; // eax
  unsigned __int8 v54; // al
  int v55; // ecx
  int v56; // eax
  int v57; // eax
  int v58; // eax
  int v59; // eax
  int v60; // ecx
  int v61; // eax
  int v62; // eax
  int v63; // eax
  int v64; // eax
  int v65; // eax
  char v66; // al
  int v67; // [esp+10h] [ebp-Ch]
  int v68; // [esp+14h] [ebp-8h]
  int v69; // [esp+18h] [ebp-4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  a1 = 0;
  v68 = 0;
  switch ( *(unsigned __int8 *)(v2 + 88) )
  {
    case 0u:
    case 5u:
      if ( !sub_4F9BC0(v1) )
        goto LABEL_10;
      v20 = *(_DWORD *)(*(_DWORD *)(v1 + 748) + 276);
      if ( *(_DWORD *)(v20 + 3656) )
      {
        v69 = 3;
        if ( *(_BYTE *)(v20 + 2252) )
          sub_501960(333, v1, 0, 0);
        else
          sub_501960(323, v1, 0, 0);
        sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), 13, &v69);
        goto LABEL_10;
      }
      v21 = *(_DWORD *)(v2 + 276);
      v68 = 1;
      if ( *(_BYTE *)(v2 + 88) != 5
        && (v23 = (double)*(int *)(v21 + 2288) - *(float *)(v1 + 60),
            v22 = (double)*(int *)(v21 + 2284) - *(float *)(v1 + 56),
            v23 * v23 + v22 * v22 <= 10000.0)
        || sub_4FC250(v1, 4) )
      {
        a1 = 0;
        goto LABEL_93;
      }
      v24 = *(float *)(v1 + 544) + *(float *)(v1 + 544);
      a1 = 1;
      *(float *)(v1 + 544) = v24;
      sub_4F9F90(6, &v67, &v69);
      v25 = (*(_DWORD *)(v1 + 36) + *(_DWORD *)&byte_5D4594[2598000]) / (unsigned int)(v69 + 1) % v67;
      if ( v25 <= (int)((*(_DWORD *)(v1 + 36) + *(_DWORD *)&byte_5D4594[2598000] - 1) / (unsigned int)(v69 + 1) % v67)
        || v25 != 2 && v25 != 8 )
      {
        goto LABEL_90;
      }
      v26 = sub_411160((float2 *)(v1 + 56));
      if ( v26 < 0 || v26 >= *(int *)&byte_5D4594[251568] )
        goto LABEL_90;
      v27 = *(_DWORD *)&byte_5D4594[60 * v26 + 2682224];
      if ( v27 <= 0x80 )
      {
        if ( v27 == 128 )
        {
          sub_501960(278, v1, 0, 0);
          goto LABEL_90;
        }
        v28 = v27 - 2;
        if ( !v28 )
          goto LABEL_90;
        v29 = v28 - 6;
        if ( !v29 )
        {
          sub_501960(277, v1, 0, 0);
          goto LABEL_90;
        }
        if ( v29 == 56 )
        {
          sub_501960(276, v1, 0, 0);
          goto LABEL_90;
        }
LABEL_87:
        sub_501960(275, v1, 0, 0);
        goto LABEL_90;
      }
      switch ( v27 )
      {
        case 0x400u:
          sub_501960(274, v1, 0, 0);
          break;
        case 0x800u:
          sub_501960(279, v1, 0, 0);
          break;
        case 0x4000u:
          break;
        default:
          goto LABEL_87;
      }
LABEL_90:
      if ( sub_415FA0(0, 100) <= 1 )
        sub_501960(322, v1, 0, 0);
LABEL_93:
      if ( !sub_4F9AB0(v1) )
      {
        if ( sub_4FF350(v1, 3) )
          *(_WORD *)(v1 + 126) = sub_4F7A40(v1);
        v30 = 8 * *(__int16 *)(v1 + 126);
        *(float *)(v1 + 88) = *(float *)&byte_587000[v30 + 194136] * *(float *)(v1 + 544) + *(float *)(v1 + 88);
        *(float *)(v1 + 92) = *(float *)&byte_587000[v30 + 194140] * *(float *)(v1 + 544) + *(float *)(v1 + 92);
      }
      if ( !*(_BYTE *)(v2 + 88) )
      {
        sub_4F9F90(4, &v67, &v69);
        v31 = *(_DWORD *)(v1 + 36) + *(_DWORD *)&byte_5D4594[2598000];
        v32 = (v31 - 1) / (v69 + 1) % v67;
        v33 = v31 / (v69 + 1) % v67;
        if ( (!sub_4FC250(v1, 4) || a1) && v33 != v32 && (v33 == 3 || v33 == 9) )
        {
          v34 = sub_411160((float2 *)(v1 + 56));
          if ( v34 >= 0 && v34 < *(int *)&byte_5D4594[251568] )
          {
            v35 = *(_DWORD *)&byte_5D4594[60 * v34 + 2682224];
            if ( v35 <= 0x80 )
            {
              if ( v35 == 128 )
              {
                sub_501960(272, v1, 0, 0);
                goto LABEL_10;
              }
              v36 = v35 - 2;
              if ( !v36 )
                goto LABEL_10;
              v37 = v36 - 6;
              if ( !v37 )
              {
                sub_501960(271, v1, 0, 0);
                goto LABEL_10;
              }
              if ( v37 == 56 )
              {
                sub_501960(270, v1, 0, 0);
                goto LABEL_10;
              }
LABEL_116:
              sub_501960(269, v1, 0, 0);
              goto LABEL_10;
            }
            switch ( v35 )
            {
              case 0x400u:
                sub_501960(268, v1, 0, 0);
                break;
              case 0x800u:
                sub_501960(273, v1, 0, 0);
                break;
              case 0x4000u:
                break;
              default:
                goto LABEL_116;
            }
          }
        }
      }
LABEL_10:
      if ( sub_51AC40(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064)) )
        goto LABEL_247;
      v3 = *(_BYTE *)(v2 + 88);
      if ( (!v3 || v3 == 5) && !sub_4F9A80(v1) )
      {
        sub_4FA020((_DWORD *)v1, 13);
        *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
      }
      v4 = *(_DWORD *)(v2 + 276);
      *(_DWORD *)(v2 + 240) &= 0xFFFFFFE1;
      if ( *(_BYTE *)(v4 + 3680) & 3
        || (v69 = sub_4FEE50(31, v1), (v5 = sub_51AB50(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064))) == 0) )
      {
LABEL_247:
        if ( v68 )
        {
          v66 = *(_BYTE *)(v2 + 88);
          if ( v66 )
          {
            if ( v66 != 5 )
            {
              if ( sub_4FC250(v1, 4) )
                sub_4FC300((_DWORD *)v1, 4);
            }
          }
        }
        return;
      }
      while ( 1 )
      {
        if ( !v69 || *((_DWORD *)v5 + 2) == 1 )
        {
          switch ( *((_DWORD *)v5 + 2) )
          {
            case 1:
              if ( !sub_4FF350(v1, 25) && (!sub_40A5C0(4096) || !*(_DWORD *)(v2 + 280)) && sub_4FC250(v1, 1) != 1 )
                *(_WORD *)(v1 + 126) = *((_WORD *)v5 + 6);
              break;
            case 2:
            case 3:
            case 4:
            case 5:
              if ( sub_4F9BC0(v1) )
              {
                sub_4FEE90(v1);
                if ( !sub_4FC250(v1, 1)
                  && (*(_BYTE *)(v2 + 88) != 1
                   || *(_DWORD *)(*(_DWORD *)(v2 + 276) + 4) & 0x47F0000 && sub_4FA2B0(v1) != 29) )
                {
                  if ( *(_BYTE *)(v2 + 88) == 16 )
                  {
                    sub_4FA020((_DWORD *)v1, 17);
                  }
                  else
                  {
                    if ( a1 )
                      sub_4FA020((_DWORD *)v1, 5);
                    else
                      sub_4FA020((_DWORD *)v1, 0);
                    v56 = *(_DWORD *)(v2 + 240);
                    if ( v5[12] & 2 )
                      LOBYTE(v56) = v56 | 1;
                    else
                      LOBYTE(v56) = v56 & 0xFE;
                    *(_DWORD *)(v2 + 240) = v56;
                    if ( *((_DWORD *)v5 + 2) == 4 )
                      *(_DWORD *)(v2 + 240) |= 4u;
                    if ( *((_DWORD *)v5 + 2) == 5 )
                    {
                      v57 = *(_DWORD *)(v2 + 240);
                      LOBYTE(v57) = v57 | 2;
                      *(_DWORD *)(v2 + 240) = v57;
                    }
                    if ( *((_DWORD *)v5 + 2) == 2 )
                    {
                      v58 = *(_DWORD *)(v2 + 240);
                      LOBYTE(v58) = v58 | 8;
                      *(_DWORD *)(v2 + 240) = v58;
                    }
                    if ( *((_DWORD *)v5 + 2) == 3 )
                    {
                      v59 = *(_DWORD *)(v2 + 240);
                      LOBYTE(v59) = v59 | 0x10;
                      *(_DWORD *)(v2 + 240) = v59;
                    }
                    *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
                  }
                }
              }
              break;
            case 6:
              if ( sub_4F9C40(v1) )
              {
                if ( !sub_40A5C0(128) && !sub_4F7DF0(v1) )
                  sub_4F9C70((_DWORD *)v1);
                if ( *(_BYTE *)(v2 + 88) == 10 )
                  sub_4FA020((_DWORD *)v1, 13);
              }
              break;
            case 7:
              if ( !sub_4F9BC0(v1) || sub_4FC250(v1, 1) || sub_4FC3E0(v1, 2) )
                break;
              sub_4FEE90(v1);
              v60 = *(_DWORD *)(*(_DWORD *)(v1 + 748) + 276);
              if ( *(_DWORD *)(v60 + 3656) )
              {
                v67 = 3;
                if ( *(_BYTE *)(v60 + 2252) )
                  sub_501960(333, v1, 0, 0);
                else
                  sub_501960(323, v1, 0, 0);
                sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), 13, &v67);
              }
              else if ( sub_4F7D30(v1, 90) )
              {
                if ( sub_4FF350(v1, 3) )
                  *(_WORD *)(v1 + 126) = sub_4F7A40(v1);
                *(_DWORD *)(v1 + 16) |= 0x4000u;
                sub_4FA020((_DWORD *)v1, 12);
                *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
                return;
              }
              break;
            case 0x14:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 1);
                sub_501960(186, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x15:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 7);
                sub_501960(190, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x16:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 3);
                sub_501960(192, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x17:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 5);
                sub_501960(188, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x18:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 2);
                sub_501960(187, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x19:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 0);
                sub_501960(193, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x1A:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 8);
                sub_501960(189, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x1B:
              if ( !sub_40A5C0(128) )
              {
                if ( !*(_DWORD *)(v2 + 216) )
                  sub_4F9B90(v1);
                *(_DWORD *)(v2 + 184) = sub_424830(*(_DWORD *)(v2 + 184), 6);
                sub_501960(191, v1, 0, 0);
                *(_BYTE *)(v2 + 188) = 0;
              }
              break;
            case 0x1C:
              sub_4FA020((_DWORD *)v1, 13);
              if ( !sub_40A5C0(128) )
              {
                if ( *(_DWORD *)(v2 + 216) )
                {
                  sub_4FB2A0(v1);
                  *(_DWORD *)(v2 + 216) = 0;
                }
                else
                {
                  v61 = sub_4ECCB0(*((_DWORD *)v5 + 3));
                  sub_4FB0E0(v1, v61);
                }
              }
              break;
            case 0x1D:
              sub_4FA020((_DWORD *)v1, 13);
              if ( !sub_40A5C0(128) )
              {
                if ( *(_DWORD *)(v2 + 216) )
                {
                  sub_4FB2A0(v1);
                  *(_DWORD *)(v2 + 216) = 0;
                }
                v62 = *(_DWORD *)(v2 + 276);
                *(_DWORD *)(v2 + 220) = *(_DWORD *)(v62 + 2284);
                *(_DWORD *)(v2 + 224) = *(_DWORD *)(v62 + 2288);
                v63 = sub_4ECCB0(*((_DWORD *)v5 + 3));
                sub_4FB0E0(v1, v63);
              }
              break;
            case 0x1E:
              if ( !sub_40A5C0(128) )
              {
                if ( *(_DWORD *)(v2 + 216) )
                {
                  sub_4FB2A0(v1);
                  *(_DWORD *)(v2 + 216) = 0;
                }
                v64 = *(_DWORD *)(v2 + 276);
                *(_DWORD *)(v2 + 220) = *(_DWORD *)(v64 + 2284);
                *(_DWORD *)(v2 + 224) = *(_DWORD *)(v64 + 2288);
                v65 = sub_4ECCB0(*((_DWORD *)v5 + 3));
                sub_4FB1D0(v1, v65);
              }
              break;
            default:
              break;
          }
        }
        v5 = sub_51ABC0(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064));
        if ( !v5 )
          goto LABEL_247;
      }
    case 1u:
      if ( !sub_538960(v1) )
      {
        if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 4) & 4 )
        {
          sub_4FA020((_DWORD *)v1, 14);
          *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
        }
        else
        {
          sub_4FA020((_DWORD *)v1, 13);
          *(_BYTE *)(*(_DWORD *)(v2 + 276) + 8) = 0;
        }
      }
      goto LABEL_10;
    case 2u:
      sub_4F9F90(21, &v67, &v69);
      v54 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v55 = v67;
      *(_BYTE *)(v2 + 236) = v54;
      if ( v54 >= v55 )
        *(_BYTE *)(v2 + 236) = v55 - 1;
      goto LABEL_10;
    case 3u:
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) > *(int *)&byte_5D4594[2649704] )
      {
        sub_4FA020((_DWORD *)v1, 4);
        *(_DWORD *)(v2 + 240) &= 0xFFFFFFDF;
        v38 = *(_DWORD *)(v1 + 16) | 0x18;
        *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
        *(_DWORD *)(v1 + 16) = v38;
        *(_DWORD *)(v1 + 84) = 0;
        *(_DWORD *)(v1 + 80) = 0;
        *(_DWORD *)(v1 + 92) = 0;
        *(_DWORD *)(v1 + 88) = 0;
        *(_DWORD *)(v1 + 100) = 0;
        *(_DWORD *)(v1 + 96) = 0;
        v39 = 0;
        if ( *(_DWORD *)&byte_5D4594[1599640] > 0 )
        {
          v40 = 0;
          do
          {
            if ( !strncmp(
                    (const char *)&byte_587000[216108],
                    *(const char **)(v40 + *(_DWORD *)&byte_5D4594[1599636]),
                    0xBu) )
              sub_507310(v39, 0, 0);
            ++v39;
            v40 += 48;
          }
          while ( v39 < *(int *)&byte_5D4594[1599640] );
        }
      }
      return;
    case 4u:
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) <= *(int *)&byte_5D4594[2649704] >> 1 )
        return;
      if ( !sub_40A5C0(1024)
        || (v41 = sub_40A020(1024), v41 <= 0)
        || (v42 = *(_DWORD *)(v2 + 276), *(_DWORD *)(v42 + 2140) < v41) )
      {
        if ( sub_40A5C0(0x2000)
          && (v47 = *(_DWORD *)(v2 + 276), !(*(_BYTE *)(v47 + 3680) & 1))
          && (v48 = sub_51AB50(*(unsigned __int8 *)(v47 + 2064))) != 0 )
        {
          while ( *((_DWORD *)v48 + 2) != 6 )
          {
            v48 = sub_51ABC0(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064));
            if ( !v48 )
              goto LABEL_149;
          }
          sub_51AC30(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064));
          sub_4F7EF0(v1);
        }
        else
        {
LABEL_149:
          if ( !sub_40A5F0() )
            return;
          sub_4F7EF0(v1);
        }
        goto LABEL_10;
      }
      if ( *(_BYTE *)(v42 + 3680) & 1 )
      {
        a1 = *(_DWORD *)(v42 + 3628);
        sub_4E6040(v1);
        for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
        {
          v46 = sub_417040(*(_DWORD *)(i + 36));
          if ( !(*(_DWORD *)(i + 16) & 0x8000) && !(v46[3680] & 1) )
            sub_4E6060(v1, i);
        }
      }
      else
      {
        sub_4174F0(v42, 32);
        sub_4E6860(*(_DWORD *)(v2 + 276), 0, 0);
        sub_4E6040(v1);
        sub_4E60A0(v1);
        if ( !sub_4F9E10(v1) )
        {
          for ( j = sub_4DA7C0(); j; j = sub_4DA7F0(j) )
          {
            v44 = sub_417040(*(_DWORD *)(j + 36));
            if ( !(*(_DWORD *)(j + 16) & 0x8000) && !(v44[3680] & 1) )
              sub_4E6060(v1, j);
          }
        }
      }
      return;
    case 0xAu:
      goto LABEL_9;
    case 0xCu:
      sub_4F9F90(3, &v69, &a1);
      v49 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(a1 + 1);
      v50 = sub_4DA7C0();
      if ( !v50 )
        goto LABEL_155;
      while ( *(_DWORD *)(*(_DWORD *)(v50 + 748) + 132) != v1 )
      {
        v50 = sub_4DA7F0(v50);
        if ( !v50 )
        {
LABEL_155:
          v51 = *(float *)(v1 + 544) + *(float *)(v1 + 544);
          v52 = 8 * *(__int16 *)(v1 + 124);
          *(float *)(v1 + 88) = v51 * *(float *)&byte_587000[v52 + 194136];
          *(float *)(v1 + 92) = v51 * *(float *)&byte_587000[v52 + 194140];
          break;
        }
      }
      if ( v49 >= v69 )
      {
        sub_4FA020((_DWORD *)v1, 0);
        v53 = *(_DWORD *)(v1 + 16);
        BYTE1(v53) &= 0xBFu;
        *(_DWORD *)(v1 + 16) = v53;
        *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
      }
      return;
    case 0xDu:
      *(_DWORD *)(v1 + 16) &= 0xFFFFBFFE;
      if ( sub_4F9A80(v1) )
        sub_4FA020((_DWORD *)v1, 0);
      if ( sub_40A5C0(128)
        || !(**(_DWORD **)(v2 + 276) & 0x3000000)
        || !sub_533E70(v1)
        && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) <= *(int *)&byte_5D4594[2649704] >> 2 )
      {
        goto LABEL_10;
      }
      sub_4FA020((_DWORD *)v1, 15);
LABEL_9:
      *(_BYTE *)(v2 + 236) = 0;
      goto LABEL_10;
    case 0xEu:
      sub_4F9F90(33, &v69, &v67);
      *(_BYTE *)(v2 + 236) = v69 - 1;
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) > *(int *)&byte_5D4594[2649704] )
        sub_4FA020((_DWORD *)v1, 13);
      goto LABEL_10;
    case 0xFu:
      sub_4F9F90(40, &v67, &v69);
      v8 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v9 = v67;
      *(_BYTE *)(v2 + 236) = v8;
      if ( v8 >= v9 )
      {
        sub_4FA020((_DWORD *)v1, 16);
        *(_BYTE *)(v2 + 236) = v67 - 1;
      }
      goto LABEL_10;
    case 0x10u:
      sub_4F9F90(40, &v69, &v67);
      *(_BYTE *)(v2 + 236) = v69 - 1;
      goto LABEL_10;
    case 0x11u:
      sub_4F9F90(40, &v67, &v69);
      v10 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v11 = v67 - v10;
      if ( (int)(v67 - v10) < v67 )
      {
        if ( v11 <= 0 )
        {
          LOBYTE(v11) = 0;
          sub_4FA020((_DWORD *)v1, 13);
        }
        *(_BYTE *)(v2 + 236) = v11;
      }
      else
      {
        *(_BYTE *)(v2 + 236) = v67 - 1;
      }
      goto LABEL_10;
    case 0x12u:
      sub_4F9F90(48, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x13u:
      sub_4F9F90(49, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x14u:
      sub_4F9F90(47, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x15u:
      sub_4F9F90(30, &v69, &v67);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v67 + 1);
      v6 = v69;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x16u:
      sub_4F9F90(31, &v69, &v67);
      *(_BYTE *)(v2 + 236) = v69 - 1;
      goto LABEL_10;
    case 0x17u:
      sub_4F9F90(50, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x18u:
      sub_4F9F90(19, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x19u:
      sub_4F9F90(20, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
      goto LABEL_56;
    case 0x1Au:
      sub_4F9F90(15, &v67, &v69);
      LOBYTE(v7) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v6 = v67;
      *(_BYTE *)(v2 + 236) = v7;
      v7 = (unsigned __int8)v7;
LABEL_56:
      v19 = v7 < v6;
      goto LABEL_57;
    case 0x1Bu:
      sub_4F9F90(16, &v67, &v69);
      v14 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v15 = v67;
      *(_BYTE *)(v2 + 236) = v14;
      if ( v14 >= v15 / 2 )
      {
        sub_4FA020((_DWORD *)v1, 28);
        *(_BYTE *)(v2 + 236) = v67 / 2;
      }
      goto LABEL_10;
    case 0x1Cu:
      sub_4F9F90(16, &v67, &v69);
      *(_BYTE *)(v2 + 236) = v67 / 2;
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) > 0x14 )
      {
        sub_4FA020((_DWORD *)v1, 29);
        *(_BYTE *)(v2 + 236) = v67 / 2;
      }
      goto LABEL_10;
    case 0x1Du:
      sub_4F9F90(16, &v67, &v69);
      v16 = v67;
      v17 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      goto LABEL_51;
    case 0x1Eu:
      sub_4F9F90(52, &v67, &v69);
      v12 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
      v13 = v67;
      *(_BYTE *)(v2 + 236) = v12;
      if ( v12 >= v13 )
      {
        sub_4FA020((_DWORD *)v1, 13);
        *(_DWORD *)(v2 + 164) = 0;
      }
      goto LABEL_10;
    case 0x20u:
      sub_4F9F90(54, &v67, &v69);
      *(_BYTE *)(v2 + 236) = v67 / 2;
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) > 0x14 )
      {
        sub_4FA020((_DWORD *)v1, 33);
        *(_BYTE *)(v2 + 236) = v67 / 2;
      }
      goto LABEL_10;
    case 0x21u:
      sub_4F9F90(54, &v67, &v69);
      v16 = v67;
      v17 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) / (unsigned int)(v69 + 1);
LABEL_51:
      v18 = v16 / 2 + v17;
      *(_BYTE *)(v2 + 236) = v18;
      v19 = v18 < v16;
LABEL_57:
      if ( !v19 )
        sub_4FA020((_DWORD *)v1, 13);
      goto LABEL_10;
    default:
      goto LABEL_10;
  }
}

//----- (004F9A80) --------------------------------------------------------
BOOL __cdecl sub_4F9A80(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 748) + 4 * *(unsigned __int8 *)(*(_DWORD *)(a1 + 748) + 181) + 168) != 0;
}

//----- (004F9AB0) --------------------------------------------------------
int __cdecl sub_4F9AB0(int a1)
{
  int v1; // edi
  int v2; // ecx
  int result; // eax
  double v4; // st7
  int v5; // eax
  double v6; // st7
  float2 v7; // [esp+8h] [ebp-8h]

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 4 * *(unsigned __int8 *)(v1 + 181) + 168);
  if ( !v2 )
    return 0;
  v7.field_0 = *(float *)(v2 + 56) - *(float *)(a1 + 56);
  v4 = *(float *)(v2 + 60) - *(float *)(a1 + 60);
  v7.field_4 = v4;
  if ( v4 * v7.field_4 + v7.field_0 * v7.field_0 >= 100.0 )
  {
    *(_WORD *)(a1 + 126) = sub_509ED0(&v7);
    if ( sub_4FF350(a1, 3) )
      *(_WORD *)(a1 + 126) = sub_4F7A40(a1);
    v5 = 8 * *(__int16 *)(a1 + 126);
    *(float *)(a1 + 88) = *(float *)&byte_587000[v5 + 194136] * *(float *)(a1 + 544) + *(float *)(a1 + 88);
    v6 = *(float *)&byte_587000[v5 + 194140] * *(float *)(a1 + 544);
    result = 1;
    *(float *)(a1 + 92) = v6 + *(float *)(a1 + 92);
  }
  else
  {
    sub_4E5CC0(v2);
    result = 0;
    *(_DWORD *)(v1 + 4 * *(unsigned __int8 *)(v1 + 181) + 168) = 0;
  }
  return result;
}

//----- (004F9B90) --------------------------------------------------------
void *__cdecl sub_4F9B90(int a1)
{
  int v1; // esi
  void *result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  result = sub_424820();
  *(_DWORD *)(v1 + 184) = result;
  *(_DWORD *)(v1 + 216) = *(_DWORD *)&byte_5D4594[2598000];
  return result;
}

//----- (004F9BC0) --------------------------------------------------------
int __cdecl sub_4F9BC0(int a1)
{
  int v1; // esi
  int v3; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( sub_4FF350(a1, 25) )
    return 0;
  if ( sub_4FF350(a1, 5) )
    return 0;
  if ( sub_40A5C0(4096) && *(_DWORD *)(v1 + 280) )
    return 0;
  if ( *(_BYTE *)(v1 + 88) == 1 )
  {
    v3 = *(_DWORD *)(v1 + 104);
    if ( v3 )
    {
      if ( *(_DWORD *)(v3 + 8) & 0x1000000 && *(_BYTE *)(v3 + 12) & 8 )
        return 0;
    }
  }
  return 1;
}

//----- (004F9C40) --------------------------------------------------------
BOOL __cdecl sub_4F9C40(int a1)
{
  int v1; // esi
  BOOL result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( sub_4FF350(a1, 25) )
    result = 0;
  else
    result = *(_BYTE *)(v1 + 88) != 23;
  return result;
}

//----- (004F9C70) --------------------------------------------------------
void __cdecl sub_4F9C70(_DWORD *a1)
{
  int v1; // edi
  int v2; // eax
  int v3; // ebp
  int v4; // eax
  int v5; // eax
  char v6; // bp

  if ( a1 && sub_4F9DC0((int)a1) )
  {
    v1 = a1[187];
    v2 = *(_DWORD *)(*(_DWORD *)(v1 + 276) + 4);
    if ( v2 )
    {
      if ( v2 & 0x47F0000 && sub_4FA2B0((int)a1) != 29 )
      {
        v3 = *(_DWORD *)(*(_DWORD *)(v1 + 104) + 736);
        if ( *(_BYTE *)(v3 + 108) || !*(_BYTE *)(v3 + 109) )
        {
          a1[34] = *(_DWORD *)&byte_5D4594[2598000];
          *(_BYTE *)(v1 + 236) = 0;
          sub_4FA020(a1, 1);
          sub_53F8E0((int)a1, *(_DWORD *)(v1 + 104));
        }
        else if ( sub_4F7D30((int)a1, 45) )
        {
          v4 = *(_DWORD *)(v3 + 96);
          LOBYTE(v4) = v4 | 2;
          *(_DWORD *)(v3 + 96) = v4;
          a1[34] = *(_DWORD *)&byte_5D4594[2598000];
          *(_BYTE *)(v1 + 236) = 0;
          sub_4FA020(a1, 1);
        }
      }
      else if ( *(_BYTE *)(v1 + 88) != 1 )
      {
        v5 = sub_4F7E80(*(_DWORD *)(*(_DWORD *)(v1 + 276) + 4));
        v6 = v5;
        if ( sub_4F7D30((int)a1, v5) )
        {
          a1[34] = *(_DWORD *)&byte_5D4594[2598000];
          *(_BYTE *)(v1 + 236) = 0;
          if ( !sub_4FA020(a1, 1) )
            sub_4F7DB0((int)a1, -v6);
        }
      }
      sub_4FF5B0((int)a1, 0);
      sub_4FF5B0((int)a1, 23);
      sub_4FEB10(67, (int)a1);
    }
    else if ( *(_BYTE *)(v1 + 88) != 1 )
    {
      sub_4FA020(a1, 1);
    }
  }
}

//----- (004F9DC0) --------------------------------------------------------
BOOL __cdecl sub_4F9DC0(int a1)
{
  BOOL result; // eax

  if ( !a1 )
    return 0;
  if ( !*(_DWORD *)(*(_DWORD *)(a1 + 748) + 288)
    || sub_5330C0(a1, *(_DWORD *)(*(_DWORD *)(a1 + 748) + 288))
    || (result = sub_40A5C0(4096)) )
  {
    result = 1;
  }
  return result;
}

//----- (004F9E10) --------------------------------------------------------
int __cdecl sub_4F9E10(int a1)
{
  int v1; // eax
  int v2; // ecx

  if ( !a1 )
    return 0;
  if ( !*(_DWORD *)(a1 + 520) )
    return 0;
  v1 = sub_4EC580(*(_DWORD *)(a1 + 520));
  if ( *(_BYTE *)(v1 + 16) & 0x20 )
    return 0;
  v2 = *(_DWORD *)(v1 + 8);
  if ( v2 & 2 || v2 & 4 && *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v1 + 748) + 276) + 3680) & 1 )
    return 0;
  sub_4E6060(a1, v1);
  return 1;
}

//----- (004F9E70) --------------------------------------------------------
void __cdecl sub_4F9E70(int a1)
{
  int v1; // edx
  int v2; // eax
  _WORD *v3; // ecx

  v1 = sub_40AA50();
  v2 = *(_DWORD *)(a1 + 16);
  v3 = *(_WORD **)(a1 + 556);
  if ( (v2 & 0x8000) == 0
    && v3
    && *v3
    && !(*(_DWORD *)&byte_5D4594[2598000]
       % (v1 * *(_DWORD *)&byte_5D4594[2649704] / (unsigned int)(unsigned __int16)v3[2])) )
  {
    sub_4EE5E0(a1, 1);
  }
}

//----- (004F9ED0) --------------------------------------------------------
void __cdecl sub_4F9ED0(_DWORD *a1)
{
  int v1; // ecx
  int v2; // ebx
  unsigned __int16 *v3; // eax
  int v4; // ecx
  unsigned __int16 v5; // si

  v1 = a1[4];
  v2 = a1[187];
  v3 = (unsigned __int16 *)a1[139];
  if ( (v1 & 0x8000) != 0 )
    return;
  if ( !v3 )
    goto LABEL_8;
  v4 = *(_DWORD *)&byte_5D4594[2649704];
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - a1[134]) > *(int *)&byte_5D4594[2649704] )
  {
    v5 = v3[2];
    if ( *v3 < v5
      && v5
      && !(*(_DWORD *)&byte_5D4594[2598000] % (300 * *(_DWORD *)&byte_5D4594[2649704] / (unsigned int)v3[2])) )
    {
      sub_4EE460((int)a1, 1);
LABEL_8:
      v4 = *(_DWORD *)&byte_5D4594[2649704];
      goto LABEL_9;
    }
  }
LABEL_9:
  if ( *(_WORD *)(v2 + 4) < *(_WORD *)(v2 + 8)
    && !(*(_DWORD *)&byte_5D4594[2598000] % (300 * v4 / (unsigned int)*(unsigned __int16 *)(v2 + 8))) )
  {
    sub_4EEB80((int)a1, 1);
  }
}

//----- (004F9F90) --------------------------------------------------------
int __cdecl sub_4F9F90(int a1, _DWORD *a2, int *a3)
{
  int result; // eax

  *a2 = *(_DWORD *)&byte_5D4594[8 * a1 + 1568412];
  result = *(_DWORD *)&byte_5D4594[8 * a1 + 1568416];
  *a3 = result;
  return result;
}

//----- (004F9FB0) --------------------------------------------------------
int __cdecl sub_4F9FB0(int a1, int a2, int a3)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[8 * a1 + 1568412] = a2;
  *(_DWORD *)&byte_5D4594[8 * a1 + 1568416] = a3;
  return result;
}

//----- (004F9FD0) --------------------------------------------------------
int __cdecl sub_4F9FD0(int a1)
{
  int v1; // ecx

  if ( !a1 )
    return 0;
  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 & 4 )
    return *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2239);
  if ( !(v1 & 2) )
    return 0;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    return *(unsigned __int8 *)(*(_DWORD *)(a1 + 748) + 1324);
  return 30;
}

//----- (004FA020) --------------------------------------------------------
int __cdecl sub_4FA020(_DWORD *a1, int a2)
{
  int v2; // ebx
  int v3; // ebp
  int v4; // eax
  int v5; // esi
  int v7; // eax
  int v8; // eax
  int v9; // ecx

  v2 = a2;
  v3 = 1;
  v4 = a1[4];
  v5 = a1[187];
  if ( (v4 & 0x8000) != 0 && a2 != 3 && a2 != 4 )
    return 0;
  if ( !sub_40A5C0(2048) )
  {
    v7 = a1[4];
    if ( v7 & 0x4000 )
    {
      if ( a2 == 30 )
        return 0;
    }
  }
  if ( a2 == 24 || a2 == 25 || a2 == 26 || a2 == 27 || a2 == 28 || a2 == 29 )
  {
    if ( sub_4FC250((int)a1, 1) )
      return 0;
    if ( *(_BYTE *)(v5 + 88) == 12 )
      return 0;
  }
  if ( *(_BYTE *)(v5 + 88) == 1 )
  {
    if ( a2 == 1 )
      goto LABEL_26;
    if ( sub_4FC3E0((int)a1, 2) && a2 != 4 && a2 != 3 )
      return 0;
  }
  if ( a2 != 1 )
  {
    *(_BYTE *)(*(_DWORD *)(v5 + 276) + 8) = 0;
    switch ( a2 )
    {
      case 3:
      case 4:
        *(_WORD *)(v5 + 160) = 0;
        *(_DWORD *)(v5 + 164) = 0;
        break;
      case 25:
        if ( *(unsigned __int8 *)(v5 + 88) != a2 )
          sub_501960(301, (int)a1, 0, 0);
        break;
      case 26:
        if ( *(unsigned __int8 *)(v5 + 88) != a2 )
          sub_501960(300, (int)a1, 0, 0);
        break;
      case 28:
        if ( *(unsigned __int8 *)(v5 + 88) != a2 )
          sub_501960(302, (int)a1, 0, 0);
        break;
      default:
        goto LABEL_42;
    }
    goto LABEL_42;
  }
LABEL_26:
  if ( *(_DWORD *)v5 <= *(int *)&byte_5D4594[2598000] )
  {
    v8 = *(_DWORD *)(v5 + 276);
    v9 = *(_DWORD *)(v8 + 4);
    *(_DWORD *)v5 = 0;
    if ( v9 )
    {
      *(_BYTE *)(v8 + 8) = 0;
    }
    else
    {
      *(_BYTE *)(*(_DWORD *)(v5 + 276) + 8) = sub_415FA0(23, 24);
      if ( !*(_BYTE *)(*(_DWORD *)(v5 + 276) + 2251) && sub_415FA0(0, 100) > 75 )
        *(_BYTE *)(*(_DWORD *)(v5 + 276) + 8) = 25;
      sub_4FF5B0((int)a1, 0);
      sub_4FF5B0((int)a1, 23);
      sub_4FEB10(67, (int)a1);
    }
  }
  else
  {
    v3 = 0;
    v2 = *(unsigned __int8 *)(v5 + 88);
  }
LABEL_42:
  if ( *(unsigned __int8 *)(v5 + 88) != v2 )
  {
    *(_BYTE *)(v5 + 89) = *(_BYTE *)(v5 + 88);
    *(_BYTE *)(v5 + 88) = v2;
    a1[34] = *(_DWORD *)&byte_5D4594[2598000];
    *(_BYTE *)(v5 + 236) = 0;
  }
  if ( v2 == 30 )
    *(_DWORD *)(v5 + 164) = *(_DWORD *)&byte_5D4594[2598000];
  return v3;
}

//----- (004FA280) --------------------------------------------------------
int __cdecl sub_4FA280(int a1)
{
  int v1; // ecx

  v1 = 2;
  while ( !((1 << v1) & a1) )
  {
    if ( ++v1 >= 27 )
      return 0;
  }
  return *(_DWORD *)&byte_587000[4 * v1 + 215824];
}

//----- (004FA2B0) --------------------------------------------------------
int __cdecl sub_4FA2B0(int a1)
{
  int v1; // edi
  int result; // eax
  int v3; // ecx

  v1 = *(_DWORD *)(a1 + 748);
  switch ( *(unsigned __int8 *)(v1 + 88) )
  {
    case 0u:
      result = 4;
      break;
    case 1u:
    case 0xEu:
    case 0x16u:
      if ( sub_4FC250(a1, 2) && sub_4FC3E0(a1, 2) )
      {
        result = 46;
      }
      else if ( sub_4FC250(a1, 1) )
      {
        result = 45;
      }
      else
      {
        result = *(_DWORD *)(v1 + 276);
        v3 = *(_DWORD *)(result + 4);
        if ( v3 & 0x47F0000 )
        {
          result = ~(unsigned __int8)*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v1 + 104) + 736) + 96) & 2;
          LOBYTE(result) = result | 0x1D;
        }
        else if ( v3 && v3 != 1 || (LOBYTE(result) = *(_BYTE *)(result + 8), !(_BYTE)result) )
        {
          result = sub_4FA280(v3);
        }
        else
        {
          result = (unsigned __int8)result;
        }
      }
      break;
    case 2u:
    case 0xAu:
      result = 21;
      break;
    case 3u:
      result = 1;
      break;
    case 4u:
      result = 2;
      break;
    case 5u:
      result = 6;
      break;
    case 0xCu:
      result = 3;
      break;
    case 0xDu:
      result = (*(_DWORD *)(*(_DWORD *)(v1 + 276) + 4) & 0x400) != 0 ? 0x26 : 0;
      break;
    case 0xFu:
    case 0x10u:
    case 0x11u:
      result = 40;
      break;
    case 0x12u:
      result = 48;
      break;
    case 0x13u:
      result = 49;
      break;
    case 0x14u:
      result = 47;
      break;
    case 0x15u:
      result = 30;
      break;
    case 0x17u:
      result = 50;
      break;
    case 0x18u:
      result = 19;
      break;
    case 0x19u:
      result = 20;
      break;
    case 0x1Au:
      result = 15;
      break;
    case 0x1Bu:
    case 0x1Cu:
    case 0x1Du:
      result = 16;
      break;
    case 0x1Eu:
      result = 52;
      break;
    case 0x20u:
      result = 54;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (004FA490) --------------------------------------------------------
int __cdecl sub_4FA490(int a1)
{
  int result; // eax
  _DWORD *i; // esi
  int *v3; // edi
  int v4; // ebx
  int (__cdecl *v5)(int, _DWORD *, _DWORD); // ecx

  result = a1;
  for ( i = *(_DWORD **)(a1 + 504); i; i = (_DWORD *)i[124] )
  {
    result = i[4];
    if ( result & 0x100 && i[2] & 0x13001000 )
    {
      v3 = (int *)i[173];
      v4 = 4;
      do
      {
        result = *v3;
        if ( *v3 )
        {
          v5 = *(int (__cdecl **)(int, _DWORD *, _DWORD))(result + 100);
          if ( v5 )
            result = v5(result, i, 0);
        }
        ++v3;
        --v4;
      }
      while ( v4 );
    }
  }
  return result;
}

//----- (004FA4F0) --------------------------------------------------------
int __cdecl sub_4FA4F0(int a1, int a2)
{
  _DWORD *v2; // edi
  int v3; // eax
  int v4; // ebp
  int *v5; // ebx
  int v6; // esi
  BOOL (__cdecl *v7)(int, int, int, int, int, BOOL *); // eax
  int v8; // eax
  int result; // eax
  int v10; // [esp+10h] [ebp-4h]

  v2 = *(_DWORD **)(a1 + 504);
  if ( !v2 )
    return 0;
  while ( 1 )
  {
    v3 = v2[4];
    if ( v3 & 0x100 )
    {
      if ( v2[2] & 0x13001000 )
        break;
    }
LABEL_10:
    v2 = (_DWORD *)v2[124];
    if ( !v2 )
      return 0;
  }
  v4 = 2;
  v5 = (int *)(v2[173] + 8);
  while ( 1 )
  {
    v6 = *v5;
    v10 = 0;
    if ( v6 )
    {
      v7 = *(BOOL (__cdecl **)(int, int, int, int, int, BOOL *))(v6 + 88);
      if ( v7 )
      {
        if ( v7 == sub_4E03D0 )
        {
          v8 = sub_4EC580(a2);
          (*(void (__cdecl **)(int, _DWORD *, int, int, int, int *))(v6 + 88))(v6, v2, a1, a2, v8, &v10);
          result = 1;
          if ( v10 == 1 )
            return result;
        }
      }
    }
    ++v4;
    ++v5;
    if ( v4 >= 4 )
      goto LABEL_10;
  }
}

//----- (004FA590) --------------------------------------------------------
_DWORD *__cdecl sub_4FA590(int a1, int a2)
{
  int v2; // eax

  v2 = *(_DWORD *)(a1 + 748);
  *(_DWORD *)(*(_DWORD *)(v2 + 276) + 2164) += a2;
  return sub_56F920(*(_DWORD *)(*(_DWORD *)(v2 + 276) + 4588), a2);
}

//----- (004FA5D0) --------------------------------------------------------
_DWORD *__cdecl sub_4FA5D0(int a1, unsigned int a2)
{
  int v2; // esi
  int v3; // edx
  unsigned int v4; // eax

  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(_DWORD *)(v2 + 276);
  v4 = *(_DWORD *)(v3 + 2164);
  if ( v4 >= a2 )
    *(_DWORD *)(v3 + 2164) = v4 - a2;
  else
    *(_DWORD *)(v3 + 2164) = 0;
  return sub_56F920(*(_DWORD *)(*(_DWORD *)(v2 + 276) + 4588), -a2);
}

//----- (004FA620) --------------------------------------------------------
_DWORD *__cdecl sub_4FA620(int a1, int a2)
{
  _DWORD *result; // eax
  int v3; // eax
  int v4; // edx

  result = (_DWORD *)a1;
  if ( a1 && *(_BYTE *)(a1 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a1 + 748);
    if ( a2 >= 0 || (v4 = *(_DWORD *)(v3 + 276), *(_DWORD *)(v4 + 2164) >= (unsigned int)-a2) )
    {
      *(_DWORD *)(*(_DWORD *)(v3 + 276) + 2164) += a2;
      result = sub_56F920(*(_DWORD *)(*(_DWORD *)(v3 + 276) + 4588), a2);
    }
    else
    {
      *(_DWORD *)(v4 + 2164) = 0;
      result = sub_56F7D0(*(_DWORD *)(*(_DWORD *)(v3 + 276) + 4588), 0);
    }
  }
  return result;
}

//----- (004FA6B0) --------------------------------------------------------
int __cdecl sub_4FA6B0(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2164);
}

//----- (004FA6D0) --------------------------------------------------------
int __cdecl sub_4FA6D0(int a1)
{
  int result; // eax

  if ( a1 && *(_BYTE *)(a1 + 8) & 4 )
    result = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2164);
  else
    result = 0;
  return result;
}

//----- (004FA700) --------------------------------------------------------
int __cdecl sub_4FA700(int a1)
{
  int result; // eax
  int v2; // ebp
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax
  int v6; // ebp
  unsigned int v7; // edx
  __int16 v8; // ax
  __int16 v9; // ax
  int v10; // ebp
  unsigned int v11; // eax
  int v12; // eax
  __int16 v13; // cx

  result = a1;
  v2 = *(_DWORD *)(a1 + 748);
  if ( !*(_DWORD *)(v2 + 292) )
  {
    result = (int)nox_calloc(1u, 0x898u);
    *(_DWORD *)(v2 + 292) = result;
  }
  v3 = *(_DWORD **)(v2 + 292);
  if ( v3 )
  {
    memset(v3, 0, 0x898u);
    v3[545] = v2;
    v4 = sub_4E3AA0((CHAR *)&byte_587000[216216]);
    v3[121] = sub_517560(v4);
    v3[334] = 1048576000;
    *((_BYTE *)v3 + 1340) = 1;
    v3[336] = 1061997773;
    *((_BYTE *)v3 + 1348) = 1;
    v3[360] = 186376;
    *((_BYTE *)v3 + 1444) = 0;
    *((_BYTE *)v3 + 544) = 0;
    v3[138] = 5;
    v3[340] = 38;
    v3[327] = 1056964608;
    v3[326] = 1062501089;
    v3[328] = 1125515264;
    v3[329] = 1106247680;
    *((_BYTE *)v3 + 1332) = -1;
    v3[330] = 1065353216;
    *((_BYTE *)v3 + 1324) = 30;
    v3[332] = 1056964608;
    v3[338] = 1065353216;
    v3[307] = -1;
    v3[309] = -1;
    v3[311] = -1;
    v3[313] = -1;
    v3[315] = -1;
    v3[317] = -1;
    v3[319] = -1;
    v3[321] = -1;
    v3[323] = -1;
    v3[325] = -1;
    v3[510] = 3;
    v3[524] = -1;
    v3[525] = -1;
    *v3 = -559023410;
    v3[94] = *(__int16 *)(a1 + 124);
    v3[95] = *(_DWORD *)(a1 + 56);
    v3[96] = *(_DWORD *)(a1 + 60);
    result = *(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2251);
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251) )
    {
      v5 = result - 1;
      if ( v5 )
      {
        result = v5 - 1;
        if ( !result )
        {
          v6 = v3[360];
          v3[339] = 1112014848;
          v3[410] = 0x8000000;
          v3[360] = v6 | 0x20;
          *((_WORD *)v3 + 724) = 0;
          v7 = *(_DWORD *)&byte_5D4594[2649704];
          v3[430] = 0x10000000;
          *((_WORD *)v3 + 725) = v7 >> 1;
          *((_WORD *)v3 + 728) = 0;
          *((_WORD *)v3 + 729) = 6 * *(_WORD *)&byte_5D4594[2649704];
          v3[432] = 0x20000000;
          v3[446] = 0x20000000;
          *((_WORD *)v3 + 732) = 3 * *(_WORD *)&byte_5D4594[2649704];
          v8 = *(_WORD *)&byte_5D4594[2649704];
          *((_WORD *)v3 + 736) = 0;
          *((_WORD *)v3 + 733) = 30 * v8;
          v3[401] = 0x40000000;
          v3[424] = 0x40000000;
          v3[456] = 0x40000000;
          v3[455] = 0x40000000;
          v3[464] = 0x40000000;
          v9 = *(_WORD *)&byte_5D4594[2649704];
          v3[376] = 2147483648;
          *((_WORD *)v3 + 740) = 0;
          *((_WORD *)v3 + 737) = 2 * v9;
          result = *(_DWORD *)&byte_5D4594[2649704];
          *((_WORD *)v3 + 741) = 6 * *(_WORD *)&byte_5D4594[2649704];
        }
      }
      else
      {
        v10 = v3[360];
        v3[339] = 1112014848;
        v3[410] = 0x8000000;
        v3[360] = v10 | 0x20;
        *((_WORD *)v3 + 724) = 0;
        v11 = *(_DWORD *)&byte_5D4594[2649704];
        *((_WORD *)v3 + 728) = 0;
        *((_WORD *)v3 + 725) = v11 >> 1;
        v3[423] = 0x10000000;
        v3[408] = 0x10000000;
        v3[411] = 0x10000000;
        *((_WORD *)v3 + 729) = *(_WORD *)&byte_5D4594[2649704];
        v3[384] = 0x20000000;
        v3[405] = 0x20000000;
        *((_WORD *)v3 + 732) = 3 * *(_WORD *)&byte_5D4594[2649704];
        *((_WORD *)v3 + 733) = 30 * *(_WORD *)&byte_5D4594[2649704];
        v12 = sub_415FA0(0, 100);
        if ( v12 >= 33 )
        {
          if ( v12 >= 66 )
          {
            v3[415] = 0x40000000;
            v3[422] = 0x40000000;
          }
          else
          {
            v3[388] = 0x40000000;
          }
        }
        else
        {
          v3[399] = 0x40000000;
        }
        *((_WORD *)v3 + 736) = 0;
        v13 = *(_WORD *)&byte_5D4594[2649704];
        v3[376] = 2147483648;
        *((_WORD *)v3 + 740) = 0;
        *((_WORD *)v3 + 737) = 2 * v13;
        result = 6 * *(_DWORD *)&byte_5D4594[2649704];
        *((_WORD *)v3 + 741) = 6 * *(_WORD *)&byte_5D4594[2649704];
      }
    }
    else
    {
      v3[339] = 0;
    }
  }
  return result;
}

//----- (004FAAC0) --------------------------------------------------------
char __cdecl sub_4FAAC0(_DWORD *a1)
{
  int v1; // eax
  int v2; // edx

  v1 = a1[2];
  if ( v1 & 4 )
  {
    LOBYTE(v1) = v1 & 0xFB | 2;
    v2 = *(_DWORD *)(a1[187] + 292);
    a1[2] = v1;
    a1[187] = v2;
    a1[3] = 16;
  }
  return v1;
}

//----- (004FAAF0) --------------------------------------------------------
char __cdecl sub_4FAAF0(_DWORD *a1)
{
  int v1; // eax
  int v2; // edx

  v1 = a1[2];
  if ( v1 & 2 )
  {
    LOBYTE(v1) = v1 & 0xFD | 4;
    v2 = *(_DWORD *)(a1[187] + 2180);
    a1[2] = v1;
    a1[187] = v2;
    a1[3] = 0;
  }
  return v1;
}

//----- (004FAB20) --------------------------------------------------------
int __cdecl sub_4FAB20(_DWORD *a1)
{
  int v1; // edi
  int result; // eax
  int v3; // ebx
  int v4; // eax
  char v5; // al
  int v6; // ecx

  v1 = a1[187];
  if ( *(_DWORD *)(v1 + 292) || (sub_4FA700((int)a1), (result = *(_DWORD *)(v1 + 292)) != 0) )
  {
    result = sub_4FAC70((int)a1);
    if ( !result )
    {
      v3 = *(_DWORD *)(v1 + 292);
      v4 = *(_DWORD *)(v3 + 1440);
      BYTE1(v4) |= 1u;
      *(_DWORD *)(v3 + 1440) = v4;
      sub_4FAAC0(a1);
      sub_50A5C0(*(float *)&a1);
      sub_4FAAF0(a1);
      v5 = sub_4FABC0((int)a1);
      v6 = *(_DWORD *)(v1 + 276);
      *(_BYTE *)(v1 + 88) = v5;
      *(_BYTE *)(v1 + 236) = *(_BYTE *)(v3 + 481);
      *(_DWORD *)(v6 + 3632) = a1[14];
      result = a1[15];
      *(_DWORD *)(v6 + 3636) = result;
    }
  }
  else
  {
    a1[186] = sub_4F8100;
  }
  return result;
}

//----- (004FABC0) --------------------------------------------------------
char __cdecl sub_4FABC0(int a1)
{
  int v1; // ecx
  char v2; // al
  char result; // al

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 292);
  v2 = *(_BYTE *)(v1 + 544);
  if ( v2 == -1 )
    return 13;
  switch ( *(_DWORD *)(v1 + 24 * (v2 + 23)) )
  {
    case 7:
    case 8:
    case 0xA:
    case 0xD:
    case 0x1D:
      result = (*(_DWORD *)(v1 + 1440) & 0x4000) != 0 ? 5 : 0;
      break;
    case 9:
      result = 0;
      break;
    case 0x10:
    case 0x11:
      result = 1;
      break;
    case 0x12:
    case 0x13:
    case 0x14:
      result = 2;
      break;
    case 0x15:
    case 0x17:
      result = 16;
      break;
    case 0x16:
      result = 17;
      break;
    case 0x18:
      result = 5;
      break;
    case 0x1E:
      result = 3;
      break;
    case 0x1F:
      result = 4;
      break;
    default:
      return 13;
  }
  return result;
}

//----- (004FAC70) --------------------------------------------------------
int __cdecl sub_4FAC70(int a1)
{
  int v1; // edi
  char *v2; // ebx
  float2 v4; // [esp+Ch] [ebp-8h]

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 292);
  v2 = sub_416640();
  if ( !**(_WORD **)(a1 + 556) )
  {
    if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 548) < (unsigned int)(2 * *(_DWORD *)&byte_5D4594[2649704]) )
      return 1;
    sub_4FA700(a1);
    sub_4EF7D0(a1, 1, 0);
    if ( !*(_DWORD *)&byte_5D4594[2650652] || *(_DWORD *)(v2 + 58) )
      sub_53FBC0((float *)(a1 + 56), *(__int16 *)(a1 + 124));
    sub_4F7AB0(&v4, a1);
    sub_4E7010(a1, &v4);
    sub_501960(148, a1, 0, 0);
    if ( sub_40A5C0(0x2000) )
      sub_4FF380(a1, 23, 5 * *(_WORD *)&byte_5D4594[2649704], 5);
  }
  return 0;
}

//----- (004FAD50) --------------------------------------------------------
int __cdecl sub_4FAD50(int a1, int a2, int a3, char a4)
{
  int result; // eax
  int v5; // ecx
  char v6[5]; // [esp+0h] [ebp-8h]

  result = a1;
  if ( a1 && *(_BYTE *)(a1 + 8) & 4 )
  {
    v5 = *(_DWORD *)(a1 + 748);
    v6[0] = -16;
    if ( a2 )
    {
      if ( a2 == 1 )
      {
        v6[1] = 31;
      }
      else
      {
        result = a2 - 2;
        if ( a2 != 2 )
          return result;
        v6[1] = 32;
      }
    }
    else
    {
      v6[1] = 30;
    }
    *(_WORD *)&v6[3] = *(_WORD *)(a3 + 36);
    v6[2] = a4;
    result = sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), v6, 5, 0, 1);
  }
  return result;
}

//----- (004FADD0) --------------------------------------------------------
void __cdecl sub_4FADD0(int a1, const char *a2, char a3)
{
  unsigned int v4; // kr04_4
  char v5[52]; // [esp+8h] [ebp-34h]

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      if ( a2 )
      {
        v4 = strlen(a2) + 1;
        if ( (_BYTE)v4 != 1 && (unsigned __int8)(v4 - 1) <= 0x30u )
        {
          v5[51] = a3;
          v5[0] = -16;
          v5[1] = 33;
          strcpy(&v5[2], a2);
          sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064), v5, 52, 0, 1);
        }
      }
    }
  }
}

//----- (004FAE70) --------------------------------------------------------
void sub_4FAE70()
{
  srand(0x1432u);
}

//----- (004FAE80) --------------------------------------------------------
int __cdecl sub_4FAE80(int a1, int a2, int a3)
{
  int v3; // ebp
  int v4; // edi
  int v5; // eax
  int v6; // ecx
  _DWORD *v7; // eax
  unsigned __int8 *v8; // ecx
  _DWORD *v9; // esi
  int v10; // eax
  int *v11; // esi
  int v12; // eax
  char *i; // esi
  int v14; // eax
  wchar_t *v16; // eax
  unsigned __int8 *v17; // [esp+10h] [ebp+4h]

  v3 = a1;
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  if ( a2 <= 0 || a2 >= 41 )
  {
    v16 = sub_40F1D0((char *)&byte_587000[216340], 0, (const char *)&byte_587000[216300], 39);
    sub_4D9EB0(a1, v16);
    return 0;
  }
  v4 = *(_DWORD *)(a1 + 748);
  v5 = *(_DWORD *)(v4 + 276);
  v6 = *(_DWORD *)(v5 + 4 * a2 + 4244);
  v7 = (_DWORD *)(v5 + 4 * a2 + 4244);
  if ( v6 )
    return 0;
  *v7 = 1;
  sub_56FCE0(*(_DWORD *)(*(_DWORD *)(v4 + 276) + 4640), a2, *(_DWORD *)(*(_DWORD *)(v4 + 276) + 4 * a2 + 4244));
  if ( a3 )
  {
    sub_501960(227, a1, 0, 0);
    sub_4FAD50(a1, 1, a1, a2);
  }
  v8 = &byte_587000[216292];
  v17 = &byte_587000[216292];
  if ( *(_DWORD *)&byte_587000[216292] )
  {
    do
    {
      v9 = *(_DWORD **)v8;
      if ( a2 == **(_DWORD **)v8 )
      {
        v10 = v9[1];
        v11 = v9 + 1;
        if ( v10 )
        {
          do
          {
            *(_DWORD *)(*(_DWORD *)(v4 + 276) + 4 * v10 + 4244) = 1;
            sub_56FCE0(
              *(_DWORD *)(*(_DWORD *)(v4 + 276) + 4640),
              *v11,
              *(_DWORD *)(*(_DWORD *)(v4 + 276) + 4 * *v11 + 4244));
            v10 = v11[1];
            ++v11;
          }
          while ( v10 );
          v8 = v17;
        }
      }
      v12 = *((_DWORD *)v8 + 1);
      v8 += 4;
      v17 = v8;
    }
    while ( v12 );
  }
  if ( a3 )
  {
    for ( i = sub_416EA0(); i; i = sub_416EE0((int)i) )
    {
      v14 = *((_DWORD *)i + 514);
      if ( v14 != v3 )
      {
        if ( v14 )
          sub_4FAD50(v14, 1, v3, a2);
      }
    }
  }
  sub_4D8000(v3, a2, a3, 0);
  return 1;
}

//----- (004FB000) --------------------------------------------------------
int __cdecl sub_4FB000(int a1, int a2)
{
  int v2; // esi
  const char *v3; // eax
  int v4; // eax
  int result; // eax

  if ( a1
    && a2
    && *(_BYTE *)(a1 + 8) & 4
    && *(_BYTE *)(a2 + 8) & 2
    && (v2 = *(_DWORD *)(a1 + 748), v3 = (const char *)sub_4E39D0(a2), (v4 = sub_427010(v3)) != 0) )
  {
    result = *(_DWORD *)(*(_DWORD *)(v2 + 276) + 4 * v4 + 4244);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (004FB050) --------------------------------------------------------
int __cdecl sub_4FB050(int a1, int a2, int *a3)
{
  int result; // eax
  float v4; // [esp+0h] [ebp-8h]

  result = sub_4FB000(a1, a2);
  if ( result )
  {
    v4 = sub_419D40(&byte_587000[216356]) * (double)*a3 + 0.5;
    result = sub_419A70(v4);
    *a3 = result;
  }
  return result;
}

//----- (004FB090) --------------------------------------------------------
void sub_4FB090()
{
  srand(0x1433u);
}

//----- (004FB0A0) --------------------------------------------------------
void sub_4FB0A0()
{
  srand(0x143Cu);
}

//----- (004FB0B0) --------------------------------------------------------
void __cdecl sub_4FB0B0(int a1)
{
  wchar_t *v1; // eax

  v1 = sub_40F1D0(*(char **)&byte_587000[4 * a1 + 216380], 0, (const char *)&byte_587000[216828], 86);
  sub_445490(v1);
}

//----- (004FB0E0) --------------------------------------------------------
int __cdecl sub_4FB0E0(int a1, int a2)
{
  _DWORD *v2; // edi
  int v3; // esi
  int v5; // ecx
  _DWORD *v6; // eax
  int v7[3]; // [esp+8h] [ebp-Ch]

  v2 = (_DWORD *)a1;
  v3 = *(_DWORD *)(a1 + 748);
  if ( !*(_BYTE *)(v3 + 212) )
    return 0;
  a1 = sub_4FD150(a1, *(_DWORD *)(v3 + 192), 0);
  v7[0] = a2;
  *(float *)&v7[1] = (double)*(int *)(v3 + 220);
  *(float *)&v7[2] = (double)*(int *)(v3 + 224);
  if ( a1 )
  {
    sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 0, &a1);
    sub_501960(231, (int)v2, 0, 0);
  }
  else
  {
    sub_4FDD20(*(_DWORD *)(v3 + 192), v2, v7);
  }
  v5 = 1;
  if ( *(_BYTE *)(v3 + 212) > 1u )
  {
    v6 = (_DWORD *)(v3 + 192);
    do
    {
      ++v5;
      *v6 = v6[1];
      ++v6;
    }
    while ( v5 < *(unsigned __int8 *)(v3 + 212) );
  }
  *(_DWORD *)(v3 + 4 * v5 + 188) = 0;
  --*(_BYTE *)(v3 + 212);
  return 1;
}

//----- (004FB1D0) --------------------------------------------------------
int __cdecl sub_4FB1D0(int a1, int a2)
{
  _DWORD *v2; // edi
  int v3; // esi
  int v5[3]; // [esp+8h] [ebp-Ch]

  v2 = (_DWORD *)a1;
  v3 = *(_DWORD *)(a1 + 748);
  if ( !*(_BYTE *)(v3 + 212) )
    return 0;
  a1 = sub_4FD150(a1, *(_DWORD *)(v3 + 4 * *(unsigned __int8 *)(v3 + 212) + 188), 0);
  v5[0] = a2;
  *(float *)&v5[1] = (double)*(int *)(v3 + 220);
  *(float *)&v5[2] = (double)*(int *)(v3 + 224);
  if ( a1 )
  {
    sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 0, &a1);
    sub_501960(231, (int)v2, 0, 0);
  }
  else
  {
    sub_4FDD20(*(_DWORD *)(v3 + 4 * *(unsigned __int8 *)(v3 + 212) + 188), v2, v5);
  }
  --*(_BYTE *)(v3 + 212);
  return 1;
}

//----- (004FB2A0) --------------------------------------------------------
int __cdecl sub_4FB2A0(int a1)
{
  _DWORD *v1; // edi
  int v2; // ebp
  int v3; // esi
  _DWORD *v4; // eax
  int v5; // ebx
  int result; // eax
  int v7; // eax
  int v8; // ebx
  int v9; // ecx
  int v10; // eax
  double v11; // st7
  int *v12; // eax
  wchar_t *v13; // eax
  int v14[3]; // [esp+10h] [ebp-Ch]

  v1 = (_DWORD *)a1;
  v2 = 1;
  v3 = *(_DWORD *)(a1 + 748);
  if ( sub_424850(*(void **)(v3 + 184)) )
  {
    v2 = 0;
  }
  else
  {
    v4 = *(_DWORD **)(v3 + 184);
    if ( v4 && *v4 )
    {
      if ( !sub_40A5C0(4096) )
      {
        v5 = *(_DWORD *)(v3 + 288);
        if ( sub_424A50(**(_DWORD **)(v3 + 184), 32) )
        {
          if ( v5 )
          {
            result = sub_5330C0((int)v1, v5);
            if ( !result )
              return result;
          }
        }
      }
      v7 = **(_DWORD **)(v3 + 184);
      if ( *(_DWORD *)(*(_DWORD *)(v3 + 276) + 4 * v7 + 3696) || v7 == 34 )
      {
        v2 = 0;
        a1 = sub_4FD0E0((int)v1, v7);
        if ( a1 || (a1 = sub_4FD150((int)v1, **(_DWORD **)(v3 + 184), 0)) != 0 )
        {
          sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 0, &a1);
          sub_501960(231, (int)v1, 0, 0);
        }
        else
        {
          v8 = sub_4FCF90((int)v1, **(_DWORD **)(v3 + 184), 1);
          if ( v8 < 0 )
          {
            a1 = 11;
            sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 0, &a1);
            sub_501960(232, (int)v1, 0, 0);
          }
          else
          {
            v14[0] = *(_DWORD *)(*(_DWORD *)(v3 + 276) + 3640);
            if ( sub_40A5C0(4096) )
            {
              if ( sub_424A50(**(_DWORD **)(v3 + 184), 32) )
              {
                v9 = *(_DWORD *)(v3 + 276);
                if ( *(_DWORD *)(v9 + 3640) )
                {
                  if ( !sub_5330C0((int)v1, *(_DWORD *)(v9 + 3640)) )
                    v14[0] = 0;
                }
              }
            }
            v10 = *(_DWORD *)(v3 + 276);
            *(float *)&v14[1] = (double)*(int *)(v10 + 2284);
            v11 = (double)*(int *)(v10 + 2288);
            v12 = *(int **)(v3 + 184);
            *(float *)&v14[2] = v11;
            if ( sub_4FDD20(*v12, v1, v14) )
            {
              sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 1, *(int **)(v3 + 184));
            }
            else
            {
              sub_4FD030((int)v1, v8);
              a1 = 8;
            }
          }
        }
      }
    }
  }
  if ( *(_BYTE *)(v3 + 88) == 2 )
    sub_4FA020(v1, 13);
  if ( v2 )
  {
    v13 = sub_40F1D0((char *)&byte_587000[216908], 0, (const char *)&byte_587000[216868], 301);
    result = sub_4D9EB0((int)v1, v13);
  }
  else if ( a1 )
  {
    result = sub_4D9630(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), **(_DWORD **)(v3 + 184), 0);
  }
  else
  {
    result = sub_424A50(**(_DWORD **)(v3 + 184), 0x100000);
    if ( !result )
      result = sub_4D9630(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), **(_DWORD **)(v3 + 184), 15);
  }
  return result;
}

//----- (004FB550) --------------------------------------------------------
int __cdecl sub_4FB550(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ebp
  int v6; // esi
  int v7; // ebx
  wchar_t *v8; // eax
  _DWORD *v9; // eax
  int v10; // edx
  int v11; // ebp
  int v12; // edi
  _DWORD *v13; // eax
  int v14; // edx
  int v15; // edi
  char *i; // edi
  int v17; // eax
  _DWORD *v18; // ebx
  int v20; // [esp+14h] [ebp+8h]

  v5 = a1;
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v6 = a2;
  if ( a2 <= 0 || a2 >= 137 )
  {
    v8 = sub_40F1D0((char *)&byte_587000[216964], 0, (const char *)&byte_587000[216924], 339);
    goto LABEL_76;
  }
  v7 = *(_DWORD *)(a1 + 748);
  if ( sub_40A5C0(6144) && *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696) == 3
    || *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696) == 5 )
  {
    v8 = sub_40F1D0((char *)&byte_587000[217020], 0, (const char *)&byte_587000[216980], 351);
LABEL_76:
    sub_4D9EB0(a1, v8);
    return 0;
  }
  if ( sub_40A5C0(4096)
    && (a2 == 34
     || a2 == 134
     || a2 == 45
     || a2 == 46
     || a2 == 47
     || a2 == 48
     || a2 == 49
     || a2 == 117
     || a2 == 118
     || a2 == 119
     || a2 == 120
     || a2 == 121
     || a2 == 122
     || a2 == 123
     || a2 == 124
     || a2 == 125
     || a2 == 19)
    && *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696) )
  {
    v8 = sub_40F1D0((char *)&byte_587000[217076], 0, (const char *)&byte_587000[217036], 386);
    goto LABEL_76;
  }
  ++*(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696);
  v9 = (_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696);
  if ( *v9 > 5 )
    *v9 = 5;
  if ( sub_40A5C0(4096) )
  {
    v10 = *(_DWORD *)(v7 + 276);
    if ( *(_DWORD *)(v10 + 4 * a2 + 3696) > 3 )
      *(_DWORD *)(v10 + 4 * a2 + 3696) = 3;
  }
  if ( a5 )
    *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696) = a5;
  sub_56FCE0(*(_DWORD *)(*(_DWORD *)(v7 + 276) + 4636), a2, *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4 * a2 + 3696));
  if ( sub_424A50(a2, 4096) )
  {
    v20 = 0x2000;
    goto LABEL_41;
  }
  if ( sub_424A50(a2, 0x4000) )
  {
    v20 = 0x8000;
    goto LABEL_41;
  }
  if ( sub_424A50(a2, 0x10000) )
  {
    v20 = 0x20000;
LABEL_41:
    v11 = 1;
    v12 = 3700;
    do
    {
      if ( sub_424A50(v11, v20) && sub_424B50(v11) )
      {
        if ( a5 )
          *(_DWORD *)(v12 + *(_DWORD *)(v7 + 276)) = a5;
        else
          ++*(_DWORD *)(v12 + *(_DWORD *)(v7 + 276));
        v13 = (_DWORD *)(v12 + *(_DWORD *)(v7 + 276));
        if ( *v13 > 5 )
          *v13 = 5;
        if ( sub_40A5C0(4096) )
        {
          v14 = *(_DWORD *)(v7 + 276);
          if ( *(_DWORD *)(v14 + 4 * v6 + 3696) > 3 )
            *(_DWORD *)(v14 + 4 * v6 + 3696) = 3;
        }
        sub_56FCE0(*(_DWORD *)(*(_DWORD *)(v7 + 276) + 4636), v6, *(_DWORD *)(v12 + *(_DWORD *)(v7 + 276)));
      }
      v12 += 4;
      ++v11;
    }
    while ( v12 < 4244 );
    v5 = a1;
  }
  if ( a3 )
  {
    v15 = 1;
    sub_501960(226, v5, 0, 0);
    if ( sub_40A5C0(2048) && (v6 == 34 || sub_424A50(v6, 86016)) )
      v15 = 0;
    if ( !sub_40A5C0(4096) || *(_DWORD *)(*(_DWORD *)(v7 + 276) + 4792) )
    {
      if ( v15 )
      {
        sub_4FAD50(v5, 0, v5, v6);
        if ( !sub_419E60(v5) )
        {
          for ( i = sub_416EA0(); i; i = sub_416EE0((int)i) )
          {
            v17 = *((_DWORD *)i + 514);
            if ( v17 != v5 && v17 )
              sub_4FAD50(v17, 0, v5, v6);
          }
        }
      }
    }
  }
  if ( sub_40A5C0(2048) && a3 == 1 && a4 == 1 )
  {
    v18 = *(_DWORD **)(v7 + 280);
    if ( v18 )
      sub_50F4C0(v18);
  }
  sub_4D7F90(v5, v6, a3, a4);
  return 1;
}

//----- (004FB940) --------------------------------------------------------
void sub_4FB940()
{
  srand(0x143Du);
}

//----- (004FB950) --------------------------------------------------------
void sub_4FB950()
{
  srand(0x22EAu);
}

//----- (004FB960) --------------------------------------------------------
void __cdecl sub_4FB960(int a1)
{
  wchar_t *v1; // eax

  v1 = sub_40F1D0(*(char **)&byte_587000[4 * a1 + 217092], 0, (const char *)&byte_587000[217264], 75);
  sub_445490(v1);
}

//----- (004FB990) --------------------------------------------------------
char *sub_4FB990()
{
  char *result; // eax

  memset(&byte_5D4594[1568876], 0, 0x300u);
  result = sub_413FE0((const char *)&byte_587000[217304], 24, 64);
  *(_DWORD *)&byte_5D4594[1569644] = result;
  return result;
}

//----- (004FB9C0) --------------------------------------------------------
int __cdecl sub_4FB9C0(int a1, int a2, int a3)
{
  int v3; // eax
  int v4; // ecx
  int v5; // edx
  _DWORD *v6; // ecx
  _DWORD *v7; // ecx
  int i; // edi
  int result; // eax
  wchar_t *v10; // eax

  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  if ( a2 <= 0 || a2 >= 6 )
  {
    v10 = sub_40F1D0((char *)&byte_587000[217368], 0, (const char *)&byte_587000[217328], 108);
    sub_4D9EB0(a1, v10);
    return 0;
  }
  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(_DWORD *)(v3 + 276);
  v5 = *(_DWORD *)(v4 + 4 * a2 + 3696);
  v6 = (_DWORD *)(v4 + 4 * a2 + 3696);
  if ( v5 )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[217388], 0);
    result = 0;
  }
  else
  {
    *v6 = 5;
    v7 = (_DWORD *)(*(_DWORD *)(v3 + 276) + 4 * a2 + 3696);
    if ( *v7 > 5 )
      *v7 = 5;
    sub_56FCE0(*(_DWORD *)(*(_DWORD *)(v3 + 276) + 4636), a2, *(_DWORD *)(*(_DWORD *)(v3 + 276) + 4 * a2 + 3696));
    sub_4D8060(a1, a2, a3);
    if ( sub_40A5C0(4096) )
    {
      sub_4FAD50(a1, 2, a1, a2);
      if ( !sub_419E60(a1) )
      {
        for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
        {
          if ( i != a1 )
            sub_4FAD50(i, 2, a1, a2);
        }
      }
    }
    result = 1;
  }
  return result;
}

//----- (004FBAF0) --------------------------------------------------------
void __cdecl sub_4FBAF0(_DWORD *a1, int a2)
{
  __int16 v2; // ax
  __int16 v3; // ax

  if ( !(a1[4] & 0x8020) )
  {
    switch ( a2 )
    {
      case 1:
        sub_53FEB0((int)a1);
        break;
      case 2:
        sub_53FF40((int)a1);
        break;
      case 3:
        sub_540070(a1);
        break;
      case 4:
        v2 = sub_425470(4);
        sub_5400B0(a1, v2);
        break;
      case 5:
        v3 = sub_425470(5);
        sub_540110((int)a1, v3);
        break;
      default:
        return;
    }
  }
}

//----- (004FBB70) --------------------------------------------------------
void __cdecl sub_4FBB70(int a1, int a2)
{
  _DWORD *v2; // esi
  int v3; // edi
  int v4; // ebx
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // ebp
  int v10; // ebx
  _DWORD *v11; // eax
  int v12; // ecx
  int v13; // eax

  v2 = (_DWORD *)a1;
  if ( !a1 )
    return;
  v3 = a2;
  if ( a2 <= 0 )
    return;
  if ( a2 >= 6 )
    return;
  if ( *(_DWORD *)(a1 + 16) & 0x8020 )
    return;
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return;
  v4 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(*(_DWORD *)(v4 + 276) + 2251) )
    return;
  if ( sub_40A5C0(32) && v3 == 1 )
  {
    v5 = v2[126];
    if ( v5 )
    {
      while ( !(*(_DWORD *)(v5 + 8) & 0x10000000) )
      {
        v5 = *(_DWORD *)(v5 + 496);
        if ( !v5 )
          goto LABEL_12;
      }
      a1 = 5;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), 2, &a1);
      goto LABEL_49;
    }
LABEL_12:
    v6 = sub_4FC3E0((int)v2, 2);
    goto LABEL_16;
  }
  if ( v3 == 2 )
  {
    v6 = sub_4FC250((int)v2, 1);
LABEL_16:
    if ( v6 )
    {
LABEL_19:
      a1 = 2;
LABEL_30:
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), 2, &a1);
LABEL_49:
      sub_501960(231, (int)v2, 0, 0);
      return;
    }
    v7 = sub_4FC250((int)v2, 3);
    goto LABEL_18;
  }
  if ( v3 == 1 )
  {
    v6 = sub_4FC3E0((int)v2, 2);
    goto LABEL_16;
  }
  if ( v3 != 3 )
    goto LABEL_25;
  if ( sub_4FC3E0((int)v2, 2) )
    goto LABEL_19;
  v7 = sub_4FC250((int)v2, 1);
LABEL_18:
  if ( v7 )
    goto LABEL_19;
LABEL_25:
  if ( sub_4FC250((int)v2, v3) )
    goto LABEL_19;
  if ( *(_BYTE *)(v4 + 88) == 12 || !sub_40A5C0(2048) && (v8 = v2[4], BYTE1(v8) & 0x40) )
  {
    a1 = 6;
    goto LABEL_30;
  }
  v9 = *(_DWORD *)(v4 + 276);
  if ( (!sub_40A5C0(0x2000) || sub_40A5C0(4096)) && !*(_DWORD *)(v9 + 4 * v3 + 3696) )
  {
    a1 = 3;
    goto LABEL_48;
  }
  if ( v3 == 1 && *(_DWORD *)(*(_DWORD *)(v4 + 276) + 3656) == 1 )
  {
    a1 = 7;
    sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), 2, &a1);
    return;
  }
  if ( *(_DWORD *)&byte_5D4594[4 * (v3 + 6 * *(unsigned __int8 *)(v9 + 2064)) + 1568876] )
  {
    a1 = 2;
LABEL_48:
    sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), 2, &a1);
    goto LABEL_49;
  }
  *(_DWORD *)&byte_5D4594[4 * (v3 + 6 * *(unsigned __int8 *)(v9 + 2064)) + 1568876] = sub_4252D0(v3);
  if ( sub_4252D0(v3) )
    sub_4D8100((int)v2, v3, 0);
  v10 = sub_425470(v3);
  if ( v10 > 0 )
  {
    v11 = sub_4142F0(*(_DWORD **)&byte_5D4594[1569644]);
    if ( v11 )
    {
      v12 = *(_DWORD *)&byte_5D4594[2598000];
      v11[1] = v2;
      *v11 = v3;
      v11[2] = v10 + v12;
      v11[4] = *(_DWORD *)&byte_5D4594[1569648];
      v11[3] = 1;
      v11[5] = 0;
      if ( *(_DWORD *)&byte_5D4594[1569648] )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1569648] + 20) = v11;
      *(_DWORD *)&byte_5D4594[1569648] = v11;
    }
  }
  sub_4FBAF0(v2, v3);
  v13 = sub_425230(v3, 0);
  sub_501960(v13, (int)v2, 0, 0);
}

//----- (004FBE60) --------------------------------------------------------
int __cdecl sub_4FBE60(int a1, int a2)
{
  char *v2; // eax
  int result; // eax

  v2 = sub_417040(*(_DWORD *)(a1 + 36));
  if ( v2 )
    result = *(_DWORD *)&byte_5D4594[4 * (a2 + 6 * (unsigned __int8)v2[2064]) + 1568876];
  else
    result = 0;
  return result;
}

//----- (004FBEA0) --------------------------------------------------------
char *__cdecl sub_4FBEA0(int a1, int a2, int a3)
{
  char *result; // eax
  int v4; // edx

  result = sub_417040(*(_DWORD *)(a1 + 36));
  if ( result )
  {
    v4 = a2 + 6 * (unsigned __int8)result[2064];
    result = (char *)a3;
    *(_DWORD *)&byte_5D4594[4 * v4 + 1568876] = a3;
  }
  return result;
}

//----- (004FBEE0) --------------------------------------------------------
void sub_4FBEE0()
{
  char *i; // edi
  int j; // esi
  int v2; // eax
  int v3; // ecx
  int *v4; // esi
  int v5; // eax
  int *v6; // edi
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // [esp-Ch] [ebp-14h]

  for ( i = sub_416EA0(); i; i = sub_416EE0((int)i) )
  {
    if ( *((_DWORD *)i + 514) && !i[2251] )
    {
      for ( j = 0; j < 6; ++j )
      {
        v2 = j + 6 * (unsigned __int8)i[2064];
        v3 = *(_DWORD *)&byte_5D4594[4 * v2 + 1568876];
        if ( v3 )
        {
          *(_DWORD *)&byte_5D4594[4 * v2 + 1568876] = v3 - 1;
          if ( !*(_DWORD *)&byte_5D4594[4 * (j + 6 * (unsigned __int8)i[2064]) + 1568876] )
            sub_4D8100(*((_DWORD *)i + 514), j, 1);
        }
      }
    }
  }
  v4 = *(int **)&byte_5D4594[1569648];
  if ( *(_DWORD *)&byte_5D4594[1569648] )
  {
    while ( 1 )
    {
      v5 = v4[4];
      v6 = (int *)v4[4];
      if ( *(_DWORD *)(v4[1] + 16) & 0x8020 )
        break;
      if ( *(_DWORD *)&byte_5D4594[2598000] > (unsigned int)v4[2] )
      {
        v11 = v4[1];
        v8 = sub_425230(*v4, 2);
        sub_501960(v8, v11, 0, 0);
        sub_4FC3C0(v4[1], *v4, 0);
        if ( *v4 == 1 )
          sub_4FA020((_DWORD *)v4[1], 13);
        v9 = v4[4];
        if ( v9 )
          *(_DWORD *)(v9 + 20) = v4[5];
        v10 = v4[5];
        if ( v10 )
        {
          *(_DWORD *)(v10 + 16) = v4[4];
          goto LABEL_24;
        }
LABEL_23:
        *(_DWORD *)&byte_5D4594[1569648] = v4[4];
        goto LABEL_24;
      }
LABEL_25:
      v4 = v6;
      if ( !v6 )
        return;
    }
    if ( v5 )
      *(_DWORD *)(v5 + 20) = v4[5];
    v7 = v4[5];
    if ( v7 )
    {
      *(_DWORD *)(v7 + 16) = v4[4];
LABEL_24:
      sub_414330(*(unsigned int **)&byte_5D4594[1569644], v4);
      goto LABEL_25;
    }
    goto LABEL_23;
  }
}

//----- (004FC030) --------------------------------------------------------
int __cdecl sub_4FC030(int a1, int a2)
{
  _DWORD *v2; // eax

  v2 = *(_DWORD **)&byte_5D4594[1569648];
  if ( !*(_DWORD *)&byte_5D4594[1569648] )
    return -1;
  while ( v2[1] != a1 || *v2 != a2 )
  {
    v2 = (_DWORD *)v2[4];
    if ( !v2 )
      return -1;
  }
  return v2[2] - *(_DWORD *)&byte_5D4594[2598000];
}

//----- (004FC070) --------------------------------------------------------
_DWORD *__cdecl sub_4FC070(int a1, int a2, int a3)
{
  _DWORD *result; // eax

  result = *(_DWORD **)&byte_5D4594[1569648];
  if ( *(_DWORD *)&byte_5D4594[1569648] )
  {
    while ( result[1] != a1 || *result != a2 )
    {
      result = (_DWORD *)result[4];
      if ( !result )
        return result;
    }
    result[2] = a3 + *(_DWORD *)&byte_5D4594[2598000];
  }
  return result;
}

//----- (004FC0B0) --------------------------------------------------------
void __cdecl sub_4FC0B0(int a1, int a2)
{
  int v2; // eax
  int v3; // esi
  int v4; // eax
  int v5; // edi
  int v6; // eax
  int v7; // eax

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      v2 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 276);
      if ( !*(_BYTE *)(v2 + 2251) )
      {
        *(_DWORD *)&byte_5D4594[4 * (a2 + 6 * *(unsigned __int8 *)(v2 + 2064)) + 1568876] = 0;
        sub_4D80C0(a1, a2);
        v3 = *(_DWORD *)&byte_5D4594[1569648];
        if ( *(_DWORD *)&byte_5D4594[1569648] )
        {
          do
          {
            v4 = *(_DWORD *)(v3 + 4);
            v5 = *(_DWORD *)(v3 + 16);
            if ( v4 == a1 && *(_DWORD *)v3 == a2 )
            {
              sub_4FC3C0(v4, *(_DWORD *)v3, 0);
              v6 = *(_DWORD *)(v3 + 16);
              if ( v6 )
                *(_DWORD *)(v6 + 20) = *(_DWORD *)(v3 + 20);
              v7 = *(_DWORD *)(v3 + 20);
              if ( v7 )
                *(_DWORD *)(v7 + 16) = *(_DWORD *)(v3 + 16);
              else
                *(_DWORD *)&byte_5D4594[1569648] = *(_DWORD *)(v3 + 16);
              sub_414330(*(unsigned int **)&byte_5D4594[1569644], (_QWORD *)v3);
            }
            v3 = v5;
          }
          while ( v5 );
        }
      }
    }
  }
}

//----- (004FC180) --------------------------------------------------------
void __cdecl sub_4FC180(int a1)
{
  int v1; // edx
  int i; // eax
  int v3; // ecx
  int v4; // esi
  int v5; // eax
  int v6; // edi
  int v7; // eax
  int v8; // eax

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      v1 = *(_DWORD *)(a1 + 748);
      if ( !*(_BYTE *)(*(_DWORD *)(v1 + 276) + 2251) )
      {
        for ( i = 1; i < 6; ++i )
        {
          v3 = i + 6 * *(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064);
          *(_DWORD *)&byte_5D4594[4 * v3 + 1568876] = 0;
        }
        sub_4D80C0(a1, 6);
        v4 = *(_DWORD *)&byte_5D4594[1569648];
        if ( *(_DWORD *)&byte_5D4594[1569648] )
        {
          do
          {
            v5 = *(_DWORD *)(v4 + 4);
            v6 = *(_DWORD *)(v4 + 16);
            if ( v5 == a1 )
            {
              sub_4FC3C0(v5, *(_DWORD *)v4, 0);
              v7 = *(_DWORD *)(v4 + 16);
              if ( v7 )
                *(_DWORD *)(v7 + 20) = *(_DWORD *)(v4 + 20);
              v8 = *(_DWORD *)(v4 + 20);
              if ( v8 )
                *(_DWORD *)(v8 + 16) = *(_DWORD *)(v4 + 16);
              else
                *(_DWORD *)&byte_5D4594[1569648] = *(_DWORD *)(v4 + 16);
              sub_414330(*(unsigned int **)&byte_5D4594[1569644], (_QWORD *)v4);
            }
            v4 = v6;
          }
          while ( v6 );
        }
      }
    }
  }
}

//----- (004FC250) --------------------------------------------------------
int __cdecl sub_4FC250(int a1, int a2)
{
  int v2; // eax
  _DWORD *v3; // eax
  int v4; // ecx

  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v2 = *(_DWORD *)(a1 + 748);
  if ( v2 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251) )
      return 0;
  }
  v3 = *(_DWORD **)&byte_5D4594[1569648];
  if ( !*(_DWORD *)&byte_5D4594[1569648] )
    return 0;
  while ( 1 )
  {
    v4 = v3[4];
    if ( v3[1] == a1 && *v3 == a2 )
      break;
    v3 = (_DWORD *)v3[4];
    if ( !v4 )
      return 0;
  }
  return 1;
}

//----- (004FC2B0) --------------------------------------------------------
int __cdecl sub_4FC2B0(int a1)
{
  int v1; // eax
  int v2; // eax

  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v1 = *(_DWORD *)(a1 + 748);
  if ( v1 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v1 + 276) + 2251) )
      return 0;
  }
  v2 = *(_DWORD *)&byte_5D4594[1569648];
  if ( !*(_DWORD *)&byte_5D4594[1569648] )
    return 0;
  while ( *(_DWORD *)(v2 + 4) != a1 )
  {
    v2 = *(_DWORD *)(v2 + 16);
    if ( !v2 )
      return 0;
  }
  return 1;
}

//----- (004FC300) --------------------------------------------------------
void __cdecl sub_4FC300(_DWORD *a1, int a2)
{
  int v2; // eax
  int v3; // esi
  int v4; // ecx

  if ( a1 && a2 > 0 && a2 < 6 )
  {
    switch ( a2 )
    {
      case 3:
        sub_4D98A0(a1, *(_DWORD **)(a1[187] + 136));
        break;
      case 4:
        sub_4FF5B0((int)a1, 31);
        break;
      case 5:
        return;
    }
    sub_4FC3C0((int)a1, a2, 0);
    v2 = *(_DWORD *)&byte_5D4594[1569648];
    if ( *(_DWORD *)&byte_5D4594[1569648] )
    {
      do
      {
        v3 = *(_DWORD *)(v2 + 16);
        if ( *(_DWORD **)(v2 + 4) == a1 && *(_DWORD *)v2 == a2 )
        {
          if ( v3 )
            *(_DWORD *)(v3 + 20) = *(_DWORD *)(v2 + 20);
          v4 = *(_DWORD *)(v2 + 20);
          if ( v4 )
            *(_DWORD *)(v4 + 16) = *(_DWORD *)(v2 + 16);
          else
            *(_DWORD *)&byte_5D4594[1569648] = *(_DWORD *)(v2 + 16);
          sub_414330(*(unsigned int **)&byte_5D4594[1569644], (_QWORD *)v2);
        }
        v2 = v3;
      }
      while ( v3 );
    }
  }
}

//----- (004FC3C0) --------------------------------------------------------
int __cdecl sub_4FC3C0(int a1, char a2, char a3)
{
  return sub_4D8150(a1, a2, a3);
}

//----- (004FC3E0) --------------------------------------------------------
int __cdecl sub_4FC3E0(int a1, int a2)
{
  int v2; // eax
  _DWORD *v3; // eax
  int v4; // ecx

  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v2 = *(_DWORD *)(a1 + 748);
  if ( v2 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251) )
      return 0;
  }
  v3 = *(_DWORD **)&byte_5D4594[1569648];
  if ( !*(_DWORD *)&byte_5D4594[1569648] )
    return 0;
  while ( 1 )
  {
    v4 = v3[4];
    if ( v3[1] == a1 && *v3 == a2 )
      break;
    v3 = (_DWORD *)v3[4];
    if ( !v4 )
      return 0;
  }
  return v3[3];
}

//----- (004FC440) --------------------------------------------------------
void __cdecl sub_4FC440(int a1, int a2)
{
  int v2; // eax
  _DWORD *v3; // eax
  int v4; // ecx

  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v2 = *(_DWORD *)(a1 + 748);
    if ( !v2 || !*(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251) )
    {
      v3 = *(_DWORD **)&byte_5D4594[1569648];
      if ( *(_DWORD *)&byte_5D4594[1569648] )
      {
        while ( 1 )
        {
          v4 = v3[4];
          if ( v3[1] == a1 && *v3 == a2 )
            break;
          v3 = (_DWORD *)v3[4];
          if ( !v4 )
            return;
        }
        v3[3] = 0;
      }
    }
  }
}

//----- (004FC4A0) --------------------------------------------------------
int __cdecl sub_4FC4A0(int a1, int a2, int a3)
{
  int result; // eax

  result = a3;
  *(_DWORD *)&byte_5D4594[4 * (a2 + 6 * a1) + 1568876] = a3;
  return result;
}

//----- (004FC4C0) --------------------------------------------------------
int __cdecl sub_4FC4C0(int a1)
{
  char *v1; // esi
  int v2; // eax
  int v3; // ecx
  double v4; // st7
  double v5; // st6

  v1 = sub_416EA0();
  if ( !v1 )
    return 0;
  while ( 1 )
  {
    v2 = *((_DWORD *)v1 + 514);
    if ( v2 )
    {
      if ( !v1[2251] )
      {
        if ( sub_4FC250(v2, 2) )
        {
          v3 = *((_DWORD *)v1 + 514);
          v4 = *(float *)(a1 + 56) - *(float *)(v3 + 56);
          v5 = *(float *)(a1 + 60) - *(float *)(v3 + 60);
          if ( sqrt(v5 * v5 + v4 * v4) + 0.1 < 300.0 )
          {
            if ( sub_537110(v3, a1) )
              break;
          }
        }
      }
    }
    v1 = sub_416EE0((int)v1);
    if ( !v1 )
      return 0;
  }
  return 1;
}

//----- (004FC560) --------------------------------------------------------
void sub_4FC560()
{
  srand(0x22EBu);
}

//----- (004FC570) --------------------------------------------------------
int __cdecl sub_4FC570(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[1569652] = a1;
  return result;
}

//----- (004FC580) --------------------------------------------------------
int __cdecl sub_4FC580(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[1569656] = a1;
  return result;
}

//----- (004FC590) --------------------------------------------------------
int sub_4FC590()
{
  int result; // eax
  int v1; // esi
  int v2; // edi

  result = *(_DWORD *)&byte_5D4594[1569652];
  if ( *(_DWORD *)&byte_5D4594[1569652] )
  {
    result = sub_4DA7C0();
    if ( result )
    {
      v1 = 0;
      if ( *(_DWORD *)&byte_5D4594[1599640] > 0 )
      {
        v2 = 0;
        do
        {
          if ( !strncmp(
                  (const char *)&byte_587000[217408],
                  *(const char **)(v2 + *(_DWORD *)&byte_5D4594[1599636]),
                  0xDu) )
            sub_507310(v1, 0, 0);
          ++v1;
          v2 += 48;
        }
        while ( v1 < *(int *)&byte_5D4594[1599640] );
      }
      result = sub_4FC570(0);
    }
  }
  return result;
}

//----- (004FC600) --------------------------------------------------------
int sub_4FC600()
{
  int result; // eax
  int v1; // esi
  int v2; // edi

  result = *(_DWORD *)&byte_5D4594[1569656];
  if ( *(_DWORD *)&byte_5D4594[1569656] )
  {
    result = sub_4DA7C0();
    if ( result )
    {
      v1 = 0;
      if ( *(_DWORD *)&byte_5D4594[1599640] > 0 )
      {
        v2 = 0;
        do
        {
          if ( !strncmp((const char *)&byte_587000[217424], *(const char **)(v2 + *(_DWORD *)&byte_5D4594[1599636]), 8u) )
            sub_507310(v1, 0, 0);
          ++v1;
          v2 += 48;
        }
        while ( v1 < *(int *)&byte_5D4594[1599640] );
      }
      result = sub_4FC580(0);
    }
  }
  return result;
}

//----- (004FC670) --------------------------------------------------------
int __cdecl sub_4FC670(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[1569660] = a1;
  return result;
}

//----- (004FC680) --------------------------------------------------------
void sub_4FC680()
{
  int v0; // eax

  if ( sub_40A5C0(2048) && !sub_40A5C0(0x80000) && *(_DWORD *)&byte_5D4594[1569660] )
  {
    v0 = sub_4DA7C0();
    if ( v0 )
    {
      sub_4FBB70(v0, *(int *)&byte_5D4594[1569660]);
      *(_DWORD *)&byte_5D4594[1569660] = 0;
    }
  }
}

//----- (004FC6D0) --------------------------------------------------------
int sub_4FC6D0()
{
  int result; // eax
  char *v1; // eax
  int i; // edi
  int v3; // esi
  int v4; // eax
  BOOL v5; // ebp
  int j; // esi
  int v7; // eax
  CHAR FileName[1024]; // [esp+Ch] [ebp-400h]

  result = *(_DWORD *)&byte_5D4594[1569652];
  if ( *(_DWORD *)&byte_5D4594[1569652] == 1 || *(_DWORD *)&byte_5D4594[1569656] == 1 )
  {
    result = sub_4DA7C0();
    if ( result )
    {
      if ( sub_40A5C0(4096) )
      {
        if ( sub_4E3CC0() == 1 )
        {
          sub_4D6960(255);
          sub_4D7440(1);
          sub_4D60B0();
        }
        else if ( !sub_4D6F30() || sub_4D7430() )
        {
          if ( sub_4D76F0() == 1 )
          {
            sub_4D6880(255, 1);
            sub_4D76E0(0);
            sub_4D7440(1);
            sub_4D60B0();
          }
          else
          {
            v1 = sub_409E10();
            nox_sprintf(FileName, (const char *)&byte_587000[217436], v1);
            for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
            {
              v3 = *(_DWORD *)(i + 748);
              v4 = *(_DWORD *)(v3 + 276);
              if ( *(_DWORD *)(v4 + 4792) == 1
                && !*(_DWORD *)(v3 + 552)
                && sub_41A140(FileName, *(unsigned __int8 *)(v4 + 2064)) )
              {
                v5 = sub_419EE0(*(_BYTE *)(*(_DWORD *)(v3 + 276) + 2064));
                sub_4DCF80(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 1);
                if ( !sub_41CFA0(FileName, *(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064)) && !v5 )
                  sub_4DCF80(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 0);
                DeleteFileA(FileName);
              }
              sub_4D6770(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064));
            }
            sub_4D6880(255, 0);
            sub_4D7440(1);
            sub_4D60B0();
          }
        }
        else
        {
          sub_4D6960(255);
          sub_4D7440(1);
          sub_4D60B0();
        }
      }
      else
      {
        sub_4D9800(1, 1);
      }
      result = sub_40A5C0(0x2000);
      if ( result )
      {
        result = sub_40A5C0(128);
        if ( !result )
        {
          result = sub_4DA7C0();
          for ( j = result; result; j = result )
          {
            v7 = *(_DWORD *)(*(_DWORD *)(j + 748) + 276);
            if ( *(_BYTE *)(v7 + 2064) != 31 && !(*(_BYTE *)(v7 + 3680) & 1) )
              sub_4FF380(j, 23, 0, 5);
            result = sub_4DA7F0(j);
          }
        }
      }
    }
  }
  return result;
}

//----- (004FC950) --------------------------------------------------------
void sub_4FC950()
{
  srand(0x1446u);
}

//----- (004FC960) --------------------------------------------------------
int __cdecl sub_4FC960(int a1, char a2)
{
  int result; // eax
  int i; // esi
  int v4; // eax
  int v5; // [esp-Ch] [ebp-10h]

  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    if ( i != a1 )
    {
      v5 = *(_DWORD *)(i + 36);
      v4 = sub_4FE1C0(*(_DWORD *)(a1 + 36), a2);
      sub_501960(v4, a1, 2, v5);
    }
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (004FC9B0) --------------------------------------------------------
int sub_4FC9B0()
{
  int result; // eax

  result = sub_4FE850();
  if ( result )
  {
    result = sub_413FE0((const char *)&byte_587000[217456], 60, 64);
    *(_DWORD *)&byte_5D4594[1569668] = result;
    if ( result )
    {
      result = sub_4E3810((CHAR *)&byte_587000[217476]);
      *(_DWORD *)&byte_5D4594[1569664] = result;
      if ( result )
      {
        sub_4DAA50(result, 0, 2944.0, 2944.0);
        *(_DWORD *)&byte_5D4594[1569676] = sub_4E3AA0((CHAR *)&byte_587000[217492]);
        *(_DWORD *)&byte_5D4594[1569680] = sub_4E3AA0((CHAR *)&byte_587000[217500]);
        *(_DWORD *)&byte_5D4594[1569684] = sub_4E3AA0((CHAR *)&byte_587000[217516]);
        *(_DWORD *)&byte_5D4594[1569688] = sub_4E3AA0((CHAR *)&byte_587000[217528]);
        *(_DWORD *)&byte_5D4594[1569692] = sub_4E3AA0((CHAR *)&byte_587000[217540]);
        *(_DWORD *)&byte_5D4594[1569696] = sub_4E3AA0((CHAR *)&byte_587000[217552]);
        *(_DWORD *)&byte_5D4594[1569700] = sub_4E3AA0((CHAR *)&byte_587000[217564]);
        result = 1;
      }
    }
  }
  return result;
}

//----- (004FCA80) --------------------------------------------------------
int sub_4FCA80()
{
  sub_4FE880();
  sub_414100(*(LPVOID *)&byte_5D4594[1569668]);
  *(_DWORD *)&byte_5D4594[1569672] = 0;
  sub_4E5CC0(*(int *)&byte_5D4594[1569664]);
  *(_DWORD *)&byte_5D4594[1569664] = 0;
  return 1;
}

//----- (004FCAC0) --------------------------------------------------------
int __cdecl sub_4FCAC0(int a1, int a2)
{
  int i; // eax
  int v3; // ecx
  _DWORD *v4; // eax

  sub_4FE8A0(a1);
  sub_4144D0(*(_DWORD **)&byte_5D4594[1569668]);
  *(_DWORD *)&byte_5D4594[1569672] = 0;
  for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
  {
    v3 = *(_DWORD *)(i + 748);
    *(_BYTE *)(v3 + 188) = 0;
    *(_DWORD *)(v3 + 216) = 0;
    *(_DWORD *)(v3 + 192) = 0;
    *(_DWORD *)(v3 + 196) = 0;
    *(_DWORD *)(v3 + 200) = 0;
    *(_DWORD *)(v3 + 204) = 0;
    *(_DWORD *)(v3 + 208) = 0;
    *(_BYTE *)(v3 + 212) = 0;
  }
  if ( a2 )
  {
    v4 = sub_4E3810((CHAR *)&byte_587000[217572]);
    *(_DWORD *)&byte_5D4594[1569664] = v4;
    if ( !v4 )
      return 0;
    sub_4DAA50((int)v4, 0, 2944.0, 2944.0);
  }
  return 1;
}

//----- (004FCB70) --------------------------------------------------------
// Microsoft VisualC 2-14/net runtime
void sub_4FCB70()
{
  sub_4FCB80();
  sub_4FEEF0();
}

//----- (004FCB80) --------------------------------------------------------
void sub_4FCB80()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // edi
  int v5; // eax
  int v6; // eax
  int v7; // ebx
  int v8; // edx
  int v9; // ebp
  int v10; // eax
  _DWORD *v11; // ebx
  int v12; // eax
  int v13; // eax
  _DWORD *v14; // eax
  _DWORD *v15; // eax
  int v16; // eax
  int v17; // eax
  int v18; // edi
  char *v19; // ebx
  unsigned __int8 v20; // bp
  int v21; // eax
  int v22; // edx
  char v23[2]; // [esp+6h] [ebp-12h]
  int v24; // [esp+8h] [ebp-10h]
  int v25; // [esp+Ch] [ebp-Ch]
  int v26; // [esp+10h] [ebp-8h]
  int v27; // [esp+14h] [ebp-4h]

  v0 = *(_DWORD *)&byte_5D4594[1569672];
  if ( *(_DWORD *)&byte_5D4594[1569672] )
  {
    while ( 1 )
    {
      v1 = *(_DWORD *)(v0 + 4);
      if ( *(_DWORD *)(v1 + 16) & 0x8020 )
      {
        v2 = *(_DWORD *)(v0 + 52);
        if ( v2 )
          *(_DWORD *)(v2 + 56) = *(_DWORD *)(v0 + 56);
        v3 = *(_DWORD *)(v0 + 56);
        if ( !v3 )
          goto LABEL_39;
        *(_DWORD *)(v3 + 52) = *(_DWORD *)(v0 + 52);
        goto LABEL_40;
      }
      if ( *(_DWORD *)&byte_5D4594[2598000] < *(int *)(v0 + 40) )
        goto LABEL_47;
      v4 = 0;
      if ( *(_BYTE *)(v1 + 8) & 4 )
        v4 = *(_DWORD *)(v1 + 748);
      if ( !*(_BYTE *)(v0 + 36) )
      {
        v23[0] = 112;
        v5 = *(_DWORD *)(v4 + 276);
        v23[1] = *(_BYTE *)(v0 + 4 * *(unsigned __int8 *)(v0 + 28) + 8);
        sub_40EBC0(*(unsigned __int8 *)(v5 + 2064), 1, v23, 2);
      }
      v6 = *(unsigned __int8 *)(v0 + 28);
      v7 = **(_DWORD **)(v0 + 32);
      v24 = *(_DWORD *)(v0 + 4 * v6 + 8);
      v8 = v24;
      if ( v7 != v24 )
      {
        v19 = sub_416640();
        LOBYTE(v27) = sub_424A20(*(_DWORD *)(v0 + 4 * *(unsigned __int8 *)(v0 + 28) + 8))[*(unsigned __int8 *)(v0 + 36)];
        v20 = v27;
        if ( !*(_DWORD *)&byte_5D4594[2650652] || *(_DWORD *)(v19 + 62) )
          sub_4FC960(*(_DWORD *)(v0 + 4), v27);
        v21 = sub_424830(*(_DWORD *)(v0 + 32), v20);
        v22 = *(_DWORD *)(v0 + 4);
        *(_DWORD *)(v0 + 32) = v21;
        if ( *(_BYTE *)(v22 + 8) & 4 )
          *(_DWORD *)(v4 + 184) = *(_DWORD *)(v0 + 32);
        ++*(_BYTE *)(v0 + 36);
        *(_DWORD *)(v0 + 40) = *(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)(v0 + 44);
        goto LABEL_47;
      }
      v26 = *(_DWORD *)(v0 + 4 * v6 + 12);
      if ( !*(_BYTE *)(v0 + 29) )
        goto LABEL_26;
      if ( v24 != 34 )
        break;
LABEL_29:
      v14 = *(_DWORD **)(v0 + 4);
      if ( v14[2] & 4 )
      {
        v15 = *(_DWORD **)(v4 + 276);
        *(_DWORD *)(v4 + 220) = v15[571];
        *(_DWORD *)(v4 + 224) = v15[572];
        if ( *(_DWORD *)(v0 + 48) )
          v15[910] = *(_DWORD *)(v0 + 4);
        else
          v15[910] = *(_DWORD *)(v4 + 288);
        sub_4FB2A0(*(_DWORD *)(v0 + 4));
        *(_DWORD *)(v4 + 216) = 0;
        *(_BYTE *)(v4 + 188) = 0;
        *(_BYTE *)(v4 + 212) = 0;
      }
      else
      {
        sub_4FDD20(v8, v14, 0);
      }
      v16 = *(_DWORD *)(v0 + 52);
      if ( v16 )
        *(_DWORD *)(v16 + 56) = *(_DWORD *)(v0 + 56);
      v17 = *(_DWORD *)(v0 + 56);
      if ( !v17 )
      {
LABEL_39:
        *(_DWORD *)&byte_5D4594[1569672] = *(_DWORD *)(v0 + 52);
        goto LABEL_40;
      }
      *(_DWORD *)(v17 + 52) = *(_DWORD *)(v0 + 52);
LABEL_40:
      v18 = *(_DWORD *)(v0 + 52);
      sub_414330(*(unsigned int **)&byte_5D4594[1569668], (_QWORD *)v0);
      v0 = v18;
LABEL_48:
      if ( !v0 )
        return;
    }
    if ( *(_BYTE *)(*(_DWORD *)(v0 + 4) + 8) & 4 )
    {
      v9 = 0;
      v10 = 1;
      if ( !*(_BYTE *)(v4 + 212) )
        goto LABEL_51;
      v11 = (_DWORD *)(v4 + 192);
      do
      {
        if ( *v11 == v8 )
        {
          v12 = *(_DWORD *)(v4 + 276);
          v25 = 6;
          sub_4DA0F0(*(unsigned __int8 *)(v12 + 2064), 0, &v25);
          v8 = v24;
          v10 = 0;
        }
        ++v9;
        ++v11;
      }
      while ( v9 < *(unsigned __int8 *)(v4 + 212) );
      if ( v10 )
      {
LABEL_51:
        if ( sub_4FCF90(*(_DWORD *)(v0 + 4), v8, 2) < 0 )
        {
          v13 = *(_DWORD *)(v4 + 276);
          v25 = 11;
          sub_4DA0F0(*(unsigned __int8 *)(v13 + 2064), 0, &v25);
          sub_501960(232, *(_DWORD *)(v0 + 4), 0, 0);
        }
        else
        {
          *(_DWORD *)(v4 + 4 * (unsigned __int8)(*(_BYTE *)(v4 + 212))++ + 192) = v24;
        }
        v8 = v24;
      }
    }
LABEL_26:
    if ( v8 != 34 && v26 )
    {
      *(_BYTE *)(v0 + 36) = 0;
      *(_DWORD *)(v0 + 32) = sub_424820();
      *(_DWORD *)(v0 + 40) = *(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)(v0 + 44);
      ++*(_BYTE *)(v0 + 28);
LABEL_47:
      v0 = *(_DWORD *)(v0 + 52);
      goto LABEL_48;
    }
    goto LABEL_29;
  }
}

//----- (004FCEB0) --------------------------------------------------------
int __cdecl sub_4FCEB0(int a1)
{
  int result; // eax
  int v2; // esi
  int v3; // ecx

  result = sub_4FE930();
  if ( result )
  {
    do
    {
      v2 = *(_DWORD *)(result + 116);
      if ( a1 != 1 || (v3 = *(_DWORD *)(result + 48)) == 0 || (*(_BYTE *)(v3 + 8) & 4) != 4 )
        sub_4FE9D0(result);
      result = v2;
    }
    while ( v2 );
  }
  return result;
}

//----- (004FCEF0) --------------------------------------------------------
int __cdecl sub_4FCEF0(int a1, int *a2, int a3)
{
  int *v3; // ebx
  int v5; // esi
  int v6; // edi
  int v7; // eax
  int v8; // eax

  if ( a1 )
  {
    v3 = a2;
    if ( a2 )
    {
      if ( a3 )
      {
        if ( byte_5D4594[2650636] & 0x20 )
          return 1;
        if ( *(_BYTE *)(a1 + 8) & 2 )
          return 1;
        v5 = (unsigned __int16)sub_4EEC80(a1);
        v6 = 0;
        if ( a3 <= 0 )
          return 1;
        while ( 1 )
        {
          v7 = *v3;
          if ( (int)*v3 < 75 || v7 > 114 )
            v8 = sub_4249A0(v7, 2);
          else
            v8 = sub_500CA0(v7, a1);
          if ( v8 > v5 )
            break;
          v5 -= v8;
          ++v6;
          ++v3;
          if ( v6 >= a3 )
            return 1;
        }
      }
    }
  }
  return 0;
}

//----- (004FCF90) --------------------------------------------------------
int __cdecl sub_4FCF90(int a1, int a2, int a3)
{
  unsigned __int16 *v3; // ebp
  int result; // eax
  int v5; // eax
  int v6; // esi

  v3 = *(unsigned __int16 **)(a1 + 748);
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return -1;
  if ( !a2 )
    return -1;
  if ( byte_5D4594[2650636] & 0x20 )
    return 0;
  if ( a2 < 75 || a2 > 114 )
    v5 = sub_4249A0(a2, a3);
  else
    v5 = sub_500CA0(a2, a1);
  v6 = v5;
  if ( v3[2] >= v5 )
  {
    sub_4EEBF0(a1, v5);
    result = v6;
  }
  else
  {
    v3[40] = sub_4249A0(a2, 1);
    result = -1;
    v3[41] = *(_WORD *)&byte_5D4594[2649704];
  }
  return result;
}

//----- (004FD030) --------------------------------------------------------
unsigned __int16 __cdecl sub_4FD030(int a1, __int16 a2)
{
  unsigned __int16 result; // ax

  result = a1;
  if ( *(_BYTE *)(a1 + 8) & 4 )
    result = sub_4EEB80(a1, a2);
  return result;
}

//----- (004FD050) --------------------------------------------------------
void __cdecl sub_4FD050(_DWORD *a1, int a2)
{
  a1[16] = *(_DWORD *)(a2 + 56);
  a1[17] = *(_DWORD *)(a2 + 60);
  a1[14] = *(_DWORD *)(a2 + 56);
  a1[15] = *(_DWORD *)(a2 + 60);
  a1[18] = *(_DWORD *)(a2 + 56);
  a1[19] = *(_DWORD *)(a2 + 60);
  sub_517970((int)a1);
}

//----- (004FD090) --------------------------------------------------------
void __cdecl sub_4FD090(int a1)
{
  int i; // esi
  int v2; // eax

  for ( i = *(_DWORD *)(a1 + 516); i; i = *(_DWORD *)(i + 512) )
  {
    if ( *(unsigned __int16 *)(i + 4) == *(_DWORD *)&byte_5D4594[1569676] )
    {
      v2 = *(_DWORD *)(i + 16);
      if ( (v2 & 0x8000) == 0 && !*(_DWORD *)(*(_DWORD *)(i + 748) + 4) )
        sub_4FD050((_DWORD *)i, a1);
    }
  }
}

//----- (004FD0E0) --------------------------------------------------------
int __cdecl sub_4FD0E0(int a1, int a2)
{
  int v2; // ebx
  int v4; // eax

  sub_424A70(a2);
  v2 = sub_4EC580(a1);
  if ( !sub_424B70(a2) )
    return 10;
  if ( *(_BYTE *)(a1 + 8) & 4 )
    return sub_57AEA0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2251), a2);
  v4 = -sub_57AEE0(a2, v2);
  LOBYTE(v4) = v4 & 0xF6;
  return v4 + 10;
}

//----- (004FD150) --------------------------------------------------------
int __cdecl sub_4FD150(int a1, int a2, int a3)
{
  int v3; // eax
  int result; // eax
  int v5; // eax
  int v6; // eax
  int v7; // edi
  double v8; // st7
  int v9; // eax
  int v10; // edx
  int v11; // [esp-14h] [ebp-20h]
  int v12; // [esp-14h] [ebp-20h]

  sub_4EC580(a1);
  if ( a3 )
    goto LABEL_9;
  if ( sub_40A5C0(16) )
  {
    if ( !*(_DWORD *)&byte_5D4594[1569704] )
      *(_DWORD *)&byte_5D4594[1569704] = sub_4E3AA0((CHAR *)&byte_587000[217588]);
    if ( sub_424A50(a2, 0x80000) )
    {
      v3 = *(_DWORD *)(a1 + 516);
      if ( v3 )
      {
        while ( *(unsigned __int16 *)(v3 + 4) != *(_DWORD *)&byte_5D4594[1569704] )
        {
          v3 = *(_DWORD *)(v3 + 512);
          if ( !v3 )
            goto LABEL_9;
        }
        if ( sub_419130(a1 + 48) )
          return 17;
      }
    }
    goto LABEL_9;
  }
  if ( sub_40A5C0(64) )
  {
    if ( !*(_DWORD *)&byte_5D4594[1569708] )
      *(_DWORD *)&byte_5D4594[1569708] = sub_4E3AA0((CHAR *)&byte_587000[217596]);
    if ( sub_424A50(a2, 0x80000) )
    {
      v5 = *(_DWORD *)(a1 + 516);
      if ( v5 )
      {
        while ( *(unsigned __int16 *)(v5 + 4) != *(_DWORD *)&byte_5D4594[1569708] )
        {
          v5 = *(_DWORD *)(v5 + 512);
          if ( !v5 )
            goto LABEL_9;
        }
        return 16;
      }
    }
LABEL_9:
    if ( sub_4FF350(a1, 29) )
      return 14;
    if ( !sub_4D7100(a2) )
      return 10;
    switch ( a2 )
    {
      case 29:
        if ( sub_4E7C80(a1, *(int *)&byte_5D4594[1569692]) > 0 )
          return 3;
        if ( sub_4E7C80(a1, *(int *)&byte_5D4594[1569688]) <= 0 )
        {
          v10 = *(_DWORD *)&byte_5D4594[1569684];
          goto LABEL_43;
        }
        return 3;
      case 31:
        v9 = sub_4E7C80(a1, *(int *)&byte_5D4594[1569696]);
        goto LABEL_44;
      case 50:
        v7 = sub_4E7C80(a1, *(int *)&byte_5D4594[1569680]);
        v12 = sub_4FE7B0(a2, a1) - 1;
        v8 = sub_419D70(&byte_587000[217620], v12);
        goto LABEL_33;
      case 52:
        v10 = *(_DWORD *)&byte_5D4594[1569700];
LABEL_43:
        v9 = sub_4E7C80(a1, v10);
LABEL_44:
        if ( v9 <= 0 )
          goto LABEL_46;
        return 3;
      case 58:
        v7 = sub_4E7C80(a1, *(int *)&byte_5D4594[1569676]);
        v11 = sub_4FE7B0(a2, a1) - 1;
        v8 = sub_419D70(&byte_587000[217608], v11);
LABEL_33:
        if ( v7 < (int)(__int64)v8 )
          goto LABEL_46;
        result = 3;
        break;
      default:
LABEL_46:
        result = 0;
        break;
    }
    return result;
  }
  if ( !sub_40A5C0(32) )
    goto LABEL_9;
  if ( !sub_424A50(a2, 0x80000) )
    goto LABEL_9;
  v6 = *(_DWORD *)(a1 + 504);
  if ( !v6 )
    goto LABEL_9;
  while ( !(*(_DWORD *)(v6 + 8) & 0x10000000) )
  {
    v6 = *(_DWORD *)(v6 + 496);
    if ( !v6 )
      goto LABEL_9;
  }
  return 13;
}

//----- (004FD400) --------------------------------------------------------
int __cdecl sub_4FD400(int a1, int a2, _DWORD *a3, int a4, int *a5, int a6)
{
  int result; // eax
  int (__cdecl *v7)(int, int, int, int, int, int); // eax
  double v8; // st7
  int v9; // edi

  if ( !a1 )
    return 0;
  if ( !a3 )
    return 0;
  if ( !a2 )
    return 0;
  if ( !a5 )
    return 0;
  if ( sub_424A50(a1, 128) && *a5 && !(*(_BYTE *)(*a5 + 8) & 6) )
    return 0;
  if ( !*a5 || sub_4FDC10(a1, *a5) )
  {
    switch ( a1 )
    {
      case 1:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C390;
        goto LABEL_95;
      case 2:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52DC80;
        goto LABEL_95;
      case 3:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C750;
        goto LABEL_95;
      case 4:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_530310, sub_530380, 0, 0);
      case 5:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C3E0;
        goto LABEL_95;
      case 6:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BBA0;
        goto LABEL_95;
      case 8:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, 0, sub_52F460, 0, 0);
      case 9:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_5011F0,
                 sub_5013E0,
                 sub_501690,
                 0);
      case 10:
      case 11:
        v7 = sub_52D5C0;
        goto LABEL_95;
      case 12:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C1E0;
        goto LABEL_95;
      case 13:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BBB0;
        goto LABEL_95;
      case 14:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CDB0;
        goto LABEL_95;
      case 15:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C920;
        goto LABEL_95;
      case 16:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D1E0;
        goto LABEL_95;
      case 17:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C8D0;
        goto LABEL_95;
      case 18:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BF00;
        goto LABEL_95;
      case 19:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_537E60;
        goto LABEL_95;
      case 21:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_531310,
                 sub_531410,
                 sub_531420,
                 70);
      case 22:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, 0, sub_52E210, 0, 0);
      case 23:
        v7 = sub_52DE40;
        goto LABEL_95;
      case 24:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_52E820,
                 sub_52E850,
                 (int)nullsub_29,
                 30);
      case 26:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52DF40;
        goto LABEL_95;
      case 27:
        v7 = sub_52C790;
        goto LABEL_95;
      case 28:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, 0, sub_52ED40, 0, 3 * *(_DWORD *)&byte_5D4594[2649704]);
      case 29:
        v7 = sub_52D3C0;
        goto LABEL_95;
      case 31:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_52EF30,
                 sub_52EFD0,
                 sub_52F1D0,
                 2 * *(_DWORD *)&byte_5D4594[2649704] / 3u);
      case 32:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C350;
        goto LABEL_95;
      case 33:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C060;
        goto LABEL_95;
      case 34:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_537FA0;
        goto LABEL_95;
      case 35:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_52F220, sub_52F2E0, 0, 0);
      case 36:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C640;
        goto LABEL_95;
      case 37:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CA30;
        goto LABEL_95;
      case 38:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BEB0;
        goto LABEL_95;
      case 39:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C980;
        goto LABEL_95;
      case 40:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C9E0;
        goto LABEL_95;
      case 41:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52DD50;
        goto LABEL_95;
      case 42:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C6D0;
        goto LABEL_95;
      case 43:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_52F820,
                 sub_52F8A0,
                 sub_530100,
                 30);
      case 44:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CE90;
        goto LABEL_95;
      case 45:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CA80;
        goto LABEL_95;
      case 46:
      case 47:
      case 48:
      case 49:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CBD0;
        goto LABEL_95;
      case 50:
        v7 = sub_540160;
        goto LABEL_95;
      case 51:
        return sub_4FEBA0(
                 a1,
                 a2,
                 (_DWORD *)*a5,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_52F5A0,
                 sub_52F650,
                 sub_52F670,
                 0);
      case 52:
        v7 = sub_52D9D0;
        goto LABEL_95;
      case 53:
        v7 = sub_52D8A0;
        goto LABEL_95;
      case 54:
        return sub_4FEBA0(
                 a1,
                 a2,
                 (_DWORD *)*a5,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_531A00,
                 0,
                 sub_531AF0,
                 0);
      case 55:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C230;
        goto LABEL_95;
      case 56:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_530F90,
                 sub_5310C0,
                 sub_531290,
                 0);
      case 57:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CA70;
        goto LABEL_95;
      case 58:
        v7 = sub_540440;
        goto LABEL_95;
      case 59:
        v8 = sub_419D40(&byte_587000[217640]);
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_531580,
                 sub_531600,
                 sub_5319E0,
                 (__int64)v8);
      case 60:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C720;
        goto LABEL_95;
      case 61:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D150;
        goto LABEL_95;
      case 62:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D110;
        goto LABEL_95;
      case 63:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D190;
        goto LABEL_95;
      case 64:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D1A0;
        goto LABEL_95;
      case 65:
        v7 = sub_52BFA0;
        goto LABEL_95;
      case 66:
        v7 = sub_52C000;
        goto LABEL_95;
      case 67:
        return sub_4FEBA0(
                 a1,
                 a2,
                 (_DWORD *)*a5,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_531490,
                 sub_5314F0,
                 sub_531560,
                 0);
      case 68:
      case 133:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BF20;
        goto LABEL_95;
      case 69:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52BF50;
        goto LABEL_95;
      case 70:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C680;
        goto LABEL_95;
      case 71:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C5A0;
        goto LABEL_95;
      case 72:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C190;
        goto LABEL_95;
      case 74:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C2C0;
        goto LABEL_95;
      case 75:
      case 76:
      case 77:
      case 78:
      case 80:
      case 81:
      case 82:
      case 83:
      case 84:
      case 85:
      case 86:
      case 87:
      case 88:
      case 89:
      case 90:
      case 91:
      case 92:
      case 93:
      case 94:
      case 95:
      case 96:
      case 97:
      case 98:
      case 99:
      case 100:
      case 101:
      case 102:
      case 103:
      case 104:
      case 105:
      case 106:
      case 107:
      case 108:
      case 109:
      case 110:
      case 111:
      case 112:
      case 113:
      case 114:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_500DA0,
                 sub_5010D0,
                 sub_5011C0,
                 0);
      case 115:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_530CA0, sub_530D30, 0, 0);
      case 116:
        return sub_4FEBA0(
                 a1,
                 a2,
                 a3,
                 a4,
                 a5,
                 a6,
                 (int (__cdecl *)(_WORD *))sub_530160,
                 sub_530250,
                 sub_530270,
                 0);
      case 117:
      case 118:
      case 119:
      case 120:
      case 122:
      case 123:
      case 124:
      case 125:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_5305D0, sub_530650, 0, 0);
      case 121:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_530820, sub_530880, 0, 0);
      case 126:
        return sub_4FEBA0(a1, a2, a3, a4, a5, a6, (int (__cdecl *)(_WORD *))sub_530A30, sub_530B70, 0, 0);
      case 127:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52D330;
        goto LABEL_95;
      case 128:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52DB60;
        goto LABEL_95;
      case 129:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52CCD0;
        goto LABEL_95;
      case 130:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C530;
        goto LABEL_95;
      case 131:
        v7 = (int (__cdecl *)(int, int, int, int, int, int))sub_52C270;
LABEL_95:
        v9 = v7(a1, a2, (int)a3, a4, (int)a5, a6);
        if ( !v9 )
          sub_501960(231, a4, 0, 0);
        result = v9;
        break;
      case 132:
        result = sub_4FEBA0(
                   a1,
                   a2,
                   a3,
                   a4,
                   a5,
                   a6,
                   (int (__cdecl *)(_WORD *))sub_4FFA90,
                   sub_500070,
                   sub_500080,
                   0);
        break;
      default:
        result = 1;
        break;
    }
  }
  else
  {
    sub_501960(231, *a5, 0, 0);
    result = 0;
  }
  return result;
}
// 52ED30: using guessed type void nullsub_29();

//----- (004FDC10) --------------------------------------------------------
int __cdecl sub_4FDC10(int a1, int a2)
{
  int v3; // esi
  int v4; // eax
  int v5; // esi

  if ( !*(_DWORD *)&byte_5D4594[1569712] )
  {
    *(_DWORD *)&byte_5D4594[1569712] = sub_4E3AA0((CHAR *)&byte_587000[217660]);
    *(_DWORD *)&byte_5D4594[1569716] = sub_4E3AA0((CHAR *)&byte_587000[217672]);
  }
  if ( !a2 )
    return 0;
  if ( sub_424A50(a1, 0x80000) && *(_BYTE *)(a2 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a2 + 748);
    if ( sub_40A5C0(32) )
    {
      if ( *(_BYTE *)(*(_DWORD *)(v3 + 276) + 4) & 1 )
        return 0;
    }
    else if ( sub_40A5C0(64) )
    {
      v4 = *(_DWORD *)(a2 + 516);
      if ( v4 )
      {
        while ( *(unsigned __int16 *)(v4 + 4) != *(_DWORD *)&byte_5D4594[1569712] )
        {
          v4 = *(_DWORD *)(v4 + 512);
          if ( !v4 )
            return 1;
        }
        return 0;
      }
    }
    else if ( sub_40A5C0(16) )
    {
      v5 = *(_DWORD *)(a2 + 516);
      if ( v5 )
      {
        while ( *(unsigned __int16 *)(v5 + 4) != *(_DWORD *)&byte_5D4594[1569716] || !sub_419130(a2 + 48) )
        {
          v5 = *(_DWORD *)(v5 + 512);
          if ( !v5 )
            return 1;
        }
        return 0;
      }
    }
  }
  return 1;
}

//----- (004FDD20) --------------------------------------------------------
int __cdecl sub_4FDD20(int a1, _DWORD *a2, int *a3)
{
  int v3; // ebx

  v3 = sub_4FE7B0(a1, (int)a2);
  if ( sub_424A50(a1, 32) )
  {
    sub_4FF5B0((int)a2, 0);
    sub_4FF5B0((int)a2, 23);
    sub_4FEB10(67, (int)a2);
  }
  if ( !sub_424A50(a1, 4) || a2 == (_DWORD *)*a3 )
    return sub_4FD400(a1, (int)a2, a2, (int)a2, a3, v3);
  sub_4FDDA0((int)a2, *a3, a1);
  return 1;
}

//----- (004FDDA0) --------------------------------------------------------
_DWORD *__cdecl sub_4FDDA0(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // eax
  int v5; // eax
  int v6; // eax
  float v7; // edx
  double v8; // st7
  double v9; // st7
  double v10; // st6
  _DWORD *result; // eax
  _DWORD *v12; // edi
  int *v13; // ebx
  __int16 v14; // ax
  int v15; // ecx
  __int16 v16; // ax
  int v17; // eax
  int v18; // [esp-10h] [ebp-34h]
  int v19; // [esp-10h] [ebp-34h]
  char v20; // [esp-4h] [ebp-28h]
  int2 v21; // [esp+Ch] [ebp-18h]
  float4 v22; // [esp+14h] [ebp-10h]
  float a2a; // [esp+28h] [ebp+4h]

  v3 = a1;
  a2a = *(float *)(a1 + 176) + 4.0;
  if ( !a2 )
  {
    if ( *(_BYTE *)(v3 + 8) & 4 )
    {
      v4 = *(_DWORD *)(v3 + 748);
      *(float *)&v21.field_0 = (double)*(int *)(*(_DWORD *)(v4 + 276) + 2284);
      *(float *)&v21.field_4 = (double)*(int *)(*(_DWORD *)(v4 + 276) + 2288);
      v18 = sub_424A70(a3);
      v5 = sub_540610((float2 *)&v21, v3, v18, 600.0, 0, v3);
    }
    else
    {
      v19 = sub_424A70(a3);
      v5 = sub_540610(0, v3, v19, 600.0, 0, v3);
    }
    a2 = v5;
  }
  v6 = 8 * *(__int16 *)(v3 + 124);
  v7 = *(float *)(v3 + 60);
  v8 = a2a * *(float *)&byte_587000[v6 + 194136];
  v22.field_0 = *(float *)(v3 + 56);
  v9 = v8 + *(float *)(v3 + 56);
  v10 = a2a * *(float *)&byte_587000[v6 + 194140];
  v22.field_4 = v7;
  v22.field_C = v10 + *(float *)(v3 + 60);
  v22.field_8 = v9 + *(float *)(v3 + 80);
  v22.field_C = v22.field_C + *(float *)(v3 + 84);
  result = (_DWORD *)sub_535250(&v22, 0, 0, 5);
  if ( result )
  {
    result = sub_4E3810((CHAR *)&byte_587000[217680]);
    v12 = result;
    if ( result )
    {
      v13 = (int *)result[187];
      v13[4] = sub_4FE7B0(a3, v3);
      sub_4DAA50((int)v12, v3, v22.field_8, v22.field_C);
      v14 = *(_WORD *)(v3 + 124);
      *((_WORD *)v12 + 62) = v14;
      *((_WORD *)v12 + 63) = v14;
      *v13 = v3;
      v13[1] = a2;
      v13[2] = v3;
      v13[3] = a3;
      sub_509E20(*(__int16 *)(v3 + 124), &v21);
      v15 = *((__int16 *)v12 + 62);
      *((float *)v12 + 20) = *(float *)&byte_587000[8 * v15 + 194136] * *((float *)v12 + 136);
      *((float *)v12 + 21) = *(float *)&byte_587000[8 * v15 + 194140] * *((float *)v12 + 136);
      *((float *)v12 + 20) = *((float *)v12 + 20) + *(float *)(v3 + 80);
      *((float *)v12 + 21) = *((float *)v12 + 21) + *(float *)(v3 + 84);
      if ( sub_4FF350(v3, 21) )
      {
        v20 = sub_4FF570(v3, 21);
        v16 = sub_4FF550(v3, 21);
        sub_4FF380((int)v12, 21, v16, v20);
      }
      v17 = sub_424800(a3, 0);
      result = sub_501960(v17, v3, 0, 0);
    }
  }
  return result;
}

//----- (004FDF90) --------------------------------------------------------
int __cdecl sub_4FDF90(int a1, int a2)
{
  int v2; // edi
  int v3; // eax
  int result; // eax
  float v5; // [esp+0h] [ebp-10h]

  if ( sub_4FF350(a1, 22) && !(*(_DWORD *)(a2 + 16) & 0x8008) && *(_BYTE *)(a2 + 8) & 6 && sub_5330C0(a1, a2) )
  {
    v2 = *(unsigned __int8 *)(a1 + 430) - 1;
    sub_501960(135, a1, 0, 0);
    sub_4FF5B0(a1, 22);
    v5 = sub_419D70(&byte_587000[217688], v2);
    v3 = sub_419A70(v5);
    (*(void (__cdecl **)(int, int, int, int, int))(a2 + 716))(a2, a1, a1, v3, 9);
  }
  result = *(_DWORD *)(a2 + 8);
  if ( result & 0x20006 )
  {
    if ( !(*(_DWORD *)(a2 + 16) & 0x8020) )
    {
      result = sub_4EC520(a2, a1);
      if ( !result )
        result = sub_4FF5B0(a1, 0);
    }
  }
  if ( *(_BYTE *)(a1 + 8) & 4 && *(_DWORD *)(a2 + 8) & 0x20000 && !(*(_DWORD *)(a2 + 16) & 0x8020) )
    result = sub_4FF5B0(a1, 0);
  return result;
}

//----- (004FE060) --------------------------------------------------------
int __cdecl sub_4FE060(int a1, int a2)
{
  int v2; // ebx
  int v3; // esi
  int *v4; // edi
  int v5; // eax
  int result; // eax
  int v7[137]; // [esp+8h] [ebp-224h]

  v2 = 0;
  v3 = sub_424AD0();
  if ( !v3 )
    goto LABEL_14;
  v4 = v7;
  do
  {
    if ( !sub_4FE100(v3) )
    {
      v5 = sub_424A70(v3);
      if ( v5 & a1 || v5 & 0x1000000 )
      {
        if ( v5 & a2 )
        {
          *v4 = v3;
          ++v2;
          ++v4;
        }
      }
    }
    v3 = sub_424AF0(v3);
  }
  while ( v3 );
  if ( v2 )
    result = v7[sub_415FA0(0, v2 - 1)];
  else
LABEL_14:
    result = 0;
  return result;
}
// 4FE060: using guessed type int var_224[137];

//----- (004FE100) --------------------------------------------------------
int __cdecl sub_4FE100(int a1)
{
  int result; // eax

  switch ( a1 )
  {
    case 1:
    case 2:
    case 6:
    case 13:
    case 15:
    case 18:
    case 19:
    case 20:
    case 30:
    case 32:
    case 33:
    case 34:
    case 38:
    case 51:
    case 57:
    case 68:
    case 69:
    case 70:
    case 73:
    case 129:
    case 133:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (004FE1C0) --------------------------------------------------------
int __cdecl sub_4FE1C0(int a1, char a2)
{
  char *v2; // eax
  int result; // eax

  if ( sub_40A5C0(1) )
  {
    if ( *(_BYTE *)(sub_4ECCB0(a1) + 8) & 4 )
    {
LABEL_5:
      v2 = sub_417040(a1);
      if ( !v2 )
        return 0;
      if ( !v2[2252] )
      {
        switch ( a2 )
        {
          case 0:
            goto LABEL_25;
          case 1:
            goto LABEL_18;
          case 2:
            goto LABEL_19;
          case 3:
            goto LABEL_24;
          case 5:
            goto LABEL_20;
          case 6:
            goto LABEL_23;
          case 7:
            goto LABEL_22;
          case 8:
            goto LABEL_21;
          default:
            return 0;
        }
      }
      switch ( a2 )
      {
        case 0:
          result = 201;
          break;
        case 1:
          result = 194;
          break;
        case 2:
          result = 195;
          break;
        case 3:
          result = 200;
          break;
        case 5:
          result = 196;
          break;
        case 6:
          result = 199;
          break;
        case 7:
          result = 198;
          break;
        case 8:
          result = 197;
          break;
        default:
          return 0;
      }
      return result;
    }
  }
  else if ( sub_45A6F0(a1)[28] & 4 )
  {
    goto LABEL_5;
  }
  switch ( a2 )
  {
    case 0:
LABEL_25:
      result = 193;
      break;
    case 1:
LABEL_18:
      result = 186;
      break;
    case 2:
LABEL_19:
      result = 187;
      break;
    case 3:
LABEL_24:
      result = 192;
      break;
    case 5:
LABEL_20:
      result = 188;
      break;
    case 6:
LABEL_23:
      result = 191;
      break;
    case 7:
LABEL_22:
      result = 190;
      break;
    case 8:
LABEL_21:
      result = 189;
      break;
    default:
      return 0;
  }
  return result;
}

//----- (004FE340) --------------------------------------------------------
int __cdecl sub_4FE340(int a1, int *a2, int a3, int a4, int a5)
{
  _DWORD *v5; // edi
  int *v6; // ebp
  int v7; // edx
  int *v8; // ecx
  int v9; // ebx
  int v10; // edx
  int *v11; // ecx
  int *v12; // eax
  int v13; // ecx
  BYTE v15; // eax
  int v16; // esi
  int *v17; // esi
  int v18; // ebp
  int v19; // ecx
  _DWORD *v20; // esi
  int v21; // eax
  int v22; // edx
  int v23; // eax
  int *v24; // ecx
  int *v25; // edx
  int v26; // [esp+10h] [ebp-4h]

  v5 = (_DWORD *)a1;
  if ( *(_DWORD *)(a1 + 16) & 0x8022 )
    return 0;
  v6 = a2;
  v7 = 0;
  v8 = a2;
  do
  {
    if ( (int)*v8 < 0 || (int)*v8 >= 137 )
      return 0;
    ++v7;
    ++v8;
  }
  while ( v7 < 5 );
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v9 = *(_DWORD *)(a1 + 748);
  if ( *(_DWORD *)(v9 + 280) )
    return 0;
  v10 = 0;
  v11 = a2;
  do
  {
    if ( !*(_DWORD *)(*(_DWORD *)(v9 + 276) + 4 * *v11 + 3696) && *v11 )
      return 0;
    ++v10;
    ++v11;
  }
  while ( v10 < 5 );
  if ( *(_DWORD *)(v9 + 216) )
    return 0;
  v26 = 0;
  if ( a3 > 0 )
  {
    v12 = a2;
    v13 = a3;
    do
    {
      if ( *v12 == 34 )
        v26 = 1;
      ++v12;
      --v13;
    }
    while ( v13 );
    if ( v26 )
    {
      if ( !sub_4FCEF0(a1, a2, a3) )
      {
        a1 = 12;
        sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v9 + 276) + 2064), 0, &a1);
        sub_501960(232, (int)v5, 0, 0);
        return 0;
      }
      if ( *(_BYTE *)(*(_DWORD *)(v9 + 276) + 2251) == 2 )
      {
        v15 = sub_500D70((int)v5, 5);
        if ( !v15 )
        {
          a1 = 4;
LABEL_44:
          sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v9 + 276) + 2064), 0, &a1);
          goto LABEL_29;
        }
        v16 = sub_4E7CF0((int)v5, 2, 0x2000);
        if ( v16 >= (int)(__int64)sub_419D40(&byte_587000[217736]) )
        {
          a1 = 5;
          goto LABEL_44;
        }
      }
      else if ( *(unsigned __int8 *)(v9 + 244) >= (int)(__int64)sub_419D40(&byte_587000[217752]) )
      {
        a1 = 5;
LABEL_28:
        sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v9 + 276) + 2064), 0, &a1);
LABEL_29:
        sub_501960(231, (int)v5, 0, 0);
        return 0;
      }
      v17 = a2;
      v18 = 0;
      while ( 1 )
      {
        a1 = sub_4FD0E0((int)v5, *v17);
        if ( a1 )
          goto LABEL_28;
        a1 = sub_4FD150((int)v5, *v17, v26);
        if ( a1 )
          goto LABEL_28;
        ++v18;
        ++v17;
        if ( v18 >= a3 )
        {
          v6 = a2;
          goto LABEL_36;
        }
      }
    }
  }
  a1 = sub_4FD0E0(a1, *a2);
  if ( a1 )
  {
    sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v9 + 276) + 2064), 0, &a1);
    goto LABEL_29;
  }
  a1 = sub_4FD150((int)v5, *v6, 0);
  if ( a1 )
    goto LABEL_44;
LABEL_36:
  sub_4FA020(v5, 2);
  v19 = *(_DWORD *)&byte_5D4594[2598000];
  *(_BYTE *)(v9 + 188) = 1;
  *(_DWORD *)(v9 + 216) = v19;
  v20 = sub_4142F0(*(_DWORD **)&byte_5D4594[1569668]);
  if ( !v20 )
    return 0;
  v21 = a5;
  v22 = a4;
  v20[1] = v5;
  v20[12] = v21;
  *((_BYTE *)v20 + 36) = 0;
  v20[10] = *(_DWORD *)&byte_5D4594[2598000];
  v20[11] = v22;
  v20[8] = sub_424820();
  *((_BYTE *)v20 + 28) = 0;
  *((_BYTE *)v20 + 29) = 0;
  v23 = 0;
  v24 = v6;
  v25 = v20 + 2;
  do
  {
    if ( v23 >= a3 )
    {
      *v25 = 0;
    }
    else
    {
      *v25 = *v24;
      if ( *v24 == 34 )
        *((_BYTE *)v20 + 29) = 1;
    }
    ++v23;
    ++v24;
    ++v25;
  }
  while ( v23 < 5 );
  v20[14] = 0;
  v20[13] = *(_DWORD *)&byte_5D4594[1569672];
  if ( *(_DWORD *)&byte_5D4594[1569672] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[1569672] + 56) = v20;
  *(_DWORD *)&byte_5D4594[1569672] = v20;
  return 1;
}
// 4FE46E: variable 'v15' is possibly undefined

//----- (004FE680) --------------------------------------------------------
void __cdecl sub_4FE680(int a1, float a2)
{
  int v2; // esi
  int v3; // ebp
  int v4; // eax
  int v5; // ecx
  double v6; // st7
  double v7; // st6
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // edi

  v2 = *(_DWORD *)&byte_5D4594[1569672];
  if ( *(_DWORD *)&byte_5D4594[1569672] )
  {
    v3 = a1;
    do
    {
      v4 = *(_DWORD *)(v2 + 4);
      if ( ((*(_BYTE *)(v4 + 8) & 4) != 4 || !sub_419150(v3 + 48, v4 + 48))
        && (v5 = *(_DWORD *)(v2 + 4),
            v6 = *(float *)(v5 + 56) - *(float *)(v3 + 56),
            v7 = *(float *)(v5 + 60) - *(float *)(v3 + 60),
            sqrt(v7 * v7 + v6 * v6) + 0.1 < a2)
        && sub_537110(v3, *(_DWORD *)(v2 + 4)) )
      {
        v8 = *(_DWORD *)(v2 + 4);
        if ( (*(_BYTE *)(v8 + 8) & 4) == 4 )
        {
          v9 = *(_DWORD *)(v8 + 748);
          *(_DWORD *)(v9 + 216) = 0;
          *(_BYTE *)(v9 + 188) = 0;
          a1 = 15;
          sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v9 + 276) + 2064), 0, &a1);
          sub_501960(231, *(_DWORD *)(v2 + 4), 0, 0);
          sub_4FA020(*(_DWORD **)(v2 + 4), 13);
        }
        v10 = *(_DWORD *)(v2 + 52);
        if ( v10 )
          *(_DWORD *)(v10 + 56) = *(_DWORD *)(v2 + 56);
        v11 = *(_DWORD *)(v2 + 56);
        if ( v11 )
          *(_DWORD *)(v11 + 52) = *(_DWORD *)(v2 + 52);
        else
          *(_DWORD *)&byte_5D4594[1569672] = *(_DWORD *)(v2 + 52);
        v12 = *(_DWORD *)(v2 + 52);
        sub_414330(*(unsigned int **)&byte_5D4594[1569668], (_QWORD *)v2);
        v2 = v12;
      }
      else
      {
        v2 = *(_DWORD *)(v2 + 52);
      }
    }
    while ( v2 );
  }
}

//----- (004FE7B0) --------------------------------------------------------
int __cdecl sub_4FE7B0(int a1, int a2)
{
  int v2; // eax
  int result; // eax
  int v4; // eax

  v2 = *(_DWORD *)&byte_5D4594[1569720];
  if ( !*(_DWORD *)&byte_5D4594[1569720] )
  {
    v2 = sub_4E3AA0((CHAR *)&byte_587000[217768]);
    *(_DWORD *)&byte_5D4594[1569720] = v2;
  }
  if ( *(unsigned __int16 *)(a2 + 4) == v2 )
    return 1;
  if ( sub_40A5C0(1392) )
    goto LABEL_15;
  if ( !a2 )
    return 2;
  v4 = *(_DWORD *)(a2 + 8);
  if ( v4 & 4 )
    return *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 4 * a1 + 3696);
  if ( !(v4 & 2) )
LABEL_15:
    result = 3;
  else
    result = *(_DWORD *)(*(_DWORD *)(a2 + 748) + 2040);
  return result;
}

//----- (004FE840) --------------------------------------------------------
void sub_4FE840()
{
  srand(0x1447u);
}

//----- (004FE850) --------------------------------------------------------
BOOL sub_4FE850()
{
  *(_DWORD *)&byte_5D4594[1569724] = sub_413FE0((const char *)&byte_587000[217784], 120, 512);
  return *(_DWORD *)&byte_5D4594[1569724] != 0;
}

//----- (004FE880) --------------------------------------------------------
void sub_4FE880()
{
  sub_414100(*(LPVOID *)&byte_5D4594[1569724]);
  *(_DWORD *)&byte_5D4594[1569728] = 0;
}

//----- (004FE8A0) --------------------------------------------------------
void __cdecl sub_4FE8A0(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // edi

  if ( a1 )
  {
    v1 = *(_DWORD *)&byte_5D4594[1569728];
    if ( *(_DWORD *)&byte_5D4594[1569728] )
    {
      do
      {
        v2 = *(_DWORD *)(v1 + 48);
        v3 = *(_DWORD *)(v1 + 116);
        if ( !v2 || !(*(_BYTE *)(v2 + 8) & 4) )
        {
          sub_4FE900(v1);
          sub_4FE980(v1);
        }
        v1 = v3;
      }
      while ( v3 );
    }
  }
  else
  {
    sub_4144D0(*(_DWORD **)&byte_5D4594[1569724]);
    *(_DWORD *)&byte_5D4594[1569728] = 0;
  }
}

//----- (004FE900) --------------------------------------------------------
int __cdecl sub_4FE900(int a1)
{
  int result; // eax
  int v2; // ecx
  int v3; // ecx

  result = a1;
  v2 = *(_DWORD *)(a1 + 112);
  if ( v2 )
    *(_DWORD *)(v2 + 116) = *(_DWORD *)(a1 + 116);
  else
    *(_DWORD *)&byte_5D4594[1569728] = *(_DWORD *)(a1 + 116);
  v3 = *(_DWORD *)(a1 + 116);
  if ( v3 )
    *(_DWORD *)(v3 + 112) = *(_DWORD *)(a1 + 112);
  return result;
}

//----- (004FE930) --------------------------------------------------------
int sub_4FE930()
{
  return *(_DWORD *)&byte_5D4594[1569728];
}

//----- (004FE940) --------------------------------------------------------
int __cdecl sub_4FE940(int a1)
{
  return *(_DWORD *)(a1 + 116);
}

//----- (004FE950) --------------------------------------------------------
_WORD *sub_4FE950()
{
  _WORD *result; // eax

  result = sub_4142F0(*(_DWORD **)&byte_5D4594[1569724]);
  if ( result )
    *result = ++*(_WORD *)&byte_5D4594[1569732];
  return result;
}

//----- (004FE980) --------------------------------------------------------
void __cdecl sub_4FE980(int a1)
{
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // esi

  v1 = *(_DWORD *)(a1 + 108);
  if ( v1 )
  {
    do
    {
      v2 = *(_DWORD *)(v1 + 116);
      sub_4FE980(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  v3 = *(_DWORD *)(a1 + 104);
  if ( v3 )
  {
    do
    {
      v4 = *(_DWORD *)(v3 + 116);
      sub_4FE980(v3);
      v3 = v4;
    }
    while ( v4 );
  }
  sub_414330(*(unsigned int **)&byte_5D4594[1569724], (_QWORD *)a1);
}

//----- (004FE9D0) --------------------------------------------------------
char __cdecl sub_4FE9D0(int a1)
{
  int v1; // eax
  int v2; // ecx
  int v3; // eax
  char result; // al
  int i; // esi

  v1 = *(_DWORD *)(a1 + 16);
  if ( v1 && *(_BYTE *)(v1 + 8) & 4 )
  {
    v2 = *(_DWORD *)(a1 + 4);
    v3 = *(_DWORD *)(v1 + 748);
    if ( v2 == 43 )
      sub_4D9630(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 43, 0);
    else
      sub_4D9630(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), v2, 15);
  }
  if ( *(_DWORD *)(a1 + 4) == 43 )
  {
    for ( i = *(_DWORD *)(a1 + 108); i; i = *(_DWORD *)(i + 116) )
    {
      if ( *(_DWORD *)(i + 48) )
        sub_4FEF90(i, *(_DWORD **)(i + 48));
    }
  }
  else if ( *(_DWORD *)(a1 + 48) )
  {
    sub_4FEF90(a1, *(_DWORD **)(a1 + 48));
    result = *(_BYTE *)(a1 + 88) | 1;
    *(_BYTE *)(a1 + 88) = result;
    return result;
  }
  result = *(_BYTE *)(a1 + 88) | 1;
  *(_BYTE *)(a1 + 88) = result;
  return result;
}

//----- (004FEA70) --------------------------------------------------------
BOOL __cdecl sub_4FEA70(int a1, float2 *a2)
{
  double v2; // st7
  double v3; // st7
  float v5; // [esp+0h] [ebp-8h]

  v2 = a2->field_0 - *(float *)(a1 + 56);
  if ( v2 < 0.0 )
    v2 = -v2;
  v5 = v2;
  v3 = a2->field_4 - *(float *)(a1 + 60);
  if ( v3 < 0.0 )
    v3 = -v3;
  return v5 >= 5.0 || v3 >= 5.0;
}

//----- (004FEAE0) --------------------------------------------------------
int __cdecl sub_4FEAE0(int a1)
{
  int result; // eax
  int v2; // esi

  result = sub_4FE930();
  if ( result )
  {
    do
    {
      v2 = *(_DWORD *)(result + 116);
      if ( *(_DWORD *)(result + 16) == a1 )
        sub_4FE9D0(result);
      result = v2;
    }
    while ( v2 );
  }
  return result;
}

//----- (004FEB10) --------------------------------------------------------
_DWORD *__cdecl sub_4FEB10(int a1, int a2)
{
  _DWORD *result; // eax
  int v3; // ecx
  _DWORD *v4; // esi

  result = *(_DWORD **)&byte_5D4594[1569728];
  if ( *(_DWORD *)&byte_5D4594[1569728] )
  {
    do
    {
      v3 = result[1];
      v4 = (_DWORD *)result[29];
      if ( v3 == a1 && result[4] == a2 || a1 >= 75 && a1 <= 114 && v3 >= 75 && v3 <= 114 && result[4] == a2 )
        sub_4FE9D0((int)result);
      result = v4;
    }
    while ( v4 );
  }
  return result;
}

//----- (004FEB60) --------------------------------------------------------
unsigned int __cdecl sub_4FEB60(int a1, int a2)
{
  unsigned int result; // eax

  result = *(_DWORD *)(a2 + 8);
  if ( result & 0x1000 )
  {
    result = *(_DWORD *)(a2 + 12);
    if ( result & 0x40000 )
      result = (unsigned int)sub_4FEB10(43, a1);
    if ( *(_DWORD *)(a2 + 12) & 0x4000000 )
      result = (unsigned int)sub_4FEB10(59, a1);
  }
  return result;
}

//----- (004FEBA0) --------------------------------------------------------
int __cdecl sub_4FEBA0(int a1, int a2, _DWORD *a3, int a4, _DWORD *a5, int a6, int (__cdecl *a7)(_WORD *), int a8, int a9, int a10)
{
  int v10; // eax
  _WORD *v12; // esi
  int v13; // edx
  int v14; // ecx
  int v15; // ecx
  BOOL v16; // eax
  int v17; // eax

  v10 = *(_DWORD *)&byte_5D4594[1569736];
  if ( !*(_DWORD *)&byte_5D4594[1569736] )
  {
    v10 = sub_4E3AA0((CHAR *)&byte_587000[217800]);
    *(_DWORD *)&byte_5D4594[1569736] = v10;
  }
  if ( a3 && !(a3[4] & 0x8020) || !a4 || *(unsigned __int16 *)(a4 + 4) == v10 )
  {
    if ( a3 )
    {
      if ( (a1 == 59 || a1 == 43) && sub_4FEE50(a1, (int)a3) == 1 )
        return 1;
      sub_4FEB10(a1, (int)a3);
    }
    sub_4FED70();
    v12 = sub_4FE950();
    if ( v12 )
    {
      *((_DWORD *)v12 + 1) = a1;
      *((_DWORD *)v12 + 2) = a6;
      *((_DWORD *)v12 + 4) = a3;
      *((_DWORD *)v12 + 3) = a2;
      *((_DWORD *)v12 + 27) = 0;
      *((_DWORD *)v12 + 26) = 0;
      if ( a4 && *(unsigned __int16 *)(a4 + 4) == *(_DWORD *)&byte_5D4594[1569736] )
      {
        *((_DWORD *)v12 + 5) = 1;
        *((_DWORD *)v12 + 6) = a4;
        *((_DWORD *)v12 + 7) = *(_DWORD *)(a4 + 56);
        v13 = *(_DWORD *)(a4 + 60);
      }
      else
      {
        *((_DWORD *)v12 + 5) = 0;
        *((_DWORD *)v12 + 6) = 0;
        *((_DWORD *)v12 + 7) = a3[14];
        v13 = a3[15];
      }
      *((_DWORD *)v12 + 9) = 0;
      *((_DWORD *)v12 + 8) = v13;
      *((_DWORD *)v12 + 12) = *a5;
      *((_DWORD *)v12 + 13) = a5[1];
      v14 = a5[2];
      *((_DWORD *)v12 + 23) = a7;
      *((_DWORD *)v12 + 14) = v14;
      *((_DWORD *)v12 + 24) = a8;
      *((_DWORD *)v12 + 25) = a9;
      *((_DWORD *)v12 + 15) = *(_DWORD *)&byte_5D4594[2598000];
      *((_DWORD *)v12 + 16) = *(_DWORD *)&byte_5D4594[2598000];
      v15 = a10 + *(_DWORD *)&byte_5D4594[2598000];
      *((_BYTE *)v12 + 88) = 0;
      *((_DWORD *)v12 + 17) = v15;
      sub_4FED40((int)v12);
      v16 = sub_424A50(a1, 4);
      v17 = sub_424800(a1, v16);
      sub_501960(v17, (int)a3, 0, 0);
      if ( !a7 || !a7(v12) )
        return 1;
      sub_4FE9D0((int)v12);
    }
  }
  return 0;
}

//----- (004FED40) --------------------------------------------------------
int __cdecl sub_4FED40(int a1)
{
  int result; // eax

  result = a1;
  if ( *(_DWORD *)&byte_5D4594[1569728] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[1569728] + 112) = a1;
  *(_DWORD *)(a1 + 112) = 0;
  *(_DWORD *)(a1 + 116) = *(_DWORD *)&byte_5D4594[1569728];
  *(_DWORD *)&byte_5D4594[1569728] = a1;
  return result;
}

//----- (004FED70) --------------------------------------------------------
int sub_4FED70()
{
  int result; // eax
  int v1; // esi

  result = *(_DWORD *)&byte_5D4594[1569728];
  if ( *(_DWORD *)&byte_5D4594[1569728] )
  {
    do
    {
      v1 = *(_DWORD *)(result + 116);
      if ( *(_BYTE *)(result + 88) & 1 )
        sub_4FEDA0((int *)result);
      result = v1;
    }
    while ( v1 );
  }
  return result;
}

//----- (004FEDA0) --------------------------------------------------------
void __cdecl sub_4FEDA0(int *a1)
{
  int v1; // eax
  void (__cdecl *v2)(int *); // eax
  int v3; // eax
  int v4; // ecx
  int v5; // [esp-Ch] [ebp-10h]

  if ( a1[4] )
  {
    v5 = a1[4];
    v1 = sub_424800(a1[1], 2);
    sub_501960(v1, v5, 0, 0);
  }
  v2 = (void (__cdecl *)(int *))a1[25];
  if ( v2 )
    v2(a1);
  v3 = a1[4];
  if ( v3 )
  {
    v4 = *(_DWORD *)(v3 + 8);
    if ( v4 & 4 )
    {
      if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v3 + 748) + 276) + 2251) || !sub_4FC250(v3, 1) )
      {
        sub_4FA020((_DWORD *)a1[4], 13);
        sub_4FE900((int)a1);
        sub_4FE980((int)a1);
        return;
      }
    }
    else if ( v4 & 2 )
    {
      sub_541630(v3, a1[1]);
    }
  }
  sub_4FE900((int)a1);
  sub_4FE980((int)a1);
}

//----- (004FEE50) --------------------------------------------------------
int __cdecl sub_4FEE50(int a1, int a2)
{
  int v2; // ecx
  int result; // eax

  v2 = *(_DWORD *)&byte_5D4594[1569728];
  if ( !*(_DWORD *)&byte_5D4594[1569728] )
    return 0;
  result = 1;
  while ( *(_DWORD *)(v2 + 20) || *(_DWORD *)(v2 + 4) != a1 || *(_DWORD *)(v2 + 16) != a2 || *(_BYTE *)(v2 + 88) & 1 )
  {
    v2 = *(_DWORD *)(v2 + 116);
    if ( !v2 )
      return 0;
  }
  return result;
}

//----- (004FEE90) --------------------------------------------------------
char __cdecl sub_4FEE90(int a1)
{
  int v1; // eax
  int v2; // esi
  int v3; // edi

  v1 = sub_4FE930();
  v2 = v1;
  if ( v1 )
  {
    do
    {
      v3 = sub_4FE940(v2);
      v1 = *(_DWORD *)(v2 + 16);
      if ( v1 == a1 )
      {
        v1 = *(_DWORD *)(v2 + 4);
        if ( v1 == 24 || v1 == 43 || v1 == 35 || v1 == 8 || v1 == 22 || v1 == 59 || v1 == 67 )
          LOBYTE(v1) = sub_4FE9D0(v2);
      }
      v2 = v3;
    }
    while ( v3 );
  }
  return v1;
}

//----- (004FEEF0) --------------------------------------------------------
void sub_4FEEF0()
{
  int v0; // esi
  int v1; // ebp
  int v2; // eax
  int v3; // eax
  int v4; // eax
  unsigned int v5; // eax
  int (__cdecl *v6)(int); // eax

  v0 = *(_DWORD *)&byte_5D4594[1569728];
  if ( *(_DWORD *)&byte_5D4594[1569728] )
  {
    do
    {
      v1 = *(_DWORD *)(v0 + 116);
      if ( *(_BYTE *)(v0 + 88) & 1 )
      {
        sub_4FEDA0((int *)v0);
      }
      else
      {
        v2 = *(_DWORD *)(v0 + 16);
        if ( v2 && *(_DWORD *)(v2 + 16) & 0x8020 )
          *(_DWORD *)(v0 + 16) = 0;
        v3 = *(_DWORD *)(v0 + 12);
        if ( v3 && *(_BYTE *)(v3 + 16) & 0x20 )
          *(_DWORD *)(v0 + 12) = 0;
        if ( !*(_DWORD *)(v0 + 16) && !*(_DWORD *)(v0 + 20) )
          goto LABEL_23;
        v4 = *(_DWORD *)(v0 + 24);
        if ( v4 && *(_BYTE *)(v4 + 16) & 0x20 )
          *(_DWORD *)(v0 + 24) = 0;
        if ( (v5 = *(_DWORD *)(v0 + 68), v5 != *(_DWORD *)(v0 + 60)) && v5 <= *(int *)&byte_5D4594[2598000]
          || (v6 = *(int (__cdecl **)(int))(v0 + 96)) != 0 && v6(v0) )
        {
LABEL_23:
          sub_4FE9D0(v0);
        }
      }
      v0 = v1;
    }
    while ( v1 );
  }
}

//----- (004FEF90) --------------------------------------------------------
void __cdecl sub_4FEF90(int a1, _DWORD *a2)
{
  int v2; // ecx
  int v3; // eax
  char v4; // cl
  int i; // esi
  char v6; // al
  char v7; // cl
  char v8; // dl
  __int16 v9; // ax
  char v10; // cl
  char v11[7]; // [esp+8h] [ebp-8h]

  if ( a1 )
  {
    v2 = *(_DWORD *)(a1 + 16);
    if ( v2 )
    {
      if ( a2 )
      {
        v3 = *(_DWORD *)(a1 + 4);
        v11[0] = -98;
        switch ( v3 )
        {
          case 7:
            v6 = *(_BYTE *)(a1 + 8);
            v11[1] = 10;
            v11[2] = v6;
            goto LABEL_13;
          case 9:
            v4 = *(_BYTE *)(a1 + 8);
            v11[1] = 9;
            v11[2] = v4;
            goto LABEL_13;
          case 22:
            v8 = *(_BYTE *)(a1 + 8);
            v11[1] = 12;
            v11[2] = v8;
            goto LABEL_13;
          case 24:
            v7 = *(_BYTE *)(a1 + 8);
            v11[1] = 11;
            v11[2] = v7;
            goto LABEL_13;
          case 35:
            if ( v2 == *(_DWORD *)(a1 + 48) )
              return;
            v11[1] = 13;
            *(_WORD *)&v11[3] = sub_578AC0(a2);
            v9 = sub_578AC0(*(_DWORD **)(a1 + 16));
            v10 = *(_BYTE *)(a1 + 8);
            *(_WORD *)&v11[5] = v9;
            v11[2] = v10;
            sub_4E5390(255, (int)v11, 7, 0, 1);
            sub_417470(*(_DWORD *)(a1 + 16), 2);
            goto LABEL_16;
          case 43:
            for ( i = *(_DWORD *)(a1 + 108); i; i = *(_DWORD *)(i + 116) )
              sub_4FEF90(i, *(_DWORD **)(i + 48));
            return;
          case 59:
            v11[1] = 8;
            v11[2] = *(_BYTE *)(v2 + 124);
LABEL_13:
            *(_WORD *)&v11[5] = sub_578AC0(a2);
            *(_WORD *)&v11[3] = sub_578AC0(*(_DWORD **)(a1 + 16));
            sub_4E5390(255, (int)v11, 7, 0, 1);
            sub_417470(*(_DWORD *)(a1 + 16), 2);
LABEL_16:
            sub_417470((int)a2, 2);
            break;
          default:
            return;
        }
      }
    }
  }
}

//----- (004FF130) --------------------------------------------------------
char *__cdecl sub_4FF130(int a1)
{
  char *result; // eax
  int v2; // edx
  int i; // esi
  char v4; // dl
  char v5; // al
  __int16 v6; // ax
  _DWORD *v7; // edx
  __int16 v8; // ax
  char v9; // cl
  _DWORD *v10; // [esp-4h] [ebp-10h]
  char v11[7]; // [esp+4h] [ebp-8h]

  v11[0] = -98;
  result = (char *)(*(_DWORD *)(a1 + 4) - 7);
  switch ( *(_DWORD *)(a1 + 4) )
  {
    case 7:
      v4 = *(_BYTE *)(a1 + 8);
      v11[1] = 3;
      v11[2] = v4;
      goto LABEL_11;
    case 9:
      v11[1] = 2;
      goto LABEL_10;
    case 0x16:
      v11[1] = 5;
LABEL_10:
      v11[2] = *(_BYTE *)(a1 + 8);
      goto LABEL_11;
    case 0x18:
      v5 = *(_BYTE *)(a1 + 8);
      v11[1] = 4;
      v11[2] = v5;
      goto LABEL_11;
    case 0x23:
      result = *(char **)(a1 + 48);
      if ( *(char **)(a1 + 16) != result )
      {
        v10 = *(_DWORD **)(a1 + 48);
        v11[1] = 6;
        *(_WORD *)&v11[3] = sub_578AC0(v10);
        v8 = sub_578AC0(*(_DWORD **)(a1 + 16));
        v9 = *(_BYTE *)(a1 + 8);
        *(_WORD *)&v11[5] = v8;
        v11[2] = v9;
        sub_4E5390(255, (int)v11, 7, 0, 1);
        sub_4174B0(*(_DWORD *)(a1 + 16), 2);
        result = sub_4174B0(*(_DWORD *)(a1 + 48), 2);
      }
      return result;
    case 0x2B:
      for ( i = *(_DWORD *)(a1 + 108); i; i = *(_DWORD *)(i + 116) )
        result = (char *)sub_4FF130(i);
      return result;
    case 0x3B:
      v2 = *(_DWORD *)(a1 + 16);
      v11[1] = 1;
      v11[2] = *(_BYTE *)(v2 + 124);
LABEL_11:
      result = *(char **)(a1 + 48);
      if ( result )
      {
        v6 = sub_578AC0(*(_DWORD **)(a1 + 48));
        v7 = *(_DWORD **)(a1 + 16);
        *(_WORD *)&v11[5] = v6;
        *(_WORD *)&v11[3] = sub_578AC0(v7);
        sub_4E5390(255, (int)v11, 7, 0, 1);
        sub_4174B0(*(_DWORD *)(a1 + 16), 2);
        result = sub_4174B0(*(_DWORD *)(a1 + 48), 2);
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (004FF2D0) --------------------------------------------------------
int __cdecl sub_4FF2D0(int a1, int a2)
{
  int result; // eax
  int v3; // ecx

  result = sub_4FE930();
  if ( !result )
    return 0;
  while ( 1 )
  {
    if ( !(*(_BYTE *)(result + 88) & 1) && *(_DWORD *)(result + 4) == a1 )
    {
      v3 = *(_DWORD *)(result + 48);
      if ( v3 )
      {
        if ( v3 == a2 )
          break;
      }
    }
    result = sub_4FE940(result);
    if ( !result )
      return 0;
  }
  return result;
}

//----- (004FF310) --------------------------------------------------------
void __cdecl sub_4FF310(int a1)
{
  int *v1; // esi
  int *v2; // edi

  v1 = *(int **)&byte_5D4594[1569728];
  if ( *(_DWORD *)&byte_5D4594[1569728] )
  {
    do
    {
      v2 = (int *)v1[29];
      if ( v1[4] == a1 )
      {
        if ( sub_424A70(v1[1]) & 0x20 )
          sub_4FE9D0((int)v1);
      }
      v1 = v2;
    }
    while ( v2 );
  }
}

//----- (004FF350) --------------------------------------------------------
BOOL __cdecl sub_4FF350(int a1, char a2)
{
  BOOL result; // eax

  result = a1;
  if ( a1 )
    result = ((1 << a2) & *(_DWORD *)(a1 + 340)) != 0;
  return result;
}

//----- (004FF380) --------------------------------------------------------
__int16 __cdecl sub_4FF380(int a1, int a2, __int16 a3, char a4)
{
  int v4; // eax
  int v5; // eax
  int v6; // eax

  LOWORD(v4) = *(_WORD *)&byte_5D4594[1569740];
  if ( !*(_DWORD *)&byte_5D4594[1569740] )
  {
    *(_DWORD *)&byte_5D4594[1569740] = sub_4E3AA0((CHAR *)&byte_587000[217808]);
    v4 = sub_4E3AA0((CHAR *)&byte_587000[217816]);
    *(_DWORD *)&byte_5D4594[1569744] = v4;
  }
  if ( a1 )
  {
    LOWORD(v4) = *(_WORD *)(a1 + 4);
    if ( (unsigned __int16)v4 != *(_DWORD *)&byte_5D4594[1569740] || a2 != 29 )
    {
      if ( sub_40A5C0(4096) && *(unsigned __int16 *)(a1 + 4) == *(_DWORD *)&byte_5D4594[1569740] && a2 == 3 )
      {
        LOWORD(v4) = (unsigned int)sub_501960(582, a1, 0, 0);
      }
      else
      {
        v4 = sub_40A5C0(4096);
        if ( v4
          && (LOWORD(v4) = *(_WORD *)&byte_5D4594[1569744],
              *(unsigned __int16 *)(a1 + 4) == *(_DWORD *)&byte_5D4594[1569744])
          && a2 == 3 )
        {
          LOWORD(v4) = (unsigned int)sub_501960(595, a1, 0, 0);
        }
        else if ( *(_BYTE *)(a1 + 8) & 2
               && (v4 = *(_DWORD *)(a1 + 12), BYTE1(v4) & 0x10)
               && a2 == 11
               && (v4 = sub_40A5C0(2048)) == 0 )
        {
          LOWORD(v4) = *(_WORD *)(a1 + 4);
          if ( (unsigned __int16)v4 == *(_DWORD *)&byte_5D4594[1569740] )
          {
            LOWORD(v4) = (unsigned int)sub_501960(582, a1, 0, 0);
          }
          else if ( v4 == *(_DWORD *)&byte_5D4594[1569744] )
          {
            LOWORD(v4) = (unsigned int)sub_501960(595, a1, 0, 0);
          }
        }
        else if ( !(*(_DWORD *)(a1 + 16) & 0x8022) )
        {
          if ( !sub_4FF350(a1, a2) || (v4 = sub_4FF550(a1, a2)) != 0 )
          {
            if ( a2 )
              sub_4FF5B0(a1, 0);
            *(_WORD *)(a1 + 2 * a2 + 344) = a3;
            *(_BYTE *)(a1 + a2 + 408) = a4;
            sub_4E48F0(a1, (1 << a2) | *(_DWORD *)(a1 + 340));
            v5 = sub_424920(a2);
            v6 = sub_424800(v5, 1);
            LOWORD(v4) = (unsigned int)sub_501960(v6, a1, 0, 0);
          }
        }
      }
    }
  }
  return v4;
}

//----- (004FF550) --------------------------------------------------------
int __cdecl sub_4FF550(int a1, int a2)
{
  return *(unsigned __int16 *)(a1 + 2 * a2 + 344);
}

//----- (004FF570) --------------------------------------------------------
char __cdecl sub_4FF570(int a1, int a2)
{
  return *(_BYTE *)(a1 + a2 + 408);
}

//----- (004FF580) --------------------------------------------------------
int __cdecl sub_4FF580(int a1)
{
  int result; // eax
  _WORD *v2; // ecx

  sub_4E48F0(a1, 0);
  result = 0;
  v2 = (_WORD *)(a1 + 344);
  do
  {
    *v2 = 0;
    *(_BYTE *)(a1 + result++ + 408) = 0;
    ++v2;
  }
  while ( result < 32 );
  return result;
}

//----- (004FF5B0) --------------------------------------------------------
int __cdecl sub_4FF5B0(int a1, int a2)
{
  int result; // eax
  int v3; // ecx
  int v4; // eax
  int v5; // eax

  result = 1 << a2;
  v3 = *(_DWORD *)(a1 + 340);
  if ( v3 & (1 << a2) )
  {
    sub_4E48F0(a1, v3 & ~result);
    result = 0;
    *(_WORD *)(a1 + 2 * a2 + 344) = 0;
    *(_BYTE *)(a1 + a2 + 408) = 0;
    if ( a2 != 16 && a2 != 30 )
    {
      v4 = sub_424920(a2);
      v5 = sub_424800(v4, 2);
      result = sub_501960(v5, a1, 0, 0);
    }
  }
  return result;
}

//----- (004FF620) --------------------------------------------------------
void __cdecl sub_4FF620(int a1)
{
  int v1; // edi
  unsigned __int16 v2; // ax
  __int16 v3; // ax
  int v4; // eax

  if ( *(_DWORD *)(a1 + 340) )
  {
    v1 = 0;
    do
    {
      if ( (1 << v1) & *(_DWORD *)(a1 + 340) )
      {
        if ( v1 == 16
          && (unsigned int)*(unsigned __int16 *)(a1 + 376) % *(_DWORD *)&byte_5D4594[2649704] == *(_DWORD *)&byte_5D4594[2649704]
                                                                                               - 1 )
        {
          sub_501960(26, a1, 0, 0);
        }
        v2 = *(_WORD *)(a1 + 2 * v1 + 344);
        if ( v2 > 0u )
        {
          v3 = v2 - 1;
          *(_WORD *)(a1 + 2 * v1 + 344) = v3;
          if ( !v3 )
          {
            if ( v1 == 7 )
            {
              v4 = *(_DWORD *)(a1 + 16);
              LOBYTE(v4) = v4 & 0xBF;
              *(_DWORD *)(a1 + 16) = v4;
            }
            else if ( v1 == 16 )
            {
              *(_DWORD *)(a1 + 520) = 0;
              *(_DWORD *)(a1 + 524) = 13;
              sub_4EE5E0(a1, 9999999);
              sub_501960(779, a1, 0, 0);
              if ( *(_BYTE *)(a1 + 8) & 4 )
              {
                sub_4D8D40(a1);
                sub_4D8EF0(a1);
              }
            }
            sub_4FF5B0(a1, v1);
            *(_BYTE *)(v1 + a1 + 408) = 0;
          }
        }
      }
      ++v1;
    }
    while ( v1 < 32 );
    if ( sub_4FF350(a1, 9) )
      *(float *)(a1 + 544) = *(float *)(a1 + 544) * 1.25;
  }
}

//----- (004FF730) --------------------------------------------------------
BOOL sub_4FF730()
{
  *(_DWORD *)&byte_5D4594[1569756] = 0;
  *(_DWORD *)&byte_5D4594[1569748] = sub_413FE0(
                                       (const char *)&byte_587000[217868],
                                       32,
                                       (*(_DWORD *)&byte_587000[217844] << 6) + 32);
  return *(_DWORD *)&byte_5D4594[1569748] != 0;
}

//----- (004FF770) --------------------------------------------------------
int sub_4FF770()
{
  int result; // eax

  sub_414100(*(LPVOID *)&byte_5D4594[1569748]);
  result = 0;
  *(_DWORD *)&byte_5D4594[1569748] = 0;
  *(_DWORD *)&byte_5D4594[1569752] = 0;
  *(_DWORD *)&byte_5D4594[1569756] = 0;
  return result;
}

//----- (004FF790) --------------------------------------------------------
void sub_4FF790()
{
  sub_4144D0(*(_DWORD **)&byte_5D4594[1569748]);
  *(_DWORD *)&byte_5D4594[1569752] = 0;
}

//----- (004FF7B0) --------------------------------------------------------
void __cdecl sub_4FF7B0(int a1)
{
  char v1; // cl
  int v2; // edi
  _DWORD *v3; // esi
  char *v4; // eax
  int v6; // [esp-14h] [ebp-28h]
  char v7[6]; // [esp+Ch] [ebp-8h]

  v1 = *(_BYTE *)(a1 + 2064);
  v2 = 1 << v1;
  if ( v1 != 31 )
  {
    v3 = *(_DWORD **)&byte_5D4594[1569752];
    if ( *(_DWORD *)&byte_5D4594[1569752] )
    {
      do
      {
        if ( *(_BYTE *)(a1 + 3680) & 0x10 )
        {
          if ( !(v2 & v3[4]) )
          {
            v4 = (char *)v3[2];
            v7[0] = 61;
            v7[1] = v4[1];
            v7[2] = *v4;
            v7[3] = v4[2];
            v7[4] = v4[5];
            v6 = *(unsigned __int8 *)(a1 + 2064);
            v7[5] = v4[6];
            sub_4E5420(v6, v7, 6, 0, 1);
            v3[4] = v2 | v3[4];
          }
        }
        v3 = (_DWORD *)v3[6];
      }
      while ( v3 );
    }
  }
}

//----- (004FF840) --------------------------------------------------------
int __cdecl sub_4FF840(int a1)
{
  int result; // eax
  int v2; // esi

  result = *(_DWORD *)&byte_5D4594[1569752];
  if ( *(_DWORD *)&byte_5D4594[1569752] )
  {
    do
    {
      v2 = *(_DWORD *)(result + 24);
      if ( *(_DWORD *)(result + 8) == a1 )
        sub_4FF870(result);
      result = v2;
    }
    while ( v2 );
  }
  return result;
}

//----- (004FF870) --------------------------------------------------------
void __cdecl sub_4FF870(int a1)
{
  _BYTE *v1; // eax
  int v2; // eax
  int v3; // eax

  sub_4FF900(a1);
  if ( sub_40A5C0(1) )
  {
    v1 = *(_BYTE **)(a1 + 8);
    if ( *(_DWORD *)a1 )
    {
      v1[1] = *(_BYTE *)(a1 + 12);
      **(_BYTE **)(a1 + 8) = *(_BYTE *)(a1 + 13);
      *(_BYTE *)(*(_DWORD *)(a1 + 8) + 2) = *(_BYTE *)(a1 + 14);
    }
    else
    {
      sub_410430((unsigned __int8)v1[5], (unsigned __int8)v1[6]);
    }
  }
  v2 = *(_DWORD *)(a1 + 28);
  if ( v2 )
    *(_DWORD *)(v2 + 24) = *(_DWORD *)(a1 + 24);
  else
    *(_DWORD *)&byte_5D4594[1569752] = *(_DWORD *)(a1 + 24);
  v3 = *(_DWORD *)(a1 + 24);
  if ( v3 )
    *(_DWORD *)(v3 + 28) = *(_DWORD *)(a1 + 28);
  sub_414330(*(unsigned int **)&byte_5D4594[1569748], (_QWORD *)a1);
}

//----- (004FF900) --------------------------------------------------------
int __cdecl sub_4FF900(int a1)
{
  int v1; // esi
  unsigned int i; // edi
  int result; // eax
  char v4; // cl
  char v5; // dl
  int v6; // eax
  int v7; // eax
  char v8[6]; // [esp+8h] [ebp-8h]

  v1 = a1;
  for ( i = 0; i < 0x20; ++i )
  {
    result = 1 << i;
    if ( (1 << i) & *(_DWORD *)(v1 + 16) )
    {
      if ( *(_DWORD *)v1 )
      {
        v4 = *(_BYTE *)(v1 + 12);
        v5 = *(_BYTE *)(v1 + 13);
        v8[3] = *(_BYTE *)(v1 + 14);
        v6 = *(_DWORD *)(v1 + 8);
        v8[0] = 61;
        v8[1] = v4;
        v8[2] = v5;
        v8[4] = *(_BYTE *)(v6 + 5);
        v8[5] = *(_BYTE *)(v6 + 6);
        result = sub_4E5420(i, v8, 6, 0, 1);
      }
      else
      {
        v7 = *(_DWORD *)(v1 + 8);
        LOBYTE(a1) = 62;
        *(_WORD *)((char *)&a1 + 1) = *(_WORD *)(v7 + 5);
        result = sub_4E5420(i, &a1, 3, 0, 1);
      }
    }
  }
  return result;
}

//----- (004FF990) --------------------------------------------------------
int __cdecl sub_4FF990(int a1)
{
  int result; // eax

  for ( result = *(_DWORD *)&byte_5D4594[1569752]; result; result = *(_DWORD *)(result + 24) )
    *(_DWORD *)(result + 16) &= ~a1;
  return result;
}

//----- (004FF9B0) --------------------------------------------------------
char __cdecl sub_4FF9B0(int a1, int a2, int a3, int a4, int a5)
{
  char result; // al

  result = sub_4FFA40(a1);
  switch ( a1 )
  {
    case 1:
      if ( a5 != a3 )
        result = sub_4FFA40(7);
      break;
    case 7:
      if ( a5 != a3 )
        result = sub_4FFA40(1);
      break;
    case 3:
      if ( a4 != a2 )
        result = sub_4FFA40(5);
      break;
    default:
      if ( a1 == 5 && a4 != a2 )
        result = sub_4FFA40(3);
      break;
  }
  return result;
}

//----- (004FFA40) --------------------------------------------------------
char __cdecl sub_4FFA40(int a1)
{
  char result; // al

  switch ( a1 )
  {
    case 1:
      result = 7;
      break;
    case 2:
    case 6:
      result = 1;
      break;
    case 3:
      result = 8;
      break;
    case 5:
      result = 10;
      break;
    case 7:
      result = 9;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (004FFA90) --------------------------------------------------------
int __cdecl sub_4FFA90(int a1)
{
  int v1; // edi
  int v2; // eax
  float v3; // edx
  float v4; // ecx
  float v5; // edx
  int v6; // edi
  int v7; // edi
  int v9; // eax
  int v10; // esi
  int v11; // ebx
  int v13; // ebp
  int v14; // ebx
  int v15; // ebp
  int v16; // [esp+4h] [ebp-28h]
  unsigned __int8 v17; // [esp+8h] [ebp-24h]
  unsigned __int8 v18; // [esp+8h] [ebp-24h]
  unsigned __int8 v19; // [esp+8h] [ebp-24h]
  int i; // [esp+Ch] [ebp-20h]
  int j; // [esp+Ch] [ebp-20h]
  int v22; // [esp+10h] [ebp-1Ch]
  float2 v23; // [esp+14h] [ebp-18h]
  float4 a1a; // [esp+1Ch] [ebp-10h]

  v1 = a1;
  v22 = 60 * *(_DWORD *)&byte_5D4594[2649704] * (*(_DWORD *)(a1 + 8) + 5);
  v2 = *(_DWORD *)(a1 + 16);
  if ( !v2 || *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  v3 = *(float *)(a1 + 32);
  a1a.field_0 = *(float *)(a1 + 28);
  v4 = *(float *)(a1 + 52);
  a1a.field_4 = v3;
  v5 = *(float *)(a1 + 56);
  a1a.field_8 = v4;
  a1a.field_C = v5;
  if ( !(unsigned __int8)sub_5374B0(&a1a) )
  {
    v6 = *(_DWORD *)(v1 + 16);
    if ( *(_BYTE *)(v6 + 8) & 4 )
    {
      v7 = *(_DWORD *)(v6 + 748);
      a1 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v7 + 276) + 2064), 0, &a1);
    }
    return 1;
  }
  v23.field_0 = a1a.field_8 - a1a.field_0;
  v23.field_4 = a1a.field_C - a1a.field_4;
  v9 = sub_509ED0(&v23);
  v10 = sub_509EA0(v9);
  v11 = (__int64)*(float *)(v1 + 52) / 23;
  v13 = (__int64)*(float *)(v1 + 56) / 23;
  if ( (((_BYTE)v11 + (_BYTE)v13) & 1) == 1 )
    ++v11;
  v16 = v11;
  a1 = (__int64)*(float *)(v1 + 56) / 23;
  v17 = sub_4FFA40(v10);
  if ( sub_4FFD00(v1, v11, v13, v17) )
  {
    for ( i = 0; i < *(int *)&byte_587000[4 * *(_DWORD *)(v1 + 8) + 217844]; ++i )
    {
      v11 = (unsigned __int8)sub_4FFEF0(v10, v16, v11, 0);
      v13 = (unsigned __int8)sub_4FFFB0(v10, a1, v13, 0);
      v18 = sub_4FF9B0(v10, v16, a1, v11, v13);
      if ( !sub_4FFD00(v1, v11, v13, v18) )
        break;
    }
    v14 = v16;
    v15 = a1;
    for ( j = 0; j < *(int *)&byte_587000[4 * *(_DWORD *)(v1 + 8) + 217844]; ++j )
    {
      v14 = (unsigned __int8)sub_4FFEF0(v10, v16, v14, 1);
      v15 = (unsigned __int8)sub_4FFFB0(v10, a1, v15, 1);
      v19 = sub_4FF9B0(v10, v16, a1, v14, v15);
      if ( !sub_4FFD00(v1, v14, v15, v19) )
        break;
    }
  }
  *(_DWORD *)(v1 + 68) = v22 + *(_DWORD *)&byte_5D4594[2598000];
  return 0;
}

//----- (004FFD00) --------------------------------------------------------
BOOL __cdecl sub_4FFD00(int a1, int a2, int a3, unsigned __int8 a4)
{
  int v4; // ebx
  int v5; // eax
  unsigned __int8 *v6; // esi
  char v7; // al
  unsigned __int8 *v9; // eax
  int v10; // [esp-4h] [ebp-20h]
  char v11; // [esp+10h] [ebp-Ch]
  char v12; // [esp+14h] [ebp-8h]
  char v13; // [esp+18h] [ebp-4h]

  v4 = 0;
  v13 = 0;
  v12 = 0;
  v11 = 0;
  if ( !byte_5D4594[1570004] )
  {
    byte_5D4594[1570004] = sub_410D60((const char *)&byte_587000[217880]);
    byte_5D4594[1570005] = sub_410D60((const char *)&byte_587000[217904]);
    byte_5D4594[1570006] = sub_410D60((const char *)&byte_587000[217924]);
  }
  v5 = sub_410580(a2, a3);
  v6 = (unsigned __int8 *)v5;
  if ( v5 )
  {
    v7 = *(_BYTE *)(v5 + 1);
    if ( v7 == byte_5D4594[1570004] )
      return 0;
    if ( v7 != byte_5D4594[1570005] && v7 != byte_5D4594[1570006] )
    {
      if ( v6[4] & 0x1C )
        return 0;
      v13 = v6[1];
      v4 = 1;
      v12 = *v6;
      v11 = v6[2];
      *v6 = sub_42A6C0(*v6, a4);
      goto LABEL_11;
    }
  }
  else
  {
    v9 = (unsigned __int8 *)sub_410250(a2, a3);
    v6 = v9;
    if ( v9 )
    {
      v9[1] = byte_5D4594[1570004];
      *v9 = a4;
      if ( !a4 || a4 == 1 )
      {
        v9[2] = v9[5] % (__int16)sub_410E00(byte_5D4594[1570004]);
        goto LABEL_12;
      }
LABEL_11:
      v6[2] = 0;
      if ( v4 )
      {
LABEL_13:
        sub_4FFE80(a1, v6, v4, v13, v12, v11);
        return v4 == 0;
      }
LABEL_12:
      v10 = v6[1];
      v6[4] |= 8u;
      v6[7] = sub_410E20(v10);
      goto LABEL_13;
    }
  }
  return 0;
}

//----- (004FFE80) --------------------------------------------------------
_DWORD *__cdecl sub_4FFE80(int a1, _BYTE *a2, int a3, char a4, char a5, char a6)
{
  _DWORD *result; // eax

  result = sub_4142F0(*(_DWORD **)&byte_5D4594[1569748]);
  if ( result )
  {
    result[2] = a2;
    *result = a3;
    *((_BYTE *)result + 4) = *a2;
    *((_BYTE *)result + 12) = a4;
    *((_BYTE *)result + 13) = a5;
    *((_BYTE *)result + 14) = a6;
    result[5] = a1;
    result[4] = 0;
    result[7] = 0;
    result[6] = *(_DWORD *)&byte_5D4594[1569752];
    if ( *(_DWORD *)&byte_5D4594[1569752] )
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1569752] + 28) = result;
    *(_DWORD *)&byte_5D4594[1569752] = result;
  }
  return result;
}

//----- (004FFEF0) --------------------------------------------------------
char __cdecl sub_4FFEF0(int a1, int a2, int a3, char a4)
{
  char result; // al
  char v5; // al

  if ( !a4 )
  {
    switch ( a1 )
    {
      case 0:
        goto LABEL_3;
      case 1:
        goto LABEL_4;
      case 2:
        goto LABEL_5;
      case 3:
        goto LABEL_12;
      case 5:
        goto LABEL_10;
      case 6:
        goto LABEL_9;
      case 7:
        goto LABEL_8;
      case 8:
        goto LABEL_7;
      default:
        goto LABEL_14;
    }
  }
  switch ( a1 )
  {
    case 0:
LABEL_7:
      result = a3 - 1;
      break;
    case 1:
LABEL_8:
      result = a3 - 1;
      break;
    case 2:
LABEL_9:
      result = a3 - 1;
      break;
    case 3:
LABEL_12:
      v5 = a3;
      if ( a3 != a2 )
        goto LABEL_11;
      goto LABEL_13;
    case 5:
LABEL_10:
      v5 = a3;
      if ( a3 == a2 )
LABEL_11:
        result = v5 - 1;
      else
LABEL_13:
        result = v5 + 1;
      break;
    case 6:
LABEL_5:
      result = a3 + 1;
      break;
    case 7:
LABEL_4:
      result = a3 + 1;
      break;
    case 8:
LABEL_3:
      result = a3 + 1;
      break;
    default:
LABEL_14:
      result = a3;
      break;
  }
  return result;
}

//----- (004FFFB0) --------------------------------------------------------
char __cdecl sub_4FFFB0(int a1, int a2, int a3, char a4)
{
  char v4; // al
  char result; // al

  if ( !a4 )
  {
    switch ( a1 )
    {
      case 0:
        goto LABEL_3;
      case 1:
        goto LABEL_7;
      case 2:
        goto LABEL_13;
      case 3:
        goto LABEL_10;
      case 5:
        goto LABEL_14;
      case 6:
        goto LABEL_9;
      case 7:
        goto LABEL_11;
      case 8:
        goto LABEL_6;
      default:
        goto LABEL_15;
    }
  }
  switch ( a1 )
  {
    case 0:
LABEL_6:
      result = a3 + 1;
      break;
    case 1:
LABEL_7:
      v4 = a3;
      if ( a3 != a2 )
        goto LABEL_12;
      result = a3 - 1;
      break;
    case 2:
LABEL_9:
      result = a3 - 1;
      break;
    case 3:
LABEL_14:
      result = a3 + 1;
      break;
    case 5:
LABEL_10:
      result = a3 - 1;
      break;
    case 6:
LABEL_13:
      result = a3 + 1;
      break;
    case 7:
LABEL_11:
      v4 = a3;
      if ( a3 != a2 )
        goto LABEL_4;
LABEL_12:
      result = v4 + 1;
      break;
    case 8:
LABEL_3:
      v4 = a3;
LABEL_4:
      result = v4 - 1;
      break;
    default:
LABEL_15:
      result = a3;
      break;
  }
  return result;
}

//----- (00500070) --------------------------------------------------------
int sub_500070()
{
  return 0;
}

//----- (00500080) --------------------------------------------------------
int __cdecl sub_500080(int a1)
{
  int result; // eax
  int v2; // esi

  result = *(_DWORD *)&byte_5D4594[1569752];
  if ( *(_DWORD *)&byte_5D4594[1569752] )
  {
    do
    {
      v2 = *(_DWORD *)(result + 24);
      if ( *(_DWORD *)(result + 20) == a1 )
        sub_4FF870(result);
      result = v2;
    }
    while ( v2 );
  }
  return result;
}

//----- (005000B0) --------------------------------------------------------
int __cdecl sub_5000B0(_DWORD *a1)
{
  int v1; // eax
  int v2; // esi
  int v4; // esi
  int v5; // [esp+0h] [ebp-2Ch]
  int v6; // [esp+4h] [ebp-28h]
  int v7; // [esp+8h] [ebp-24h]
  int v8; // [esp+Ch] [ebp-20h]
  int v9; // [esp+10h] [ebp-1Ch]
  int v10; // [esp+14h] [ebp-18h]
  int v11; // [esp+18h] [ebp-14h]
  int v12; // [esp+1Ch] [ebp-10h]
  int v13; // [esp+20h] [ebp-Ch]
  int v14; // [esp+24h] [ebp-8h]
  int v15; // [esp+28h] [ebp-4h]

  v6 = 1;
  sub_426AC0(&v6, 2u);
  if ( (__int16)v6 > 1 || (__int16)v6 <= 0 )
    return 0;
  v1 = *(_DWORD *)&byte_5D4594[1569752];
  for ( LOBYTE(v5) = 0; v1; v1 = *(_DWORD *)(v1 + 24) )
    LOBYTE(v5) = v5 + 1;
  sub_426AC0(&v5, 1u);
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    if ( (_BYTE)v5 )
    {
      sub_5002D0(a1);
      v4 = 0;
      *(_DWORD *)&byte_5D4594[1569756] = 0;
      if ( (_BYTE)v5 )
      {
        do
        {
          sub_426AC0(&v13, 4u);
          sub_426AC0(&v15, 1u);
          sub_426AC0(&v14, 1u);
          sub_426AC0(&v12, 1u);
          sub_426AC0(&v11, 1u);
          sub_426AC0(&v10, 1u);
          sub_426AC0(&v9, 1u);
          sub_426AC0(&v8, 1u);
          sub_426AC0(&v7, 1u);
          sub_426AC0(&a1, 1u);
          sub_500330(v15, v14, v13, v12, v11, v10, v9, v8, v7, (char)a1);
          ++v4;
        }
        while ( v4 < (unsigned __int8)v5 );
      }
    }
    return 1;
  }
  v2 = *(_DWORD *)&byte_5D4594[1569752];
  if ( !*(_DWORD *)&byte_5D4594[1569752] )
    return 1;
  do
  {
    sub_426AC0((_BYTE *)v2, 4u);
    sub_426AC0((_BYTE *)(*(_DWORD *)(v2 + 8) + 5), 1u);
    sub_426AC0((_BYTE *)(*(_DWORD *)(v2 + 8) + 6), 1u);
    sub_426AC0((_BYTE *)(v2 + 12), 1u);
    sub_426AC0((_BYTE *)(v2 + 13), 1u);
    sub_426AC0((_BYTE *)(v2 + 14), 1u);
    sub_426AC0((_BYTE *)(*(_DWORD *)(v2 + 8) + 1), 1u);
    sub_426AC0((_BYTE *)(*(_DWORD *)(v2 + 8) + 2), 1u);
    sub_426AC0(*(_BYTE **)(v2 + 8), 1u);
    sub_426AC0((_BYTE *)(*(_DWORD *)(v2 + 8) + 7), 1u);
    v2 = *(_DWORD *)(v2 + 24);
  }
  while ( v2 );
  return 1;
}

//----- (005002D0) --------------------------------------------------------
int __cdecl sub_5002D0(_DWORD *a1)
{
  int v1; // ecx
  int v3[3]; // [esp+0h] [ebp-Ch]

  v3[0] = (int)a1;
  v1 = a1[187];
  *(float *)&v3[1] = (double)*(int *)(*(_DWORD *)(v1 + 276) + 2284);
  *(float *)&v3[2] = (double)*(int *)(*(_DWORD *)(v1 + 276) + 2288);
  return sub_4FEBA0(132, (int)a1, a1, (int)a1, v3, 3, 0, 0, 0, 0);
}

//----- (00500330) --------------------------------------------------------
void __cdecl sub_500330(char a1, char a2, int a3, char a4, char a5, char a6, char a7, char a8, char a9, char a10)
{
  int v11; // ecx
  int result;

  if ( *(int *)&byte_5D4594[1569756] < 15 )
  {
    result = 16 * *(_DWORD *)&byte_5D4594[1569756];
    v11 = *(_DWORD *)&byte_5D4594[1569756] + 1;
    byte_5D4594[result + 1569764] = a1;
    byte_5D4594[result + 1569765] = a2;
    *(_DWORD *)&byte_5D4594[result + 1569768] = a3;
    byte_5D4594[result + 1569772] = a4;
    byte_5D4594[result + 1569773] = a5;
    byte_5D4594[result + 1569774] = a6;
    byte_5D4594[result + 1569775] = a7;
    byte_5D4594[result + 1569776] = a8;
    byte_5D4594[result + 1569777] = a9;
    byte_5D4594[result + 1569778] = a10;
    *(_DWORD *)&byte_5D4594[1569756] = v11;
  }
}

//----- (005003B0) --------------------------------------------------------
int __cdecl sub_5003B0(int a1)
{
  int v1; // edi
  int result; // eax
  int v3; // ebp
  unsigned __int8 *v4; // esi
  _BYTE *v5; // eax

  if ( *(int *)&byte_5D4594[1569756] <= 0 )
  {
    v1 = a1;
  }
  else
  {
    v1 = sub_4FE930();
    if ( !v1 )
      return 0;
    while ( *(_DWORD *)(v1 + 4) != 132 || *(_DWORD *)(v1 + 16) != a1 || *(_BYTE *)(v1 + 88) & 1 )
    {
      result = sub_4FE940(v1);
      v1 = result;
      if ( !result )
        return result;
    }
    if ( !v1 )
      return 0;
    *(_DWORD *)(v1 + 92) = sub_4FFA90;
    *(_DWORD *)(v1 + 96) = sub_500070;
    *(_DWORD *)(v1 + 100) = sub_500080;
    *(_DWORD *)(v1 + 48) = 0;
  }
  v3 = 0;
  if ( *(_DWORD *)&byte_5D4594[1569756] > 0 )
  {
    v4 = &byte_5D4594[1569764];
    do
    {
      v5 = (_BYTE *)sub_410580(*v4, v4[1]);
      if ( v5 )
      {
        *v5 = v4[13];
      }
      else
      {
        v5 = sub_410250(*v4, v4[1]);
        if ( !v5 )
          return 0;
        v5[4] |= 8u;
        v5[1] = v4[11];
        v5[2] = v4[12];
        *v5 = v4[13];
        v5[7] = v4[14];
      }
      sub_4FFE80(v1, v5, *((_DWORD *)v4 + 1), v4[8], v4[9], v4[10]);
      ++v3;
      v4 += 16;
    }
    while ( v3 < *(int *)&byte_5D4594[1569756] );
  }
  *(_DWORD *)&byte_5D4594[1569756] = 0;
  return 1;
}

//----- (005004D0) --------------------------------------------------------
int sub_5004D0()
{
  int result; // eax

  for ( result = *(_DWORD *)&byte_5D4594[1569752]; result; result = *(_DWORD *)(result + 24) )
  {
    if ( *(_DWORD *)result == 1 )
      **(_BYTE **)(result + 8) = *(_BYTE *)(result + 13);
  }
  return result;
}

//----- (005004F0) --------------------------------------------------------
int sub_5004F0()
{
  int result; // eax

  for ( result = *(_DWORD *)&byte_5D4594[1569752]; result; result = *(_DWORD *)(result + 24) )
  {
    if ( *(_DWORD *)result == 1 )
      **(_BYTE **)(result + 8) = *(_BYTE *)(result + 4);
  }
  return result;
}

//----- (00500510) --------------------------------------------------------
void __cdecl sub_500510(const char *a1)
{
  if ( a1 )
    strcpy((char *)&byte_5D4594[1570008], a1);
}

//----- (00500540) --------------------------------------------------------
char *__cdecl sub_500540(char *a1, int a2)
{
  char *result; // eax
  char *v3; // edx

  result = sub_5005E0(a1);
  if ( result )
  {
    *((_DWORD *)result + 34) = a2;
  }
  else
  {
    result = (char *)nox_malloc(0x94u);
    v3 = result;
    if ( result )
    {
      strcpy(result, (const char *)&byte_5D4594[1570140]);
      *((_DWORD *)result + 33) = 0;
      *((_DWORD *)result + 34) = a2;
      *((_DWORD *)result + 36) = 0;
      *((_DWORD *)result + 35) = *(_DWORD *)&byte_5D4594[1570272];
      result = *(char **)&byte_5D4594[1570272];
      if ( *(_DWORD *)&byte_5D4594[1570272] )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1570272] + 144) = v3;
      *(_DWORD *)&byte_5D4594[1570272] = v3;
    }
  }
  return result;
}

//----- (005005E0) --------------------------------------------------------
char *__cdecl sub_5005E0(char *a1)
{
  unsigned int v1; // edx
  unsigned __int8 *v2; // edi
  unsigned __int8 *v3; // edi
  char *v4; // esi
  char v5; // cl
  unsigned int v6; // ecx
  char v7; // al
  int i; // esi

  if ( strchr(a1, 58) )
  {
    v6 = strlen(a1) + 1;
    v7 = v6;
    v6 >>= 2;
    qmemcpy(&byte_5D4594[1570140], a1, 4 * v6);
    v4 = &a1[4 * v6];
    v3 = &byte_5D4594[4 * v6 + 1570140];
    v5 = v7;
  }
  else
  {
    strcpy((char *)&byte_5D4594[1570140], (const char *)&byte_5D4594[1570008]);
    *(_WORD *)&byte_5D4594[strlen((const char *)&byte_5D4594[1570140]) + 1570140] = *(_WORD *)&byte_587000[217952];
    v1 = strlen(a1) + 1;
    v2 = &byte_5D4594[strlen((const char *)&byte_5D4594[1570140]) + 1570140];
    qmemcpy(v2, a1, 4 * (v1 >> 2));
    v4 = &a1[4 * (v1 >> 2)];
    v3 = &v2[4 * (v1 >> 2)];
    v5 = v1;
  }
  qmemcpy(v3, v4, v5 & 3);
  for ( i = *(_DWORD *)&byte_5D4594[1570272]; i; i = *(_DWORD *)(i + 140) )
  {
    if ( !_strcmpi((const char *)i, (const char *)&byte_5D4594[1570140]) )
      break;
  }
  return (char *)i;
}

//----- (005006B0) --------------------------------------------------------
char *__cdecl sub_5006B0(char *a1, int a2)
{
  char *result; // eax
  char *v3; // edx

  result = sub_5005E0(a1);
  if ( result )
  {
    *((_DWORD *)result + 34) = a2;
  }
  else
  {
    result = (char *)nox_malloc(0x94u);
    v3 = result;
    if ( result )
    {
      strcpy(result, (const char *)&byte_5D4594[1570140]);
      *((_DWORD *)result + 33) = 1;
      *((_DWORD *)result + 34) = a2;
      *((_DWORD *)result + 36) = 0;
      *((_DWORD *)result + 35) = *(_DWORD *)&byte_5D4594[1570272];
      result = *(char **)&byte_5D4594[1570272];
      if ( *(_DWORD *)&byte_5D4594[1570272] )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1570272] + 144) = v3;
      *(_DWORD *)&byte_5D4594[1570272] = v3;
    }
  }
  return result;
}

//----- (00500750) --------------------------------------------------------
int __cdecl sub_500750(char *a1)
{
  char *v1; // eax
  int result; // eax

  v1 = sub_5005E0(a1);
  if ( v1 )
    result = *((_DWORD *)v1 + 34);
  else
    result = 0;
  return result;
}

//----- (00500770) --------------------------------------------------------
double __cdecl sub_500770(char *a1)
{
  char *v1; // eax
  double result; // st7

  v1 = sub_5005E0(a1);
  if ( v1 )
    result = *((float *)v1 + 34);
  else
    result = 0.0;
  return result;
}

//----- (00500790) --------------------------------------------------------
void __cdecl sub_500790(LPVOID lpMem)
{
  int v1; // ecx
  int v2; // ecx

  v1 = *((_DWORD *)lpMem + 36);
  if ( v1 )
    *(_DWORD *)(v1 + 140) = *((_DWORD *)lpMem + 35);
  v2 = *((_DWORD *)lpMem + 35);
  if ( v2 )
    *(_DWORD *)(v2 + 144) = *((_DWORD *)lpMem + 36);
  if ( lpMem == *(LPVOID *)&byte_5D4594[1570272] )
    *(_DWORD *)&byte_5D4594[1570272] = *((_DWORD *)lpMem + 35);
  free(lpMem);
}

//----- (005007E0) --------------------------------------------------------
char *__cdecl sub_5007E0(char *a1)
{
  unsigned __int8 *v1; // edx
  char *result; // eax
  unsigned int v3; // kr04_4
  char *v4; // esi
  int v5; // esi
  int v6; // edi
  int v7; // esi
  int v8; // ebx
  const char *v9; // edi
  char *v10; // edx
  const char *v11; // ebx
  int v12; // esi
  unsigned int v13; // kr0C_4
  int v14; // edi
  int v15; // ebp
  unsigned int v16; // kr10_4
  int v17; // [esp+18h] [ebp+4h]

  sub_5009B0(a1);
  v1 = (unsigned __int8 *)strchr((const char *)&byte_5D4594[1570140], 42);
  if ( v1 )
  {
    v3 = strlen((const char *)&byte_5D4594[1570140]) + 1;
    result = 0;
    if ( !strcmp((const char *)&byte_5D4594[1570140], (const char *)&byte_587000[217956]) )
    {
      result = *(char **)&byte_5D4594[1570272];
      if ( *(_DWORD *)&byte_5D4594[1570272] )
      {
        do
        {
          v4 = (char *)*((_DWORD *)result + 35);
          sub_500790(result);
          result = v4;
        }
        while ( v4 );
      }
    }
    else if ( v1 == &byte_5D4594[v3 + 1570138] )
    {
      v5 = *(_DWORD *)&byte_5D4594[1570272];
      if ( *(_DWORD *)&byte_5D4594[1570272] )
      {
        do
        {
          v6 = *(_DWORD *)(v5 + 140);
          result = (char *)_strnicmp((const char *)v5, (const char *)&byte_5D4594[1570140], v3 - 2);
          if ( !result )
            sub_500790((LPVOID)v5);
          v5 = v6;
        }
        while ( v6 );
      }
    }
    else if ( v1 == &byte_5D4594[1570140] )
    {
      v7 = *(_DWORD *)&byte_5D4594[1570272];
      if ( *(_DWORD *)&byte_5D4594[1570272] )
      {
        do
        {
          v8 = *(_DWORD *)(v7 + 140);
          result = strstr((const char *)v7, (const char *)&byte_5D4594[1570141]);
          if ( result )
          {
            v9 = result;
            result = 0;
            if ( v3 - 2 == strlen(v9) )
              sub_500790((LPVOID)v7);
          }
          v7 = v8;
        }
        while ( v8 );
      }
    }
    else
    {
      v10 = strchr((const char *)&byte_5D4594[1570140], 58);
      result = 0;
      v11 = v10 + 2;
      v12 = *(_DWORD *)&byte_5D4594[1570272];
      v13 = strlen(v10 + 2) + 1;
      if ( *(_DWORD *)&byte_5D4594[1570272] )
      {
        v14 = v10 - (char *)&byte_5D4594[1570140];
        v17 = v10 - (char *)&byte_5D4594[1570140];
        do
        {
          v15 = *(_DWORD *)(v12 + 140);
          result = (char *)_strnicmp((const char *)v12, (const char *)&byte_5D4594[1570140], v14 + 1);
          if ( !result )
          {
            result = strstr((const char *)(v14 + v12 + 2), v11);
            if ( result )
            {
              v16 = strlen(result) + 1;
              result = (char *)(v13 - 1);
              if ( v13 - 1 == v16 - 1 )
                sub_500790((LPVOID)v12);
              v14 = v17;
            }
          }
          v12 = v15;
        }
        while ( v15 );
      }
    }
  }
  else
  {
    result = sub_5005E0(a1);
    if ( result )
      sub_500790(result);
  }
  return result;
}

//----- (005009B0) --------------------------------------------------------
unsigned int __cdecl sub_5009B0(char *a1)
{
  unsigned int v1; // ecx
  char v2; // al
  unsigned __int8 *v3; // edi
  unsigned __int8 *v4; // esi
  unsigned int result; // eax

  if ( strchr(a1, 58) )
  {
    result = strlen(a1) + 1;
    qmemcpy(&byte_5D4594[1570140], a1, result);
  }
  else
  {
    v1 = strlen((const char *)&byte_5D4594[1570008]) + 1;
    v2 = v1;
    v1 >>= 2;
    qmemcpy(&byte_5D4594[1570140], &byte_5D4594[1570008], 4 * v1);
    v4 = &byte_5D4594[4 * v1 + 1570008];
    v3 = &byte_5D4594[4 * v1 + 1570140];
    LOBYTE(v1) = v2;
    result = 0;
    qmemcpy(v3, v4, v1 & 3);
    *(_WORD *)&byte_5D4594[strlen((const char *)&byte_5D4594[1570140]) + 1570140] = *(_WORD *)&byte_587000[217960];
    strcat((char *)&byte_5D4594[1570140], a1);
  }
  return result;
}

//----- (00500A60) --------------------------------------------------------
int sub_500A60()
{
  int result; // eax
  int v1; // eax
  int j; // esi
  int v3; // edi
  int i; // [esp+0h] [ebp-Ch]
  int v5; // [esp+4h] [ebp-8h]
  int v6; // [esp+8h] [ebp-4h]

  v5 = 1;
  sub_426AC0(&v5, 2u);
  if ( (__int16)v5 > 1 )
    return 0;
  v1 = *(_DWORD *)&byte_5D4594[1570272];
  for ( i = 0; v1; ++i )
    v1 = *(_DWORD *)(v1 + 140);
  if ( sub_40A5C0(2048) )
  {
    sub_426AC0(&i, 4u);
    for ( j = *(_DWORD *)&byte_5D4594[1570272]; j; j = *(_DWORD *)(j + 140) )
    {
      LOBYTE(v6) = strlen((const char *)j);
      sub_426AC0(&v6, 1u);
      sub_426AC0((_BYTE *)j, (unsigned __int8)v6);
      sub_426AC0((_BYTE *)(j + 132), 4u);
      v3 = *(_DWORD *)(j + 132);
      if ( v3 )
      {
        if ( v3 == 1 )
          sub_426AC0((_BYTE *)(j + 136), 4u);
      }
      else
      {
        sub_426AC0((_BYTE *)(j + 136), 4u);
      }
    }
    result = 1;
  }
  else
  {
    i = 0;
    sub_426AC0(&i, 4u);
    result = 1;
  }
  return result;
}

//----- (00500B70) --------------------------------------------------------
int sub_500B70()
{
  unsigned int i; // esi
  int v2; // [esp+0h] [ebp-118h]
  int v3; // [esp+4h] [ebp-114h]
  unsigned int v4; // [esp+8h] [ebp-110h]
  int v5; // [esp+Ch] [ebp-10Ch]
  int v6; // [esp+10h] [ebp-108h]
  int v7; // [esp+14h] [ebp-104h]
  char v8[256]; // [esp+18h] [ebp-100h]

  sub_5007E0((char *)&byte_587000[217964]);
  v3 = 1;
  sub_426AC0(&v3, 2u);
  if ( (__int16)v3 > 1 )
    return 0;
  sub_426AC0(&v4, 4u);
  for ( i = 0; i < v4; ++i )
  {
    sub_426AC0(&v2, 1u);
    sub_426AC0(v8, (unsigned __int8)v2);
    v8[(unsigned __int8)v2] = 0;
    sub_426AC0(&v5, 4u);
    if ( v5 )
    {
      if ( v5 == 1 )
      {
        sub_426AC0(&v7, 4u);
        sub_5006B0(v8, v7);
      }
    }
    else
    {
      sub_426AC0(&v6, 4u);
      sub_500540(v8, v6);
    }
  }
  return 1;
}
// 500B70: using guessed type char var_100[256];

//----- (00500C70) --------------------------------------------------------
int __cdecl sub_500C70(int a1, int a2)
{
  *((_DWORD *)sub_417090(a1) + 912) = a2;
  return sub_4D7EE0(a1, a2);
}

//----- (00500CA0) --------------------------------------------------------
int __cdecl sub_500CA0(int a1, int a2)
{
  int result; // eax

  if ( a2 && *(_BYTE *)(a2 + 8) & 4 )
    result = *(_DWORD *)&byte_587000[4 * a1 + 217668];
  else
    result = 0;
  return result;
}

//----- (00500CC0) --------------------------------------------------------
int __cdecl sub_500CC0(int a1, int a2)
{
  int v2; // eax
  int result; // eax

  if ( (*(_BYTE *)(a2 + 8) & 2 && (v2 = *(_DWORD *)(a2 + 16), (v2 & 0x8000) == 0) || sub_534A40(a2))
    && (*(_BYTE *)(*(_DWORD *)(a2 + 748) + 1440) & 0x80) )
  {
    result = sub_4EC4F0(a2, a1);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00500D10) --------------------------------------------------------
int __cdecl sub_500D10(int a1)
{
  int v1; // esi
  int i; // edi

  v1 = *(_DWORD *)(a1 + 516);
  for ( i = 0; v1; v1 = *(_DWORD *)(v1 + 512) )
  {
    if ( sub_500CC0(a1, v1) )
      i += sub_500D50(v1);
  }
  return i;
}

//----- (00500D50) --------------------------------------------------------
int __cdecl sub_500D50(int a1)
{
  int v1; // eax
  int v3; // eax

  v1 = *(_DWORD *)(a1 + 12);
  if ( v1 & 1 )
    return 1;
  v3 = -((v1 & 2) != 0);
  LOBYTE(v3) = v3 & 0xFE;
  return v3 + 4;
}

//----- (00500D70) --------------------------------------------------------
bool __cdecl sub_500D70(int a1, int a2)
{
  int v2; // ebx

  v2 = sub_427460(a2);
  return sub_500D10(a1) + v2 <= 4;
}

//----- (00500DA0) --------------------------------------------------------
int __cdecl sub_500DA0(int a1)
{
  int v1; // eax
  int v2; // edi
  int v3; // ebp
  BYTE v5; // eax
  char *v6; // eax
  int v7; // eax
  int v8; // edx
  int v9; // eax
  int v10; // eax
  double v11; // st7
  int v12; // eax
  int v13; // ecx
  char v14; // al
  float v15; // [esp+0h] [ebp-20h]
  __int16 v16; // [esp+0h] [ebp-20h]
  unsigned __int8 v17[16]; // [esp+10h] [ebp-10h]

  v1 = *(_DWORD *)(a1 + 16);
  v2 = *(_DWORD *)(a1 + 4) - 74;
  if ( !v1 || *(_DWORD *)(v1 + 16) & 0x8020 || *(_DWORD *)(a1 + 20) )
    return 1;
  if ( *(_BYTE *)(v1 + 8) & 4 )
  {
    v3 = *(_DWORD *)(v1 + 748);
    if ( sub_40A5C0(4608) && !*(_DWORD *)(*(_DWORD *)(v3 + 276) + 4 * v2 + 4244) )
    {
      sub_4DA2C0(*(_DWORD *)(a1 + 16), (const char *)&byte_587000[218128], 0);
      return 1;
    }
    v5 = sub_500D70(*(_DWORD *)(a1 + 16), v2);
    if ( !v5 )
    {
      sub_4DA2C0(*(_DWORD *)(a1 + 16), (const char *)&byte_587000[218156], 0);
      return 1;
    }
  }
  if ( !sub_500F40(a1, COERCE_FLOAT(&v17[2])) )
    return 1;
  v17[10] = *(_BYTE *)(*(_DWORD *)(a1 + 16) + 124);
  v6 = sub_427230(v2);
  *(_WORD *)v17 = sub_4E3AA0(v6);
  *(_WORD *)&v17[11] = (*(_WORD *)&byte_5D4594[1570276])++;
  if ( *(_WORD *)&byte_5D4594[1570276] >= 0xFDE8u )
    *(_WORD *)&byte_5D4594[1570276] = 0;
  v7 = *(_DWORD *)&v17[4];
  v17[13] = 0;
  *(_DWORD *)(a1 + 72) = *(_DWORD *)v17;
  v8 = *(_DWORD *)&v17[8];
  *(_DWORD *)(a1 + 76) = v7;
  LOWORD(v7) = *(_WORD *)&v17[12];
  *(_DWORD *)(a1 + 80) = v8;
  *(_WORD *)(a1 + 84) = v7;
  v9 = sub_427460(v2) - 1;
  if ( v9 )
  {
    v10 = v9 - 1;
    if ( v10 )
    {
      if ( v10 != 2 )
      {
        v12 = a1;
        goto LABEL_22;
      }
      v11 = sub_419D70(&byte_587000[218220], 2);
    }
    else
    {
      v11 = sub_419D70(&byte_587000[218204], 1);
    }
  }
  else
  {
    v11 = sub_419D70(&byte_587000[218188], 0);
  }
  v15 = v11;
  v12 = sub_419A70(v15);
LABEL_22:
  v13 = v12 + *(_DWORD *)&byte_5D4594[2598000];
  v16 = v12;
  v14 = v17[10];
  *(_DWORD *)(a1 + 68) = v13;
  sub_5236F0(*(__int16 *)&v17[11], (float *)&v17[2], v14, *(__int16 *)v17, v16);
  return 0;
}
// 500E24: variable 'v5' is possibly undefined

//----- (00500F40) --------------------------------------------------------
int __cdecl sub_500F40(int a1, float a2)
{
  _DWORD *v2; // esi
  int v3; // eax
  float v4; // edi
  float v5; // edx
  float v6; // ecx
  double v7; // st7
  double v8; // st6
  long double v9; // st6
  float v10; // edx
  int result; // eax
  int v12; // esi
  int v13; // esi
  float v14; // edx
  float v15; // eax
  float v16; // ecx
  int v17; // eax
  int v18; // edx
  float4 v19; // [esp+8h] [ebp-10h]

  v2 = (_DWORD *)a1;
  if ( *(float *)&a1 == 0.0 )
    return 0;
  v3 = *(_DWORD *)(a1 + 16);
  if ( !v3 )
    return 0;
  v4 = a2;
  if ( a2 == 0.0 )
    return 0;
  if ( *(_BYTE *)(v3 + 8) & 4 )
  {
    v19.field_0 = *(float *)(v3 + 56);
    v5 = *(float *)(v3 + 60);
    v6 = *(float *)(a1 + 56);
    v19.field_8 = *(float *)(a1 + 52);
    v19.field_C = v6;
    v7 = v19.field_8 - v19.field_0;
    v19.field_4 = v5;
    v8 = v6 - v5;
    *(float *)&a1 = v8;
    v9 = sqrt(v8 * *(float *)&a1 + v7 * v7);
    a2 = v9;
    if ( v9 > 50.0 )
    {
      v19.field_8 = v7 * 50.0 / a2 + v19.field_0;
      v19.field_C = *(float *)&a1 * 50.0 / a2 + v19.field_4;
    }
    if ( sub_535250(&v19, 0, 0, 9) && !sub_411A90((float2 *)&v19.field_8) )
    {
      v10 = v19.field_C;
      *(_DWORD *)LODWORD(v4) = LODWORD(v19.field_8);
      *(float *)(LODWORD(v4) + 4) = v10;
      return 1;
    }
    v12 = v2[4];
    if ( *(_BYTE *)(v12 + 8) & 4 )
    {
      v13 = *(_DWORD *)(v12 + 748);
      a1 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v13 + 276) + 2064), 0, &a1);
    }
    return 0;
  }
  v19.field_0 = *(float *)(v3 + 56);
  v14 = *(float *)(v3 + 60);
  v15 = *(float *)(a1 + 52);
  v16 = *(float *)(a1 + 56);
  v19.field_4 = v14;
  v19.field_8 = v15;
  v19.field_C = v16;
  if ( sub_535250(&v19, 0, 0, 9) )
  {
    *(_DWORD *)LODWORD(v4) = v2[13];
    *(_DWORD *)(LODWORD(v4) + 4) = v2[14];
    result = 1;
  }
  else
  {
    v17 = v2[4];
    *(_DWORD *)LODWORD(v4) = *(_DWORD *)(v17 + 56);
    v18 = *(_DWORD *)(v17 + 60);
    result = 1;
    *(_DWORD *)(LODWORD(v4) + 4) = v18;
  }
  return result;
}

//----- (005010D0) --------------------------------------------------------
int __cdecl sub_5010D0(int a1)
{
  int v1; // eax
  int v2; // edi
  int v3; // ebx
  int result; // eax
  BYTE v5; // eax
  _DWORD *v6; // eax

  v1 = *(_DWORD *)(a1 + 16);
  if ( !v1 || *(_DWORD *)(v1 + 16) & 0x8020 )
    return 1;
  if ( *(_DWORD *)(a1 + 68) - 1 != *(_DWORD *)&byte_5D4594[2598000] )
    return 0;
  v2 = *(_DWORD *)(a1 + 4) - 74;
  if ( !(*(_BYTE *)(v1 + 8) & 4) )
    goto LABEL_17;
  v3 = *(_DWORD *)(v1 + 748);
  if ( sub_40A5C0(512) && !*(_DWORD *)(*(_DWORD *)(v3 + 276) + 4 * v2 + 4244) )
  {
    sub_4DA2C0(*(_DWORD *)(a1 + 16), (const char *)&byte_587000[218236], 0);
    return 1;
  }
  v5 = sub_500D70(*(_DWORD *)(a1 + 16), v2);
  if ( v5 )
  {
LABEL_17:
    v6 = sub_5016C0(*(unsigned __int16 *)(a1 + 72), (int *)(a1 + 74), *(_DWORD *)(a1 + 16), *(_BYTE *)(a1 + 82));
    if ( v6 )
      sub_501960(899, (int)v6, 0, 0);
    *(_BYTE *)(a1 + 85) = 1;
    result = 1;
  }
  else
  {
    sub_4DA2C0(*(_DWORD *)(a1 + 16), (const char *)&byte_587000[218264], 0);
    result = 1;
  }
  return result;
}
// 50115B: variable 'v5' is possibly undefined

//----- (005011C0) --------------------------------------------------------
void __cdecl sub_5011C0(int a1)
{
  if ( !*(_BYTE *)(a1 + 85) )
  {
    sub_523760(*(_WORD *)(a1 + 83));
    sub_501A30(900, (float2 *)(a1 + 74), 0, 0);
  }
}

//----- (005011F0) --------------------------------------------------------
int __cdecl sub_5011F0(int *a1)
{
  __int16 v1; // ax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  double v9; // st7
  int *v10; // eax
  int v11; // edx
  int v12; // [esp-14h] [ebp-1Ch]
  int v13; // [esp-8h] [ebp-10h]
  float v14; // [esp+0h] [ebp-8h]
  int v15; // [esp+0h] [ebp-8h]
  float v16; // [esp+0h] [ebp-8h]

  if ( a1[5] )
  {
    v14 = sub_419D40(&byte_587000[218296]);
    v1 = sub_419A70(v14);
    sub_4FF380(a1[12], 3, v1, a1[2]);
    sub_4E7540(a1[4], a1[12]);
    return 1;
  }
  v15 = a1[4];
  v3 = sub_424A70(a1[1]);
  v4 = sub_540610((float2 *)(a1 + 13), a1[4], v3, 300.0, 0, v15);
  a1[12] = v4;
  if ( !v4 )
  {
    sub_4DA2C0(a1[4], (const char *)&byte_587000[218320], 0);
    sub_501960(16, a1[4], 0, 0);
    return 1;
  }
  if ( *(_BYTE *)(v4 + 8) & 2 && !sub_500CC0(a1[4], v4) )
  {
    v5 = sub_4272B0(*(unsigned __int16 *)(a1[12] + 4));
    v6 = a1[4];
    if ( *(_BYTE *)(v6 + 8) & 4 )
    {
      if ( !v5 )
      {
        sub_4DA2C0(v6, (const char *)&byte_587000[218356], 0);
        v12 = a1[4];
        a1[12] = 0;
        sub_501960(16, v12, 0, 0);
        return 1;
      }
      if ( !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v6 + 748) + 276) + 4 * v5 + 4244) )
      {
        a1[12] = 0;
        sub_4DA2C0(v6, (const char *)&byte_587000[218388], 0);
        sub_501960(16, a1[4], 0, 0);
        return 1;
      }
    }
    v7 = sub_427460(v5) - 1;
    if ( v7 )
    {
      v8 = v7 - 1;
      if ( v8 )
      {
        if ( v8 != 2 )
        {
          v10 = a1;
          goto LABEL_20;
        }
        v9 = sub_419D70(&byte_587000[218456], a1[2] - 1);
      }
      else
      {
        v9 = sub_419D70(&byte_587000[218436], a1[2] - 1);
      }
    }
    else
    {
      v9 = sub_419D70(&byte_587000[218416], a1[2] - 1);
    }
    v16 = v9;
    v10 = (int *)sub_419A70(v16);
LABEL_20:
    v11 = a1[12];
    a1[17] = (int)v10 + *(_DWORD *)&byte_5D4594[2598000];
    sub_4FF380(v11, 28, (_WORD)v10 + 1, 5);
    sub_4FF130((int)a1);
    return 0;
  }
  v13 = a1[4];
  a1[12] = 0;
  sub_501960(16, v13, 0, 0);
  return 1;
}

//----- (005013E0) --------------------------------------------------------
int __cdecl sub_5013E0(int *a1)
{
  int v1; // eax
  int v2; // eax
  int v4; // eax
  int v5; // ecx
  int v6; // eax
  BYTE v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // edi
  int v11; // eax
  int v12; // ebp
  unsigned __int16 v13; // ax
  int v14; // edi
  unsigned __int16 v15; // di
  int v16; // eax
  int v17; // edi
  int v18; // eax
  int v19; // edx
  int v20; // eax
  int v21; // ecx
  int v22; // eax
  int v23; // [esp-10h] [ebp-14h]

  v1 = a1[12];
  if ( !v1 || *(_DWORD *)(v1 + 16) & 0x8020 )
    goto LABEL_6;
  if ( sub_4E6C00(a1[4], a1[12]) > 300.0 )
  {
    v2 = a1[4];
    if ( *(_BYTE *)(v2 + 8) & 4 )
      sub_4DA2C0(v2, (const char *)&byte_587000[218476], 0);
LABEL_6:
    sub_501960(16, a1[4], 0, 0);
    return 1;
  }
  if ( a1[17] - 1 != *(_DWORD *)&byte_5D4594[2598000] )
    return 0;
  v4 = a1[12];
  v5 = *(_DWORD *)(v4 + 12);
  if ( v5 & 0x2000 )
  {
    sub_4DA2C0(a1[4], (const char *)&byte_587000[218508], 0);
LABEL_13:
    sub_501960(16, a1[4], 0, 0);
    return 1;
  }
  if ( *(_BYTE *)(a1[4] + 8) & 4 )
  {
    v6 = sub_4272B0(*(unsigned __int16 *)(v4 + 4));
    v7 = sub_500D70(a1[4], v6);
    if ( !v7 )
    {
      sub_4DA2C0(a1[4], (const char *)&byte_587000[218544], 0);
      goto LABEL_13;
    }
  }
  sub_4FF5B0(a1[12], 28);
  v8 = sub_4EC580(a1[12]);
  v9 = a1[4];
  if ( v8 == v9 )
  {
    if ( *(_BYTE *)(v9 + 8) & 4 )
      sub_4DA2C0(v9, (const char *)&byte_587000[218576], 0);
    goto LABEL_6;
  }
  sub_4EC300(a1[12]);
  sub_4EC290(a1[4], a1[12]);
  if ( sub_419130(a1[12] + 48) )
    sub_419570(a1[12] + 48, *(_DWORD *)(a1[12] + 36));
  v10 = *(_DWORD *)(a1[12] + 748);
  v11 = *(_DWORD *)(v10 + 1440);
  LOBYTE(v11) = v11 | 0x80;
  *(_DWORD *)(v10 + 1440) = v11;
  if ( sub_40A5C0(4096) )
  {
    v12 = sub_4E3B70(*(unsigned __int16 *)(a1[12] + 4));
    v13 = sub_4EE780(a1[12]);
    v14 = *(_DWORD *)(v10 + 484);
    v15 = v14 ? *(_WORD *)(v14 + 72) : *(_WORD *)(*(_DWORD *)(v12 + 136) + 4);
    *(_WORD *)(*(_DWORD *)(a1[12] + 556) + 4) = v15;
    if ( v13 > v15 )
      sub_4E4560(a1[12], v15);
  }
  v16 = a1[4];
  if ( *(_BYTE *)(v16 + 8) & 4 )
  {
    v17 = *(_DWORD *)(v16 + 748);
    sub_533900(v16, a1[12], *(_DWORD *)(*(_DWORD *)(v17 + 276) + 3648));
    v18 = a1[12];
    v19 = *(_DWORD *)(v18 + 12);
    LOBYTE(v19) = v19 | 0x80;
    *(_DWORD *)(v18 + 12) = v19;
    v20 = a1[12];
    v21 = *(_DWORD *)(v20 + 12);
    BYTE1(v21) |= 1u;
    *(_DWORD *)(v20 + 12) = v21;
    sub_4D91A0(*(unsigned __int8 *)(*(_DWORD *)(v17 + 276) + 2064), a1[12]);
    sub_417190(*(unsigned __int8 *)(*(_DWORD *)(v17 + 276) + 2064), a1[12], 1);
    sub_4DF360(*(unsigned __int8 *)(*(_DWORD *)(v17 + 276) + 2064), a1[12]);
    if ( sub_40A5C0(4096) )
      sub_50E140(a1[12]);
  }
  else
  {
    sub_533900(v16, a1[12], 4);
  }
  v23 = a1[4];
  v22 = sub_424800(a1[1], 1);
  sub_501960(v22, v23, 0, 0);
  return 1;
}
// 50148A: variable 'v7' is possibly undefined

//----- (00501690) --------------------------------------------------------
int __cdecl sub_501690(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 48);
  if ( result )
  {
    if ( !(*(_DWORD *)(result + 16) & 0x8020) )
    {
      sub_4FF5B0(result, 5);
      result = sub_4FF5B0(*(_DWORD *)(a1 + 48), 28);
    }
  }
  return result;
}

//----- (005016C0) --------------------------------------------------------
_DWORD *__cdecl sub_5016C0(int a1, int *a2, int a3, unsigned __int8 a4)
{
  _DWORD *result; // eax
  _DWORD *v5; // esi
  int v6; // ebp
  int v7; // ecx
  int v8; // ebx
  int v9; // eax

  result = sub_4E3450(a1);
  v5 = result;
  if ( !result )
    return result;
  sub_4DAA50((int)result, a3, *(float *)a2, *((float *)a2 + 1));
  v6 = v5[187];
  *((_WORD *)v5 + 63) = a4;
  *((_WORD *)v5 + 62) = a4;
  v7 = *(_DWORD *)(v6 + 1440);
  LOBYTE(v7) = v7 | 0x80;
  *(_DWORD *)(v6 + 1440) = v7;
  if ( !a3 )
    return v5;
  if ( !(*(_BYTE *)(a3 + 8) & 4) )
  {
    sub_533900(a3, (int)v5, 4);
    *(_DWORD *)(v6 + 1360) = 38;
    return v5;
  }
  v8 = *(_DWORD *)(a3 + 748);
  sub_533900(a3, (int)v5, *(_DWORD *)(*(_DWORD *)(v8 + 276) + 3648));
  *(_DWORD *)(v6 + 1360) = 38;
  v5[3] |= 0x80u;
  sub_4D91A0(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (int)v5);
  sub_417190(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (int)v5, 1);
  sub_4DF360(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (int)v5);
  if ( sub_419130(a3 + 48) )
    sub_4191D0(*(_BYTE *)(a3 + 52), a3 + 48, 1, v5[9], 0);
  v9 = v5[3];
  BYTE1(v9) |= 1u;
  v5[3] = v9;
  return v5;
}

//----- (005017F0) --------------------------------------------------------
void __cdecl sub_5017F0(int a1)
{
  int v1; // eax
  int v2; // esi

  if ( !*(_DWORD *)&byte_5D4594[1570280] )
    *(_DWORD *)&byte_5D4594[1570280] = sub_4E3AA0((CHAR *)&byte_587000[218608]);
  if ( a1 )
  {
    v1 = *(_DWORD *)(a1 + 504);
    if ( v1 )
    {
      do
      {
        v2 = *(_DWORD *)(v1 + 496);
        if ( *(unsigned __int16 *)(v1 + 4) == *(_DWORD *)&byte_5D4594[1570280] )
          sub_4E5CC0(v1);
        v1 = v2;
      }
      while ( v2 );
    }
    sub_522FF0(129, (float2 *)(a1 + 56));
    sub_4E5CC0(a1);
  }
}

//----- (00501860) --------------------------------------------------------
int sub_501860()
{
  int result; // eax
  unsigned __int8 *v1; // eax

  if ( *(_DWORD *)&byte_5D4594[1599064] )
    return 1;
  *(_DWORD *)&byte_5D4594[1599056] = sub_413FE0((const char *)&byte_587000[218616], 36, 128);
  if ( !*(_DWORD *)&byte_5D4594[1599056] )
    return 0;
  v1 = &byte_5D4594[1570292];
  do
  {
    *((_DWORD *)v1 - 2) = 600;
    *(_DWORD *)v1 = 0;
    *((_DWORD *)v1 + 1) = 0;
    *((_DWORD *)v1 + 2) = 0;
    *((_DWORD *)v1 + 3) = 0;
    *((_DWORD *)v1 + 4) = 0;
    v1 += 28;
  }
  while ( (int)v1 < (int)&byte_5D4594[1598936] );
  result = 1;
  *(_DWORD *)&byte_5D4594[1599064] = 1;
  return result;
}

//----- (005018D0) --------------------------------------------------------
void sub_5018D0()
{
  if ( *(_DWORD *)&byte_5D4594[1599064] )
  {
    sub_414100(*(LPVOID *)&byte_5D4594[1599056]);
    *(_DWORD *)&byte_5D4594[1599060] = 0;
    *(_DWORD *)&byte_5D4594[1599064] = 0;
  }
}

//----- (00501900) --------------------------------------------------------
int __cdecl sub_501900(int a1)
{
  return *(_DWORD *)&byte_5D4594[28 * a1 + 1570288];
}

//----- (00501920) --------------------------------------------------------
int __cdecl sub_501920(int a1)
{
  return *(_DWORD *)&byte_5D4594[28 * a1 + 1570284];
}

//----- (00501940) --------------------------------------------------------
int __cdecl sub_501940(int a1)
{
  return *(_DWORD *)&byte_5D4594[28 * a1 + 1570296];
}

//----- (00501960) --------------------------------------------------------
_DWORD *__cdecl sub_501960(int a1, int a2, int a3, int a4)
{
  _DWORD *result; // eax
  _DWORD *v5; // esi

  result = (_DWORD *)sub_40A5C0(0x80000);
  if ( result != (_DWORD *)1 )
  {
    if ( a2 )
    {
      if ( a1 )
      {
        result = (_DWORD *)sub_501940(a1);
        if ( (int)result > 0 )
        {
          if ( !sub_40A5C0(4096) || !(*(_BYTE *)(a2 + 8) & 4) || (result = (_DWORD *)sub_419E60(a2)) == 0 )
          {
            result = sub_4142F0(*(_DWORD **)&byte_5D4594[1599056]);
            v5 = result;
            if ( result )
            {
              result[1] = a1;
              if ( *(_BYTE *)(a2 + 16) & 0x20 )
                result[4] = 0;
              else
                result[4] = a2;
              result[2] = *(_DWORD *)(a2 + 56);
              result[3] = *(_DWORD *)(a2 + 60);
              result[5] = a3;
              result[6] = a4;
              if ( a3 != 2 )
                sub_50CD40(a1, a2, (_DWORD *)(a2 + 56));
              result = *(_DWORD **)&byte_5D4594[1599060];
              *v5 = *(_DWORD *)&byte_5D4594[1599060];
              *(_DWORD *)&byte_5D4594[1599060] = v5;
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (00501A30) --------------------------------------------------------
void __cdecl sub_501A30(int a1, float2 *a2, int a3, int a4)
{
  int *v4; // esi

  if ( !sub_40A5C0(0x80000) )
  {
    if ( a1 )
    {
      if ( sub_501940(a1) > 0 )
      {
        v4 = (int *)sub_4142F0(*(_DWORD **)&byte_5D4594[1599056]);
        if ( v4 )
        {
          v4[1] = a1;
          *((float2 *)v4 + 1) = *a2;
          v4[4] = 0;
          v4[5] = a3;
          v4[6] = a4;
          if ( a3 != 2 )
            sub_50CD40(a1, 0, a2);
          *v4 = *(_DWORD *)&byte_5D4594[1599060];
          *(_DWORD *)&byte_5D4594[1599060] = v4;
        }
      }
    }
  }
}

//----- (00501AC0) --------------------------------------------------------
int __cdecl sub_501AC0(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 >= 0 )
  {
    if ( a1 > 100 )
      result = 100;
    *(_DWORD *)&byte_5D4594[1599068] = result;
  }
  else
  {
    result = 0;
    *(_DWORD *)&byte_5D4594[1599068] = 0;
  }
  return result;
}

//----- (00501AE0) --------------------------------------------------------
int sub_501AE0()
{
  return *(_DWORD *)&byte_5D4594[1599068];
}

//----- (00501AF0) --------------------------------------------------------
int __cdecl sub_501AF0(int a1, float *a2, float *a3)
{
  float *v3; // eax
  int v4; // esi
  double v5; // st7
  int v6; // eax
  int v7; // eax
  int v9; // [esp+Ch] [ebp-4h]
  float v10; // [esp+14h] [ebp+4h]
  float v11; // [esp+18h] [ebp+8h]

  v3 = a2;
  v4 = *(_DWORD *)&byte_5D4594[28 * a1 + 1570284];
  v9 = *(_DWORD *)&byte_5D4594[28 * a1 + 1570284];
  v11 = *a2 - *a3;
  v10 = v3[1] - a3[1];
  v5 = (double)v9;
  if ( v11 >= v5 )
    return 0;
  if ( v10 >= v5 )
    return 0;
  if ( v4 <= 0 )
    return 0;
  v6 = sub_419B10(sqrt(v10 * v10 + v11 * v11 + 0.1));
  if ( v6 >= v4 )
    return 0;
  v7 = 100 * (v4 - v6) / v4;
  if ( v7 <= 100 )
  {
    if ( v7 < 0 )
      v7 = 0;
  }
  else
  {
    v7 = 100;
  }
  return v7 <= *(int *)&byte_5D4594[1599068] ? 0 : v7;
}

//----- (00501BB0) --------------------------------------------------------
unsigned int __cdecl sub_501BB0(int a1, float *a2, float *a3)
{
  int v3; // eax
  int v4; // ecx
  unsigned int v6; // eax

  v3 = sub_501AF0(a1, a2, a3);
  v4 = *(_DWORD *)&byte_5D4594[28 * a1 + 1570292];
  if ( !v4 )
    return 0;
  return (v3 * v4) / 100;
}

//----- (00501C00) --------------------------------------------------------
char __cdecl sub_501C00(float *a1, int a2)
{
  char v2; // bl
  int v3; // ecx
  char *v4; // eax
  int v5; // eax
  float v6; // ecx
  struc_19 *v7; // eax
  int2 v9; // [esp+4h] [ebp-8h]

  v2 = 0;
  if ( a2 )
  {
    v3 = *(_DWORD *)(a2 + 8);
    if ( v3 & 4 )
    {
      v2 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 3668);
      goto LABEL_7;
    }
    if ( v3 & 2 )
    {
      v4 = sub_4214A0(**(_DWORD **)(a2 + 748));
      if ( v4 )
      {
        v2 = v4[130];
LABEL_7:
        if ( v2 )
          return v2;
        goto LABEL_8;
      }
    }
  }
LABEL_8:
  v5 = sub_419A70(*a1);
  v6 = a1[1];
  v9.field_0 = v5;
  v9.field_4 = sub_419A70(v6);
  v7 = sub_4217B0(&v9, 0);
  if ( v7 )
    return BYTE2(v7->field_0[32]);
  return v2;
}

//----- (00501CA0) --------------------------------------------------------
int __cdecl sub_501CA0(int a1)
{
  int v1; // ebx
  int v2; // ebp
  int v3; // eax
  int v4; // ecx
  int v5; // ecx
  int v6; // eax
  int v7; // edx
  struc_19 *v8; // eax
  int i; // esi
  int v10; // eax
  char *v11; // eax
  char v12; // al
  int v13; // eax
  int v14; // eax
  char *v16; // [esp+Ch] [ebp-Ch]
  int2 v17; // [esp+10h] [ebp-8h]
  char v18; // [esp+1Ch] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  v16 = 0;
  v3 = *(_DWORD *)(v2 + 276);
  if ( !(*(_BYTE *)(v3 + 3680) & 3) || (v4 = *(_DWORD *)(v3 + 3628)) == 0 )
  {
    if ( *(int *)(v3 + 3664) == -559023410 )
      sub_421C70(a1);
    v5 = *(_DWORD *)(v2 + 276);
    goto LABEL_11;
  }
  if ( *(_BYTE *)(v4 + 8) & 4 )
  {
    v5 = *(_DWORD *)(*(_DWORD *)(v4 + 748) + 276);
LABEL_11:
    v18 = *(_BYTE *)(v5 + 3668);
    goto LABEL_12;
  }
  v6 = sub_419A70(*(float *)(*(_DWORD *)(v3 + 3628) + 56));
  v7 = *(_DWORD *)(v2 + 276);
  v17.field_0 = v6;
  v17.field_4 = sub_419A70(*(float *)(*(_DWORD *)(v7 + 3628) + 60));
  v8 = sub_4217B0(&v17, 0);
  if ( v8 )
    v18 = BYTE2(v8->field_0[32]);
  else
    v18 = 0;
LABEL_12:
  sub_501E80();
  if ( sub_419130(v1 + 48) )
    v16 = sub_418AB0(*(unsigned __int8 *)(v1 + 52));
  for ( i = *(_DWORD *)&byte_5D4594[1599060]; i; i = *(_DWORD *)i )
  {
    v10 = *(_DWORD *)(i + 20);
    if ( v10 == 1 )
    {
      v11 = sub_418AB0(*(_DWORD *)(i + 24));
      if ( v16 && v11 && v16 == v11 )
        goto LABEL_22;
    }
    else if ( v10 != 2 || *(_DWORD *)(v1 + 36) == *(_DWORD *)(i + 24) )
    {
LABEL_22:
      v12 = sub_501C00((float *)(i + 8), *(_DWORD *)(i + 16));
      if ( v12 == v18 || !v12 )
      {
        if ( *(_BYTE *)(v2 + 188) || (v13 = *(_DWORD *)(i + 4), v13 < 186) || v13 > 193 || v1 != *(_DWORD *)(i + 16) )
        {
          v14 = sub_501AF0(*(_DWORD *)(i + 4), (float *)(i + 8), (float *)(*(_DWORD *)(v2 + 276) + 3632)) >> 1;
          if ( v14 > 0 )
          {
            if ( *(_DWORD *)&byte_5D4594[28 * *(_DWORD *)(i + 4) + 1570304] )
              sub_501EA0((_DWORD *)i, v14);
            else
              sub_501FD0(v1, i, v14);
          }
        }
      }
      continue;
    }
  }
  return sub_502060(v1);
}

//----- (00501E80) --------------------------------------------------------
int sub_501E80()
{
  int result; // eax

  result = 0;
  memset(&byte_5D4594[1598928], 0, 0x80u);
  return result;
}

//----- (00501EA0) --------------------------------------------------------
_DWORD *__cdecl sub_501EA0(_DWORD *a1, int a2)
{
  unsigned int v2; // esi

  v2 = a1[1];
  if ( !sub_501EF0(v2) )
  {
    sub_501F10(v2);
    *(_DWORD *)&byte_5D4594[28 * v2 + 1570308] = 0;
  }
  a1[8] = a2;
  return sub_501F30((int)&byte_5D4594[28 * v2 + 1570284], a1);
}

//----- (00501EF0) --------------------------------------------------------
int __cdecl sub_501EF0(unsigned int a1)
{
  return *(_DWORD *)&byte_5D4594[4 * (a1 >> 5) + 1598928] & (1 << (a1 & 0x1F));
}

//----- (00501F10) --------------------------------------------------------
unsigned int __cdecl sub_501F10(unsigned int a1)
{
  unsigned int result; // eax

  result = a1 >> 5;
  *(_DWORD *)&byte_5D4594[4 * (a1 >> 5) + 1598928] |= 1 << (a1 & 0x1F);
  return result;
}

//----- (00501F30) --------------------------------------------------------
_DWORD *__cdecl sub_501F30(int a1, _DWORD *a2)
{
  _DWORD *result; // eax
  _DWORD *v3; // ebp
  int v4; // ebx
  int v5; // esi
  int v6; // edx
  int v7; // ecx
  _DWORD *v8; // [esp+10h] [ebp-4h]

  result = *(_DWORD **)(a1 + 24);
  v3 = *(_DWORD **)(a1 + 24);
  v8 = *(_DWORD **)(a1 + 24);
  if ( result )
  {
    v4 = 1;
    v5 = a2[8];
    do
    {
      v6 = result[8];
      v7 = v5 - v6;
      if ( v5 - v6 < 0 )
        v7 = v6 - v5;
      if ( v7 >= 5 )
      {
        if ( v5 > v6 )
          break;
      }
      else if ( byte_5D4594[28 * a2[1] + 1570300] & 0x10 )
      {
        break;
      }
      if ( ++v4 > *(int *)(a1 + 20) )
        return result;
      v3 = result;
      result = (_DWORD *)result[7];
    }
    while ( result );
    a2[7] = result;
    if ( result == v8 )
      *(_DWORD *)(a1 + 24) = a2;
    else
      v3[7] = a2;
  }
  else
  {
    result = a2;
    a2[7] = v3;
    *(_DWORD *)(a1 + 24) = a2;
  }
  return result;
}

//----- (00501FD0) --------------------------------------------------------
int __cdecl sub_501FD0(int a1, int a2, __int16 a3)
{
  int v3; // esi
  double v4; // st7
  __int16 v5; // dx
  float v7; // [esp+0h] [ebp-Ch]

  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(float *)(a2 + 8);
  v5 = *(_WORD *)(a2 + 4) | (a3 << 10);
  LOBYTE(a1) = (a1 == *(_DWORD *)(a2 + 16)) - 90;
  HIWORD(a1) = v5;
  v7 = v4 - *(float *)(*(_DWORD *)(v3 + 276) + 3632);
  BYTE1(a1) = 50 * sub_419A70(v7) / (*(_DWORD *)&byte_5D4594[3805496] / 2);
  return sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 1, &a1, 4);
}

//----- (00502060) --------------------------------------------------------
int __cdecl sub_502060(int a1)
{
  int *v1; // ecx
  int v2; // ebx
  int result; // eax
  int v4; // edi
  int v5; // esi
  int i; // ebp
  int v7; // edx
  unsigned int v8; // [esp+10h] [ebp-8h]
  unsigned __int8 *v9; // [esp+14h] [ebp-4h]

  v1 = (int *)&byte_5D4594[1598928];
  v2 = 0;
  v9 = &byte_5D4594[1598928];
  do
  {
    result = *v1;
    v8 = *v1;
    if ( *v1 )
    {
      v4 = 0;
      do
      {
        if ( result & 1 )
        {
          v5 = *(_DWORD *)&byte_5D4594[28 * (v2 + v4) + 1570308];
          for ( i = *(_DWORD *)&byte_5D4594[28 * (v2 + v4) + 1570304]; v5; v5 = *(_DWORD *)(v5 + 28) )
          {
            v7 = i--;
            if ( v7 <= 0 )
              break;
            sub_501FD0(a1, v5, *(_DWORD *)(v5 + 32));
          }
        }
        result = v8 >> 1;
        ++v4;
        v8 >>= 1;
      }
      while ( v4 < 32 );
      v1 = (int *)v9;
    }
    ++v1;
    v2 += 32;
    v9 = (unsigned __int8 *)v1;
  }
  while ( (int)v1 < (int)&byte_5D4594[1599056] );
  return result;
}

//----- (00502100) --------------------------------------------------------
void sub_502100()
{
  sub_4144D0(*(_DWORD **)&byte_5D4594[1599056]);
  *(_DWORD *)&byte_5D4594[1599060] = 0;
}

//----- (00502120) --------------------------------------------------------
BOOL __cdecl sub_502120(int a1, void *a2)
{
  int v2; // esi
  int v3; // ebp
  unsigned __int8 *v4; // eax
  int v5; // eax
  char *v6; // ecx
  char v7; // bl
  unsigned __int8 *v8; // ecx
  unsigned __int8 *v9; // ecx
  unsigned __int8 v10; // dl
  int v11; // ecx
  __int16 v12; // dx
  __int16 v13; // dx
  BOOL result; // eax
  int v15; // [esp-4h] [ebp-20h]
  unsigned __int8 v16; // [esp+10h] [ebp-Ch]
  unsigned __int8 v17; // [esp+14h] [ebp-8h]
  unsigned __int8 v18; // [esp+18h] [ebp-4h]
  unsigned __int8 v19; // [esp+20h] [ebp+4h]

  v2 = a1;
  v3 = *(_DWORD *)&byte_5D4594[1599064];
  v4 = *(unsigned __int8 **)(a1 + 8);
  v15 = a1;
  v19 = *v4;
  *(_DWORD *)(v15 + 8) = v4 + 1;
  sub_40ACC0(a2, 1u, v19, v15);
  *((_BYTE *)a2 + v19) = 0;
  v5 = sub_40AF50(a2);
  if ( !v5 )
    v3 = 0;
  while ( 2 )
  {
    v6 = *(char **)(v2 + 8);
    v7 = *v6;
    v8 = (unsigned __int8 *)(v6 + 1);
    *(_DWORD *)(v2 + 8) = v8;
    switch ( v7 )
    {
      case 0:
        result = v7 == 0;
        break;
      case 1:
      case 5:
        *(_DWORD *)(v2 + 8) = v8 + 1;
        continue;
      case 2:
        v16 = *v8;
        *(_DWORD *)(v2 + 8) = v8 + 1;
        if ( v3 )
          *(_DWORD *)&byte_5D4594[28 * v5 + 1570300] = v16;
        continue;
      case 3:
        v18 = *v8;
        *(_DWORD *)(v2 + 8) = v8 + 1;
        if ( v3 )
          *(_DWORD *)&byte_5D4594[28 * v5 + 1570292] = v18;
        continue;
      case 4:
        v17 = *v8;
        *(_DWORD *)(v2 + 8) = v8 + 1;
        if ( v3 )
          *(_DWORD *)&byte_5D4594[28 * v5 + 1570304] = v17;
        continue;
      case 6:
        *(_DWORD *)(v2 + 8) = v8 + 2;
        continue;
      case 7:
        while ( 1 )
        {
          v9 = *(unsigned __int8 **)(v2 + 8);
          v10 = *v9;
          v11 = (int)(v9 + 1);
          *(_DWORD *)(v2 + 8) = v11;
          if ( !v10 )
            break;
          *(_DWORD *)(v2 + 8) = v11 + v10;
          ++*(_DWORD *)&byte_5D4594[28 * v5 + 1570296];
        }
        continue;
      case 8:
        *(_DWORD *)(v2 + 8) = v8 + 8;
        continue;
      case 9:
        v12 = *(_WORD *)v8;
        *(_DWORD *)(v2 + 8) = v8 + 2;
        if ( v3 )
          *(_DWORD *)&byte_5D4594[28 * v5 + 1570284] = 15 * v12;
        continue;
      case 0xA:
        v13 = *(_WORD *)v8;
        *(_DWORD *)(v2 + 8) = v8 + 2;
        if ( v3 )
          *(_DWORD *)&byte_5D4594[28 * v5 + 1570288] = v13;
        continue;
      default:
        result = 0;
        break;
    }
    break;
  }
  return result;
}

//----- (00502320) --------------------------------------------------------
int __cdecl sub_502320(int a1, void *a2)
{
  int v2; // ebx
  int *v3; // eax
  int v4; // edi

  v2 = 0;
  v3 = *(int **)(a1 + 8);
  v4 = *v3;
  *(_DWORD *)(a1 + 8) = v3 + 1;
  if ( v4 <= 0 )
    return 1;
  while ( sub_502370(a1, a2) )
  {
    if ( ++v2 >= v4 )
      return 1;
  }
  return 0;
}

//----- (00502370) --------------------------------------------------------
int __cdecl sub_502370(int a1, void *a2)
{
  char *v2; // eax
  int v3; // edi
  int v4; // eax
  unsigned __int8 *v5; // ecx
  __int16 v6; // bp
  unsigned __int8 v7; // dl
  __int16 v8; // di
  int v9; // ecx
  char *v10; // eax
  char v11; // dl
  int v12; // eax
  char *v14; // eax
  char v15; // cl
  int v16; // eax
  unsigned __int8 v17; // [esp+14h] [ebp+8h]

  v2 = *(char **)(a1 + 8);
  v3 = *v2;
  *(_DWORD *)(a1 + 8) = v2 + 1;
  sub_40ACC0(a2, 1u, v3, a1);
  *((_BYTE *)a2 + v3) = 0;
  v4 = sub_40AF50(a2);
  if ( v4 && *(_DWORD *)&byte_5D4594[1599064] )
  {
    v5 = *(unsigned __int8 **)(a1 + 8);
    v6 = *(_WORD *)v5;
    v5 += 2;
    *(_DWORD *)(a1 + 8) = v5;
    v7 = *v5++;
    *(_DWORD *)(a1 + 8) = v5;
    v8 = *(_WORD *)v5;
    v5 += 2;
    *(_DWORD *)(a1 + 8) = v5;
    v17 = *v5;
    *(_DWORD *)(a1 + 8) = v5 + 1;
    if ( v8 > 0 )
      *(_DWORD *)&byte_5D4594[28 * v4 + 1570284] = 15 * v8;
    v9 = 28 * v4;
    *(_DWORD *)&byte_5D4594[v9 + 1570288] = v6;
    *(_DWORD *)&byte_5D4594[v9 + 1570292] = v7;
    *(_DWORD *)&byte_5D4594[v9 + 1570304] = v17;
    *(_DWORD *)(a1 + 8) += 3;
    while ( 1 )
    {
      v10 = *(char **)(a1 + 8);
      v11 = *v10;
      v12 = (int)(v10 + 1);
      *(_DWORD *)(a1 + 8) = v12;
      if ( !v11 )
        break;
      *(_DWORD *)(a1 + 8) = v12 + v11;
      ++*(_DWORD *)&byte_5D4594[v9 + 1570296];
    }
    *(_DWORD *)&byte_5D4594[v9 + 1570300] = 2;
  }
  else
  {
    for ( *(_DWORD *)(a1 + 8) += 9; ; *(_DWORD *)(a1 + 8) = v16 + v15 )
    {
      v14 = *(char **)(a1 + 8);
      v15 = *v14;
      v16 = (int)(v14 + 1);
      *(_DWORD *)(a1 + 8) = v16;
      if ( !v15 )
        break;
    }
  }
  return 1;
}

//----- (00502490) --------------------------------------------------------
unsigned __int8 *__cdecl sub_502490(int *a1, int a2, int a3)
{
  int v3; // eax
  int v4; // ecx
  unsigned __int8 *result; // eax
  int v6; // edi
  LPVOID *v7; // esi
  int v8; // eax

  *(_DWORD *)&byte_5D4594[1599076] = 0;
  v3 = *a1;
  if ( *a1 & 1 )
    return 0;
  v4 = a1[1];
  if ( v4 == -1 )
    return 0;
  if ( v3 & 2 )
  {
    LOBYTE(v3) = v3 | 1;
    *a1 = v3;
  }
  if ( *(_DWORD *)&byte_5D4594[1599660] )
  {
    sub_5025A0((int)a1, a2, a3);
    result = &byte_5D4594[1599076];
  }
  else
  {
    sub_507310(v4, a2, a3);
    if ( *(_DWORD *)(48 * a1[1] + *(_DWORD *)&byte_5D4594[1599636] + 4) )
      *(_DWORD *)&byte_5D4594[1599076] = script_pop();
    v6 = *(_DWORD *)&byte_5D4594[1599624];
    *(_DWORD *)&byte_5D4594[1599660] = 0;
    if ( *(_DWORD *)&byte_5D4594[1599624] < *(int *)&byte_5D4594[1599632] )
    {
      v7 = (LPVOID *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[1599624] + 3831212];
      do
      {
        free(*v7);
        v8 = *(_DWORD *)&byte_5D4594[1599632];
        *v7 = 0;
        ++v6;
        ++v7;
      }
      while ( v6 < v8 );
      v6 = *(_DWORD *)&byte_5D4594[1599624];
    }
    *(_DWORD *)&byte_5D4594[1599632] = v6;
    sub_5025E0((int)a1, a2, a3);
    if ( *(_DWORD *)&byte_5D4594[1599468] > 0 )
      sub_502490(*(int **)&byte_5D4594[1599084], *(int *)&byte_5D4594[1599088], *(int *)&byte_5D4594[1599092]);
    result = &byte_5D4594[1599076];
  }
  return result;
}

//----- (005025A0) --------------------------------------------------------
void __cdecl sub_5025A0(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // ecx

  if ( *(int *)&byte_5D4594[1599468] < 32 )
  {
    result = 12 * *(_DWORD *)&byte_5D4594[1599468];
    v4 = *(_DWORD *)&byte_5D4594[1599468] + 1;
    *(_DWORD *)&byte_5D4594[result + 1599084] = a1;
    *(_DWORD *)&byte_5D4594[result + 1599088] = a2;
    *(_DWORD *)&byte_5D4594[result + 1599092] = a3;
    *(_DWORD *)&byte_5D4594[1599468] = v4;
  }
}

//----- (005025E0) --------------------------------------------------------
int __cdecl sub_5025E0(int a1, int a2, int a3)
{
  int result; // eax
  int v4; // edi
  int v5; // ecx
  unsigned __int8 *v6; // esi
  unsigned __int8 *v7; // eax
  int v8; // ecx
  int v9; // [esp+4h] [ebp-4h]

  result = *(_DWORD *)&byte_5D4594[1599468];
  if ( *(_DWORD *)&byte_5D4594[1599468] )
  {
    v4 = 0;
    if ( *(_DWORD *)&byte_5D4594[1599468] > 0 )
    {
      v5 = *(_DWORD *)&byte_5D4594[1599468] - 1;
      v9 = *(_DWORD *)&byte_5D4594[1599468] - 1;
      v6 = &byte_5D4594[1599084];
      do
      {
        if ( *(_DWORD *)v6 == a1 && *((_DWORD *)v6 + 1) == a2 && *((_DWORD *)v6 + 2) == a3 )
        {
          if ( (int)v6 < (int)&byte_5D4594[1599468] && v4 < v5 )
          {
            v7 = v6;
            v8 = v5 - v4;
            do
            {
              --v8;
              *(_DWORD *)v7 = *((_DWORD *)v7 + 3);
              *((_DWORD *)v7 + 1) = *((_DWORD *)v7 + 4);
              *((_DWORD *)v7 + 2) = *((_DWORD *)v7 + 5);
              v7 += 12;
            }
            while ( v8 );
            result = *(_DWORD *)&byte_5D4594[1599468];
            v5 = v9;
          }
          --result;
          --v5;
          *(_DWORD *)&byte_5D4594[1599468] = result;
          v9 = v5;
        }
        ++v4;
        v6 += 12;
      }
      while ( v4 < result );
    }
  }
  return result;
}

//----- (00502670) --------------------------------------------------------
void __cdecl sub_502670(unsigned __int8 *a1, int a2, void (__cdecl *a3)(int, int), int a4)
{
  int *i; // esi
  int v5; // eax
  int *j; // esi
  _DWORD *v7; // eax
  int *k; // esi
  int v9; // eax
  int *l; // esi
  unsigned __int8 *v11; // eax

  if ( a1 )
  {
    switch ( *a1 )
    {
      case 0u:
        if ( !a2 )
        {
          for ( i = (int *)*((_DWORD *)a1 + 21); i; i = (int *)i[2] )
          {
            v5 = sub_4ED020(*i);
            if ( v5 )
              a3(v5, a4);
          }
        }
        break;
      case 1u:
        if ( a2 == 1 )
        {
          for ( j = (int *)*((_DWORD *)a1 + 21); j; j = (int *)j[2] )
          {
            v7 = sub_579C40(*j);
            if ( v7 )
              a3((int)v7, a4);
          }
        }
        break;
      case 2u:
        if ( a2 == 2 )
        {
          for ( k = (int *)*((_DWORD *)a1 + 21); k; k = (int *)k[2] )
          {
            v9 = sub_410580(*k, k[1]);
            if ( v9 )
              a3(v9, a4);
          }
          goto LABEL_20;
        }
        break;
      case 3u:
LABEL_20:
        for ( l = (int *)*((_DWORD *)a1 + 21); l; l = (int *)l[2] )
        {
          v11 = (unsigned __int8 *)sub_57C0A0(*l);
          if ( v11 )
            sub_502670(v11, a2, a3, a4);
        }
        break;
      default:
        return;
    }
  }
}

//----- (00502790) --------------------------------------------------------
int __cdecl sub_502790(FILE *a1, char *a2)
{
  int result; // eax
  int i; // ebx
  int v4; // edi
  int v5; // eax
  int v6; // [esp+8h] [ebp-410h]
  int v7; // [esp+Ch] [ebp-40Ch]
  int v8; // [esp+10h] [ebp-408h]
  int v9; // [esp+14h] [ebp-404h]
  char v10[1024]; // [esp+18h] [ebp-400h]

  sub_408E40((char *)&v8, 4, 1, a1);
  sub_408E40(v10, 1, v8, a1);
  sub_408E40(a2, 4, 1, a1);
  sub_408E40((char *)&v7, 4, 1, a1);
  result = v7;
  for ( i = 0; i < v7; ++i )
  {
    sub_408E40((char *)&v6, 1, 1, a1);
    sub_409050(a1, 1, 1);
    v4 = 0;
    v5 = 268 * (unsigned __int8)v6;
    if ( byte_587000[v5 + 218640] )
    {
      do
      {
        switch ( *(_DWORD *)&byte_587000[8 * v4 + 218648 + v5] )
        {
          case 0:
          case 3:
          case 4:
          case 5:
          case 6:
            sub_409050(a1, 4, 1);
            break;
          case 1:
            sub_409050(a1, 8, 1);
            break;
          case 2:
          case 7:
            sub_408E40((char *)&v9, 1, 1, a1);
            sub_409050(a1, (unsigned __int8)v9, 1);
            break;
          default:
            break;
        }
        ++v4;
        v5 = 268 * (unsigned __int8)v6;
      }
      while ( v4 < byte_587000[v5 + 218640] );
    }
    result = v7;
  }
  return result;
}

//----- (005028E0) --------------------------------------------------------
char *sub_5028E0()
{
  char *result; // eax

  *(_DWORD *)&byte_5D4594[1599480] = -1;
  *(_DWORD *)&byte_5D4594[1599572] = -1;
  *(_DWORD *)&byte_5D4594[1599476] = 0;
  *(_DWORD *)&byte_5D4594[1599540] = 0;
  *(_DWORD *)&byte_5D4594[1599544] = 0;
  *(_DWORD *)&byte_5D4594[1599532] = 0;
  *(_DWORD *)&byte_5D4594[1599536] = 0;
  *(_DWORD *)&byte_5D4594[1599556] = 0;
  *(_DWORD *)&byte_5D4594[1599560] = 0;
  *(_DWORD *)&byte_5D4594[1599548] = 0;
  *(_DWORD *)&byte_5D4594[1599552] = 0;
  *(_DWORD *)&byte_5D4594[1599564] = 0;
  *(_DWORD *)&byte_5D4594[1599568] = 0;
  *(_DWORD *)&byte_5D4594[1599484] = 0;
  *(_DWORD *)&byte_5D4594[1599488] = 0;
  *(_DWORD *)&byte_5D4594[1599492] = 0;
  *(_DWORD *)&byte_5D4594[1599496] = 0;
  memset(&byte_5D4594[1599500], 0, 0x20u);
  if ( !*(_DWORD *)&byte_5D4594[1599588] )
    *(_DWORD *)&byte_5D4594[1599588] = nox_malloc(0x800u);
  result = *(char **)&byte_5D4594[1599592];
  if ( !*(_DWORD *)&byte_5D4594[1599592] )
  {
    result = (char *)nox_malloc(0x800u);
    *(_DWORD *)&byte_5D4594[1599592] = result;
  }
  return result;
}

//----- (005029A0) --------------------------------------------------------
int __cdecl sub_5029A0(char *a1)
{
  int v1; // edi
  int i; // esi

  v1 = 0;
  if ( *(int *)&byte_5D4594[1599596] <= 0 )
    return -1;
  for ( i = 0; _strcmpi(a1, (const char *)(i + *(_DWORD *)&byte_5D4594[1599576])); i += 76 )
  {
    if ( ++v1 >= *(int *)&byte_5D4594[1599596] )
      return -1;
  }
  return v1;
}

//----- (005029F0) --------------------------------------------------------
int __cdecl sub_5029F0(int a1)
{
  int result; // eax

  if ( a1 < 0 || a1 > *(int *)&byte_5D4594[1599596] )
    result = 0;
  else
    result = *(_DWORD *)&byte_5D4594[1599576] + 76 * a1;
  return result;
}

//----- (00502A20) --------------------------------------------------------
int sub_502A20()
{
  return *(_DWORD *)&byte_5D4594[1599596];
}

//----- (00502A30) --------------------------------------------------------
BOOL __cdecl sub_502A30(char *a1)
{
  int v1; // eax

  v1 = sub_5029A0(a1);
  return sub_502D70(v1);
}

//----- (00502A50) --------------------------------------------------------
int __cdecl sub_502A50(char *a1)
{
  int result; // eax

  sub_502DF0();
  if ( a1 )
  {
    strncpy(*(char **)&byte_5D4594[1599588], a1, 0x7FFu);
    result = 1;
  }
  else
  {
    **(_BYTE **)&byte_5D4594[1599588] = byte_5D4594[1599608];
    result = 0;
  }
  return result;
}

//----- (00502A90) --------------------------------------------------------
int sub_502A90()
{
  return strlen(*(const char **)&byte_5D4594[1599588]) != 0 ? *(_DWORD *)&byte_5D4594[1599588] : 0;
}

//----- (00502AB0) --------------------------------------------------------
int __cdecl sub_502AB0(char *a1)
{
  int result; // eax

  if ( a1 )
  {
    strncpy(*(char **)&byte_5D4594[1599592], a1, 0x7FFu);
    result = 1;
  }
  else
  {
    **(_BYTE **)&byte_5D4594[1599592] = byte_5D4594[1599612];
    result = 0;
  }
  return result;
}

//----- (00502AF0) --------------------------------------------------------
int sub_502AF0()
{
  return strlen(*(const char **)&byte_5D4594[1599592]) != 0 ? *(_DWORD *)&byte_5D4594[1599592] : 0;
}

//----- (00502B10) --------------------------------------------------------
int sub_502B10()
{
  int result; // eax
  int v1; // ebp
  int v2; // ecx
  int v3; // ebp
  char v4; // [esp+12h] [ebp-56h]
  char v5; // [esp+13h] [ebp-55h]
  int v6; // [esp+14h] [ebp-54h]
  int v7; // [esp+18h] [ebp-50h]
  int v8; // [esp+1Ch] [ebp-4Ch]
  float v9; // [esp+20h] [ebp-48h]
  float v10; // [esp+24h] [ebp-44h]
  char v11[64]; // [esp+28h] [ebp-40h]

  *(_DWORD *)&byte_5D4594[1599596] = 0;
  if ( !*(_DWORD *)&byte_5D4594[1599588] )
    *(_DWORD *)&byte_5D4594[1599588] = nox_malloc(0x800u);
  if ( !*(_DWORD *)&byte_5D4594[1599592] )
    *(_DWORD *)&byte_5D4594[1599592] = nox_malloc(0x800u);
  if ( !*(_DWORD *)&byte_5D4594[1599576] )
    *(_DWORD *)&byte_5D4594[1599576] = nox_malloc(0x26000u);
  result = 0;
  if ( strlen(*(const char **)&byte_5D4594[1599588]) )
  {
    result = sub_502DA0(*(char **)&byte_5D4594[1599588]);
    if ( result )
    {
      fread(&v8, 4u, 1u, *(FILE **)&byte_5D4594[1599584]);
      if ( v8 == -889266515 )
      {
        while ( 1 )
        {
          v6 = 0;
          fread(&v6, 4u, 1u, *(FILE **)&byte_5D4594[1599584]);
          v1 = v6;
          if ( !v6 )
            break;
          if ( *(_DWORD *)&byte_5D4594[1599596] >= 2048 )
            goto LABEL_10;
          *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * *(_DWORD *)&byte_5D4594[1599596] + 72) = ftell(*(FILE **)&byte_5D4594[1599584]) - 4;
          fread(&v7, 1u, 1u, *(FILE **)&byte_5D4594[1599584]);
          fread(v11, (unsigned __int8)v7, 1u, *(FILE **)&byte_5D4594[1599584]);
          v2 = -1 - (unsigned __int8)v7;
          v11[(unsigned __int8)v7] = 0;
          v3 = v2 + v1;
          strcpy((char *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * *(_DWORD *)&byte_5D4594[1599596]), v11);
          fread(&v4, 1u, 1u, *(FILE **)&byte_5D4594[1599584]);
          fread(&v5, 1u, 1u, *(FILE **)&byte_5D4594[1599584]);
          fread(&v9, 4u, 1u, *(FILE **)&byte_5D4594[1599584]);
          fread(&v10, 4u, 1u, *(FILE **)&byte_5D4594[1599584]);
          *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * *(_DWORD *)&byte_5D4594[1599596] + 64) = v9;
          *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * (*(_DWORD *)&byte_5D4594[1599596])++ + 68) = v10;
          fseek(*(FILE **)&byte_5D4594[1599584], v3 - 10, 1);
        }
        sub_502DF0();
        result = 1;
      }
      else
      {
LABEL_10:
        sub_502DF0();
        result = 0;
      }
    }
  }
  return result;
}
// 502B10: using guessed type char var_40[64];

//----- (00502D70) --------------------------------------------------------
BOOL __cdecl sub_502D70(int a1)
{
  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[1599596] )
    return 0;
  *(_DWORD *)&byte_5D4594[3835396] = a1;
  return sub_503830(a1) == 0;
}

//----- (00502DA0) --------------------------------------------------------
FILE *__cdecl sub_502DA0(char *a1)
{
  FILE *result; // eax

  result = *(FILE **)&byte_5D4594[1599584];
  if ( *(_DWORD *)&byte_5D4594[1599584]
    || (result = (FILE *)sub_426910(a1, 1, -1)) != 0
    && (result = sub_426A60(), (*(_DWORD *)&byte_5D4594[1599584] = result) != 0) )
  {
    fseek(result, 0, 0);
    result = (FILE *)1;
  }
  return result;
}

//----- (00502DF0) --------------------------------------------------------
FILE *sub_502DF0()
{
  FILE *result; // eax

  result = *(FILE **)&byte_5D4594[1599584];
  if ( *(_DWORD *)&byte_5D4594[1599584] )
  {
    result = sub_4269F0();
    *(_DWORD *)&byte_5D4594[1599584] = 0;
  }
  return result;
}

//----- (00502E10) --------------------------------------------------------
FILE *__cdecl sub_502E10(int a1)
{
  if ( !*(_DWORD *)&byte_5D4594[1599584] || a1 < 0 || a1 >= *(int *)&byte_5D4594[1599596] )
    return 0;
  fseek(*(FILE **)&byte_5D4594[1599584], *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * a1 + 72), 0);
  return *(FILE **)&byte_5D4594[1599584];
}

//----- (00502E50) --------------------------------------------------------
FILE *__cdecl sub_502E50(char *a1)
{
  FILE *result; // eax
  int v2; // eax

  result = (FILE *)a1;
  if ( a1 )
  {
    v2 = sub_5029A0(a1);
    result = sub_502E10(v2);
  }
  return result;
}

//----- (00502E70) --------------------------------------------------------
double __cdecl sub_502E70(int a1)
{
  double result; // st7

  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[1599596] )
    result = -1.0;
  else
    result = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * a1 + 64);
  return result;
}

//----- (00502EA0) --------------------------------------------------------
double __cdecl sub_502EA0(int a1)
{
  double result; // st7

  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[1599596] )
    result = -1.0;
  else
    result = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * a1 + 68);
  return result;
}

//----- (00502ED0) --------------------------------------------------------
FILE *__cdecl sub_502ED0(const char *a1)
{
  FILE *result; // eax
  int v2; // edx
  int v3; // eax
  char *v4; // edi
  unsigned __int8 v5; // cl
  FILE *v6; // edi
  FILE *v7; // ebx
  int v8; // ebp
  int v9; // ecx
  int v10; // ebp
  int v11; // [esp+Ch] [ebp-854h]
  int v12; // [esp+10h] [ebp-850h]
  int v13; // [esp+14h] [ebp-84Ch]
  int v14; // [esp+18h] [ebp-848h]
  int v15; // [esp+1Ch] [ebp-844h]
  char v16[64]; // [esp+20h] [ebp-840h]
  char v17[2048]; // [esp+60h] [ebp-800h]

  v13 = 0;
  result = (FILE *)sub_503140();
  if ( result )
  {
    v2 = *(_DWORD *)&byte_587000[229712];
    strcpy(v17, (const char *)&byte_5D4594[3841580]);
    v3 = *(_DWORD *)&byte_587000[229716];
    v4 = &v17[strlen(v17)];
    *(_DWORD *)v4 = *(_DWORD *)&byte_587000[229708];
    v5 = byte_587000[229720];
    *((_DWORD *)v4 + 1) = v2;
    *((_DWORD *)v4 + 2) = v3;
    v4[12] = v5;
    result = fopen(v17, "rb");
    v6 = result;
    if ( result )
    {
      result = fopen(*(const char **)&byte_5D4594[1599588], "wb");
      v7 = result;
      if ( result )
      {
        fread(&v14, 4u, 1u, v6);
        if ( v14 == -889266515 )
        {
          fwrite(&v14, 4u, 1u, v7);
          while ( 1 )
          {
            v12 = 0;
            fread(&v12, 4u, 1u, v6);
            v8 = v12;
            if ( !v12 )
              break;
            fread(&v11, 1u, 1u, v6);
            fread(v16, (unsigned __int8)v11, 1u, v6);
            v9 = -1 - (unsigned __int8)v11;
            v16[(unsigned __int8)v11] = 0;
            v10 = v9 + v8;
            if ( !strcmp(v16, a1) )
            {
              fseek(v6, v10, 1);
            }
            else
            {
              v13 = 1;
              fwrite(&v12, 4u, 1u, v7);
              fwrite(&v11, 1u, 1u, v7);
              fwrite(v16, (unsigned __int8)v11, 1u, v7);
              for ( ; v10; --v10 )
              {
                fread(&v11, 1u, 1u, v6);
                fwrite(&v11, 1u, 1u, v7);
              }
            }
          }
          v15 = 0;
          fwrite(&v15, 4u, 1u, v7);
          fclose(v6);
          fclose(v7);
          sub_502B10();
          result = (FILE *)(v13 != 0);
        }
        else
        {
          fclose(v6);
          fclose(v7);
          result = 0;
        }
      }
    }
  }
  return result;
}
// 502ED0: using guessed type char var_800[2048];
// 502ED0: using guessed type char var_840[64];

//----- (00503140) --------------------------------------------------------
BOOL sub_503140()
{
  BOOL result; // eax
  int v1; // edx
  int v2; // eax
  char *v3; // edi
  unsigned __int8 v4; // cl
  char NewFileName[2048]; // [esp+4h] [ebp-800h]

  sub_502DF0();
  result = 0;
  if ( strlen(*(const char **)&byte_5D4594[1599588]) )
  {
    result = 0;
    if ( strlen((const char *)&byte_5D4594[3841580]) )
    {
      v1 = *(_DWORD *)&byte_587000[229736];
      strcpy(NewFileName, (const char *)&byte_5D4594[3841580]);
      v2 = *(_DWORD *)&byte_587000[229740];
      v3 = &NewFileName[strlen(NewFileName)];
      *(_DWORD *)v3 = *(_DWORD *)&byte_587000[229732];
      v4 = byte_587000[229744];
      *((_DWORD *)v3 + 1) = v1;
      *((_DWORD *)v3 + 2) = v2;
      v3[12] = v4;
      if ( remove(NewFileName) != -1 || errno != 13 )
        result = rename(*(LPCSTR *)&byte_5D4594[1599588], NewFileName) != -1;
      else
        result = 0;
    }
  }
  return result;
}
// 503140: using guessed type CHAR NewFileName[2048];

//----- (00503230) --------------------------------------------------------
FILE *__cdecl sub_503230(const char *a1, char *a2)
{
  FILE *result; // eax
  int v3; // edx
  int v4; // eax
  char *v5; // edi
  unsigned __int8 v6; // cl
  FILE *v7; // ebx
  FILE *v8; // ebp
  int v9; // esi
  int v10; // edx
  int v11; // ecx
  int i; // esi
  char v13; // [esp+13h] [ebp-85Dh]
  int v14; // [esp+14h] [ebp-85Ch]
  int v15; // [esp+18h] [ebp-858h]
  int v16; // [esp+1Ch] [ebp-854h]
  int v17; // [esp+20h] [ebp-850h]
  int v18; // [esp+24h] [ebp-84Ch]
  int v19; // [esp+28h] [ebp-848h]
  int v20; // [esp+2Ch] [ebp-844h]
  char v21[64]; // [esp+30h] [ebp-840h]
  char v22[2048]; // [esp+70h] [ebp-800h]

  result = (FILE *)sub_503140();
  if ( result )
  {
    v3 = *(_DWORD *)&byte_587000[229752];
    strcpy(v22, (const char *)&byte_5D4594[3841580]);
    v4 = *(_DWORD *)&byte_587000[229756];
    v5 = &v22[strlen(v22)];
    *(_DWORD *)v5 = *(_DWORD *)&byte_587000[229748];
    v6 = byte_587000[229760];
    *((_DWORD *)v5 + 1) = v3;
    *((_DWORD *)v5 + 2) = v4;
    v5[12] = v6;
    result = fopen(v22, "rb");
    v7 = result;
    if ( result )
    {
      v8 = fopen(*(const char **)&byte_5D4594[1599588], "wb");
      if ( v8 )
      {
        fread(&v17, 4u, 1u, v7);
        fwrite(&v17, 4u, 1u, v8);
        while ( 1 )
        {
          fread(&v16, 4u, 1u, v7);
          v9 = v16;
          if ( !v16 )
            break;
          fread(&v14, 1u, 1u, v7);
          fread(v21, (unsigned __int8)v14, 1u, v7);
          v10 = (unsigned __int8)v14;
          v11 = -1 - (unsigned __int8)v14;
          v21[(unsigned __int8)v14] = 0;
          v20 = v11 + v9;
          if ( !strcmp(v21, a1) )
          {
            LOBYTE(v15) = strlen(a2);
            v19 = v16 + (unsigned __int8)v15 - v10;
            fwrite(&v19, 4u, 1u, v8);
            fwrite(&v15, 1u, 1u, v8);
            fwrite(a2, (unsigned __int8)v15, 1u, v8);
          }
          else
          {
            fwrite(&v16, 4u, 1u, v8);
            fwrite(&v14, 1u, 1u, v8);
            fwrite(v21, (unsigned __int8)v14, 1u, v8);
          }
          for ( i = v20; i; --i )
          {
            fread(&v13, 1u, 1u, v7);
            fwrite(&v13, 1u, 1u, v8);
          }
        }
        v18 = 0;
        fwrite(&v18, 4u, 1u, v8);
        fclose(v7);
        fclose(v8);
        sub_502B10();
        result = (FILE *)1;
      }
      else
      {
        fclose(v7);
        result = 0;
      }
    }
  }
  return result;
}
// 503230: using guessed type char var_800[2048];
// 503230: using guessed type char var_840[64];

//----- (005034B0) --------------------------------------------------------
int __cdecl sub_5034B0(char *a1)
{
  int v1; // edx
  __int16 v2; // ax
  char *v3; // edi
  char *v4; // eax
  FILE *v5; // esi
  int result; // eax
  FILE *v7; // ebx
  int v8; // edi
  int v9; // edi
  int v10; // edi
  int v11; // edi
  unsigned __int8 v12; // [esp+Fh] [ebp-105Dh]
  int v13; // [esp+10h] [ebp-105Ch]
  char v14; // [esp+17h] [ebp-1055h]
  int v15; // [esp+18h] [ebp-1054h]
  int v16; // [esp+1Ch] [ebp-1050h]
  int v17; // [esp+20h] [ebp-104Ch]
  int v18; // [esp+24h] [ebp-1048h]
  int v19; // [esp+28h] [ebp-1044h]
  char v20[64]; // [esp+2Ch] [ebp-1040h]
  char v21[4096]; // [esp+6Ch] [ebp-1000h]

  v1 = *(_DWORD *)&byte_587000[229776];
  strcpy(v21, (const char *)&byte_5D4594[3841580]);
  v2 = *(_WORD *)&byte_587000[229780];
  v3 = &v21[strlen(v21)];
  *(_DWORD *)v3 = *(_DWORD *)&byte_587000[229772];
  *((_DWORD *)v3 + 1) = v1;
  *((_WORD *)v3 + 4) = v2;
  v4 = (char *)sub_502A90();
  sub_502DA0(v4);
  v5 = sub_502E50(a1);
  if ( v5 )
  {
    v7 = fopen(v21, "wb");
    if ( v7 )
    {
      fread(&v17, 4u, 1u, v5);
      v8 = v17;
      fread(&v13, 1u, 1u, v5);
      fread(v20, (unsigned __int8)v13, 1u, v5);
      v9 = -1 - (unsigned __int8)v13 + v8;
      v20[(unsigned __int8)v13] = 0;
      fread(&v14, 1u, 1u, v5);
      fread(&v12, 1u, 1u, v5);
      fread(&v19, 4u, 1u, v5);
      fread(&v18, 4u, 1u, v5);
      v10 = v9 - 10;
      if ( v12 > 1u )
      {
        fread(&v16, 4u, 1u, v5);
        fseek(v5, v16, 1);
        v10 += -4 - v16;
      }
      fread(&v15, 4u, 1u, v5);
      v11 = v10 - 4;
      if ( v15 == -889266515 )
      {
        v15 = -1410467122;
        fwrite(&v15, 4u, 1u, v7);
        for ( ; v11; --v11 )
        {
          fread(&v13, 1u, 1u, v5);
          fwrite(&v13, 1u, 1u, v7);
        }
        sub_502DF0();
        fclose(v7);
        result = 1;
      }
      else
      {
        sub_502DF0();
        fclose(v7);
        result = 0;
      }
    }
    else
    {
      sub_502DF0();
      result = 0;
    }
  }
  else
  {
    sub_502DF0();
    result = 0;
  }
  return result;
}
// 5034B0: using guessed type char var_1000[4096];
// 5034B0: using guessed type char var_1040[64];

//----- (005036D0) --------------------------------------------------------
int __cdecl sub_5036D0(char *a1, LPCSTR lpFileName)
{
  const char *v2; // edi
  char *v3; // eax
  FILE *v4; // eax
  FILE *v5; // esi
  FILE *v7; // edi
  char v8; // [esp+Bh] [ebp-55h]
  int v9; // [esp+Ch] [ebp-54h]
  int v10; // [esp+10h] [ebp-50h]
  int v11; // [esp+14h] [ebp-4Ch]
  int v12; // [esp+18h] [ebp-48h]
  int v13; // [esp+1Ch] [ebp-44h]
  char v14[64]; // [esp+20h] [ebp-40h]

  v2 = lpFileName;
  DeleteFileA(lpFileName);
  v3 = (char *)sub_502A90();
  sub_502DA0(v3);
  v4 = sub_502E50(a1);
  v5 = v4;
  if ( !v4 )
  {
    sub_502DF0();
    return 0;
  }
  fread(&v11, 4u, 1u, v4);
  fread(&v10, 1u, 1u, v5);
  fread(v14, (unsigned __int8)v10, 1u, v5);
  v14[(unsigned __int8)v10] = 0;
  fread(&v8, 1u, 1u, v5);
  fread(&lpFileName, 1u, 1u, v5);
  fread(&v12, 4u, 1u, v5);
  fread(&v13, 4u, 1u, v5);
  if ( (unsigned __int8)lpFileName <= 1u )
    return 0;
  fread(&v9, 4u, 1u, v5);
  if ( !v9 )
    return 0;
  v7 = fopen(v2, "wb");
  if ( !v7 )
    return 0;
  for ( ; v9; --v9 )
  {
    fread(&a1, 1u, 1u, v5);
    fwrite(&a1, 1u, 1u, v7);
  }
  sub_502DF0();
  fclose(v7);
  return 1;
}
// 5036D0: using guessed type char var_40[64];

//----- (00503830) --------------------------------------------------------
int __cdecl sub_503830(int a1)
{
  FILE *v1; // esi
  _DWORD *v2; // eax
  int v3; // esi
  unsigned __int8 v5; // [esp+Fh] [ebp-19Dh]
  int v6; // [esp+10h] [ebp-19Ch]
  char v7; // [esp+17h] [ebp-195h]
  int v8; // [esp+18h] [ebp-194h]
  int v9; // [esp+1Ch] [ebp-190h]
  int v10; // [esp+20h] [ebp-18Ch]
  int v11[8]; // [esp+24h] [ebp-188h]
  int v19[2]; // [esp+44h] [ebp-168h]
  int v21; // [esp+4Ch] [ebp-160h]
  int v22; // [esp+50h] [ebp-15Ch]
  int v23; // [esp+54h] [ebp-158h]
  char v24[4]; // [esp+58h] [ebp-154h]
  int4 v25; // [esp+5Ch] [ebp-150h]
  char v26[64]; // [esp+6Ch] [ebp-140h]
  char v27[256]; // [esp+ACh] [ebp-100h]

  if ( a1 < 0 )
    return 0;
  if ( a1 >= *(int *)&byte_5D4594[1599596] )
    return 0;
  sub_503F40();
  *(_DWORD *)&byte_5D4594[1599572] = -1;
  *(_DWORD *)&byte_5D4594[1599644] = 0;
  sub_502DA0(*(char **)&byte_5D4594[1599588]);
  if ( !sub_502E10(a1) )
    return 0;
  v1 = sub_426A60();
  fread(&v22, 4u, 1u, v1);
  fread(&v9, 1u, 1u, v1);
  fread(v26, (unsigned __int8)v9, 1u, v1);
  fread(&v7, 1u, 1u, v1);
  fread(&v5, 1u, 1u, v1);
  fread(&v21, 4u, 1u, v1);
  fread(&v23, 4u, 1u, v1);
  if ( v5 > 1u )
  {
    fread(&v6, 4u, 1u, v1);
    fseek(v1, v6, 1);
  }
  fread(&v10, 4u, 1u, v1);
  if ( v10 != -889266515 )
    return 0;
  fread(v19, 4u, 1u, v1);
  fread(&v19[1], 4u, 1u, v1);
  sub_426A80(v19);
  fread(v11, 4u, 1u, v1);
  fread(&v11[1], 4u, 1u, v1);
  fread(&v11[6], 4u, 1u, v1);
  fread(&v11[7], 4u, 1u, v1);
  fread(&v11[2], 4u, 1u, v1);
  fread(&v11[3], 4u, 1u, v1);
  fread(&v11[4], 4u, 1u, v1);
  fread(&v11[5], 4u, 1u, v1);
  sub_4D3C80(v11);
  qmemcpy(&byte_5D4594[1599500], v11, 0x20u);
  sub_428170(&v11, &v25);
  sub_426A50(1);
  while ( 1 )
  {
    v6 = 0;
    LOBYTE(v8) = 0;
    sub_426AC0(&v8, 1u);
    if ( !(_BYTE)v8 )
      break;
    sub_426AC0(v27, (unsigned __int8)v8);
    sub_426AC0(&v24, 4u);
    if ( !sub_426EA0((int)&v11, v27, &v6) )
    {
      if ( v6 == 1 )
        goto LABEL_15;
      v2 = sub_4E3810(v27);
      v3 = (int)v2;
      if ( !v2 )
        return 0;
      if ( !((int (__cdecl *)(_DWORD *, int4 *))v2[176])(v2, &v25) )
      {
        sub_4E38A0(v3);
LABEL_15:
        sub_502DF0();
        return 0;
      }
      sub_4F3F50(v3, 0, &v25.field_0);
    }
  }
  sub_426A50(0);
  *(_DWORD *)&byte_5D4594[1599480] = a1;
  *(_DWORD *)&byte_5D4594[1599476] = 0;
  *(_DWORD *)&byte_5D4594[3835396] = a1;
  sub_502DF0();
  return 1;
}

//----- (00503B30) --------------------------------------------------------
int __cdecl sub_503B30(float2 *a1)
{
  int result; // eax
  int v2; // edi
  double v3; // st7
  float v4; // ecx
  char *v5; // eax
  char *v6; // ecx
  int v7; // eax
  int v8; // esi
  int v9; // edi
  int i; // eax
  int j; // eax
  int k; // eax
  float2 v13; // [esp+Ch] [ebp-50h]
  float2 v14; // [esp+14h] [ebp-48h]
  float2 a2; // [esp+1Ch] [ebp-40h]
  int2 v16; // [esp+24h] [ebp-38h]
  int4 v17; // [esp+2Ch] [ebp-30h]
  int v18[8]; // [esp+3Ch] [ebp-20h]

  result = sub_4D3D90(a1, &a2);
  if ( result )
  {
    v2 = *(_DWORD *)&byte_5D4594[3835396];
    if ( *(_DWORD *)&byte_5D4594[1599480] != *(_DWORD *)&byte_5D4594[3835396]
      || *(int *)&byte_5D4594[1599480] == -1
      || *(_DWORD *)&byte_5D4594[1599476] == 1 )
    {
      result = sub_503830(*(int *)&byte_5D4594[3835396]);
      if ( !result )
        return result;
      v2 = *(_DWORD *)&byte_5D4594[3835396];
    }
    v18[2] = (__int64)a2.field_0;
    v18[3] = (__int64)a2.field_4;
    v13.field_0 = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * v2 + 64) + a1->field_0;
    v13.field_4 = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * v2 + 68) + a1->field_4;
    sub_4D3D90(&v13, &v14);
    v18[4] = (__int64)v14.field_0;
    v18[5] = (__int64)v14.field_4;
    v3 = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * *(_DWORD *)&byte_5D4594[3835396] + 64) + a1->field_0;
    v13.field_4 = a1->field_4;
    v13.field_0 = v3;
    sub_4D3D90(&v13, &v14);
    v18[0] = (__int64)v14.field_0;
    v4 = a1->field_0;
    v18[1] = (__int64)v14.field_4;
    v13.field_0 = v4;
    v13.field_4 = *(float *)(*(_DWORD *)&byte_5D4594[1599576] + 76 * *(_DWORD *)&byte_5D4594[3835396] + 68)
                + a1->field_4;
    sub_4D3D90(&v13, &v14);
    v18[6] = (__int64)v14.field_0;
    v18[7] = (__int64)v14.field_4;
    sub_4D3C80(v18);
    sub_428170(v18, &v17);
    v5 = sub_426A70();
    v6 = v5;
    v7 = *(_DWORD *)v5;
    *(_DWORD *)&byte_5D4594[1599484] = v7;
    *(_DWORD *)&byte_5D4594[1599488] = *((_DWORD *)v6 + 1);
    *(float *)&byte_5D4594[1599492] = (double)(23 * v7);
    *(float *)&byte_5D4594[1599496] = (double)(int)(23 * *(_DWORD *)&byte_5D4594[1599488]);
    v8 = (__int64)(a2.field_0 - (double)*(int *)&byte_5D4594[1599508]);
    v9 = (__int64)(a2.field_4 - (double)*(int *)&byte_5D4594[1599512]);
    result = sub_504150(v8, v9);
    if ( result )
    {
      result = sub_504330(v8, v9);
      if ( result )
      {
        result = sub_504560(v8, v9);
        if ( result )
        {
          result = sub_504910(v8, v9);
          if ( result )
          {
            sub_579D20();
            for ( i = sub_579890(); i; i = sub_5798A0(i) )
              *(_DWORD *)(i + 480) |= 0x80000000;
            *(_DWORD *)&byte_5D4594[3835392] = sub_4D0010(&v17, *(int *)&byte_5D4594[3835392]);
            result = sub_504720(v8, v9);
            if ( result )
            {
              for ( j = sub_579890(); j; j = sub_5798A0(j) )
                *(_DWORD *)(j + 4) = 0;
              for ( k = sub_4DA870(); k; k = sub_4DA880(k) )
                *(_DWORD *)(k + 44) = 0;
              sub_5799C0();
              sub_4DB030();
              *(_DWORD *)&byte_5D4594[1599476] = 1;
              if ( *(_DWORD *)&byte_5D4594[1599644] )
              {
                ++*(_DWORD *)&byte_5D4594[3835308];
                sub_542BF0(*(int *)&byte_5D4594[3835312], v8, v9);
                v16.field_0 = v8;
                v16.field_4 = v9;
                sub_543110((LPCSTR)&byte_5D4594[3830188], &v16);
                if ( *(_DWORD *)&byte_5D4594[1599580] )
                {
                  remove((LPCSTR)&byte_5D4594[3835436]);
                  rename((LPCSTR)&byte_5D4594[3837484], (LPCSTR)&byte_5D4594[3835436]);
                  sub_541670(
                    (LPCSTR)&byte_5D4594[3835436],
                    (LPCSTR)&byte_5D4594[3830188],
                    (LPCSTR)&byte_5D4594[3837484]);
                }
                else
                {
                  *(_DWORD *)&byte_5D4594[1599580] = 1;
                  rename((LPCSTR)&byte_5D4594[3830188], (LPCSTR)&byte_5D4594[3837484]);
                }
              }
              ++*(_DWORD *)&byte_5D4594[3835312];
              result = 1;
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (00503EC0) --------------------------------------------------------
int __cdecl sub_503EC0(int a1, float *a2)
{
  float2 a1a; // [esp+0h] [ebp-18h]
  float2 v4; // [esp+8h] [ebp-10h]
  float2 a2a; // [esp+10h] [ebp-8h]

  if ( *(_DWORD *)&byte_5D4594[1599480] != *(_DWORD *)&byte_5D4594[3835396]
    || *(int *)&byte_5D4594[1599480] == -1
    || *(_DWORD *)&byte_5D4594[1599476] == 1 )
  {
    return 0;
  }
  a1a.field_0 = (double)*(int *)&byte_5D4594[1599508];
  a1a.field_4 = (double)*(int *)&byte_5D4594[1599512];
  sub_4D3E30(&a1a, &a2a);
  sub_4D3E30((float2 *)(a1 + 56), &v4);
  *a2 = v4.field_0 - a2a.field_0;
  a2[1] = v4.field_4 - a2a.field_4;
  return 1;
}

//----- (00503F40) --------------------------------------------------------
char *sub_503F40()
{
  int *v0; // esi
  int *v1; // edi
  int v2; // esi
  int v3; // edi
  LPVOID *v4; // edi
  LPVOID *v5; // ebx
  int v6; // eax
  int v7; // esi
  LPVOID *v8; // esi
  LPVOID *v9; // edi
  _QWORD **v10; // edi
  _QWORD **v11; // ebx
  int v12; // eax
  int v13; // esi

  v0 = *(int **)&byte_5D4594[1599540];
  if ( *(_DWORD *)&byte_5D4594[1599540] )
  {
    do
    {
      v1 = (int *)v0[1];
      if ( !*(_DWORD *)&byte_5D4594[1599476] )
        sub_4E38A0(*v0);
      free(v0);
      v0 = v1;
    }
    while ( v1 );
  }
  v2 = *(_DWORD *)&byte_5D4594[1599548];
  if ( *(_DWORD *)&byte_5D4594[1599548] )
  {
    do
    {
      v3 = *(_DWORD *)(v2 + 4);
      if ( !*(_DWORD *)&byte_5D4594[1599476] )
        free(*(LPVOID *)v2);
      free((LPVOID)v2);
      v2 = v3;
    }
    while ( v3 );
  }
  v4 = *(LPVOID **)&byte_5D4594[1599556];
  if ( *(_DWORD *)&byte_5D4594[1599556] )
  {
    do
    {
      v5 = (LPVOID *)v4[4];
      v6 = *((_DWORD *)*v4 + 4);
      if ( v6 )
      {
        do
        {
          v7 = *(_DWORD *)(v6 + 16);
          sub_4221E0(v6);
          v6 = v7;
        }
        while ( v7 );
      }
      free(*v4);
      free(v4);
      v4 = v5;
    }
    while ( v5 );
  }
  v8 = *(LPVOID **)&byte_5D4594[1599532];
  if ( *(_DWORD *)&byte_5D4594[1599532] )
  {
    do
    {
      v9 = (LPVOID *)v8[1];
      if ( !*(_DWORD *)&byte_5D4594[1599476] && *((_BYTE *)*v8 + 4) & 4 )
        free(*((LPVOID *)*v8 + 7));
      free(*v8);
      free(v8);
      v8 = v9;
    }
    while ( v9 );
  }
  v10 = *(_QWORD ***)&byte_5D4594[1599564];
  if ( *(_DWORD *)&byte_5D4594[1599564] )
  {
    do
    {
      v11 = (_QWORD **)v10[1];
      if ( *(_DWORD *)&byte_5D4594[1599476] )
      {
        free(v10);
      }
      else
      {
        v12 = *((_DWORD *)*v10 + 21);
        if ( v12 )
        {
          do
          {
            v13 = *(_DWORD *)(v12 + 8);
            sub_57C390((_QWORD *)v12);
            v12 = v13;
          }
          while ( v13 );
        }
        sub_57C370(*v10);
        free(v10);
      }
      v10 = v11;
    }
    while ( v11 );
  }
  *(_DWORD *)&byte_5D4594[1599568] = 0;
  *(_DWORD *)&byte_5D4594[1599564] = 0;
  return sub_5028E0();
}

//----- (005040A0) --------------------------------------------------------
_DWORD *__cdecl sub_5040A0(int a1, int a2, float a3)
{
  _DWORD *result; // eax
  _DWORD *v4; // esi
  void *v5; // eax
  double v6; // st7
  bool v7; // zf
  float v8; // [esp+10h] [ebp+Ch]

  result = nox_malloc(0x18u);
  v4 = result;
  if ( result )
  {
    v5 = nox_malloc(0x14u);
    *v4 = v5;
    if ( v5 )
    {
      v4[5] = 0;
      v4[4] = *(_DWORD *)&byte_5D4594[1599556];
      if ( *(_DWORD *)&byte_5D4594[1599556] )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599556] + 20) = v4;
      *(_DWORD *)&byte_5D4594[1599556] = v4;
      v6 = (double)a1 * 46.0;
      ++*(_DWORD *)&byte_5D4594[1599560];
      v7 = LOBYTE(a3) == 1;
      *((_BYTE *)v4 + 12) = LOBYTE(a3);
      *((float *)v4 + 1) = v6;
      v8 = (double)a2 * 46.0;
      *((float *)v4 + 2) = v8;
      result = v4;
      if ( v7 )
        *((float *)v4 + 1) = v6 + 23.0;
      else
        *((float *)v4 + 2) = v8 + 23.0;
    }
    else
    {
      free(v4);
      result = 0;
    }
  }
  return result;
}

//----- (00504150) --------------------------------------------------------
int __cdecl sub_504150(int a1, int a2)
{
  int v2; // eax
  const char *v3; // edx
  int v5; // edi
  int *i; // esi
  float2 a1a; // [esp+Ch] [ebp-50h]
  char v8[72]; // [esp+14h] [ebp-48h]
  float v9; // [esp+60h] [ebp+4h]
  float v10; // [esp+64h] [ebp+8h]

  if ( *(int *)&byte_587000[229704] == -1 )
  {
    v2 = 0;
    if ( *(int *)&byte_5D4594[251568] > 0 )
    {
      v3 = (const char *)&byte_5D4594[2682188];
      while ( strcmp(v3, (const char *)&byte_587000[229792]) )
      {
        ++v2;
        v3 += 60;
        if ( v2 >= *(int *)&byte_5D4594[251568] )
          goto LABEL_8;
      }
      *(_DWORD *)&byte_587000[229704] = v2;
LABEL_8:
      if ( v2 == -1 )
        return 0;
    }
  }
  qmemcpy(v8, sub_4D3C70(), sizeof(v8));
  v5 = *(_DWORD *)&byte_5D4594[1599556];
  if ( *(_DWORD *)&byte_5D4594[1599556] )
  {
    v9 = (double)a1;
    v10 = (double)a2;
    do
    {
      a1a.field_0 = v9 + *(float *)(v5 + 4);
      a1a.field_4 = v10 + *(float *)(v5 + 8);
      sub_51D540(**(_DWORD **)v5);
      sub_51D570(*(_DWORD *)(*(_DWORD *)v5 + 4));
      sub_51D5C0(1);
      if ( **(_DWORD **)v5 != *(_DWORD *)&byte_587000[229704] )
        sub_51D8F0(&a1a);
      for ( i = *(int **)(*(_DWORD *)v5 + 16); i; i = (int *)i[4] )
      {
        sub_544070(i[2]);
        sub_5440A0(i[3]);
        sub_51D540(*i);
        sub_51D570(i[1]);
        sub_544310(&a1a);
      }
      v5 = *(_DWORD *)(v5 + 16);
    }
    while ( v5 );
  }
  sub_4D3C50(v8);
  return 1;
}

//----- (00504290) --------------------------------------------------------
_DWORD *__cdecl sub_504290(char a1, char a2)
{
  _DWORD *result; // eax
  _DWORD *v3; // esi
  _BYTE *v4; // eax

  result = nox_malloc(0xCu);
  v3 = result;
  if ( result )
  {
    result[2] = 0;
    result[1] = *(_DWORD *)&byte_5D4594[1599532];
    if ( *(_DWORD *)&byte_5D4594[1599532] )
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599532] + 8) = result;
    *(_DWORD *)&byte_5D4594[1599532] = result;
    v4 = nox_calloc(1u, 0x24u);
    *v3 = v4;
    v4[5] = a1;
    *(_BYTE *)(*v3 + 6) = a2;
    result = v3;
  }
  return result;
}

//----- (005042F0) --------------------------------------------------------
_DWORD *__cdecl sub_5042F0(int a1, int a2)
{
  _DWORD *result; // eax

  result = *(_DWORD **)&byte_5D4594[1599532];
  if ( !*(_DWORD *)&byte_5D4594[1599532] )
    return 0;
  while ( *(unsigned __int8 *)(*result + 5) != a1 || *(unsigned __int8 *)(*result + 6) != a2 )
  {
    result = (_DWORD *)result[1];
    if ( !result )
      return 0;
  }
  return result;
}

//----- (00504330) --------------------------------------------------------
int __cdecl sub_504330(int a1, int a2)
{
  unsigned __int8 **v2; // edi
  int v3; // ebp
  int v4; // ecx
  int v6; // ebx
  unsigned __int8 *v7; // esi
  unsigned __int8 v8; // dl
  unsigned __int8 v9; // al
  _DWORD *v11; // [esp-4h] [ebp-14h]
  int v12; // [esp-4h] [ebp-14h]

  v2 = *(unsigned __int8 ***)&byte_5D4594[1599532];
  if ( !*(_DWORD *)&byte_5D4594[1599532] )
    return 1;
  while ( 1 )
  {
    v3 = (a1 + 23 * (*v2)[5]) / 23;
    v4 = a2 + 23 * (*v2)[6];
    v6 = v4 / 23;
    v7 = (unsigned __int8 *)sub_410580(v3, v6);
    if ( v7 )
    {
      v8 = **v2;
      if ( *(_DWORD *)&byte_5D4594[3835368] )
        *v7 = sub_42A6C0(*v7, v8);
      else
        *v7 = v8;
      goto LABEL_8;
    }
    v7 = (unsigned __int8 *)sub_410250(v3, v6);
    if ( !v7 )
      return 0;
    *v7 = **v2;
LABEL_8:
    v7[1] = (*v2)[1];
    v7[2] = (*v2)[2];
    v7[7] = (*v2)[7];
    if ( ((*v2)[4] & 0x80u) != 0 )
      v7[4] |= 0x80u;
    if ( v7[2] >= sub_410DD0(v7[1], *v7, 0) )
      v7[2] = 0;
    if ( v7[4] & 4 )
      sub_4107A0(*((LPVOID *)v7 + 7));
    if ( (*v2)[4] & 4 )
    {
      v7[4] |= 4u;
      v11 = (_DWORD *)*((_DWORD *)*v2 + 7);
      *((_DWORD *)v7 + 7) = v11;
      sub_410760(v11);
    }
    if ( (*v2)[4] & 8 )
    {
      v9 = v7[4];
      if ( !(v9 & 8) )
      {
        v12 = *((_DWORD *)v7 + 7);
        v7[4] = v9 | 8;
        sub_410840(v12);
      }
    }
    if ( (*v2)[4] & 0x40 )
      v7[4] |= 0x40u;
    v2 = (unsigned __int8 **)v2[1];
    if ( !v2 )
      return 1;
  }
}

//----- (005044B0) --------------------------------------------------------
_DWORD *__cdecl sub_5044B0(int a1, float a2, float a3)
{
  _DWORD *result; // eax
  _DWORD *v4; // esi
  _DWORD *v5; // eax
  _DWORD *v6; // eax

  result = nox_malloc(0xCu);
  v4 = result;
  if ( result )
  {
    v5 = sub_579E70();
    *v4 = v5;
    if ( v5 )
    {
      v4[2] = 0;
      v4[1] = *(_DWORD *)&byte_5D4594[1599548];
      if ( *(_DWORD *)&byte_5D4594[1599548] )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599548] + 8) = v4;
      *(_DWORD *)&byte_5D4594[1599548] = v4;
      *(_DWORD *)*v4 = a1;
      *(float *)(*v4 + 8) = a2;
      *(float *)(*v4 + 12) = a3;
      *(_DWORD *)(*v4 + 488) = 0;
      v6 = (_DWORD *)v4[1];
      if ( v6 )
      {
        *(_DWORD *)(*v4 + 484) = *v6;
        *(_DWORD *)(*(_DWORD *)v4[1] + 488) = *v4;
        result = v4;
      }
      else
      {
        result = v4;
        *(_DWORD *)(*v4 + 484) = 0;
      }
    }
    else
    {
      free(v4);
      result = 0;
    }
  }
  return result;
}

//----- (00504560) --------------------------------------------------------
int __cdecl sub_504560(int a1, int a2)
{
  int *v2; // esi
  float v4; // [esp+8h] [ebp+4h]
  float v5; // [esp+Ch] [ebp+8h]

  v2 = *(int **)&byte_5D4594[1599548];
  if ( *(_DWORD *)&byte_5D4594[1599548] )
  {
    v4 = (double)a1;
    v5 = (double)a2;
    do
    {
      *(float *)(*v2 + 8) = v4 + *(float *)(*v2 + 8);
      *(float *)(*v2 + 12) = v5 + *(float *)(*v2 + 12);
      sub_579E90(*v2);
      v2 = (int *)v2[1];
    }
    while ( v2 );
  }
  return 1;
}

//----- (005045B0) --------------------------------------------------------
int sub_5045B0()
{
  int result; // eax

  if ( *(_DWORD *)&byte_5D4594[1599480] == *(_DWORD *)&byte_5D4594[3835396]
    && *(int *)&byte_5D4594[1599480] != -1
    && *(_DWORD *)&byte_5D4594[1599476] != 1
    || (result = sub_503830(*(int *)&byte_5D4594[3835396])) != 0 )
  {
    result = **(_DWORD **)&byte_5D4594[1599548];
  }
  return result;
}

//----- (005045F0) --------------------------------------------------------
int __cdecl sub_5045F0(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 )
    result = *(_DWORD *)(a1 + 484);
  return result;
}

//----- (00504600) --------------------------------------------------------
_DWORD *__cdecl sub_504600(const char *a1, int a2, char a3)
{
  _DWORD *v3; // ebx
  _DWORD *result; // eax
  void *v5; // eax
  char *v6; // edx
  unsigned int v7; // ecx
  char v8; // al
  char *v9; // edi
  const char *v10; // esi

  v3 = nox_malloc(0xCu);
  if ( !v3 )
    return 0;
  v5 = sub_57C330();
  *v3 = v5;
  if ( !v5 )
    return 0;
  v3[2] = 0;
  v3[1] = *(_DWORD *)&byte_5D4594[1599564];
  if ( *(_DWORD *)&byte_5D4594[1599564] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599564] + 8) = v3;
  *(_DWORD *)&byte_5D4594[1599564] = v3;
  *(_DWORD *)(*v3 + 88) = 0;
  *(_DWORD *)(*v3 + 92) = 0;
  *(_DWORD *)(*v3 + 84) = 0;
  *(_DWORD *)(*v3 + 4) = a2;
  *(_BYTE *)*v3 = a3;
  v6 = (char *)(*v3 + 8);
  v7 = strlen(a1) + 1;
  v8 = v7;
  v7 >>= 2;
  qmemcpy(v6, a1, 4 * v7);
  v10 = &a1[4 * v7];
  v9 = &v6[4 * v7];
  LOBYTE(v7) = v8;
  result = v3;
  qmemcpy(v9, v10, v7 & 3);
  return result;
}

//----- (005046A0) --------------------------------------------------------
int __cdecl sub_5046A0(_DWORD *a1, int a2)
{
  char **v2; // esi
  _DWORD *v4; // eax
  char v5; // cl
  int v6; // ecx

  v2 = *(char ***)&byte_5D4594[1599564];
  if ( !*(_DWORD *)&byte_5D4594[1599564] )
    return 0;
  while ( *((_DWORD *)*v2 + 1) != a2 )
  {
    v2 = (char **)v2[1];
    if ( !v2 )
      return 0;
  }
  v4 = sub_57C360();
  if ( !v4 )
    return 0;
  v5 = **v2;
  if ( !v5 || v5 == 1 || v5 == 3 )
  {
    *v4 = *a1;
    goto LABEL_12;
  }
  if ( v5 != 2 )
    return 0;
  *v4 = *a1;
  v4[1] = a1[1];
LABEL_12:
  v4[3] = 0;
  v4[2] = *((_DWORD *)*v2 + 21);
  v6 = *((_DWORD *)*v2 + 21);
  if ( v6 )
    *(_DWORD *)(v6 + 12) = v4;
  *((_DWORD *)*v2 + 21) = v4;
  return 1;
}

//----- (00504720) --------------------------------------------------------
int __cdecl sub_504720(int a1, int a2)
{
  int *v2; // esi

  sub_504760(a1, a2);
  v2 = *(int **)&byte_5D4594[1599564];
  if ( *(_DWORD *)&byte_5D4594[1599564] )
  {
    do
    {
      sub_57C3B0(*v2);
      v2 = (int *)v2[1];
    }
    while ( v2 );
  }
  return 1;
}

//----- (00504760) --------------------------------------------------------
int __cdecl sub_504760(int a1, int a2)
{
  int result; // eax
  char **v3; // ebp
  char v4; // bl
  int *v5; // esi
  int v6; // eax
  int v7; // ecx
  int v8; // [esp+4h] [ebp-50h]
  char v9[76]; // [esp+8h] [ebp-4Ch]

  result = sub_57BF80();
  v3 = *(char ***)&byte_5D4594[1599564];
  v8 = result;
  if ( *(_DWORD *)&byte_5D4594[1599564] )
  {
    while ( 1 )
    {
      v4 = **v3;
      nox_sprintf(v9, (const char *)&byte_587000[229812], *v3 + 8, *(_DWORD *)&byte_5D4594[3835312]);
      strcpy(*v3 + 8, v9);
      result = (int)*v3;
      *((_DWORD *)*v3 + 1) += v8;
      v5 = (int *)*((_DWORD *)*v3 + 21);
      if ( v5 )
        break;
LABEL_15:
      v3 = (char **)v3[1];
      if ( !v3 )
        return result;
    }
    while ( 1 )
    {
      if ( v4 )
      {
        switch ( v4 )
        {
          case 1:
            result = sub_579C60(*v5);
            if ( result )
              *v5 = *(_DWORD *)result;
            break;
          case 2:
            v6 = v5[1];
            *v5 = (a1 + 23 * *v5) / 23;
            v7 = a2 + 23 * v6;
            result = -1307163959 * v7;
            v5[1] = v7 / 23;
            break;
          case 3:
            result = v8 + *v5;
            goto LABEL_13;
        }
      }
      else
      {
        result = sub_4CFFE0(*v5);
        if ( result )
        {
          result = *(_DWORD *)(result + 40);
LABEL_13:
          *v5 = result;
          goto LABEL_14;
        }
      }
LABEL_14:
      v5 = (int *)v5[2];
      if ( !v5 )
        goto LABEL_15;
    }
  }
  return result;
}

//----- (005048A0) --------------------------------------------------------
_DWORD *__cdecl sub_5048A0(int a1)
{
  _DWORD *result; // eax
  _DWORD *v2; // ecx

  result = nox_malloc(0xCu);
  if ( !result )
    return 0;
  result[2] = 0;
  *result = a1;
  result[1] = *(_DWORD *)&byte_5D4594[1599540];
  if ( *(_DWORD *)&byte_5D4594[1599540] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599540] + 8) = result;
  *(_DWORD *)&byte_5D4594[1599540] = result;
  *(_DWORD *)(*result + 448) = 0;
  v2 = (_DWORD *)result[1];
  if ( v2 )
  {
    *(_DWORD *)(*result + 444) = *v2;
    *(_DWORD *)(*(_DWORD *)result[1] + 448) = *result;
  }
  else
  {
    *(_DWORD *)(*result + 444) = 0;
  }
  return result;
}

//----- (00504910) --------------------------------------------------------
int __cdecl sub_504910(int a1, int a2)
{
  int *v2; // esi
  float v4; // [esp+8h] [ebp+4h]
  float v5; // [esp+Ch] [ebp+8h]

  v2 = *(int **)&byte_5D4594[1599540];
  if ( *(_DWORD *)&byte_5D4594[1599540] )
  {
    v4 = (double)a1;
    v5 = (double)a2;
    do
    {
      *(float *)(*v2 + 56) = v4 + *(float *)(*v2 + 56);
      *(float *)(*v2 + 60) = v5 + *(float *)(*v2 + 60);
      sub_4DAA50(*v2, 0, *(float *)(*v2 + 56), *(float *)(*v2 + 60));
      *(_DWORD *)(*v2 + 16) |= 0x80000000;
      v2 = (int *)v2[1];
    }
    while ( v2 );
  }
  return 1;
}

//----- (00504980) --------------------------------------------------------
int sub_504980()
{
  int result; // eax

  if ( (*(_DWORD *)&byte_5D4594[1599480] == *(_DWORD *)&byte_5D4594[3835396]
     && *(int *)&byte_5D4594[1599480] != -1
     && *(_DWORD *)&byte_5D4594[1599476] != 1
     || sub_503830(*(int *)&byte_5D4594[3835396]))
    && *(_DWORD *)&byte_5D4594[1599540] )
  {
    result = **(_DWORD **)&byte_5D4594[1599540];
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (005049C0) --------------------------------------------------------
int __cdecl sub_5049C0(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 )
    result = *(_DWORD *)(a1 + 444);
  return result;
}

//----- (005049D0) --------------------------------------------------------
LPVOID sub_5049D0()
{
  return *(LPVOID *)&byte_5D4594[1599540];
}

//----- (005049E0) --------------------------------------------------------
int __cdecl sub_5049E0(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 )
    result = *(_DWORD *)(a1 + 4);
  return result;
}

//----- (005049F0) --------------------------------------------------------
int __cdecl sub_5049F0(FILE *a1, int a2)
{
  return fseek(a1, a2, 1);
}

//----- (00504A10) --------------------------------------------------------
int __cdecl sub_504A10(int a1)
{
  int *v1; // esi
  int v3; // eax
  int v4; // eax
  int v5; // ecx
  int v6; // ecx

  if ( !a1 )
    return 0;
  v1 = *(int **)&byte_5D4594[1599540];
  if ( !*(_DWORD *)&byte_5D4594[1599540] )
    return 0;
  while ( *v1 != a1 )
  {
    v1 = (int *)v1[1];
    if ( !v1 )
      return 0;
  }
  v3 = v1[1];
  if ( v3 )
    *(_DWORD *)(v3 + 8) = v1[2];
  v4 = v1[2];
  if ( v4 )
    *(_DWORD *)(v4 + 4) = v1[1];
  if ( v1 == *(int **)&byte_5D4594[1599540] )
    *(_DWORD *)&byte_5D4594[1599540] = v1[1];
  v5 = *(_DWORD *)(*v1 + 444);
  if ( v5 )
    *(_DWORD *)(v5 + 448) = *(_DWORD *)(*v1 + 448);
  v6 = *(_DWORD *)(*v1 + 448);
  if ( v6 )
    *(_DWORD *)(v6 + 444) = *(_DWORD *)(*v1 + 444);
  sub_4E38A0(*v1);
  free(v1);
  return 1;
}

//----- (00504AB0) --------------------------------------------------------
int __cdecl sub_504AB0(char *a1)
{
  char *v1; // eax
  const char *v2; // eax
  FILE *v3; // ebp
  int result; // eax
  FILE *v5; // esi
  int v6; // edi
  int v7; // edi
  char v8; // [esp+Fh] [ebp-851h]
  int v9; // [esp+10h] [ebp-850h]
  int v10; // [esp+14h] [ebp-84Ch]
  int v11; // [esp+18h] [ebp-848h]
  int v12; // [esp+1Ch] [ebp-844h]
  char v13[64]; // [esp+20h] [ebp-840h]
  char v14[2048]; // [esp+60h] [ebp-800h]

  v12 = 0;
  strcpy(v14, (const char *)sub_502A90());
  sub_502DF0();
  v1 = (char *)sub_502AF0();
  sub_502A50(v1);
  sub_502B10();
  v2 = (const char *)sub_502A90();
  v3 = fopen(v2, "r+b");
  if ( v3 )
  {
    v5 = fopen(a1, "rb");
    if ( v5 )
    {
      fseek(v3, -4, 2);
      fread(&v11, 4u, 1u, v5);
      if ( v11 == -889266515 )
      {
        while ( 1 )
        {
          fread(&v10, 4u, 1u, v5);
          v6 = v10;
          if ( !v10 )
            break;
          fread(&v9, 1u, 1u, v5);
          fread(v13, (unsigned __int8)v9, 1u, v5);
          v7 = -1 - (unsigned __int8)v9 + v6;
          v13[(unsigned __int8)v9] = 0;
          if ( sub_5029A0(v13) == -1 )
          {
            fwrite(&v10, 4u, 1u, v3);
            fwrite(&v9, 1u, 1u, v3);
            fwrite(v13, (unsigned __int8)v9, 1u, v3);
            for ( ; v7; --v7 )
            {
              fread(&v8, 1u, 1u, v5);
              fwrite(&v8, 1u, 1u, v3);
            }
          }
          else
          {
            fseek(v5, v7, 1);
          }
        }
        fwrite(&v12, 4u, 1u, v3);
        fclose(v3);
        fclose(v5);
        sub_502A50(v14);
        sub_502B10();
        result = 1;
      }
      else
      {
        fclose(v3);
        fclose(v5);
        sub_502A50(v14);
        sub_502B10();
        result = 0;
      }
    }
    else
    {
      fclose(v3);
      sub_502A50(v14);
      sub_502B10();
      result = 0;
    }
  }
  else
  {
    sub_502A50(v14);
    sub_502B10();
    result = 0;
  }
  return result;
}
// 504AB0: using guessed type char var_840[64];

//----- (00504CF0) --------------------------------------------------------
int __cdecl sub_504CF0(_DWORD *a2)
{
  int result; // eax
  int i; // esi
  int j; // esi
  int v4; // eax
  float v5; // ecx
  int v6; // eax
  _DWORD *v7; // ebp
  unsigned __int16 v8; // ax
  _DWORD *v9; // eax
  _DWORD *v10; // edi
  int v11; // ebx
  int v12; // [esp+10h] [ebp-24h]
  int v13; // [esp+14h] [ebp-20h]
  int v14; // [esp+18h] [ebp-1Ch]
  int2 a1; // [esp+1Ch] [ebp-18h]
  int4 v16; // [esp+24h] [ebp-10h]

  v13 = 1;
  sub_426AC0(&v13, 2u);
  if ( (__int16)v13 > 1 )
    return 0;
  if ( a2 )
    sub_428170(a2, &v16);
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    sub_426AC0(&v12, 2u);
    if ( (_WORD)v12 )
    {
      v7 = a2;
      while ( 1 )
      {
        sub_426C20(&a1, 4u);
        v8 = sub_42C2B0(v12);
        v9 = sub_4E3450(v8);
        v10 = v9;
        if ( !v9 )
          break;
        v11 = 0;
        if ( !((int (__cdecl *)(_DWORD *, unsigned int))v9[176])(v9, a2 != 0 ? (unsigned int)&v16 : 0) )
          break;
        if ( v10[4] & 0x400000 )
        {
          v7 = (_DWORD *)v10[32];
          v11 = 1;
        }
        if ( sub_4F3F50((int)v10, 0, (int *)(a2 != 0 ? (unsigned int)&v16 : 0)) == 1 && v11 == 1 )
          sub_511660(v10, (int)v7);
        sub_426AC0(&v12, 2u);
        if ( !(_WORD)v12 )
          return 1;
      }
      sub_4269F0();
      return 0;
    }
    return 1;
  }
  for ( i = sub_4DA790(); i; i = sub_4DA7A0(i) )
  {
    if ( !a2
      || (a1.field_0 = sub_419A70(*(float *)(i + 56)), a1.field_4 = sub_419A70(*(float *)(i + 60)), sub_4280E0(&a1, a2)) )
    {
      if ( sub_4E3B80(*(unsigned __int16 *)(i + 4)) && !sub_51DF90(i) )
        return 0;
    }
  }
  for ( j = sub_4DA840(); j; j = sub_4DA850(j) )
  {
    if ( a2 )
    {
      v4 = sub_419A70(*(float *)(j + 56));
      v5 = *(float *)(j + 60);
      a1.field_0 = v4;
      a1.field_4 = sub_419A70(v5);
      if ( !sub_4280E0(&a1, a2) )
        continue;
    }
    if ( *(_DWORD *)(j + 8) & 0x1000000 && *(_BYTE *)(j + 12) & 0x40 )
    {
      v6 = sub_4E7980(j);
      *(_DWORD *)(v6 + 56) = *(_DWORD *)(j + 56);
      *(_DWORD *)(v6 + 60) = *(_DWORD *)(j + 60);
      sub_51DF90(v6);
    }
    else if ( sub_4E3B80(*(unsigned __int16 *)(j + 4)) && !sub_51DF90(j) )
    {
      return 0;
    }
  }
  if ( sub_40A5C0(0x200000) || !sub_40A5C0(1) || sub_40A5C0(0x400000) || (result = sub_51DED0()) != 0 )
  {
    v14 = 0;
    sub_426AC0(&v14, 2u);
    return 1;
  }
  return result;
}

//----- (00504F90) --------------------------------------------------------
int sub_504F90()
{
  int result; // eax
  char v1; // [esp+3h] [ebp-5h]
  int v2; // [esp+4h] [ebp-4h]

  v2 = 1;
  sub_426AC0(&v2, 2u);
  if ( (__int16)v2 > 1 )
    return 0;
  v1 = 0;
  if ( *(_DWORD *)&byte_5D4594[1599636] && sub_40A5C0(1) && !sub_40A5C0(0x400000) )
    v1 = 1;
  sub_426AC0(&v1, 1u);
  if ( !v1 )
    return 1;
  sub_426AC0(*(_BYTE **)(*(_DWORD *)&byte_5D4594[1599636] + 76), 4 * *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 64));
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    result = sub_51AF80();
    if ( !result )
      return result;
    return 1;
  }
  result = sub_51AEA0();
  if ( result )
    return 1;
  return result;
}

//----- (00505050) --------------------------------------------------------
LPVOID sub_505050()
{
  return *(LPVOID *)&byte_5D4594[1599616];
}

//----- (00505060) --------------------------------------------------------
LPVOID sub_505060()
{
  LPVOID result; // eax

  result = *(LPVOID *)&byte_5D4594[1599616];
  if ( *(_DWORD *)&byte_5D4594[1599616] )
  {
    free(*(LPVOID *)&byte_5D4594[1599616]);
    *(_DWORD *)&byte_5D4594[1599616] = 0;
  }
  return result;
}

//----- (00505080) --------------------------------------------------------
int sub_505080()
{
  FILE *v0; // ebx
  BOOL v1; // ebp
  char *v2; // edi
  __int16 v3; // dx
  unsigned __int8 v4; // al
  char *v5; // edi
  char *v6; // edi
  unsigned __int8 v7; // cl
  __int16 v8; // si
  int v9; // edi
  FILE *v10; // eax
  FILE *v11; // esi
  int result; // eax
  _BYTE *v13; // eax
  _BYTE *v14; // edi
  int i; // esi
  char v16; // [esp+13h] [ebp-409h]
  size_t v17; // [esp+14h] [ebp-408h]
  int v18; // [esp+18h] [ebp-404h]
  char v19[1024]; // [esp+1Ch] [ebp-400h]

  v0 = 0;
  v18 = 1;
  v17 = 0;
  v1 = sub_40A5C0(0x200000);
  sub_505060();
  v2 = sub_409E10();
  v3 = *(_WORD *)&byte_587000[229832];
  strcpy(v19, v2);
  v4 = byte_587000[229834];
  v5 = &v19[strlen(v19)];
  *(_DWORD *)v5 = *(_DWORD *)&byte_587000[229828];
  *((_WORD *)v5 + 2) = v3;
  v5[6] = v4;
  strcat(v19, sub_409B40());
  *(_WORD *)&v19[strlen(v19)] = *(_WORD *)&byte_587000[229836];
  strcat(v19, sub_409B40());
  v6 = &v19[strlen(v19) + 1];
  v7 = byte_587000[229844];
  v8 = v18;
  *(_DWORD *)--v6 = *(_DWORD *)&byte_587000[229840];
  v6[4] = v7;
  sub_426AC0(&v18, 2u);
  if ( v8 > (__int16)v18 )
    return 0;
  v9 = 0;
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      sub_426AC0(&v17, 4u);
      if ( (int)v17 <= 0 )
        return 1;
      if ( sub_40A5C0(0x400000) )
      {
        sub_426AA0(v17);
        return 1;
      }
      if ( v1 )
      {
        v0 = fopen(v19, "wb");
        if ( v0 )
        {
          v14 = (_BYTE *)v18;
          goto LABEL_18;
        }
      }
      else
      {
        v13 = nox_malloc(v17);
        *(_DWORD *)&byte_5D4594[1599616] = v13;
        if ( v13 )
        {
          v14 = v13;
LABEL_18:
          for ( i = 0; i < (int)v17; ++i )
          {
            sub_426AC0(&v16, 1u);
            if ( v1 )
              fwrite(&v16, 1u, 1u, v0);
            else
              *v14++ = v16;
          }
          if ( v0 )
            fclose(v0);
          return 1;
        }
      }
    }
    return 0;
  }
  if ( v1 && (v10 = fopen(v19, "rb"), (v11 = v10) != 0) )
  {
    fseek(v10, 0, 2);
    v17 = ftell(v11);
    fseek(v11, 0, 0);
    sub_426AC0(&v17, 4u);
    if ( (int)v17 > 0 )
    {
      do
      {
        fread(&v16, 1u, 1u, v11);
        sub_426AC0(&v16, 1u);
        ++v9;
      }
      while ( v9 < (int)v17 );
    }
    fclose(v11);
    result = 1;
  }
  else
  {
    v17 = 0;
    sub_426AC0(&v17, 4u);
    result = 1;
  }
  return result;
}
// 505080: using guessed type char var_400[1024];

//----- (00505360) --------------------------------------------------------
int sub_505360()
{
  int v1; // ebp
  unsigned __int8 *v3; // edi
  int v4; // eax
  size_t v5; // esi
  void *v6; // eax
  int v9; // eax
  int v10; // ebp
  int v12; // esi
  int v13; // ebp
  char *v14; // eax
  int v15; // ecx
  _BYTE *v16; // esi
  bool v17; // cf
  unsigned __int8 v18; // dl
  int v19; // eax
  char *v20; // eax
  char *v21; // eax
  char *v22; // eax
  int v23; // eax
  int v24; // eax
  int v25; // ecx
  int v26; // ecx
  int v27; // eax
  int v28; // ecx
  int v29; // edi
  int v30; // ebx
  int v31; // ecx
  int v32; // esi
  int i; // edi
  int v34; // ecx
  int v35; // esi
  char v36[2]; // [esp+12h] [ebp-40Ah]
  int v37; // [esp+14h] [ebp-408h]
  char v38[1024]; // [esp+1Ch] [ebp-400h]

  strcpy(v36, "%");
  *(_DWORD *)&byte_5D4594[1599620] = fopen((const char *)&byte_587000[229864], (const char *)&byte_587000[229860]);
  if ( !*(_DWORD *)&byte_5D4594[1599620] )
    return 0;
  if ( !sub_505870((const char *)&byte_587000[229872]) )
    goto LABEL_45;
  if ( !sub_505870((const char *)&byte_587000[229884]) )
    goto LABEL_9;
  v1 = 0;
  *(_DWORD *)&byte_5D4594[1599624] = sub_505800();
  *(_DWORD *)&byte_5D4594[1599632] = *(_DWORD *)&byte_5D4594[1599624];
  if ( *(_DWORD *)&byte_5D4594[1599624] > 0 )
  {
    v3 = &byte_5D4594[3831212];
    do
    {
      v4 = sub_505800();
      v5 = v4;
      v6 = nox_calloc(1u, v4 + 1);
      *(_DWORD *)v3 = v6;
      if ( !sub_505830(v5, v6) )
        goto LABEL_45;
      ++v1;
      v3 += 4;
    }
    while ( v1 < *(int *)&byte_5D4594[1599624] );
  }
  if ( !sub_505870((const char *)&byte_587000[229892]) )
  {
LABEL_9:
    fclose(*(FILE **)&byte_5D4594[1599620]);
    return 0;
  }
  v9 = sub_505800();
  *(_DWORD *)&byte_5D4594[1599640] = v9;
  if ( v9 )
  {
    *(_DWORD *)&byte_5D4594[1599636] = nox_calloc(1u, 48 * v9);
    v9 = *(_DWORD *)&byte_5D4594[1599640];
  }
  v10 = 0;
  v37 = 0;
  if ( v9 > 0 )
  {
    while ( sub_505870((const char *)&byte_587000[229900]) )
    {
      v12 = sub_505800();
      v13 = 48 * v10;
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13) = nox_calloc(1u, v12 + 1);
      if ( !sub_505830(v12, *(void **)(*(_DWORD *)&byte_5D4594[1599636] + v13)) )
        goto LABEL_51;
      if ( strlen(*(const char **)(*(_DWORD *)&byte_5D4594[1599636] + v13)) >= 0x400 )
        return 0;
      strcpy(v38, *(const char **)(*(_DWORD *)&byte_5D4594[1599636] + v13));
      v14 = strtok(v38, v36);
      v16 = *(_BYTE **)(*(_DWORD *)&byte_5D4594[1599636] + v13);
      while ( 1 )
      {
        LOBYTE(v15) = *v14;
        v17 = (unsigned __int8)*v14 < *v16;
        if ( *v14 != *v16 )
          break;
        if ( !(_BYTE)v15 )
          goto LABEL_23;
        v18 = v14[1];
        LOBYTE(v15) = v18;
        v17 = v18 < v16[1];
        if ( v18 != v16[1] )
          break;
        v14 += 2;
        v16 += 2;
        if ( !v18 )
        {
LABEL_23:
          v19 = 0;
          goto LABEL_25;
        }
      }
      v19 = -v17 - (v17 - 1);
LABEL_25:
      if ( v19 )
      {
        v20 = strtok(0, v36);
        nox_sprintf(v38, (const char *)&byte_587000[229908], v20);
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 36) = nox_calloc(1u, strlen(v38) + 1);
        strcpy(*(char **)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 36), v38);
        v21 = strtok(0, v36);
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 40) = atoi(v21);
        v22 = strtok(0, v36);
        v23 = atoi(v22);
        v15 = *(_DWORD *)&byte_5D4594[1599636];
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 44) = v23;
      }
      else
      {
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 36) = 0;
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 40) = 0;
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 44) = 0;
      }
      v24 = sub_505800();
      v25 = *(_DWORD *)&byte_5D4594[1599636];
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 4) = v24;
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 8) = sub_505800();
      if ( !sub_505870((const char *)&byte_587000[229916]) )
        goto LABEL_45;
      v27 = sub_505800();
      v29 = v37;
      v30 = v27;
      if ( !v37 )
        v30 = v27 + 1;
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 12) = v30;
      sub_505800();
      if ( v30 )
      {
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 20) = nox_calloc(1u, 4 * v30);
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 24) = nox_calloc(1u, 4 * v30);
      }
      else
      {
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 20) = 0;
        v31 = *(_DWORD *)&byte_5D4594[1599636];
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 24) = 0;
      }
      v32 = 0;
      if ( !v29 )
      {
        v32 = 1;
        **(_DWORD **)(*(_DWORD *)&byte_5D4594[1599636] + 20) = 0;
        v31 = *(_DWORD *)&byte_5D4594[1599636];
        **(_DWORD **)(*(_DWORD *)&byte_5D4594[1599636] + 24) = 0;
      }
      for ( i = 0; v32 < v30; ++v32 )
      {
        *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 20) + 4 * v32) = sub_505800();
        v31 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 24);
        *(_DWORD *)(v31 + 4 * v32) = i;
        i += *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 20) + 4 * v32);
      }
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 16) = i;
      if ( i )
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 28) = nox_calloc(1u, 4 * i);
      else
        *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 28) = 0;
      if ( !sub_505870((const char *)&byte_587000[229924]) )
        goto LABEL_9;
      v35 = sub_505800();
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 32) = nox_calloc(1u, v35);
      if ( fread(*(void **)(*(_DWORD *)&byte_5D4594[1599636] + v13 + 32), 1u, v35, *(FILE **)&byte_5D4594[1599620]) != v35 )
      {
LABEL_51:
        fclose(*(FILE **)&byte_5D4594[1599620]);
        return 0;
      }
      if ( ++v37 >= *(int *)&byte_5D4594[1599640] )
        goto LABEL_44;
      v10 = v37;
    }
    goto LABEL_9;
  }
LABEL_44:
  if ( !sub_505870((const char *)&byte_587000[229932]) )
  {
LABEL_45:
    fclose(*(FILE **)&byte_5D4594[1599620]);
    return 0;
  }
  fclose(*(FILE **)&byte_5D4594[1599620]);
  return 1;
}
// 5053BC: variable 'v0' is possibly undefined
// 5053D6: variable 'v2' is possibly undefined
// 505436: variable 'v7' is possibly undefined
// 505486: variable 'v11' is possibly undefined
// 505607: variable 'v15' is possibly undefined
// 50563A: variable 'v26' is possibly undefined
// 505655: variable 'v28' is possibly undefined
// 5056C8: variable 'v31' is possibly undefined
// 505749: variable 'v34' is possibly undefined

//----- (00505800) --------------------------------------------------------
int sub_505800()
{
  size_t v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v1 = fread(&v3, 4u, 1u, *(FILE **)&byte_5D4594[1599620]);
  return v1 == 1 ? v3 : 0;
}

//----- (00505830) --------------------------------------------------------
BOOL __cdecl sub_505830(size_t a1, void *a2)
{
  size_t v2; // eax

  v2 = fread(a2, 1u, a1, *(FILE **)&byte_5D4594[1599620]);
  *((_BYTE *)a2 + a1) = 0;
  return v2 == a1;
}

//----- (00505870) --------------------------------------------------------
BOOL __cdecl sub_505870(const char *a1)
{
  char v2[256]; // [esp+Ch] [ebp-100h]

  sub_505830(strlen(a1), v2);
  return strcmp(v2, a1) == 0;
}

//----- (005058F0) --------------------------------------------------------
char *sub_5058F0()
{
  int v0; // edi
  LPVOID *v1; // esi
  int v2; // eax
  int v3; // ebx
  LPVOID *v4; // esi
  int v5; // eax
  char *result; // eax
  int v7; // edi
  int v8; // esi

  v0 = *(_DWORD *)&byte_5D4594[1599624];
  if ( *(_DWORD *)&byte_5D4594[1599624] < *(int *)&byte_5D4594[1599632] )
  {
    v1 = (LPVOID *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[1599624] + 3831212];
    do
    {
      free(*v1);
      v2 = *(_DWORD *)&byte_5D4594[1599632];
      *v1 = 0;
      ++v0;
      ++v1;
    }
    while ( v0 < v2 );
    v0 = *(_DWORD *)&byte_5D4594[1599624];
  }
  if ( v0 )
  {
    v3 = 0;
    if ( v0 > 0 )
    {
      v4 = (LPVOID *)&byte_5D4594[3831212];
      do
      {
        free(*v4);
        v5 = *(_DWORD *)&byte_5D4594[1599624];
        *v4 = 0;
        ++v3;
        ++v4;
      }
      while ( v3 < v5 );
    }
  }
  result = *(char **)&byte_5D4594[1599636];
  *(_DWORD *)&byte_5D4594[1599624] = 0;
  *(_DWORD *)&byte_5D4594[1599628] = 0;
  *(_DWORD *)&byte_5D4594[1599632] = 0;
  if ( *(_DWORD *)&byte_5D4594[1599636] )
  {
    v7 = 0;
    if ( *(_DWORD *)&byte_5D4594[1599640] > 0 )
    {
      v8 = 0;
      do
      {
        if ( *(_DWORD *)&result[v8] )
        {
          free(*(LPVOID *)&result[v8]);
          result = *(char **)&byte_5D4594[1599636];
        }
        if ( *(_DWORD *)&result[v8 + 36] )
        {
          free(*(LPVOID *)&result[v8 + 36]);
          result = *(char **)&byte_5D4594[1599636];
        }
        if ( *(_DWORD *)&result[v8 + 20] )
        {
          free(*(LPVOID *)&result[v8 + 20]);
          result = *(char **)&byte_5D4594[1599636];
        }
        if ( *(_DWORD *)&result[v8 + 24] )
        {
          free(*(LPVOID *)&result[v8 + 24]);
          result = *(char **)&byte_5D4594[1599636];
        }
        if ( *(_DWORD *)&result[v8 + 28] )
        {
          free(*(LPVOID *)&result[v8 + 28]);
          result = *(char **)&byte_5D4594[1599636];
        }
        if ( *(_DWORD *)&result[v8 + 32] )
        {
          free(*(LPVOID *)&result[v8 + 32]);
          result = *(char **)&byte_5D4594[1599636];
        }
        ++v7;
        v8 += 48;
      }
      while ( v7 < *(int *)&byte_5D4594[1599640] );
    }
    free(result);
    *(_DWORD *)&byte_5D4594[1599636] = 0;
  }
  *(_DWORD *)&byte_5D4594[1599640] = 0;
  return result;
}

//----- (00505A40) --------------------------------------------------------
int sub_505A40()
{
  int v0; // edi
  char *v1; // eax
  FILE *v2; // eax
  FILE *v3; // esi
  FILE *v5; // esi
  int i; // ebx
  int j; // ebx
  char v8; // [esp+Bh] [ebp-9h]
  int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]

  v0 = 0;
  v10 = 1;
  v9 = 0;
  sub_426A30();
  v1 = sub_409E10();
  nox_sprintf((char *)&byte_5D4594[3830188], (const char *)&byte_587000[229940], v1);
  *(_DWORD *)&byte_5D4594[1599644] = 0;
  sub_426AC0(&v10, 2u);
  if ( (__int16)v10 < 1 )
    return 0;
  if ( !*(_DWORD *)&byte_5D4594[3803300] )
  {
    v2 = fopen((const char *)&byte_5D4594[3830188], (const char *)&byte_587000[229952]);
    v3 = v2;
    if ( !v2 )
    {
      v9 = 0;
      sub_426AC0(&v9, 4u);
      return 1;
    }
    fseek(v2, 0, 2);
    v9 = ftell(v3);
    fseek(v3, 0, 0);
    sub_426AC0(&v9, 4u);
    if ( v9 > 0 )
    {
      do
      {
        fread(&v8, 1u, 1u, v3);
        sub_426AC0(&v8, 1u);
        ++v0;
      }
      while ( v0 < v9 );
    }
    fclose(v3);
    return 1;
  }
  if ( *(_DWORD *)&byte_5D4594[3803300] != 1 )
    return 0;
  v5 = fopen((const char *)&byte_5D4594[3830188], (const char *)&byte_587000[229956]);
  if ( !v5 )
    return 0;
  sub_426AC0(&v9, 4u);
  *(_DWORD *)&byte_5D4594[1599644] = v9;
  if ( sub_40A5C0(0x400000) )
  {
    for ( i = 0; i < v9; ++i )
    {
      sub_426AC0(&v8, 1u);
      fwrite(&v8, 1u, 1u, v5);
    }
  }
  else
  {
    for ( j = 0; j < v9; ++j )
    {
      sub_426AC0(&v8, 1u);
      fwrite(&v8, 1u, 1u, v5);
    }
  }
  fclose(v5);
  if ( v9 <= 0 || sub_40A5C0(6291456) )
    return 1;
  return sub_505360();
}

//----- (00505C30) --------------------------------------------------------
int sub_505C30()
{
  char v0; // bp
  int v2; // ebx
  int i; // eax
  int v4; // esi
  int j; // eax
  int v6; // edi
  char v7; // al
  bool v8; // zf
  char *v9; // eax
  char *v10; // esi
  int v11; // edi
  int v12; // [esp+10h] [ebp-15Ch]
  int v13; // [esp+14h] [ebp-158h]
  char v14[2]; // [esp+1Ah] [ebp-152h]
  int v15; // [esp+1Ch] [ebp-150h]
  int v16; // [esp+20h] [ebp-14Ch]
  int v17; // [esp+24h] [ebp-148h]
  int v18; // [esp+28h] [ebp-144h]
  int v19[2]; // [esp+2Ch] [ebp-140h]
  int v21; // [esp+34h] [ebp-138h]
  int v22; // [esp+38h] [ebp-134h]
  char v23[76]; // [esp+3Ch] [ebp-130h]
  char v24[76]; // [esp+88h] [ebp-E4h]
  char v25[76]; // [esp+D4h] [ebp-98h]
  char v26[76]; // [esp+120h] [ebp-4Ch]

  v15 = 3;
  v0 = sub_426A30();
  sub_426AC0(&v15, 2u);
  if ( (__int16)v15 > 3 )
    return 0;
  v2 = 0;
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    v21 = 0;
    v22 = 0;
    sub_426AC0(&v13, 4u);
    if ( v13 <= 0 )
      return 1;
    while ( 1 )
    {
      sub_426AC0(&v17, 1u);
      sub_426AC0(v23, (unsigned __int8)v17);
      v8 = (_WORD)v15 == 2;
      if ( (__int16)v15 < 2 )
      {
        if ( strlen(sub_409B30()) + 1 + strlen(v23) >= 0x35 )
          return 0;
        v9 = sub_409B30();
        nox_sprintf(v25, (const char *)&byte_587000[229960], v9, v23);
        strcpy(v23, v25);
        v8 = (_WORD)v15 == 2;
      }
      if ( v8 )
      {
        strcpy(v14, ":");
        strcpy(v24, sub_409B30());
        *(_WORD *)&v24[strlen(v24)] = *(_WORD *)&byte_587000[229976];
        strcpy(v26, v23);
        strtok(v26, v14);
        v10 = strtok(0, v14);
        if ( strlen(sub_409B30()) + 1 + strlen(v10) >= 0x35 )
          return 0;
        strcat(v24, v10);
        strcpy(v23, v24);
      }
      sub_426AC0(&v18, 1u);
      sub_426AC0(&v16, 4u);
      if ( !(v0 & 4) )
      {
        if ( sub_40A5C0(0x400000) )
        {
          sub_504600(v23, v16, v18);
        }
        else if ( sub_40A5C0(2097153) )
        {
          sub_57C0C0(v23, v16, v18);
        }
      }
      sub_426AC0(&v12, 4u);
      v11 = 0;
      if ( v12 > 0 )
        break;
LABEL_44:
      if ( ++v2 >= v13 )
        return 1;
    }
    while ( 1 )
    {
      if ( (_BYTE)v18 )
      {
        if ( (_BYTE)v18 == 1 )
          goto LABEL_38;
        if ( (_BYTE)v18 != 2 )
        {
          if ( (_BYTE)v18 != 3 )
            return 0;
LABEL_38:
          sub_426AC0(&v19[0], 4u);
          goto LABEL_39;
        }
        sub_426AC0(&v19[0], 4u);
        sub_426AC0(&v19[1], 4u);
      }
      else
      {
        sub_426AC0(&v19[0], 4u);
      }
LABEL_39:
      if ( !(v0 & 4) )
      {
        if ( sub_40A5C0(0x400000) )
          sub_5046A0(v19, v16);
        else
          sub_57C130(v19, v16);
      }
      if ( ++v11 >= v12 )
        goto LABEL_44;
    }
  }
  v13 = 0;
  for ( i = sub_57C080(); i; i = sub_57C090(i) )
    ++v13;
  sub_426AC0(&v13, 4u);
  v4 = sub_57C080();
  if ( !v4 )
    return 1;
  do
  {
    LOBYTE(v17) = strlen((const char *)(v4 + 8)) + 1;
    sub_426AC0(&v17, 1u);
    sub_426AC0((_BYTE *)(v4 + 8), (unsigned __int8)v17);
    sub_426AC0((_BYTE *)v4, 1u);
    sub_426AC0((_BYTE *)(v4 + 4), 4u);
    v12 = 0;
    for ( j = *(_DWORD *)(v4 + 84); j; j = *(_DWORD *)(j + 8) )
      ++v12;
    sub_426AC0(&v12, 4u);
    v6 = *(_DWORD *)(v4 + 84);
    if ( v6 )
    {
      while ( 1 )
      {
        v7 = *(_BYTE *)v4;
        if ( !*(_BYTE *)v4 || v7 == 1 )
          goto LABEL_15;
        if ( v7 != 2 )
          break;
        sub_426AC0((_BYTE *)v6, 4u);
        sub_426AC0((_BYTE *)(v6 + 4), 4u);
LABEL_16:
        v6 = *(_DWORD *)(v6 + 8);
        if ( !v6 )
          goto LABEL_17;
      }
      if ( v7 != 3 )
        return 0;
LABEL_15:
      sub_426AC0((_BYTE *)v6, 4u);
      goto LABEL_16;
    }
LABEL_17:
    v4 = sub_57C090(v4);
  }
  while ( v4 );
  return 1;
}
// 505C30: using guessed type char var_E4[76];

//----- (005060D0) --------------------------------------------------------
int sub_5060D0()
{
  int j; // eax
  char *v2; // esi
  int i; // esi
  size_t v4; // [esp+0h] [ebp-15Ch]
  int v5; // [esp+4h] [ebp-158h]
  int v6; // [esp+8h] [ebp-154h]
  char v7[80]; // [esp+Ch] [ebp-150h]
  char v8[256]; // [esp+5Ch] [ebp-100h]

  v6 = 1;
  sub_426AC0(&v6, 2u);
  if ( (__int16)v6 < 1 )
    return 0;
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    sub_426AC0(&v5, 4u);
    for ( i = 0; i < v5; ++i )
    {
      sub_426AC0(&v4, 4u);
      sub_426AC0(v7, v4);
      sub_426AC0(&v4, 4u);
      sub_426AC0(v8, v4);
      if ( !sub_40A5C0(0x400000) && sub_40A5C0(1) )
        sub_57C500(v7, v8);
    }
    return 1;
  }
  v5 = 0;
  for ( j = sub_57C3E0(); j; j = sub_57C3F0(j) )
    ++v5;
  sub_426AC0(&v5, 4u);
  v2 = (char *)sub_57C3E0();
  if ( !v2 )
    return 1;
  do
  {
    v4 = strlen(v2);
    ++v4;
    sub_426AC0(&v4, 4u);
    sub_426AC0(v2, v4);
    v4 = strlen(v2 + 80);
    ++v4;
    sub_426AC0(&v4, 4u);
    sub_426AC0(v2 + 80, v4);
    v2 = (char *)sub_57C3F0((int)v2);
  }
  while ( v2 );
  return 1;
}

//----- (00506260) --------------------------------------------------------
int __cdecl sub_506260(_DWORD *a1)
{
  float *v2; // esi
  _DWORD *v3; // edi
  char *v4; // esi
  int v5; // ebx
  _BYTE *v6; // edi
  char *v7; // esi
  char **v8; // eax
  char *v9; // ebp
  _BYTE *v10; // esi
  int v11; // ebx
  _BYTE *v12; // ebp
  _BYTE *v13; // edi
  int v14; // ebx
  _BYTE *v15; // ebp
  _BYTE *v16; // edi
  float *v17; // [esp+10h] [ebp-9Ch]
  int v18; // [esp+14h] [ebp-98h]
  int v19; // [esp+18h] [ebp-94h]
  int v20; // [esp+1Ch] [ebp-90h]
  unsigned int v21; // [esp+20h] [ebp-8Ch]
  float v22; // [esp+24h] [ebp-88h]
  float v23; // [esp+28h] [ebp-84h]
  int v24; // [esp+2Ch] [ebp-80h]
  int v25; // [esp+30h] [ebp-7Ch]
  int2 v26; // [esp+34h] [ebp-78h]
  int v27; // [esp+3Ch] [ebp-70h]
  __int64 v28; // [esp+40h] [ebp-6Ch]
  __int64 v29; // [esp+48h] [ebp-64h]
  int4 v30; // [esp+50h] [ebp-5Ch]
  char v31[76]; // [esp+60h] [ebp-4Ch]

  v18 = 4;
  sub_426AC0(&v18, 2u);
  if ( (__int16)v18 > 4 )
    return 0;
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    sub_426AC0(&v19, 4u);
    v24 = 0;
    if ( v19 > 0 )
    {
      while ( 1 )
      {
        sub_426AC0(&v25, 4u);
        if ( (__int16)v18 < 4 )
        {
          sub_426AC0(&v21, 4u);
          v28 = v21;
          v22 = (double)v21;
          sub_426AC0(&v21, 4u);
          v29 = v21;
          v23 = (double)v21;
        }
        else
        {
          sub_426AC0(&v22, 4u);
          sub_426AC0(&v23, 4u);
        }
        if ( (__int16)v18 >= 3 )
        {
          sub_426AC0(&v20, 1u);
          if ( (_BYTE)v20 )
          {
            sub_426AC0(v31, (unsigned __int8)v20);
            v31[(unsigned __int8)v20] = 0;
          }
          else
          {
            v31[0] = byte_5D4594[1599648];
          }
        }
        if ( a1 )
        {
          v7 = sub_426A70();
          sub_428170(a1, &v30);
          v22 = v22 - (double)(int)(23 * *(_DWORD *)v7) + (double)v30.field_0 - 11.0;
          v23 = v23 - (double)(int)(23 * *((_DWORD *)v7 + 1)) + (double)v30.field_4 - 11.0;
        }
        if ( sub_40A5C0(0x400000) )
        {
          v8 = (char **)sub_5044B0(v25, v22, v23);
          v9 = *v8;
          v17 = (float *)*v8;
        }
        else
        {
          v17 = sub_579970(v25, v22, v23);
          v9 = (char *)v17;
        }
        if ( !v9 )
          break;
        if ( (__int16)v18 >= 3 )
          strcpy(v9 + 16, v31);
        sub_426AC0(v9 + 480, 4u);
        if ( (__int16)v18 < 4 )
        {
          sub_426AC0(&v21, 4u);
          v10 = v9 + 476;
          v9[476] = v21;
        }
        else
        {
          v10 = v9 + 476;
          sub_426AC0(v9 + 476, 1u);
        }
        if ( (__int16)v18 >= 2 )
        {
          v14 = 0;
          if ( *v10 )
          {
            v15 = v9 + 96;
            v16 = v17 + 87;
            do
            {
              sub_426AC0(v16, 4u);
              sub_426AC0(v15, 1u);
              ++v14;
              v16 += 4;
              v15 += 8;
            }
            while ( v14 < (unsigned __int8)*v10 );
          }
        }
        else
        {
          v11 = 0;
          if ( *v10 )
          {
            v12 = v9 + 96;
            v13 = v17 + 87;
            do
            {
              sub_426AC0(v13, 4u);
              *v12 = 2;
              ++v11;
              v13 += 4;
              v12 += 8;
            }
            while ( v11 < (unsigned __int8)*v10 );
          }
        }
        if ( ++v24 >= v19 )
          return 1;
      }
      return 0;
    }
    return 1;
  }
  v19 = 0;
  v2 = (float *)sub_579860();
  if ( v2 )
  {
    do
    {
      v3 = a1;
      if ( !a1 || (v26.field_0 = (__int64)v2[2], v26.field_4 = (__int64)v2[3], sub_427F30(&v26, a1)) )
        ++v19;
      v2 = (float *)sub_579870((int)v2);
    }
    while ( v2 );
  }
  else
  {
    v3 = a1;
  }
  sub_426AC0(&v19, 4u);
  v4 = (char *)sub_579860();
  if ( !v4 )
    return 1;
  do
  {
    if ( !v3
      || (v26.field_0 = (__int64)*((float *)v4 + 2), v26.field_4 = (__int64)*((float *)v4 + 3), sub_427F30(&v26, v3)) )
    {
      sub_426AC0(v4, 4u);
      sub_426AC0(v4 + 8, 4u);
      sub_426AC0(v4 + 12, 4u);
      LOBYTE(v20) = strlen(v4 + 16);
      sub_426AC0(&v20, 1u);
      sub_426AC0(v4 + 16, (unsigned __int8)v20);
      v27 = *((_DWORD *)v4 + 120) & 1;
      sub_426AC0(&v27, 4u);
      sub_426AC0(v4 + 476, 1u);
      v5 = 0;
      if ( v4[476] )
      {
        v6 = v4 + 96;
        do
        {
          sub_426AC0(*((_BYTE **)v6 - 1), 4u);
          sub_426AC0(v6, 1u);
          ++v5;
          v6 += 8;
        }
        while ( v5 < (unsigned __int8)v4[476] );
      }
      v3 = a1;
    }
    v4 = (char *)sub_579870((int)v4);
  }
  while ( v4 );
  return 1;
}
// 506260: using guessed type char var_4C[76];

//----- (005066D0) --------------------------------------------------------
int sub_5066D0()
{
  int result; // eax

  result = sub_413FE0((const char *)&byte_587000[229996], 52, 64);
  *(_DWORD *)&byte_5D4594[1599652] = result;
  if ( result )
  {
    *(_DWORD *)&byte_5D4594[1599656] = 0;
    result = 1;
  }
  return result;
}

//----- (00506700) --------------------------------------------------------
void sub_506700()
{
  sub_4144D0(*(_DWORD **)&byte_5D4594[1599652]);
  *(_DWORD *)&byte_5D4594[1599656] = 0;
}

//----- (00506720) --------------------------------------------------------
int sub_506720()
{
  int result; // eax

  sub_414100(*(LPVOID *)&byte_5D4594[1599652]);
  result = 0;
  *(_DWORD *)&byte_5D4594[1599652] = 0;
  *(_DWORD *)&byte_5D4594[1599656] = 0;
  return result;
}

//----- (00506740) --------------------------------------------------------
int __cdecl sub_506740(int a1)
{
  int result; // eax
  int v2; // esi
  int v3; // ecx
  int v4; // edi

  result = a1;
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      result = *(_DWORD *)&byte_5D4594[1599656];
      v2 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064);
      if ( *(_DWORD *)&byte_5D4594[1599656] )
      {
        do
        {
          v3 = *(_DWORD *)(result + 8);
          v4 = *(_DWORD *)(result + 44);
          if ( v3 & v2 )
          {
            *(_DWORD *)(result + 8) = ~v2 & v3;
            --*(_BYTE *)(result + 4);
          }
          if ( !*(_BYTE *)(result + 4) )
            sub_5067B0(result);
          result = v4;
        }
        while ( v4 );
      }
    }
  }
  return result;
}

//----- (005067B0) --------------------------------------------------------
void __cdecl sub_5067B0(int a1)
{
  int v1; // esi

  if ( a1 )
  {
    if ( *(_DWORD *)a1 == 2 )
    {
      v1 = 0;
      do
      {
        if ( (1 << v1) & *(_DWORD *)(a1 + 8) )
          sub_506840(v1);
        ++v1;
      }
      while ( v1 < 32 );
    }
    sub_506810(a1);
    sub_414330(*(unsigned int **)&byte_5D4594[1599652], (_QWORD *)a1);
    if ( !*(_DWORD *)&byte_5D4594[1599656] )
      sub_507190(255, 0);
  }
}

//----- (00506810) --------------------------------------------------------
int __cdecl sub_506810(int a1)
{
  int result; // eax
  int v2; // ecx
  int v3; // ecx

  result = a1;
  v2 = *(_DWORD *)(a1 + 44);
  if ( v2 )
    *(_DWORD *)(v2 + 48) = *(_DWORD *)(a1 + 48);
  v3 = *(_DWORD *)(a1 + 48);
  if ( v3 )
  {
    result = *(_DWORD *)(a1 + 44);
    *(_DWORD *)(v3 + 44) = result;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[1599656] = *(_DWORD *)(a1 + 44);
  }
  return result;
}

//----- (00506840) --------------------------------------------------------
int __cdecl sub_506840(int a1)
{
  char v2[2]; // [esp+0h] [ebp-2h]

  v2[0] = -18;
  v2[1] = 7;
  return sub_4E5390(a1, (int)v2, 2, 0, 1);
}

//----- (00506870) --------------------------------------------------------
char __cdecl sub_506870(int a1, int a2, wchar_t *a3)
{
  char result; // al

  result = a2;
  if ( a2 && *(_BYTE *)(a2 + 8) & 4 )
  {
    switch ( a1 )
    {
      case 0:
        result = sub_5068E0(0, a2, a3);
        break;
      case 1:
        result = sub_5068E0(1, a2, a3);
        break;
      case 2:
        result = (unsigned int)sub_506B00(2, a2);
        break;
      case 3:
        result = (unsigned int)sub_506B80(3, a2, a3);
        break;
      default:
        return result;
    }
  }
  return result;
}

//----- (005068E0) --------------------------------------------------------
char __cdecl sub_5068E0(int a1, int a2, wchar_t *a3)
{
  int v3; // eax
  int v4; // ebp
  int v5; // esi
  int v6; // edi
  int v7; // esi

  LOBYTE(v3) = byte_587000[229980];
  if ( *(_DWORD *)&byte_587000[229980] <= 0x20u )
  {
    if ( *(_DWORD *)&byte_587000[229980] )
    {
      if ( a3 )
      {
        if ( a2 )
        {
          v4 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 2064);
          v3 = sub_416EA0();
          v5 = v3;
          if ( v3 )
          {
            while ( 1 )
            {
              if ( *(_DWORD *)(v5 + 2092) == 1 )
              {
                v3 = nox_wcscmp((const wchar_t *)(v5 + 4704), a3);
                if ( !v3 )
                  break;
              }
              v3 = sub_416EE0(v5);
              v5 = v3;
              if ( !v3 )
                return v3;
            }
            if ( *(_BYTE *)(v5 + 2064) != 31 )
            {
              v6 = *(_DWORD *)(v5 + 2056);
              if ( v6 )
              {
                if ( a2 != v6 )
                {
                  if ( !sub_417DA0(4) || (v3 = sub_419150(a2 + 48, v6 + 48)) != 0 )
                  {
                    v7 = *(_DWORD *)&byte_5D4594[1599656];
                    if ( !*(_DWORD *)&byte_5D4594[1599656] )
                      goto LABEL_21;
                    while ( *(_DWORD *)v7 != a1 || *(_DWORD *)(v7 + 28) != v6 )
                    {
                      v7 = *(_DWORD *)(v7 + 44);
                      if ( !v7 )
                        goto LABEL_21;
                    }
                    if ( !v7 )
                    {
LABEL_21:
                      v3 = sub_506A20(a1, a2);
                      v7 = v3;
                      if ( !v3 )
                        return v3;
                      *(_DWORD *)(v3 + 28) = v6;
                      if ( sub_417DA0(4) )
                        *(_DWORD *)(v7 + 20) = 1;
                    }
                    v3 = *(_DWORD *)(v7 + 8);
                    if ( !(v4 & v3) )
                    {
                      LOBYTE(v3) = *(_BYTE *)(v7 + 4) + 1;
                      *(_DWORD *)(v7 + 8) |= v4;
                      *(_BYTE *)(v7 + 4) = v3;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return v3;
}

//----- (00506A20) --------------------------------------------------------
_DWORD *__cdecl sub_506A20(int a1, int a2)
{
  int v2; // ebx
  _DWORD *v3; // esi

  v2 = 0;
  if ( !a2 || !(*(_BYTE *)(a2 + 8) & 4) )
    return 0;
  if ( !*(_DWORD *)&byte_5D4594[1599656] )
    v2 = 1;
  v3 = sub_4142F0(*(_DWORD **)&byte_5D4594[1599652]);
  if ( !v3 )
    return 0;
  *v3 = a1;
  v3[6] = *(_DWORD *)&byte_5D4594[2598000];
  v3[4] = a2 + 48;
  switch ( a1 )
  {
    case 0:
    case 1:
      *((_BYTE *)v3 + 12) = byte_587000[229980];
      break;
    case 2:
    case 3:
      *((_BYTE *)v3 + 12) = 6;
      break;
    default:
      *((_BYTE *)v3 + 12) = byte_587000[229984];
      break;
  }
  sub_506AD0((int)v3);
  if ( v2 )
    sub_507190(255, 1);
  return v3;
}

//----- (00506AD0) --------------------------------------------------------
int __cdecl sub_506AD0(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 44) = *(_DWORD *)&byte_5D4594[1599656];
  if ( *(_DWORD *)&byte_5D4594[1599656] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599656] + 48) = a1;
  *(_DWORD *)&byte_5D4594[1599656] = a1;
  return result;
}

//----- (00506B00) --------------------------------------------------------
_DWORD *__cdecl sub_506B00(int a1, int a2)
{
  _DWORD *result; // eax
  int v3; // esi
  char v4; // cl

  result = *(_DWORD **)&byte_587000[229988];
  if ( *(_DWORD *)&byte_587000[229988] )
  {
    if ( a2 )
    {
      result = *(_DWORD **)(*(_DWORD *)(a2 + 748) + 276);
      v3 = 1 << *((_BYTE *)result + 2064);
      if ( result[1198] )
      {
        result = *(_DWORD **)&byte_5D4594[1599656];
        if ( !*(_DWORD *)&byte_5D4594[1599656] )
          goto LABEL_9;
        while ( *result != a1 )
        {
          result = (_DWORD *)result[11];
          if ( !result )
            goto LABEL_9;
        }
        if ( !result )
        {
LABEL_9:
          result = sub_506A20(a1, a2);
          if ( !result )
            return result;
          result[5] = 0;
        }
        if ( !(result[2] & v3) )
        {
          v4 = *((_BYTE *)result + 4) + 1;
          result[2] |= v3;
          *((_BYTE *)result + 4) = v4;
        }
      }
    }
  }
  return result;
}

//----- (00506B80) --------------------------------------------------------
_DWORD *__cdecl sub_506B80(int a1, int a2, wchar_t *a3)
{
  _DWORD *result; // eax
  int v4; // edi
  const wchar_t *v5; // esi
  int v6; // esi
  char v7; // cl

  result = *(_DWORD **)&byte_587000[229992];
  if ( *(_DWORD *)&byte_587000[229992] )
  {
    if ( a3 )
    {
      result = (_DWORD *)a2;
      if ( a2 )
      {
        result = *(_DWORD **)(*(_DWORD *)(a2 + 748) + 276);
        v4 = 1 << *((_BYTE *)result + 2064);
        if ( result[1198] )
        {
          result = sub_416EA0();
          v5 = (const wchar_t *)result;
          if ( result )
          {
            while ( 1 )
            {
              if ( *((_DWORD *)v5 + 523) == 1 )
              {
                result = (_DWORD *)nox_wcscmp(v5 + 2352, a3);
                if ( !result )
                  break;
              }
              result = sub_416EE0((int)v5);
              v5 = (const wchar_t *)result;
              if ( !result )
                return result;
            }
            if ( *((_BYTE *)v5 + 2064) != 31 )
            {
              result = (_DWORD *)*((_DWORD *)v5 + 1198);
              if ( result )
              {
                v6 = *((_DWORD *)v5 + 514);
                if ( v6 )
                {
                  if ( a2 != v6 )
                  {
                    result = *(_DWORD **)&byte_5D4594[1599656];
                    if ( !*(_DWORD *)&byte_5D4594[1599656] )
                      goto LABEL_20;
                    while ( *result != a1 || result[7] != v6 )
                    {
                      result = (_DWORD *)result[11];
                      if ( !result )
                        goto LABEL_20;
                    }
                    if ( !result )
                    {
LABEL_20:
                      result = sub_506A20(a1, a2);
                      if ( !result )
                        return result;
                      result[7] = v6;
                    }
                    if ( !(result[2] & v4) )
                    {
                      v7 = *((_BYTE *)result + 4) + 1;
                      result[2] |= v4;
                      *((_BYTE *)result + 4) = v7;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (00506C90) --------------------------------------------------------
void __cdecl sub_506C90(int a1, int a2, wchar_t *a3)
{
  if ( a2 && *(_BYTE *)(a2 + 8) & 4 )
  {
    switch ( a1 )
    {
      case 0:
        sub_506D00(a2, a3);
        break;
      case 1:
        sub_506D00(a2, a3);
        break;
      case 2:
        sub_506DE0(a2);
        break;
      case 3:
        sub_506E50(a2, a3);
        break;
      default:
        return;
    }
  }
}

//----- (00506D00) --------------------------------------------------------
void __cdecl sub_506D00(int a1, wchar_t *a2)
{
  char *v2; // esi
  int v3; // esi
  int v4; // eax
  int v5; // edx
  int v6; // esi
  bool v7; // zf

  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 4 )
      {
        v2 = sub_416EA0();
        if ( v2 )
        {
          while ( *((_DWORD *)v2 + 523) != 1 || nox_wcscmp((const wchar_t *)v2 + 2352, a2) )
          {
            v2 = sub_416EE0((int)v2);
            if ( !v2 )
              return;
          }
          if ( v2[2064] != 31 )
          {
            v3 = *((_DWORD *)v2 + 514);
            if ( v3 )
            {
              v4 = *(_DWORD *)&byte_5D4594[1599656];
              v5 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064);
              if ( *(_DWORD *)&byte_5D4594[1599656] )
              {
                while ( *(_DWORD *)v4 || *(_DWORD *)(v4 + 28) != v3 || !(v5 & *(_DWORD *)(v4 + 8)) )
                {
                  v4 = *(_DWORD *)(v4 + 44);
                  if ( !v4 )
                    return;
                }
                if ( v4 )
                {
                  v6 = ~v5 & *(_DWORD *)(v4 + 8);
                  v7 = (*(_BYTE *)(v4 + 4))-- == 1;
                  *(_DWORD *)(v4 + 8) = v6;
                  if ( v7 )
                    sub_5067B0(v4);
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (00506DE0) --------------------------------------------------------
void __cdecl sub_506DE0(int a1)
{
  int result;
  int v2; // edx
  char v3; // cl
  int v4; // esi

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      result = *(_DWORD *)&byte_5D4594[1599656];
      v2 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064);
      if ( *(_DWORD *)&byte_5D4594[1599656] )
      {
        while ( *(_DWORD *)result != 2 )
        {
          result = *(_DWORD *)(result + 44);
          if ( !result )
            return;
        }
        if ( result && v2 & *(_DWORD *)(result + 8) )
        {
          v3 = *(_BYTE *)(result + 4) - 1;
          v4 = ~v2 & *(_DWORD *)(result + 8);
          *(_BYTE *)(result + 4) = v3;
          *(_DWORD *)(result + 8) = v4;
          if ( !v3 )
            sub_5067B0(result);
        }
      }
    }
  }
}

//----- (00506E50) --------------------------------------------------------
void __cdecl sub_506E50(int a1, wchar_t *a2)
{
  char *v2; // esi
  int v3; // esi
  int v4; // eax
  int v5; // edx
  int v6; // esi
  bool v7; // zf

  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 4 )
      {
        v2 = sub_416EA0();
        if ( v2 )
        {
          while ( *((_DWORD *)v2 + 523) != 1 || nox_wcscmp((const wchar_t *)v2 + 2352, a2) )
          {
            v2 = sub_416EE0((int)v2);
            if ( !v2 )
              return;
          }
          if ( v2[2064] != 31 )
          {
            v3 = *((_DWORD *)v2 + 514);
            if ( v3 )
            {
              v4 = *(_DWORD *)&byte_5D4594[1599656];
              v5 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064);
              if ( *(_DWORD *)&byte_5D4594[1599656] )
              {
                while ( *(_DWORD *)v4 != 3 || *(_DWORD *)(v4 + 28) != v3 || !(v5 & *(_DWORD *)(v4 + 8)) )
                {
                  v4 = *(_DWORD *)(v4 + 44);
                  if ( !v4 )
                    return;
                }
                if ( v4 )
                {
                  v6 = ~v5 & *(_DWORD *)(v4 + 8);
                  v7 = (*(_BYTE *)(v4 + 4))-- == 1;
                  *(_DWORD *)(v4 + 8) = v6;
                  if ( v7 )
                    sub_5067B0(v4);
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (00506F30) --------------------------------------------------------
_DWORD *sub_506F30()
{
  _DWORD *result; // eax
  _DWORD *v1; // esi

  result = *(_DWORD **)&byte_5D4594[1599656];
  if ( *(_DWORD *)&byte_5D4594[1599656] )
  {
    do
    {
      v1 = (_DWORD *)result[11];
      switch ( *result )
      {
        case 0:
        case 1:
          sub_506F80((int)result);
          break;
        case 2:
          sub_507090((int)result);
          break;
        case 3:
          sub_507100((int)result);
          break;
        default:
          break;
      }
      result = v1;
    }
    while ( v1 );
  }
  return result;
}

//----- (00506F80) --------------------------------------------------------
void __cdecl sub_506F80(int a1)
{
  int v1; // esi
  int v3; // esi

  v1 = *(_DWORD *)(a1 + 28);
  if ( *(_BYTE *)(v1 + 16) & 0x20 )
  {
    sub_5067B0(a1);
    return;
  }
  *(_DWORD *)(a1 + 16) = v1 + 48;
  if ( sub_507000(a1) == 1 )
  {
    v3 = *(_DWORD *)(v1 + 748);
    sub_4DEAB0(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), 4);
    sub_416770(15, (wchar_t *)(*(_DWORD *)(v3 + 276) + 4704), (const char *)(*(_DWORD *)(v3 + 276) + 2112));
    sub_5067B0(a1);
  }
}

//----- (00507000) --------------------------------------------------------
BOOL __cdecl sub_507000(int a1)
{
  int v1; // edi
  int i; // esi
  int j; // eax

  v1 = 0;
  if ( *(_BYTE *)(a1 + 4) >= *(_BYTE *)(a1 + 12) )
    return 1;
  if ( *(_DWORD *)(a1 + 20) == 1 )
  {
    for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
    {
      if ( sub_419150(*(_DWORD *)(a1 + 16), i + 48) )
        ++v1;
    }
  }
  else
  {
    for ( j = sub_4DA7C0(); j; j = sub_4DA7F0(j) )
      ++v1;
  }
  return *(unsigned __int8 *)(a1 + 4) >= (unsigned int)(v1 - 1) && *(_BYTE *)(a1 + 4) >= 2u;
}

//----- (00507090) --------------------------------------------------------
void __cdecl sub_507090(int a1)
{
  int i; // esi
  int v3; // eax
  char *v4; // eax

  sub_4E3CE0();
  if ( *(unsigned __int8 *)(a1 + 4) >= sub_4E3CE0() )
  {
    for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
    {
      v3 = *(_DWORD *)(*(_DWORD *)(i + 748) + 276);
      if ( *(_DWORD *)(v3 + 4792) == 1 )
        sub_4F7EF0(*(_DWORD *)(v3 + 2056));
    }
    sub_4E3CD0(0);
    v4 = sub_4D0F60();
    sub_4D2450(v4);
    sub_5067B0(a1);
  }
}

//----- (00507100) --------------------------------------------------------
void __cdecl sub_507100(int a1)
{
  int v1; // edi
  int v2; // ebx
  unsigned int v3; // eax
  unsigned int result; // eax

  v1 = *(_DWORD *)(a1 + 28);
  if ( !v1 )
  {
    sub_5067B0(a1);
    return;
  }
  if ( *(_BYTE *)(v1 + 16) & 0x20 )
  {
    sub_5067B0(a1);
    return;
  }
  v2 = *(_DWORD *)(v1 + 748);
  if ( !*(_DWORD *)(*(_DWORD *)(v2 + 276) + 4792) )
  {
    sub_5067B0(a1);
    return;
  }
  if ( *(_BYTE *)(a1 + 4) >= *(_BYTE *)(a1 + 12) )
  {
LABEL_8:
    sub_4DCFB0(v1);
    sub_416770(15, (wchar_t *)(*(_DWORD *)(v2 + 276) + 4704), (const char *)(*(_DWORD *)(v2 + 276) + 2112));
    sub_5067B0(a1);
    return;
  }
  v3 = sub_4E3CE0();
  if ( v3 <= 1 )
  {
    sub_5067B0(a1);
    return;
  }
  result = v3 - 1;
  if ( *(unsigned __int8 *)(a1 + 4) >= result && *(_BYTE *)(a1 + 4) >= 2u )
    goto LABEL_8;
}

//----- (00507190) --------------------------------------------------------
int __cdecl sub_507190(int a1, char a2)
{
  int v2; // ecx
  char v4[3]; // [esp+0h] [ebp-4h]
  char v5; // [esp+3h] [ebp-1h]

  v5 = HIBYTE(v2);
  v4[0] = -18;
  v4[1] = 6;
  v4[2] = a2;
  return sub_4E5390(a1, (int)v4, 3, 0, 1);
}

//----- (005071C0) --------------------------------------------------------
BOOL sub_5071C0()
{
  return *(_DWORD *)&byte_5D4594[1599656] != 0;
}

//----- (005071D0) --------------------------------------------------------
int __cdecl sub_5071D0(const char *a1)
{
  int v1; // ebp
  const char **i; // edi

  v1 = 0;
  if ( *(int *)&byte_5D4594[1599640] <= 0 )
    return -1;
  for ( i = *(const char ***)&byte_5D4594[1599636]; strcmp(*i, a1); i += 12 )
  {
    if ( ++v1 >= *(int *)&byte_5D4594[1599640] )
      return -1;
  }
  return v1;
}

//----- (00507230) --------------------------------------------------------
int __cdecl sub_507230(int a1)
{
  int result; // eax

  result = *(_DWORD *)&byte_5D4594[1599660];
  if ( *(int *)&byte_5D4594[1599660] < 1024 )
  {
    *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[1599660] + 3821996] = a1;
    *(_DWORD *)&byte_5D4594[1599660] = ++result;
  }
  return result;
}

//----- (00507250) --------------------------------------------------------
int script_pop()
{
  int v0; // eax

  v0 = *(_DWORD *)&byte_5D4594[1599660];
  if ( *(_DWORD *)&byte_5D4594[1599660] > 0 )
    v0 = --*(_DWORD *)&byte_5D4594[1599660];
  return *(_DWORD *)&byte_5D4594[4 * v0 + 3821996];
}

//----- (00507270) --------------------------------------------------------
int __cdecl sub_507270(int **a1)
{
  int result; // eax

  result = **a1;
  ++*a1;
  return result;
}

//----- (00507280) --------------------------------------------------------
double __cdecl sub_507280(float **a1)
{
  double result; // st7

  result = **a1;
  ++*a1;
  return result;
}

//----- (00507290) --------------------------------------------------------
LPVOID sub_507290()
{
  LPVOID result; // eax

  *(_DWORD *)&byte_5D4594[3821640] = 0;
  byte_5D4594[3821644] = byte_5D4594[1599668];
  result = *(LPVOID *)&byte_5D4594[1599636];
  *(_DWORD *)&byte_5D4594[3821636] = 0;
  if ( *(_DWORD *)&byte_5D4594[1599636] )
  {
    **(_DWORD **)(*(_DWORD *)&byte_5D4594[1599636] + 76) = -2;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4) = -1;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 8) = 1;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 12) = 0;
    result = (LPVOID)sub_4DB240();
    if ( !result )
      result = (LPVOID)sub_507310(1, 0, 0);
  }
  return result;
}

//----- (00507310) --------------------------------------------------------
int __cdecl sub_507310(int a1, int a2, int a3)
{
  int v3; // ebx
  int v4; // eax
  int v5; // ebp
  int v6; // esi
  int v7; // ecx
  int v8; // edx
  int v9; // esi
  int v10; // eax
  int v11; // esi
  int v12; // eax
  double v13; // st7
  int v14; // edi
  int v15; // eax
  int v16; // ecx
  int v17; // esi
  int v18; // eax
  int v19; // eax
  int v20; // esi
  int v21; // eax
  double v22; // st7
  int v23; // esi
  int v24; // eax
  int v25; // eax
  int v26; // esi
  int v27; // eax
  int v28; // esi
  int v29; // eax
  int v30; // esi
  int v31; // eax
  int v32; // esi
  int v33; // eax
  int v34; // esi
  int v35; // eax
  int v36; // esi
  int v37; // eax
  int v38; // esi
  int v39; // eax
  char v40; // si
  int v41; // eax
  char v42; // si
  int v43; // eax
  int v44; // esi
  int v45; // esi
  int v46; // edi
  int v47; // esi
  float v48; // edi
  int v49; // esi
  int v50; // edi
  int v51; // esi
  int v52; // esi
  int v53; // edx
  double v54; // st7
  float *v55; // eax
  int v56; // eax
  double v57; // st7
  float *v58; // eax
  int v59; // ecx
  float *v60; // eax
  double v61; // st7
  int v62; // ebp
  int v63; // edi
  int v64; // ebx
  int v65; // esi
  int v66; // eax
  int v67; // eax
  int v68; // edi
  int v69; // esi
  int v70; // esi
  int v71; // ecx
  float *v72; // eax
  double v73; // st7
  int v74; // edi
  int v75; // esi
  int v76; // edx
  int v77; // eax
  int v78; // edi
  int v79; // esi
  int v80; // esi
  int v81; // esi
  int v82; // edi
  int v83; // esi
  int v84; // esi
  char v85; // di
  int v86; // esi
  char v87; // di
  int v88; // esi
  int v89; // edi
  int v90; // esi
  int v91; // edi
  int v92; // esi
  int v93; // edi
  int v94; // esi
  int v95; // esi
  int v96; // eax
  int v97; // esi
  int v98; // esi
  int v99; // eax
  int v100; // esi
  int v101; // kr00_4
  int v102; // esi
  int v103; // eax
  int v104; // esi
  int v105; // kr04_4
  int v106; // esi
  int v107; // eax
  int v108; // esi
  int v109; // kr08_4
  int v110; // esi
  int v111; // eax
  int v112; // esi
  int v113; // kr0C_4
  int v114; // esi
  int v115; // eax
  int v116; // esi
  int v117; // esi
  int v118; // esi
  int v119; // edi
  int v120; // esi
  int v121; // ebx
  int v122; // eax
  int v123; // esi
  int v124; // esi
  int result; // eax
  int v126; // eax
  int v127; // edi
  int v128; // esi
  int v129; // ebx
  int v130; // eax
  int v131; // esi
  int v132; // edi
  int v133; // ebx
  int v134; // eax
  int v135; // eax
  int v136; // eax
  int v137; // eax
  int v138; // eax
  int v139; // eax
  int v140; // [esp+10h] [ebp-118h]
  float v141; // [esp+10h] [ebp-118h]
  float v142; // [esp+10h] [ebp-118h]
  int v143; // [esp+10h] [ebp-118h]
  float v144; // [esp+10h] [ebp-118h]
  int v145; // [esp+10h] [ebp-118h]
  float v146; // [esp+10h] [ebp-118h]
  float v147; // [esp+10h] [ebp-118h]
  float v148; // [esp+10h] [ebp-118h]
  float v149; // [esp+10h] [ebp-118h]
  float v150; // [esp+10h] [ebp-118h]
  float v151; // [esp+10h] [ebp-118h]
  float v152; // [esp+10h] [ebp-118h]
  float v153; // [esp+10h] [ebp-118h]
  float v154; // [esp+10h] [ebp-118h]
  float v155; // [esp+10h] [ebp-118h]
  float v156; // [esp+10h] [ebp-118h]
  float v157; // [esp+10h] [ebp-118h]
  int v158; // [esp+10h] [ebp-118h]
  float v159; // [esp+10h] [ebp-118h]
  int v160; // [esp+18h] [ebp-110h]
  int v161; // [esp+1Ch] [ebp-10Ch]
  int v162; // [esp+20h] [ebp-108h]
  int v163; // [esp+24h] [ebp-104h]
  char v164[256]; // [esp+28h] [ebp-100h]

  v3 = a3;
  *(_DWORD *)&byte_5D4594[3821964] = a2;
  v4 = *(_DWORD *)&byte_5D4594[1599636];
  *(_DWORD *)&byte_5D4594[3821968] = a3;
  v5 = 48 * a1;
  v6 = 0;
  v7 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 48 * a1 + 8);
  v161 = 0;
  v162 = 48 * a1;
  if ( v7 > 0 )
  {
    do
    {
      *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * ++v6 - 4) = script_pop();
      v4 = *(_DWORD *)&byte_5D4594[1599636];
    }
    while ( v6 < *(int *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 8) );
  }
  v8 = *(_DWORD *)(v4 + v5 + 32);
  v163 = *(_DWORD *)&byte_5D4594[1599660];
  v160 = v8;
  while ( 1 )
  {
    switch ( sub_507270((int **)&v160) )
    {
      case 0:
      case 3:
        v9 = sub_507270((int **)&v160);
        v10 = sub_507270((int **)&v160);
        if ( v9 )
        {
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76)
                               + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 72) + 4 * v10)));
        }
        else if ( v10 < 0 )
        {
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760)
                               + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 24) - 4 * v10)));
        }
        else
        {
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28)
                               + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 24) + 4 * v10)));
        }
        continue;
      case 1:
        v11 = sub_507270((int **)&v160);
        v12 = sub_507270((int **)&v160);
        if ( v11 )
        {
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76)
                         + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 72) + 4 * v12));
        }
        else if ( v12 < 0 )
        {
          v13 = *(float *)(*(_DWORD *)(v3 + 760)
                         + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 24) - 4 * v12));
        }
        else
        {
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28)
                         + 4 * *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 24) + 4 * v12));
        }
        goto LABEL_16;
      case 2:
        v14 = sub_507270((int **)&v160);
        v15 = sub_507270((int **)&v160);
        if ( v14 )
        {
          v16 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 68) + 4 * v15);
          v17 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 72) + 4 * v15);
        }
        else if ( v15 < 0 )
        {
          v18 = 4 * v15;
          v16 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 20) - v18);
          v17 = -*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 24) - v18);
        }
        else
        {
          v16 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 20) + 4 * v15);
          v17 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 24) + 4 * v15);
        }
        if ( v16 > 1 )
          sub_507230(v16);
        sub_507230(v14);
        sub_507230(v17);
        continue;
      case 4:
      case 6:
        v19 = sub_507270((int **)&v160);
        sub_507230(v19);
        continue;
      case 5:
        v141 = sub_507280((float **)&v160);
        sub_507230(SLODWORD(v141));
        continue;
      case 7:
        v20 = script_pop();
        v21 = script_pop();
        sub_507230(v21 + v20);
        continue;
      case 8:
        v142 = COERCE_FLOAT(script_pop());
        v22 = COERCE_FLOAT(script_pop()) + v142;
        goto LABEL_29;
      case 9:
        v26 = script_pop();
        v27 = script_pop();
        sub_507230(v27 - v26);
        continue;
      case 10:
        v144 = COERCE_FLOAT(script_pop());
        *(float *)&v145 = COERCE_FLOAT(script_pop()) - v144;
        sub_507230(v145);
        continue;
      case 11:
        v28 = script_pop();
        v29 = script_pop();
        sub_507230(v28 * v29);
        continue;
      case 12:
        v146 = COERCE_FLOAT(script_pop());
        v22 = COERCE_FLOAT(script_pop()) * v146;
LABEL_29:
        *(float *)&v143 = v22;
        sub_507230(v143);
        continue;
      case 13:
        v30 = script_pop();
        v31 = script_pop();
        sub_507230(v31 / v30);
        continue;
      case 14:
        v147 = COERCE_FLOAT(script_pop());
        v13 = COERCE_FLOAT(script_pop()) / v147;
        goto LABEL_16;
      case 15:
        v32 = script_pop();
        v33 = script_pop();
        sub_507230(v33 % v32);
        continue;
      case 16:
        v34 = script_pop();
        v35 = script_pop();
        sub_507230(v35 & v34);
        continue;
      case 17:
        v36 = script_pop();
        v37 = script_pop();
        sub_507230(v37 | v36);
        continue;
      case 18:
        v38 = script_pop();
        v39 = script_pop();
        sub_507230(v39 ^ v38);
        continue;
      case 19:
        v160 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 32) + 4 * sub_507270((int **)&v160);
        continue;
      case 20:
        v44 = sub_507270((int **)&v160);
        if ( script_pop() )
          v160 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 32) + 4 * v44;
        continue;
      case 21:
        v45 = sub_507270((int **)&v160);
        if ( !script_pop() )
          v160 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 32) + 4 * v45;
        continue;
      case 22:
      case 24:
        v46 = script_pop();
        v47 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v47) = v46;
          sub_507230(v46);
        }
        else
        {
          if ( v47 < 0 )
            *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v47) = v46;
          else
            *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v47) = v46;
          sub_507230(v46);
        }
        continue;
      case 23:
        v48 = COERCE_FLOAT(script_pop());
        v49 = script_pop();
        if ( script_pop() )
        {
          *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v49) = v48;
          sub_507230(SLODWORD(v48));
        }
        else
        {
          if ( v49 < 0 )
            *(float *)(*(_DWORD *)(v3 + 760) - 4 * v49) = v48;
          else
            *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v49) = v48;
          sub_507230(SLODWORD(v48));
        }
        continue;
      case 25:
        v74 = script_pop();
        v75 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v75) *= v74;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v75));
        }
        else if ( v75 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v75) *= v74;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v75));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v75) *= v74;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v75));
        }
        continue;
      case 26:
        v150 = COERCE_FLOAT(script_pop());
        v52 = script_pop();
        if ( script_pop() )
        {
          v76 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76);
          v54 = v150 * *(float *)(v76 + 4 * v52);
          v55 = (float *)(v76 + 4 * v52);
          goto LABEL_98;
        }
        if ( v52 >= 0 )
        {
          v77 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28);
          v57 = v150 * *(float *)(v77 + 4 * v52);
          v58 = (float *)(v77 + 4 * v52);
          goto LABEL_101;
        }
        v59 = 4 * v52;
        v60 = (float *)(*(_DWORD *)(v3 + 760) - 4 * v52);
        v61 = v150 * *v60;
        goto LABEL_103;
      case 27:
        v78 = script_pop();
        v79 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v79) /= v78;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v79));
        }
        else if ( v79 < 0 )
        {
          v80 = 4 * v79;
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - v80) /= v78;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - v80));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v79) /= v78;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v79));
        }
        continue;
      case 28:
        v151 = COERCE_FLOAT(script_pop());
        v81 = script_pop();
        if ( script_pop() )
        {
          *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v81) = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76)
                                                                                              + 4 * v81)
                                                                                   / v151;
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v81);
          goto LABEL_16;
        }
        if ( v81 >= 0 )
        {
          *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v81) = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v81)
                                                                                        / v151;
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v81);
          goto LABEL_16;
        }
        v71 = 4 * v81;
        v72 = (float *)(*(_DWORD *)(v3 + 760) - 4 * v81);
        v73 = *v72 / v151;
        goto LABEL_114;
      case 29:
        v50 = script_pop();
        v51 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v51) += v50;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v51));
        }
        else if ( v51 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v51) += v50;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v51));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v51) += v50;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v51));
        }
        continue;
      case 30:
        v148 = COERCE_FLOAT(script_pop());
        v52 = script_pop();
        if ( script_pop() )
        {
          v53 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76);
          v54 = v148 + *(float *)(v53 + 4 * v52);
          v55 = (float *)(v53 + 4 * v52);
LABEL_98:
          *v55 = v54;
          sub_507230(COERCE_INT(*(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v52)));
        }
        else if ( v52 < 0 )
        {
          v59 = 4 * v52;
          v60 = (float *)(*(_DWORD *)(v3 + 760) - 4 * v52);
          v61 = v148 + *v60;
LABEL_103:
          *v60 = v61;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - v59));
        }
        else
        {
          v56 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28);
          v57 = v148 + *(float *)(v56 + 4 * v52);
          v58 = (float *)(v56 + 4 * v52);
LABEL_101:
          *v58 = v57;
          sub_507230(COERCE_INT(*(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v52)));
        }
        continue;
      case 31:
        v62 = script_pop();
        v63 = script_pop();
        v64 = script_pop();
        if ( v64 )
        {
          v65 = 4 * v63;
          v66 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v63);
        }
        else
        {
          v65 = 4 * v63;
          if ( v63 < 0 )
            v66 = *(_DWORD *)(*(_DWORD *)(a3 + 760) - 4 * v63);
          else
            v66 = *(_DWORD *)(*(_DWORD *)(v162 + *(_DWORD *)&byte_5D4594[1599636] + 28) + 4 * v63);
        }
        nox_sprintf(
          v164,
          (const char *)&byte_587000[230016],
          *(_DWORD *)&byte_5D4594[4 * v66 + 3831212],
          *(_DWORD *)&byte_5D4594[4 * v62 + 3831212]);
        v67 = sub_512E40(v164);
        if ( v64 )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + v65) = v67;
          sub_507230(v67);
          v5 = v162;
        }
        else
        {
          if ( v63 < 0 )
            *(_DWORD *)(*(_DWORD *)(a3 + 760) - v65) = v67;
          else
            *(_DWORD *)(*(_DWORD *)(v162 + *(_DWORD *)&byte_5D4594[1599636] + 28) + v65) = v67;
          sub_507230(v67);
          v5 = v162;
        }
        goto LABEL_4;
      case 32:
        v68 = script_pop();
        v69 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v69) -= v68;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v69));
        }
        else if ( v69 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v69) -= v68;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v69));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v69) -= v68;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v69));
        }
        continue;
      case 33:
        v149 = COERCE_FLOAT(script_pop());
        v70 = script_pop();
        if ( script_pop() )
        {
          *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v70) = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76)
                                                                                              + 4 * v70)
                                                                                   - v149;
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v70);
LABEL_16:
          *(float *)&v140 = v13;
          sub_507230(v140);
          continue;
        }
        if ( v70 >= 0 )
        {
          *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v70) = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v70)
                                                                                        - v149;
          v13 = *(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v70);
          goto LABEL_16;
        }
        v71 = 4 * v70;
        v72 = (float *)(*(_DWORD *)(v3 + 760) - 4 * v70);
        v73 = *v72 - v149;
LABEL_114:
        *v72 = v73;
        sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - v71));
        break;
      case 34:
        v82 = script_pop();
        v83 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v83) %= v82;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v83));
        }
        else if ( v83 < 0 )
        {
          v84 = 4 * v83;
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - v84) %= v82;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - v84));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v83) %= v82;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v83));
        }
        continue;
      case 35:
        v95 = script_pop();
        v96 = script_pop();
        sub_507230(v96 == v95);
        continue;
      case 36:
        v152 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) != v152 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 37:
        v97 = script_pop();
        if ( !strcmp(
                *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                *(const char **)&byte_5D4594[4 * v97 + 3831212]) )
          sub_507230(1);
        else
          sub_507230(0);
        continue;
      case 38:
        v40 = script_pop();
        v41 = script_pop();
        sub_507230(v41 << v40);
        continue;
      case 39:
        v42 = script_pop();
        v43 = script_pop();
        sub_507230(v43 >> v42);
        continue;
      case 40:
        v98 = script_pop();
        v99 = script_pop();
        sub_507230(v99 < v98);
        continue;
      case 41:
        v153 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) >= (double)v153 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 42:
        v100 = script_pop();
        v101 = strcmp(
                 *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                 *(const char **)&byte_5D4594[4 * v100 + 3831212]);
        if ( v101 )
          sub_507230(-(v101 < 0) - ((v101 < 0) - 1) < 0);
        else
          sub_507230(0);
        continue;
      case 43:
        v102 = script_pop();
        v103 = script_pop();
        sub_507230(v103 > v102);
        continue;
      case 44:
        v154 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) <= (double)v154 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 45:
        v104 = script_pop();
        v105 = strcmp(
                 *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                 *(const char **)&byte_5D4594[4 * v104 + 3831212]);
        if ( v105 )
          sub_507230(-(v105 < 0) - ((v105 < 0) - 1) > 0);
        else
          sub_507230(0);
        continue;
      case 46:
        v106 = script_pop();
        v107 = script_pop();
        sub_507230(v107 <= v106);
        continue;
      case 47:
        v155 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) > (double)v155 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 48:
        v108 = script_pop();
        v109 = strcmp(
                 *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                 *(const char **)&byte_5D4594[4 * v108 + 3831212]);
        if ( v109 )
          sub_507230(-(v109 < 0) - ((v109 < 0) - 1) <= 0);
        else
          sub_507230(1);
        continue;
      case 49:
        v110 = script_pop();
        v111 = script_pop();
        sub_507230(v111 >= v110);
        continue;
      case 50:
        v156 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) < (double)v156 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 51:
        v112 = script_pop();
        v113 = strcmp(
                 *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                 *(const char **)&byte_5D4594[4 * v112 + 3831212]);
        if ( v113 )
          sub_507230(-(v113 < 0) - ((v113 < 0) - 1) >= 0);
        else
          sub_507230(1);
        continue;
      case 52:
        v114 = script_pop();
        v115 = script_pop();
        sub_507230(v115 != v114);
        continue;
      case 53:
        v157 = COERCE_FLOAT(script_pop());
        if ( COERCE_FLOAT(script_pop()) == v157 )
          goto LABEL_184;
        sub_507230(1);
        continue;
      case 54:
        v116 = script_pop();
        if ( !strcmp(
                *(const char **)&byte_5D4594[4 * script_pop() + 3831212],
                *(const char **)&byte_5D4594[4 * v116 + 3831212]) )
          sub_507230(0);
        else
          sub_507230(1);
        continue;
      case 55:
        v117 = script_pop();
        if ( script_pop() && v117 )
          sub_507230(1);
        else
LABEL_184:
          sub_507230(0);
        continue;
      case 56:
        v118 = script_pop();
        if ( script_pop() || v118 )
          sub_507230(1);
        else
          sub_507230(0);
        continue;
      case 57:
        v85 = script_pop();
        v86 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v86) <<= v85;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v86));
        }
        else if ( v86 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v86) <<= v85;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v86));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v86) <<= v85;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v86));
        }
        continue;
      case 58:
        v87 = script_pop();
        v88 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v88) >>= v87;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v88));
        }
        else if ( v88 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v88) >>= v87;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v88));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v88) >>= v87;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v88));
        }
        continue;
      case 59:
        v89 = script_pop();
        v90 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v90) &= v89;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v90));
        }
        else if ( v90 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v90) &= v89;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v90));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v90) &= v89;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v90));
        }
        continue;
      case 60:
        v93 = script_pop();
        v94 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v94) |= v93;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v94));
        }
        else if ( v94 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v94) |= v93;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v94));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v94) |= v93;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v94));
        }
        continue;
      case 61:
        v91 = script_pop();
        v92 = script_pop();
        if ( script_pop() )
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v92) ^= v91;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * v92));
        }
        else if ( v92 < 0 )
        {
          *(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v92) ^= v91;
          sub_507230(*(_DWORD *)(*(_DWORD *)(v3 + 760) - 4 * v92));
        }
        else
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v92) ^= v91;
          sub_507230(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * v92));
        }
        continue;
      case 62:
        v135 = script_pop();
        sub_507230(v135 == 0);
        continue;
      case 63:
        v136 = script_pop();
        sub_507230(~v136);
        continue;
      case 64:
        v137 = script_pop();
        sub_507230(-v137);
        continue;
      case 65:
        v159 = -COERCE_FLOAT(script_pop());
        sub_507230(SLODWORD(v159));
        continue;
      case 66:
        v119 = script_pop();
        v120 = script_pop();
        v121 = script_pop();
        v122 = script_pop();
        if ( v119 < 0 || v119 >= v122 )
          v161 = 1;
        if ( v121 )
        {
          v123 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * (v119 + v120));
        }
        else if ( v120 < 0 )
        {
          v123 = *(_DWORD *)(*(_DWORD *)(a3 + 760) + 4 * (v120 - v119));
        }
        else
        {
          v123 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * (v119 + v120));
        }
        sub_507230(v123);
        goto LABEL_198;
      case 67:
        v127 = script_pop();
        v128 = script_pop();
        v129 = script_pop();
        v130 = script_pop();
        if ( v127 < 0 || v127 > v130 )
          v161 = 1;
        if ( v129 )
        {
          sub_507230(COERCE_INT(*(float *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + 76) + 4 * (v127 + v128))));
        }
        else
        {
          if ( v128 < 0 )
            v158 = *(int *)(*(_DWORD *)(a3 + 760) + 4 * (v128 - v127));
          else
            v158 = *(int *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 28) + 4 * (v127 + v128));
          sub_507230(v158);
        }
        goto LABEL_198;
      case 68:
        v131 = script_pop();
        v132 = script_pop();
        v133 = script_pop();
        v134 = script_pop();
        if ( v131 < 0 || v131 > v134 )
          v161 = 1;
        sub_507230(v133);
        if ( v132 < 0 )
          sub_507230(v132 - v131);
        else
          sub_507230(v132 + v131);
LABEL_198:
        if ( v161 )
          goto LABEL_199;
LABEL_4:
        v3 = a3;
        continue;
      case 69:
        v138 = sub_507270((int **)&v160);
        if ( sub_508B70(a1, v138) != 1 )
          continue;
        goto LABEL_199;
      case 70:
        v139 = sub_507270((int **)&v160);
        sub_507310(v139, a2, v3);
        continue;
      case 73:
        v23 = script_pop();
        v24 = script_pop();
        nox_sprintf(
          v164,
          (const char *)&byte_587000[230008],
          *(_DWORD *)&byte_5D4594[4 * v24 + 3831212],
          *(_DWORD *)&byte_5D4594[4 * v23 + 3831212]);
        v25 = sub_512E40(v164);
        sub_507230(v25);
        continue;
      default:
LABEL_199:
        v124 = v163;
        result = *(_DWORD *)(*(_DWORD *)&byte_5D4594[1599636] + v5 + 4);
        if ( *(_DWORD *)&byte_5D4594[1599660] != result + v163 )
        {
          if ( result )
          {
            if ( *(_DWORD *)&byte_5D4594[1599660] )
            {
              v126 = script_pop();
              *(_DWORD *)&byte_5D4594[1599660] = v124;
              result = sub_507230(v126);
            }
            else
            {
              *(_DWORD *)&byte_5D4594[1599660] = v163;
              result = sub_507230(0);
            }
          }
          else
          {
            *(_DWORD *)&byte_5D4594[1599660] = v163;
          }
        }
        return result;
    }
  }
}

//----- (00508B70) --------------------------------------------------------
int __cdecl sub_508B70(int a1, int a2)
{
  int v2; // ebx
  int result; // eax

  v2 = 48 * a1;
  if ( !*(_DWORD *)(48 * a1 + *(_DWORD *)&byte_5D4594[1599636] + 36) )
    return (*(int (__cdecl **)())&byte_587000[4 * a2 + 245900])();
  if ( sub_508C30(a2) )
    strcpy((char *)&byte_5D4594[3821644], *(const char **)(v2 + *(_DWORD *)&byte_5D4594[1599636] + 36));
  if ( sub_508C70(a2) )
  {
    *(_DWORD *)&byte_5D4594[3821636] = *(_DWORD *)(v2 + *(_DWORD *)&byte_5D4594[1599636] + 40);
    *(_DWORD *)&byte_5D4594[3821640] = *(_DWORD *)(v2 + *(_DWORD *)&byte_5D4594[1599636] + 44);
  }
  result = (*(int (__cdecl **)())&byte_587000[4 * a2 + 245900])();
  byte_5D4594[3821644] = byte_5D4594[1599672];
  *(_DWORD *)&byte_5D4594[3821640] = 0;
  *(_DWORD *)&byte_5D4594[3821636] = 0;
  return result;
}

//----- (00508C30) --------------------------------------------------------
int __cdecl sub_508C30(int a1)
{
  int v1; // eax
  unsigned __int8 *i; // ecx

  v1 = 0;
  if ( *(int *)&byte_587000[246800] <= 0 )
    return 0;
  for ( i = &byte_587000[246748]; *(_DWORD *)&byte_587000[4 * a1 + 245900] != *(_DWORD *)i; i += 4 )
  {
    if ( ++v1 >= *(int *)&byte_587000[246800] )
      return 0;
  }
  return 1;
}

//----- (00508C70) --------------------------------------------------------
int __cdecl sub_508C70(int a1)
{
  int v1; // eax
  unsigned __int8 *i; // ecx

  v1 = 0;
  if ( *(int *)&byte_587000[246768] <= 0 )
    return 0;
  for ( i = &byte_587000[246772]; *(_DWORD *)&byte_587000[4 * a1 + 245900] != *(_DWORD *)i; i += 4 )
  {
    if ( ++v1 >= *(int *)&byte_587000[246768] )
      return 0;
  }
  return 1;
}

//----- (00508CB0) --------------------------------------------------------
int __cdecl sub_508CB0(_DWORD *a1, int a2)
{
  int v2; // edi
  int result; // eax
  int v4; // ecx
  _DWORD *v5; // esi
  _DWORD *v6; // esi
  int v7; // esi
  _DWORD *v8; // esi

  v2 = a1[189];
  if ( !v2 )
    return 0;
  if ( a2 == 14 )
  {
    if ( sub_40A5C0(6291456) )
      result = v2;
    else
      result = *(_DWORD *)(48 * a1[192] + *(_DWORD *)&byte_5D4594[1599636]);
    return result;
  }
  v4 = a1[2];
  if ( v4 & 0x200 )
  {
    v5 = (_DWORD *)a1[187];
    if ( a2 )
    {
      if ( a2 != 1 )
      {
        if ( a2 == 2 )
        {
          if ( sub_40A5C0(6291456) )
            result = v2 + 384;
          else
            result = *(_DWORD *)(48 * v5[8] + *(_DWORD *)&byte_5D4594[1599636]);
          return result;
        }
        return 0;
      }
      if ( sub_40A5C0(6291456) )
        result = v2 + 256;
      else
        result = *(_DWORD *)(48 * v5[6] + *(_DWORD *)&byte_5D4594[1599636]);
    }
    else if ( sub_40A5C0(6291456) )
    {
      result = v2 + 512;
    }
    else
    {
      result = *(_DWORD *)(48 * v5[4] + *(_DWORD *)&byte_5D4594[1599636]);
    }
  }
  else if ( v4 & 2 )
  {
    v6 = (_DWORD *)a1[187];
    switch ( a2 )
    {
      case 3:
        if ( sub_40A5C0(6291456) )
          result = v2 + 640;
        else
          result = *(_DWORD *)(48 * v6[309] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 4:
        if ( sub_40A5C0(6291456) )
          result = v2 + 768;
        else
          result = *(_DWORD *)(48 * v6[307] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 5:
        if ( sub_40A5C0(6291456) )
          result = v2 + 896;
        else
          result = *(_DWORD *)(48 * v6[317] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 6:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1024;
        else
          result = *(_DWORD *)(48 * v6[311] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 7:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1152;
        else
          result = *(_DWORD *)(48 * v6[313] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 8:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1280;
        else
          result = *(_DWORD *)(48 * v6[315] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 9:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1408;
        else
          result = *(_DWORD *)(48 * v6[319] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 10:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1536;
        else
          result = *(_DWORD *)(48 * v6[321] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 11:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1664;
        else
          result = *(_DWORD *)(48 * v6[323] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 13:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1792;
        else
          result = *(_DWORD *)(48 * v6[325] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      default:
        return 0;
    }
  }
  else if ( v4 & 0x800 )
  {
    v7 = a1[175];
    if ( a2 != 12 )
      return 0;
    if ( sub_40A5C0(6291456) )
      result = v2 + 128;
    else
      result = *(_DWORD *)(48 * *(_DWORD *)(v7 + 4) + *(_DWORD *)&byte_5D4594[1599636]);
  }
  else
  {
    if ( !(v4 & 0x20000) )
      return 0;
    v8 = (_DWORD *)a1[187];
    switch ( a2 )
    {
      case 15:
        if ( sub_40A5C0(6291456) )
          result = v2 + 1920;
        else
          result = *(_DWORD *)(48 * v8[13] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 16:
        if ( sub_40A5C0(6291456) )
          result = v2 + 2048;
        else
          result = *(_DWORD *)(48 * v8[15] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 17:
        if ( sub_40A5C0(6291456) )
          result = v2 + 2304;
        else
          result = *(_DWORD *)(48 * v8[17] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      case 18:
        if ( sub_40A5C0(6291456) )
          result = v2 + 2176;
        else
          result = *(_DWORD *)(48 * v8[19] + *(_DWORD *)&byte_5D4594[1599636]);
        break;
      default:
        return 0;
    }
  }
  return result;
}

//----- (00509120) --------------------------------------------------------
void __cdecl sub_509120(_DWORD *a1, int a2, const char *a3)
{
  char *v3; // ebx
  int v4; // ecx
  _DWORD *v5; // esi
  char *v6; // edx
  _DWORD *v7; // esi
  int v8; // esi
  _DWORD *v9; // esi

  v3 = (char *)a1[189];
  if ( v3 )
  {
    if ( a2 == 14 )
    {
      if ( sub_40A5C0(6291456) )
        strcpy(v3, a3);
      else
        a1[192] = sub_5071D0(a3);
      return;
    }
    v4 = a1[2];
    if ( v4 & 0x200 )
    {
      v5 = (_DWORD *)a1[187];
      if ( a2 )
      {
        if ( a2 == 1 )
        {
          if ( !sub_40A5C0(6291456) )
          {
            v5[6] = sub_5071D0(a3);
            return;
          }
          v6 = v3 + 256;
        }
        else
        {
          if ( a2 != 2 )
            return;
          if ( !sub_40A5C0(6291456) )
          {
            v5[8] = sub_5071D0(a3);
            return;
          }
          v6 = v3 + 384;
        }
      }
      else
      {
        if ( !sub_40A5C0(6291456) )
        {
          v5[4] = sub_5071D0(a3);
          return;
        }
        v6 = v3 + 512;
      }
LABEL_66:
      strcpy(v6, a3);
      return;
    }
    if ( v4 & 2 )
    {
      v7 = (_DWORD *)a1[187];
      switch ( a2 )
      {
        case 3:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 640;
            goto LABEL_66;
          }
          v7[309] = sub_5071D0(a3);
          break;
        case 4:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 768;
            goto LABEL_66;
          }
          v7[307] = sub_5071D0(a3);
          break;
        case 5:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 896;
            goto LABEL_66;
          }
          v7[317] = sub_5071D0(a3);
          break;
        case 6:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1024;
            goto LABEL_66;
          }
          v7[311] = sub_5071D0(a3);
          break;
        case 7:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1152;
            goto LABEL_66;
          }
          v7[313] = sub_5071D0(a3);
          break;
        case 8:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1280;
            goto LABEL_66;
          }
          v7[315] = sub_5071D0(a3);
          break;
        case 9:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1408;
            goto LABEL_66;
          }
          v7[319] = sub_5071D0(a3);
          break;
        case 10:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1536;
            goto LABEL_66;
          }
          v7[321] = sub_5071D0(a3);
          break;
        case 11:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1664;
            goto LABEL_66;
          }
          v7[323] = sub_5071D0(a3);
          break;
        case 13:
          if ( sub_40A5C0(6291456) )
          {
            v6 = v3 + 1792;
            goto LABEL_66;
          }
          v7[325] = sub_5071D0(a3);
          break;
        default:
          return;
      }
    }
    else
    {
      if ( v4 & 0x800 )
      {
        v8 = a1[175];
        if ( a2 != 12 )
          return;
        if ( !sub_40A5C0(6291456) )
        {
          *(_DWORD *)(v8 + 4) = sub_5071D0(a3);
          return;
        }
        v6 = v3 + 128;
        goto LABEL_66;
      }
      if ( v4 & 0x20000 )
      {
        v9 = (_DWORD *)a1[187];
        switch ( a2 )
        {
          case 15:
            if ( sub_40A5C0(6291456) )
            {
              v6 = v3 + 1920;
              goto LABEL_66;
            }
            v9[13] = sub_5071D0(a3);
            break;
          case 16:
            if ( sub_40A5C0(6291456) )
            {
              v6 = v3 + 2048;
              goto LABEL_66;
            }
            v9[15] = sub_5071D0(a3);
            break;
          case 17:
            if ( sub_40A5C0(6291456) )
            {
              v6 = v3 + 2304;
              goto LABEL_66;
            }
            v9[17] = sub_5071D0(a3);
            break;
          case 18:
            if ( sub_40A5C0(6291456) )
            {
              v6 = v3 + 2176;
              goto LABEL_66;
            }
            v9[19] = sub_5071D0(a3);
            break;
          default:
            return;
        }
      }
    }
  }
}

//----- (005095E0) --------------------------------------------------------
int sub_5095E0()
{
  int v0; // ebp
  BOOL v1; // ebx
  int v2; // esi
  char *i; // eax
  int v4; // ecx
  int v5; // edi
  int v6; // ebp
  int v7; // eax
  int v8; // eax
  int result; // eax
  char *v10; // [esp+10h] [ebp-8h]
  int v11; // [esp+14h] [ebp-4h]

  v0 = 0;
  v11 = 0;
  v10 = 0;
  v1 = 0;
  v2 = 0x7FFFFFFF;
  for ( i = sub_418B10(); i; i = sub_418B60((int)i) )
  {
    v4 = *((_DWORD *)i + 13);
    if ( v4 <= v2 )
    {
      v1 = v4 == v2 && v0;
      v2 = *((_DWORD *)i + 13);
      v10 = i;
      v0 = (int)i;
    }
  }
  v5 = sub_4DA7C0();
  if ( v5 )
  {
    do
    {
      v6 = *(_DWORD *)(v5 + 748);
      if ( !sub_419130(v5 + 48) )
      {
        v7 = *(_DWORD *)(v6 + 276);
        if ( !(*(_BYTE *)(v7 + 3680) & 1) )
        {
          v8 = *(_DWORD *)(v7 + 2140);
          if ( v8 <= v2 )
          {
            v1 = v8 == v2 && v11;
            v2 = v8;
            v11 = v5;
          }
        }
      }
      v5 = sub_4DA7F0(v5);
    }
    while ( v5 );
    v0 = (int)v10;
  }
  sub_40A4D0(8);
  if ( v1 )
    return sub_4D8BF0(0, 1);
  result = v11;
  if ( v11 )
    return sub_4D8B90(v11, 1);
  if ( v0 )
    result = sub_4D8BF0(v0, 1);
  return result;
}

//----- (005096F0) --------------------------------------------------------
int sub_5096F0()
{
  int result; // eax
  unsigned __int8 *v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // esi
  int v5; // edi
  char v6[5]; // [esp+0h] [ebp-8h]

  result = sub_40A1A0();
  if ( !result )
    return result;
  if ( sub_40A5C0(4096) )
  {
    v1 = sub_4E8E50();
    sub_4D2450((char *)v1);
    sub_4DA390((const char *)&byte_587000[230024]);
    v2 = sub_4DA7C0();
    if ( v2 )
    {
      do
      {
        v3 = *(_DWORD *)(v2 + 748);
        if ( !*(_DWORD *)(v3 + 312) && *(_DWORD *)(*(_DWORD *)(v3 + 276) + 4792) == 1 )
          sub_4D60E0(v2);
        v2 = sub_4DA7F0(v2);
      }
      while ( v2 );
      return sub_40A1F0(0);
    }
    return sub_40A1F0(0);
  }
  if ( !sub_40A300() )
  {
    if ( sub_40A5C0(96) )
    {
      sub_5099B0();
      return sub_40A1F0(0);
    }
    if ( sub_40A5C0(272) )
    {
      sub_5098A0();
      return sub_40A1F0(0);
    }
    if ( sub_40A5C0(1024) )
      sub_5095E0();
    return sub_40A1F0(0);
  }
  sub_40A4D0(0x4000000);
  v6[0] = -102;
  v4 = sub_4DA7C0();
  if ( !v4 )
    return sub_40A1F0(0);
  do
  {
    v5 = *(_DWORD *)(v4 + 748);
    if ( v5 )
    {
      *(_WORD *)&v6[1] = (__int64)*(float *)(*(_DWORD *)(v5 + 276) + 3632);
      *(_WORD *)&v6[3] = (__int64)*(float *)(*(_DWORD *)(v5 + 276) + 3636);
      sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), 1, v6, 5);
    }
    sub_501960(582, v4, 2, *(_DWORD *)(v4 + 36));
    v4 = sub_4DA7F0(v4);
  }
  while ( v4 );
  return sub_40A1F0(0);
}

//----- (005098A0) --------------------------------------------------------
int sub_5098A0()
{
  int v0; // ebp
  BOOL v1; // ebx
  signed int v2; // esi
  char *i; // eax
  signed int v4; // ecx
  int v5; // edi
  int v6; // ebp
  int v7; // eax
  signed int v8; // eax
  int result; // eax
  char *v10; // [esp+10h] [ebp-8h]
  int v11; // [esp+14h] [ebp-4h]

  v0 = 0;
  v11 = 0;
  v10 = 0;
  v1 = 0;
  v2 = 2147483648;
  for ( i = sub_418B10(); i; i = sub_418B60((int)i) )
  {
    v4 = *((_DWORD *)i + 13);
    if ( v4 >= v2 )
    {
      v1 = v4 == v2 && v0;
      v2 = *((_DWORD *)i + 13);
      v10 = i;
      v0 = (int)i;
    }
  }
  v5 = sub_4DA7C0();
  if ( v5 )
  {
    do
    {
      v6 = *(_DWORD *)(v5 + 748);
      if ( !sub_419130(v5 + 48) )
      {
        v7 = *(_DWORD *)(v6 + 276);
        if ( !(*(_BYTE *)(v7 + 3680) & 1) )
        {
          v8 = *(_DWORD *)(v7 + 2136);
          if ( v8 >= v2 )
          {
            v1 = v8 == v2 && v11;
            v2 = v8;
            v11 = v5;
          }
        }
      }
      v5 = sub_4DA7F0(v5);
    }
    while ( v5 );
    v0 = (int)v10;
  }
  sub_40A4D0(8);
  if ( v1 )
    return sub_4D8BF0(0, 1);
  result = v11;
  if ( v11 )
    return sub_4D8B90(v11, 1);
  if ( v0 )
    result = sub_4D8BF0(v0, 1);
  return result;
}

//----- (005099B0) --------------------------------------------------------
int sub_5099B0()
{
  int v0; // edi
  BOOL v1; // ebx
  int v2; // esi
  char *i; // eax
  int v4; // ecx
  int result; // eax

  v0 = 0;
  v1 = 0;
  v2 = -1;
  for ( i = sub_418B10(); i; i = sub_418B60((int)i) )
  {
    v4 = *((_DWORD *)i + 13);
    if ( v4 >= v2 )
    {
      v1 = v4 == v2 && v0;
      v2 = *((_DWORD *)i + 13);
      v0 = (int)i;
    }
  }
  sub_40A4D0(8);
  if ( !v0 || v1 )
  {
    if ( sub_40A5C0(64) )
      result = sub_4D8C40(0);
    else
      result = sub_4D8C80(0, 1);
  }
  else if ( sub_40A5C0(64) )
  {
    result = sub_4D8C40(v0);
  }
  else
  {
    result = sub_4D8C80(v0, 1);
  }
  return result;
}

//----- (00509A60) --------------------------------------------------------
char sub_509A60()
{
  char *v0; // eax
  __int16 v1; // ax
  int v2; // edi
  char *v3; // esi
  int v4; // esi
  int v5; // eax
  char *v6; // edi
  __int16 v7; // ax
  int v8; // ebp
  int v9; // ebx
  int i; // esi
  int v11; // eax

  if ( sub_40A5C0(1024) )
  {
    v6 = 0;
    v7 = sub_40A5B0();
    LOWORD(v0) = sub_40A020(v7);
    v8 = (unsigned __int16)v0;
    if ( (int)(unsigned __int16)v0 >= 1 )
    {
      v9 = 0;
      for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
      {
        v11 = *(_DWORD *)(*(_DWORD *)(i + 748) + 276);
        if ( !(*(_BYTE *)(v11 + 3680) & 1) && *(_DWORD *)(v11 + 2140) < v8 )
        {
          v0 = (char *)sub_419130(i + 48);
          if ( v0 )
          {
            if ( v6 )
            {
              v0 = sub_418AB0(*(unsigned __int8 *)(i + 52));
              if ( v6 != v0 )
                return (char)v0;
            }
            else
            {
              v6 = sub_418AB0(*(unsigned __int8 *)(i + 52));
            }
          }
          else
          {
            if ( v9 || v6 )
              return (char)v0;
            v9 = i;
          }
        }
      }
      v0 = sub_40A8A0();
      if ( v0 )
      {
        sub_40A4D0(8);
        if ( v6 )
        {
          LOBYTE(v0) = sub_4D8BF0((int)v6, 0);
        }
        else if ( v9 )
        {
          LOBYTE(v0) = sub_4D8B90(v9, 0);
        }
        else
        {
          LOBYTE(v0) = sub_4D8B90(0, 0);
        }
      }
    }
  }
  else
  {
    v0 = (char *)sub_40A5C0(512);
    if ( !v0 )
    {
      v1 = sub_40A5B0();
      LOWORD(v0) = sub_40A020(v1);
      v2 = (unsigned __int16)v0;
      if ( (_WORD)v0 )
      {
        v3 = sub_418B10();
        if ( v3 )
        {
          while ( *((_DWORD *)v3 + 13) < v2 )
          {
            v3 = sub_418B60((int)v3);
            if ( !v3 )
              goto LABEL_7;
          }
          sub_40A4D0(8);
          LOBYTE(v0) = sub_4D8BF0((int)v3, 0);
        }
        else
        {
LABEL_7:
          v0 = (char *)sub_4DA7C0();
          v4 = (int)v0;
          if ( v0 )
          {
            while ( 1 )
            {
              v5 = *(_DWORD *)(*(_DWORD *)(v4 + 748) + 276);
              if ( !(*(_BYTE *)(v5 + 3680) & 1) && *(_DWORD *)(v5 + 2136) >= v2 )
                break;
              v0 = (char *)sub_4DA7F0(v4);
              v4 = (int)v0;
              if ( !v0 )
                return (char)v0;
            }
            sub_40A4D0(8);
            LOBYTE(v0) = sub_4D8B90(v4, 0);
          }
        }
      }
    }
  }
  return (char)v0;
}
// 509BEA: variable 'v0' is possibly undefined

//----- (00509C30) --------------------------------------------------------
_DWORD *__cdecl sub_509C30(int a1)
{
  char *v1; // edx

  if ( !*(_DWORD *)&byte_5D4594[1599688] )
  {
    sub_425760(&byte_5D4594[1599676]);
    *(_DWORD *)&byte_5D4594[1599688] = 1;
  }
  v1 = (char *)nox_malloc(0x20u);
  *((_DWORD *)v1 + 6) = *(_DWORD *)(a1 + 2068);
  strcpy(v1 + 12, (const char *)(a1 + 2096));
  v1[28] = *(_BYTE *)(a1 + 2251);
  return sub_4257F0((int *)&byte_5D4594[1599676], v1);
}

//----- (00509CB0) --------------------------------------------------------
int *sub_509CB0()
{
  int *result; // eax
  int *v1; // esi
  int *v2; // edi

  result = *(int **)&byte_5D4594[1599688];
  if ( *(_DWORD *)&byte_5D4594[1599688] )
  {
    result = sub_425890((int *)&byte_5D4594[1599676]);
    v1 = result;
    if ( result )
    {
      do
      {
        v2 = sub_4258A0(v1);
        sub_425920((_DWORD **)v1);
        free(v1);
        v1 = v2;
      }
      while ( v2 );
    }
  }
  return result;
}

//----- (00509CF0) --------------------------------------------------------
int __cdecl sub_509CF0(const char *a1, char a2, int a3)
{
  int *v3; // edi

  v3 = sub_425890((int *)&byte_5D4594[1599676]);
  if ( !v3 )
    return 1;
  while ( strcmp((const char *)v3 + 12, a1) || a2 == *((_BYTE *)v3 + 28) && a3 == v3[6] )
  {
    v3 = sub_4258A0(v3);
    if ( !v3 )
      return 1;
  }
  return 0;
}

//----- (00509D80) --------------------------------------------------------
int __cdecl sub_509D80(int a1)
{
  int *v1; // edi

  v1 = sub_425890((int *)&byte_5D4594[1599676]);
  if ( !v1 )
    return 0;
  while ( strcmp((const char *)v1 + 12, (const char *)(a1 + 2096)) )
  {
    v1 = sub_4258A0(v1);
    if ( !v1 )
      return 0;
  }
  return 1;
}

//----- (00509E00) --------------------------------------------------------
int __cdecl sub_509E00(_DWORD *a1)
{
  return *(_DWORD *)&byte_587000[4 * (*a1 + 3 * a1[1]) + 230072];
}

//----- (00509E20) --------------------------------------------------------
int __cdecl sub_509E20(int a1, int2 *a2)
{
  int v2; // ecx
  int v3; // ecx
  int result; // eax

  v2 = *(int *)&byte_587000[8 * a1 + 192088];
  if ( v2 <= *(int *)&byte_587000[230092] )
    a2->field_0 = (v2 >= -*(int *)&byte_587000[230092]) - 1;
  else
    a2->field_0 = 1;
  v3 = *(int *)&byte_587000[8 * a1 + 192092];
  result = *(_DWORD *)&byte_587000[230092];
  if ( v3 <= *(int *)&byte_587000[230092] )
  {
    result = -*(int *)&byte_587000[230092];
    if ( v3 >= -*(int *)&byte_587000[230092] )
      a2->field_4 = 0;
    else
      a2->field_4 = -1;
  }
  else
  {
    a2->field_4 = 1;
  }
  return result;
}

//----- (00509E90) --------------------------------------------------------
int __cdecl sub_509E90(int a1)
{
  return *(_DWORD *)&byte_587000[4 * a1 + 230056];
}

//----- (00509EA0) --------------------------------------------------------
int __cdecl sub_509EA0(int a1)
{
  int2 a2; // [esp+0h] [ebp-8h]

  sub_509E20(a1, &a2);
  return a2.field_4 + a2.field_0 + 2 * a2.field_4 + 4;
}

//----- (00509ED0) --------------------------------------------------------
int __cdecl sub_509ED0(float2 *a1)
{
  int result; // eax
  float v2; // [esp+0h] [ebp-4h]

  v2 = (atan2(a1->field_4, a1->field_0) + 6.2831855) * 40.743664 + 0.5;
  result = sub_419A70(v2);
  if ( result < 0 )
    result += (unsigned int)(255 - result) >> 8 << 8;
  if ( result >= 256 )
    result += -256 * ((unsigned int)result >> 8);
  return result;
}

//----- (00509F20) --------------------------------------------------------
void __cdecl sub_509F20(float2 *a1)
{
  double v1; // st7

  v1 = sub_419AF0(sqrt(a1->field_0 * a1->field_0 + a1->field_4 * a1->field_4));
  a1->field_0 = a1->field_0 / v1;
  a1->field_4 = a1->field_4 / v1;
}

//----- (00509F60) --------------------------------------------------------
void __cdecl sub_509F60(int a1, int a2)
{
  int v2; // esi
  char v3; // al
  int result; // eax
  int v5; // edi
  _DWORD *v6; // esi

  v2 = *(_DWORD *)(a1 + 748);
  sub_5341A0((char *)&byte_587000[233784], *(_DWORD *)&byte_5D4594[2598000], a2);
  v3 = *(_BYTE *)(v2 + 544);
  if ( v3 == -1 )
  {
    sub_5341A0((char *)&byte_587000[233804]);
    sub_5341A0((char *)&byte_587000[233832]);
  }
  else
  {
    if ( v3 >= 0 )
    {
      v5 = v3 + 1;
      v6 = (_DWORD *)(v2 + 8 * (3 * v3 + 69));
      do
      {
        sub_5341A0((char *)&byte_587000[233824], *(_DWORD *)&byte_587000[4 * *v6 + 230096]);
        v6 -= 6;
        --v5;
      }
      while ( v5 );
    }
    sub_5341A0((char *)&byte_587000[233832]);
  }
}

//----- (00509FF0) --------------------------------------------------------
int __cdecl sub_509FF0(int a1)
{
  int result; // eax

  result = a1;
  if ( *(_BYTE *)(*(_DWORD *)a1 + 16) & 0x20 )
    *(_DWORD *)a1 = 0;
  return result;
}

//----- (0050A010) --------------------------------------------------------
int __cdecl sub_50A010(int a1)
{
  int result; // eax

  result = a1 < 39;
  LOBYTE(result) = a1 > 39;
  return result;
}

//----- (0050A020) --------------------------------------------------------
int __cdecl sub_50A020(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23));
}

//----- (0050A040) --------------------------------------------------------
int __cdecl sub_50A040(int a1)
{
  int v1; // ebx
  int v2; // esi
  int *i; // edi
  int v4; // eax

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(char *)(v1 + 544) - 1;
  if ( v2 < 0 )
    return 38;
  for ( i = (int *)(v1 + 8 * (3 * v2 + 69)); ; i -= 6 )
  {
    v4 = sub_50A010(*i);
    if ( !v4 )
      break;
    if ( --v2 < 0 )
      return 38;
  }
  return *(_DWORD *)(v1 + 8 * (3 * v2 + 69));
}
// 50A06B: variable 'v4' is possibly undefined

//----- (0050A090) --------------------------------------------------------
int __cdecl sub_50A090(int a1, int a2)
{
  int v2; // ecx
  int v3; // eax
  _DWORD *i; // ecx

  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(char *)(v2 + 544) - 1;
  if ( v3 < 0 )
    return 0;
  for ( i = (_DWORD *)(v2 + 8 * (3 * v3 + 69)); *i != a2; i -= 6 )
  {
    if ( --v3 < 0 )
      return 0;
  }
  return 1;
}

//----- (0050A0D0) --------------------------------------------------------
int __cdecl sub_50A0D0(int a1, int a2)
{
  int v2; // ecx
  int v3; // eax
  _DWORD *i; // ecx

  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(char *)(v2 + 544);
  if ( v3 < 0 )
    return 0;
  for ( i = (_DWORD *)(v2 + 8 * (3 * v3 + 69)); *i != a2; i -= 6 )
  {
    if ( --v3 < 0 )
      return 0;
  }
  return 1;
}

//----- (0050A110) --------------------------------------------------------
int __cdecl sub_50A110(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 748);
  *(_BYTE *)(result + 481) = 0;
  *(_BYTE *)(result + 482) = 0;
  *(_BYTE *)(result + 483) = 0;
  *(_DWORD *)(result + 8) = 0;
  *(_DWORD *)(result + 268) = 0;
  *(_DWORD *)(result + 296) = 0;
  *(_DWORD *)(result + 364) = 0;
  *(_DWORD *)(result + 548) = *(_DWORD *)&byte_5D4594[2598000];
  *(_DWORD *)(result + 496) = *(_DWORD *)&byte_5D4594[2598000];
  return result;
}

//----- (0050A160) --------------------------------------------------------
char __cdecl sub_50A160(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // eax
  char v4; // al
  _DWORD *v5; // edi
  int v6; // eax
  void (__cdecl *v7)(int); // eax
  char v8; // cl
  int v9; // edi
  int *v10; // ebp
  int v11; // eax
  char result; // al
  int v13; // [esp-Ch] [ebp-1Ch]
  int v14; // [esp-8h] [ebp-18h]
  int v15; // [esp-4h] [ebp-14h]

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(char *)(v1 + 544);
  v15 = v2;
  v14 = *(_DWORD *)&byte_587000[4 * *(_DWORD *)(v1 + 8 * (3 * v2 + 69)) + 230096];
  v13 = *(_DWORD *)(a1 + 36);
  v3 = sub_4E39D0(a1);
  sub_5341A0((char *)&byte_587000[233876], *(_DWORD *)&byte_5D4594[2598000], v3, v13, v14, v15);
  v4 = *(_BYTE *)(v1 + 544);
  if ( v4 >= 0 )
  {
    v5 = (_DWORD *)(v1 + 24 * (v4 + 23));
    v6 = sub_50A010(*(_DWORD *)(v1 + 24 * (v4 + 23)));
    if ( !v6 )
    {
      if ( v5[5] )
      {
        v7 = *(void (__cdecl **)(int))&byte_587000[16 * *v5 + 233168];
        if ( v7 )
          v7(a1);
      }
    }
  }
  *(_DWORD *)&byte_5D4594[1599692] = 1;
  v8 = *(_BYTE *)(v1 + 544) - 1;
  v9 = v8;
  *(_BYTE *)(v1 + 544) = v8;
  if ( v8 >= 0 )
  {
    v10 = (int *)(v1 + 8 * (3 * v8 + 69));
    do
    {
      v11 = sub_50A010(*v10);
      if ( !v11 )
        break;
      v10 -= 6;
      --v9;
      --*(_BYTE *)(v1 + 544);
    }
    while ( v9 >= 0 );
  }
  sub_50A110(a1);
  result = *(_BYTE *)(v1 + 544);
  if ( result < 0 )
  {
    *(_BYTE *)(v1 + 544) = 0;
    *(_DWORD *)(v1 + 552) = 0;
  }
  return result;
}
// 50A1CB: variable 'v6' is possibly undefined
// 50A21D: variable 'v11' is possibly undefined

//----- (0050A260) --------------------------------------------------------
int *__cdecl sub_50A260(int a1, int a2)
{
  int v2; // esi
  int *result; // eax
  char v4; // cl
  _DWORD *v5; // edi
  int v6; // eax
  void (__cdecl *v7)(int); // eax
  char v8; // al
  int *v9; // esi
  int v10; // eax
  int v11; // [esp-8h] [ebp-18h]
  int v12; // [esp-4h] [ebp-14h]

  v2 = *(_DWORD *)(a1 + 748);
  if ( !(*(_BYTE *)(a1 + 8) & 2) )
    return 0;
  v4 = *(_BYTE *)(v2 + 544);
  if ( v4 == 23 )
    return 0;
  if ( v4 < 0 )
    goto LABEL_19;
  if ( *(_DWORD *)(v2 + 552) == 31 && a2 != 30 )
    return 0;
  v5 = (_DWORD *)(v2 + 24 * (v4 + 23));
  if ( *(_DWORD *)(v2 + 24 * (v4 + 23)) || v4 )
  {
    v6 = sub_50A010(*(_DWORD *)(v2 + 24 * (v4 + 23)));
    if ( !v6 && v5[5] )
    {
      v7 = *(void (__cdecl **)(int))&byte_587000[16 * *v5 + 233172];
      if ( v7 )
        v7(a1);
    }
  }
  else
  {
LABEL_19:
    *(_BYTE *)(v2 + 544) = -1;
  }
  v8 = *(_BYTE *)(v2 + 544) + 1;
  *(_BYTE *)(v2 + 544) = v8;
  v9 = (int *)(v2 + 24 * (v8 + 23));
  *v9 = a2;
  v9[5] = 0;
  sub_50A110(a1);
  v12 = *(_DWORD *)&byte_587000[4 * a2 + 230096];
  v11 = *(_DWORD *)(a1 + 36);
  v10 = sub_4E39D0(a1);
  sub_5341A0((char *)&byte_587000[233916], *(_DWORD *)&byte_5D4594[2598000], v10, v11, v12);
  result = v9;
  *(_DWORD *)&byte_5D4594[1599692] = 1;
  return result;
}
// 50A2CD: variable 'v6' is possibly undefined

//----- (0050A360) --------------------------------------------------------
int *__cdecl sub_50A360(int a1, int a2)
{
  int *result; // eax

  if ( *(_BYTE *)(a1 + 8) & 2
    && *(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23)) != a2 )
  {
    result = sub_50A260(a1, a2);
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (0050A3A0) --------------------------------------------------------
void __cdecl sub_50A3A0(int a1)
{
  if ( *(_BYTE *)(a1 + 8) & 2 && !sub_5341F0(a1) )
  {
    do
      sub_50A160(a1);
    while ( !sub_5341F0(a1) );
  }
}

//----- (0050A3D0) --------------------------------------------------------
int __cdecl sub_50A3D0(_DWORD *a1)
{
  int v1; // ebx
  int i; // edi
  int result; // eax
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  int v7; // ecx
  int v8; // edi
  int v9; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // esi

  v1 = a1[187];
  if ( sub_40A5C0(4096) )
    sub_50E1E0((int)a1);
  for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
  {
    if ( (_DWORD *)sub_4DDF30(i) == a1 )
      sub_4DDEF0(i);
  }
  sub_50A3A0((int)a1);
  sub_50A260((int)a1, 31);
  sub_50A260((int)a1, 30);
  result = sub_534A40((int)a1);
  if ( !result )
  {
    v4 = a1[4];
    LOBYTE(v4) = v4 & 0x7F;
    a1[4] = v4;
    sub_4DA9F0(a1);
    sub_4FF580((int)a1);
    if ( (signed char)*(_BYTE *)(v1 + 1440) >= 0 )
    {
      if ( !sub_40A5C0(4096) )
        goto LABEL_13;
      v5 = sub_415FA0(5, 8);
    }
    else
    {
      v5 = sub_415FA0(10, 20);
    }
    sub_511660(a1, *(_DWORD *)&byte_5D4594[2649704] * v5);
LABEL_13:
    v6 = a1[127];
    if ( v6 && *(_BYTE *)(v6 + 8) & 4 )
    {
      v7 = a1[3];
      v8 = *(_DWORD *)(v6 + 748);
      LOBYTE(v7) = v7 & 0x7F;
      a1[3] = v7;
      sub_4D9200(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (int)a1);
      sub_417300(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (int)a1, 1);
    }
    v9 = a1[3];
    BYTE1(v9) &= 0xFEu;
    a1[3] = v9;
    sub_4EC4B0((int)a1);
    sub_4EC300((int)a1);
    v10 = a1[3];
    if ( !(v10 & 0x2000) )
      sub_4EDA40(a1);
    if ( !sub_40A5C0(2048) && *(_DWORD *)(v1 + 2188) == 2 && *(_DWORD *)(v1 + 2184) == 2 )
    {
      if ( a1[130] )
      {
        v11 = sub_4EC580(a1[130]);
        if ( *(_BYTE *)(v11 + 8) & 4 )
          sub_4FC0B0(v11, 1);
      }
    }
    result = sub_40A5C0(4096);
    if ( result )
    {
      v12 = a1[130];
      if ( v12 )
      {
        result = sub_4EC580(v12);
        if ( *(_BYTE *)(result + 8) & 4 )
          result = sub_4D6170(result);
      }
    }
  }
  return result;
}

//----- (0050A5C0) --------------------------------------------------------
int __cdecl sub_50A5C0(float a1)
{
  int v1; // esi
  int v2; // edi
  char v3; // al
  int v4; // eax
  int result; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  unsigned __int16 *v9; // eax
  int v10; // ecx
  unsigned __int16 v11; // cx
  int v12; // ecx
  int v13; // eax
  int v14; // edx
  int v15; // ebp
  int v16; // edx
  _DWORD *v17; // eax
  void (__cdecl *v18)(int); // eax
  int v19; // ebx
  unsigned __int8 v20; // cl
  int v21; // [esp+14h] [ebp+4h]

  v1 = LODWORD(a1);
  v2 = *(_DWORD *)(LODWORD(a1) + 748);
  v3 = *(_BYTE *)(v2 + 2094);
  if ( v3 )
    *(_BYTE *)(v2 + 2094) = v3 - 1;
  v4 = *(_DWORD *)(v2 + 2192);
  if ( v4 && *(_DWORD *)(v4 + 16) & 0x8020 )
    *(_DWORD *)(v2 + 2192) = 0;
  sub_50A910(SLODWORD(a1));
  sub_50CDD0(SLODWORD(a1));
  result = *(_DWORD *)(LODWORD(a1) + 16);
  if ( result & 0x1000000 )
  {
    *(_DWORD *)&byte_5D4594[1599692] = 0;
    result = *(_DWORD *)(v2 + 484);
    if ( result )
    {
      if ( !(*(_DWORD *)(LODWORD(a1) + 16) & 0x8020) )
      {
        v6 = *(_DWORD *)(v2 + 1440);
        if ( v6 & 0x200 )
        {
          v7 = sub_424300(SLODWORD(a1));
          if ( v7 )
            sub_501960(*(_DWORD *)(v7 + 64), SLODWORD(a1), 0, 0);
          sub_502490((int *)(v2 + 1248), *(_DWORD *)(LODWORD(a1) + 520), SLODWORD(a1));
          sub_5341A0(
            (char *)&byte_587000[234068],
            *(_DWORD *)&byte_5D4594[2598000],
            **(unsigned __int16 **)(LODWORD(a1) + 556),
            *(unsigned __int16 *)(*(_DWORD *)(LODWORD(a1) + 556) + 4));
        }
        v8 = *(_DWORD *)(v2 + 520);
        if ( v8 && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v8) >= *(int *)&byte_5D4594[2649704] )
        {
          sub_532800(SLODWORD(a1));
          *(_DWORD *)(v2 + 520) = 0;
        }
        sub_5469B0(SLODWORD(a1));
      }
      v9 = *(unsigned __int16 **)(LODWORD(a1) + 556);
      if ( v9 )
      {
        v10 = *(_DWORD *)(LODWORD(a1) + 16);
        if ( (v10 & 0x8000) == 0
          && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(LODWORD(a1) + 536)) > *(int *)&byte_5D4594[2649704] )
        {
          v11 = v9[2];
          if ( *v9 < v11
            && v11
            && !(*(_DWORD *)&byte_5D4594[2598000] % (180 * *(_DWORD *)&byte_5D4594[2649704] / (unsigned int)v9[2])) )
          {
            sub_4EE460(SLODWORD(a1), 1);
          }
        }
      }
      sub_5281F0(a1);
      sub_547210(SLODWORD(a1));
      sub_546A70(SLODWORD(a1));
      sub_50A850(SLODWORD(a1));
      v12 = *(_DWORD *)&byte_5D4594[1599692];
      v21 = *(_DWORD *)&byte_5D4594[1599692];
      while ( 1 )
      {
        v13 = *(char *)(v2 + 544);
        v14 = 3 * v13 + 69;
        v13 *= 3;
        v15 = *(_DWORD *)(v2 + 8 * v14);
        v16 = *(_DWORD *)(v2 + 8 * v13 + 572);
        v17 = (_DWORD *)(v2 + 8 * v13 + 572);
        if ( v16 )
          break;
        *v17 = 1;
        *(_DWORD *)&byte_5D4594[1599692] = 0;
        v18 = *(void (__cdecl **)(int))&byte_587000[16 * v15 + 233160];
        if ( v18 )
        {
          v18(v1);
          v12 = *(_DWORD *)&byte_5D4594[1599692];
          if ( *(_DWORD *)&byte_5D4594[1599692] )
            continue;
        }
        goto LABEL_30;
      }
      if ( v12 )
        goto LABEL_31;
LABEL_30:
      *(_DWORD *)&byte_5D4594[1599692] = v21;
LABEL_31:
      (*(void (__cdecl **)(int))&byte_587000[16 * v15 + 233164])(v1);
      if ( *(_DWORD *)&byte_5D4594[1599692] )
        sub_509F60(v1, (int)&byte_587000[234084]);
      v19 = *(_DWORD *)(v2 + 1440);
      BYTE1(v19) &= 0xFDu;
      *(_DWORD *)(v2 + 1440) = v19;
      sub_421FF0(v1);
      v20 = *(_BYTE *)(v2 + 1128);
      if ( v20 < 0x64u )
        *(_BYTE *)(v2 + 1128) = v20 + 0x64u / *(_DWORD *)&byte_5D4594[2649704];
      if ( sub_534840(v1) )
        sub_534950(v1);
      result = *(_DWORD *)&byte_5D4594[2649704];
      if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 536) > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) )
        *(_DWORD *)(v2 + 1440) &= 0xFFF7FFFF;
    }
  }
  return result;
}

//----- (0050A850) --------------------------------------------------------
char __cdecl sub_50A850(int a1)
{
  _BYTE *v1; // esi
  unsigned __int8 *v2; // eax
  unsigned __int8 v3; // cl
  unsigned __int8 v4; // cl
  unsigned __int8 v5; // dl
  unsigned __int8 v6; // cl

  v1 = *(_BYTE **)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
  {
    v2 = *(unsigned __int8 **)&v1[24 * (char)v1[544] + 552];
    if ( v2 == (unsigned __int8 *)16 || v2 == (unsigned __int8 *)17 )
    {
      v1[483] = 0;
      return (char)v2;
    }
  }
  LOBYTE(v2) = v1[483];
  if ( !(_BYTE)v2 )
  {
    v2 = sub_533D00(a1);
    if ( v2 )
    {
      v1[480] = v2[9];
      if ( !v2[9] )
        goto LABEL_13;
      v3 = v1[482] + 1;
      v1[482] = v3;
      if ( v3 >= v2[10] + 1 )
      {
        v4 = v1[481];
        v1[482] = 0;
        v1[481] = ++v4;
        v5 = v4;
        v6 = v2[9];
        if ( v5 >= v6 )
        {
          if ( *((_DWORD *)v2 + 3) )
          {
            v1[481] = 0;
            return (char)v2;
          }
          v1[481] = v6 - 1;
LABEL_13:
          v1[483] = 1;
          return (char)v2;
        }
      }
    }
  }
  return (char)v2;
}

//----- (0050A910) --------------------------------------------------------
int __cdecl sub_50A910(int a1)
{
  int v1; // ecx
  int v2; // eax
  int result; // eax
  _DWORD *v4; // esi
  int v5; // edi
  _DWORD *v6; // ebx
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // eax
  int v11; // ecx
  int v12; // [esp+0h] [ebp-8h]
  int v13; // [esp+4h] [ebp-4h]

  v1 = *(_DWORD *)(a1 + 748);
  v12 = v1;
  v2 = *(_DWORD *)(v1 + 1216);
  if ( v2 && *(_DWORD *)(v2 + 16) & 0x8020 )
    *(_DWORD *)(v1 + 1216) = 0;
  result = *(char *)(v1 + 544);
  if ( result >= 0 )
  {
    v4 = (_DWORD *)(v1 + 8 * (3 * result + 69));
    v13 = result + 1;
    while ( 1 )
    {
      v5 = 0;
      if ( *(_DWORD *)&byte_587000[16 * *v4 + 230388] > 0 )
      {
        v6 = v4 + 1;
        do
        {
          if ( *(_DWORD *)&byte_587000[4 * (v5 + 4 * *v4) + 230392] == 1 && *v6 )
            sub_509FF0((int)v6);
          ++v5;
          v6 += 2;
        }
        while ( v5 < *(int *)&byte_587000[16 * *v4 + 230388] );
        v1 = v12;
      }
      switch ( *v4 )
      {
        case 3:
          v7 = v4[3];
          if ( v7 )
            goto LABEL_26;
          break;
        case 7:
        case 8:
          v10 = v4[3];
          if ( v10 )
          {
            if ( sub_5370E0(a1, v10, 0) || sub_50A0D0(a1, 3) )
            {
              v7 = v4[3];
              v11 = *(_DWORD *)(v7 + 56);
              goto LABEL_27;
            }
            v4[3] = 0;
          }
          break;
        case 0xF:
          v7 = *(_DWORD *)(v1 + 1196);
          if ( v7 )
          {
LABEL_26:
            v11 = *(_DWORD *)(v7 + 56);
LABEL_27:
            v4[1] = v11;
            v4[2] = *(_DWORD *)(v7 + 60);
          }
          break;
        case 0x11:
          v8 = v4[3];
          if ( v8 && sub_5370E0(a1, v8, 0) )
          {
            v9 = v4[3];
            v4[1] = *(_DWORD *)(v9 + 56);
            v4[2] = *(_DWORD *)(v9 + 60);
          }
          break;
        default:
          break;
      }
      v4 -= 6;
      result = --v13;
      if ( !v13 )
        break;
      v1 = v12;
    }
  }
  return result;
}

//----- (0050AA90) --------------------------------------------------------
int __cdecl sub_50AA90(int a1)
{
  int v1; // edx
  int v2; // eax
  _DWORD *i; // ecx
  int v5; // esi

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(char *)(v1 + 544);
  if ( v2 < 0 )
    return 0;
  for ( i = (_DWORD *)(v1 + 8 * (3 * v2 + 69)); *i != 3; i -= 6 )
  {
    if ( --v2 < 0 )
      return 0;
  }
  v5 = v1 + 24 * v2 + 564;
  if ( *(_DWORD *)v5 )
    sub_509FF0(v5);
  return *(_DWORD *)v5;
}

//----- (0050AAE0) --------------------------------------------------------
int sub_50AAE0()
{
  int v0; // eax

  v0 = sub_4DA790();
  *(_DWORD *)&byte_5D4594[1599696] = v0;
  if ( !v0 )
    return 0;
  while ( !(*(_BYTE *)(v0 + 8) & 2) )
  {
    v0 = sub_4DA7A0(v0);
    *(_DWORD *)&byte_5D4594[1599696] = v0;
    if ( !v0 )
      return 0;
  }
  return v0 + 56;
}

//----- (0050AB10) --------------------------------------------------------
int sub_50AB10()
{
  int v0; // eax

  v0 = sub_4DA7A0(*(int *)&byte_5D4594[1599696]);
  *(_DWORD *)&byte_5D4594[1599696] = v0;
  if ( !v0 )
    return 0;
  while ( !(*(_BYTE *)(v0 + 8) & 2) )
  {
    v0 = sub_4DA7A0(v0);
    *(_DWORD *)&byte_5D4594[1599696] = v0;
    if ( !v0 )
      return 0;
  }
  return v0 + 56;
}

//----- (0050AB50) --------------------------------------------------------
__int16 __cdecl sub_50AB50(int a1, int a2)
{
  __int16 result; // ax

  if ( a1 < 0 || a1 >= 256 || a2 < 0 || a2 >= 256 )
    result = 0;
  else
    result = *(_WORD *)&byte_5D4594[12 * (a2 + (a1 << 8)) + 1599724];
  return result;
}

//----- (0050AB90) --------------------------------------------------------
int sub_50AB90()
{
  int result; // eax

  result = sub_413FE0((const char *)&byte_587000[234344], 16, 1024);
  *(_DWORD *)&byte_5D4594[2386184] = result;
  if ( result )
  {
    *(_DWORD *)&byte_5D4594[2386176] = nox_malloc(0x2000u);
    if ( *(_DWORD *)&byte_5D4594[2386176] )
    {
      *(_DWORD *)&byte_5D4594[2386172] = 0;
      result = 1;
    }
    else
    {
      sub_414100(*(LPVOID *)&byte_5D4594[2386184]);
      result = 0;
    }
  }
  return result;
}

//----- (0050ABF0) --------------------------------------------------------
void sub_50ABF0()
{
  free(*(LPVOID *)&byte_5D4594[2386176]);
  sub_414100(*(LPVOID *)&byte_5D4594[2386184]);
  *(_DWORD *)&byte_5D4594[2386184] = 0;
}

//----- (0050AC20) --------------------------------------------------------
int __cdecl sub_50AC20(int a3, _WORD *a2)
{
  unsigned __int16 *v2; // ecx
  unsigned __int16 v3; // dx
  unsigned __int16 v4; // ax
  unsigned __int16 v5; // dx
  __int16 v6; // ax
  _DWORD *v7; // esi
  _WORD *v8; // edi
  int result; // eax
  int v10; // eax
  int v11; // esi
  int v12; // esi
  __int16 v13; // ax
  _WORD *v14; // edi
  __int16 v15; // ax
  _WORD *v16; // edi
  float v17; // [esp+0h] [ebp-18h]
  float v18; // [esp+0h] [ebp-18h]
  float v19; // [esp+0h] [ebp-18h]
  float v20; // [esp+0h] [ebp-18h]
  int v21; // [esp+Ch] [ebp-Ch]
  float2 a1; // [esp+10h] [ebp-8h]

  v2 = (unsigned __int16 *)a3;
  v3 = *(_WORD *)(a3 + 2);
  a3 = *(unsigned __int16 *)a3;
  v21 = v3;
  if ( !(byte_5D4594[12 * (v3 + (a3 << 8)) + 1599724] & 0x3C) )
    return 0;
  *(_DWORD *)&byte_5D4594[2386152] = 0;
  v4 = *v2;
  v5 = v2[1];
  a1.field_0 = (double)a3 * 23.0;
  v6 = *(_WORD *)&byte_5D4594[12 * (v5 + (v4 << 8)) + 1599724];
  a1.field_4 = (double)v21 * 23.0;
  if ( v6 & 0x10 )
  {
    a3 = 2048;
    sub_517B70(&a1, sub_50AE80, (int)&a3);
    if ( *(_DWORD *)&byte_5D4594[2386152] )
    {
      v7 = (_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 700) + 8);
      if ( *(int *)(*(_DWORD *)&byte_5D4594[2386152] + 700) != -8 )
      {
        if ( *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 16) & 0x1000000 )
        {
          v8 = a2;
          *a2 = (__int16)*(int*)v7 / 23;
          result = 1;
          v8[1] = (int)v7[1] / 23;
          return result;
        }
      }
    }
    return 0;
  }
  if ( v6 & 0x20 )
  {
    a3 = 1024;
    sub_517B70(&a1, sub_50AE80, (int)&a3);
    v10 = *(_DWORD *)&byte_5D4594[2386152];
    if ( !*(_DWORD *)&byte_5D4594[2386152] )
      return 0;
    v11 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 748) + 12);
    goto LABEL_18;
  }
  if ( v6 & 4 )
  {
    a3 = 0x4000;
    sub_517B70(&a1, sub_50AE80, (int)&a3);
    if ( *(_DWORD *)&byte_5D4594[2386152] )
    {
      v12 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 748) + 4);
      if ( v12 )
      {
        if ( *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 16) & 0x1000000 )
        {
          v17 = *(float *)(v12 + 56) * 0.043478262;
          v13 = sub_419A70(v17);
          v14 = a2;
          *a2 = v13;
          v18 = *(float *)(v12 + 60) * 0.043478262;
          v14[1] = sub_419A70(v18);
          return 1;
        }
      }
    }
    return 0;
  }
  if ( v6 & 8 )
  {
    a3 = 0x8000;
    sub_517B70(&a1, sub_50AE80, (int)&a3);
    v10 = *(_DWORD *)&byte_5D4594[2386152];
    if ( *(_DWORD *)&byte_5D4594[2386152] )
    {
      v11 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 748) + 4);
LABEL_18:
      if ( v11 && *(_DWORD *)(v10 + 16) & 0x1000000 )
      {
        v19 = *(float *)(v11 + 56) * 0.043478262;
        v15 = sub_419A70(v19);
        v16 = a2;
        *a2 = v15;
        v20 = *(float *)(v11 + 60) * 0.043478262;
        v16[1] = sub_419A70(v20);
        return 1;
      }
      return 0;
    }
  }
  return 0;
}

//----- (0050AE80) --------------------------------------------------------
void __cdecl sub_50AE80(int a1, int a2)
{
  if ( *(_DWORD *)(a1 + 8) & *(_DWORD *)a2 )
    *(_DWORD *)&byte_5D4594[2386152] = a1;
}

//----- (0050AEA0) --------------------------------------------------------
int __cdecl sub_50AEA0(int a1, float2 *a2, _DWORD *a3)
{
  unsigned __int16 *v3; // ecx
  unsigned __int16 v4; // dx
  unsigned __int16 v5; // ax
  unsigned __int16 v6; // dx
  __int16 v7; // ax
  int v9; // [esp+0h] [ebp-Ch]
  float2 a1a; // [esp+4h] [ebp-8h]

  v3 = (unsigned __int16 *)a1;
  v4 = *(_WORD *)(a1 + 2);
  a1 = *(unsigned __int16 *)a1;
  v9 = v4;
  if ( !(byte_5D4594[12 * (v4 + (a1 << 8)) + 1599724] & 0x3C) )
    return 0;
  *(_DWORD *)&byte_5D4594[2386152] = 0;
  v5 = *v3;
  v6 = v3[1];
  a1a.field_0 = (double)a1 * 23.0;
  v7 = *(_WORD *)&byte_5D4594[12 * (v6 + (v5 << 8)) + 1599724];
  a1a.field_4 = (double)v9 * 23.0;
  if ( v7 & 0x10 )
  {
    a1 = 2048;
  }
  else if ( v7 & 0x20 )
  {
    a1 = 1024;
  }
  else if ( v7 & 4 )
  {
    a1 = 0x4000;
  }
  else if ( v7 & 8 )
  {
    a1 = 0x8000;
  }
  sub_517B70(&a1a, sub_50AE80, (int)&a1);
  if ( !*(_DWORD *)&byte_5D4594[2386152] || !(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 16) & 0x1000000) )
    return 0;
  *a2 = *(float2 *)(*(_DWORD *)&byte_5D4594[2386152] + 56);
  *a3 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386152] + 36);
  return 1;
}

//----- (0050AFA0) --------------------------------------------------------
float *sub_50AFA0()
{
  int i; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // esi
  int v5; // eax
  int v6; // esi
  int v7; // eax
  int v8; // esi
  int v9; // eax
  int v10; // eax
  double v11; // st7
  int v12; // ebx
  int v13; // esi
  int v14; // eax
  int v15; // ecx
  unsigned __int8 *v16; // ebp
  float *v17; // esi
  __int16 v18; // ax
  float *result; // eax
  float *k; // edi
  int v21; // esi
  int v22; // eax
  float v23; // [esp+0h] [ebp-3Ch]
  float v24; // [esp+0h] [ebp-3Ch]
  float v25; // [esp+0h] [ebp-3Ch]
  float v26; // [esp+0h] [ebp-3Ch]
  float v27; // [esp+0h] [ebp-3Ch]
  float v28; // [esp+0h] [ebp-3Ch]
  float v29; // [esp+0h] [ebp-3Ch]
  float v30; // [esp+0h] [ebp-3Ch]
  float v31; // [esp+0h] [ebp-3Ch]
  float v32; // [esp+0h] [ebp-3Ch]
  float v33; // [esp+0h] [ebp-3Ch]
  float v34; // [esp+0h] [ebp-3Ch]
  float v35; // [esp+4h] [ebp-38h]
  float v36; // [esp+4h] [ebp-38h]
  int j; // [esp+14h] [ebp-28h]
  int v38; // [esp+18h] [ebp-24h]
  int v39; // [esp+1Ch] [ebp-20h]
  int v40; // [esp+20h] [ebp-1Ch]
  float v41; // [esp+24h] [ebp-18h]
  float v42; // [esp+28h] [ebp-14h]
  float2 a2; // [esp+2Ch] [ebp-10h]
  int v44; // [esp+34h] [ebp-8h]

  *(_DWORD *)&byte_5D4594[2386160] = 0;
  memset(&byte_5D4594[1599716], 0, 0xC0000u);
  *(_DWORD *)&byte_5D4594[2386164] = 0;
  for ( i = sub_4DA790(); i; i = sub_4DA7A0(i) )
  {
    sub_50B2C0(i);
    v1 = *(_DWORD *)(i + 8);
    if ( (v1 & 0x80u) == 0 )
    {
      if ( v1 & 0x800 )
      {
        v23 = *(float *)(i + 56) * 0.043478262;
        v2 = sub_419A70(v23);
        v24 = *(float *)(i + 60) * 0.043478262;
        v3 = sub_419A70(v24);
        byte_5D4594[12 * (v3 + (v2 << 8)) + 1599724] |= 0x10u;
      }
      else if ( v1 & 0x400 )
      {
        v25 = *(float *)(i + 56) * 0.043478262;
        v4 = sub_419A70(v25);
        v26 = *(float *)(i + 60) * 0.043478262;
        v5 = sub_419A70(v26);
        byte_5D4594[12 * (v5 + (v4 << 8)) + 1599724] |= 0x20u;
      }
      else if ( v1 & 0x4000 )
      {
        v27 = *(float *)(i + 56) * 0.043478262;
        v6 = sub_419A70(v27);
        v28 = *(float *)(i + 60) * 0.043478262;
        v7 = sub_419A70(v28);
        byte_5D4594[12 * (v7 + (v6 << 8)) + 1599724] |= 4u;
      }
      else if ( (v1 & 0x8000) == 0 )
      {
        if ( !(*(_BYTE *)(i + 16) & 0x49) )
        {
          if ( v1 & 0x400000 )
          {
            v31 = *(float *)(i + 232) * 0.043478262;
            v10 = sub_419A70(v31);
            v11 = *(float *)(i + 236) * 0.043478262;
            v12 = v10;
            v44 = v10;
            v32 = v11;
            v13 = sub_419A70(v32);
            v33 = *(float *)(i + 240) * 0.043478262;
            v39 = sub_419A70(v33);
            v34 = *(float *)(i + 244) * 0.043478262;
            v14 = sub_419A70(v34);
            v15 = v13;
            v40 = v14;
            for ( j = v13; v15 <= v14; j = v15 )
            {
              v38 = v12;
              if ( v12 <= v39 )
              {
                v16 = &byte_5D4594[12 * (v15 + (v12 << 8)) + 1599724];
                do
                {
                  v17 = (float *)&byte_587000[234108];
                  while ( 1 )
                  {
                    v41 = (double)v38 * 23.0;
                    a2.field_0 = v41 + *(v17 - 1);
                    v42 = (double)j * 23.0;
                    a2.field_4 = v42 + *v17;
                    if ( sub_547DB0(i, &a2) )
                      break;
                    v17 += 2;
                    if ( (int)v17 >= (int)&byte_587000[234180] )
                      goto LABEL_22;
                  }
                  v18 = *(_WORD *)v16;
                  LOBYTE(v18) = *(unsigned __int16 *)v16 | 1;
                  *(_WORD *)v16 = v18;
                  if ( !(*(_BYTE *)(i + 16) & 0x10) )
                  {
                    LOBYTE(v18) = v18 | 2;
                    *(_WORD *)v16 = v18;
                  }
LABEL_22:
                  ++v12;
                  v16 += 3072;
                  v38 = v12;
                }
                while ( v12 <= v39 );
                v15 = j;
                v14 = v40;
                v12 = v44;
              }
              ++v15;
            }
          }
        }
      }
      else
      {
        v29 = *(float *)(i + 56) * 0.043478262;
        v8 = sub_419A70(v29);
        v30 = *(float *)(i + 60) * 0.043478262;
        v9 = sub_419A70(v30);
        byte_5D4594[12 * (v9 + (v8 << 8)) + 1599724] |= 8u;
      }
    }
  }
  result = (float *)sub_579860();
  for ( k = result; result; k = result )
  {
    if ( sub_579EE0((int)k, 0x80u) )
    {
      v35 = k[2] * 0.043478262;
      v21 = sub_419A70(v35);
      v36 = k[3] * 0.043478262;
      v22 = sub_419A70(v36);
      *(_WORD *)&byte_5D4594[12 * (v22 + (v21 << 8)) + 1599724] |= 0x40u;
    }
    result = (float *)sub_579870((int)k);
  }
  return result;
}

//----- (0050B2C0) --------------------------------------------------------
int __cdecl sub_50B2C0(int a1)
{
  int v1; // ebp
  int result; // eax
  double v3; // st7
  int v4; // eax
  double v5; // st7
  int v6; // ebx
  int v7; // esi
  int v8; // eax
  int v9; // ecx
  unsigned __int8 *v10; // edi
  float *v11; // esi
  int v12; // eax
  __int16 v13; // ax
  float v14; // [esp+0h] [ebp-74h]
  float v15; // [esp+0h] [ebp-74h]
  float v16; // [esp+0h] [ebp-74h]
  float v17; // [esp+0h] [ebp-74h]
  int v18; // [esp+14h] [ebp-60h]
  int v19; // [esp+18h] [ebp-5Ch]
  int v20; // [esp+1Ch] [ebp-58h]
  float v21; // [esp+20h] [ebp-54h]
  float v22; // [esp+24h] [ebp-50h]
  float2 a2; // [esp+28h] [ebp-4Ch]
  int v24; // [esp+30h] [ebp-44h]
  char v25[60]; // [esp+38h] [ebp-3Ch]
  int a1a; // [esp+78h] [ebp+4h]

  v1 = a1;
  result = *(_DWORD *)(a1 + 8);
  if ( !(result & 0xC080)
    && (result & 0x2000 || !(*(_BYTE *)(a1 + 16) & 0x49))
    && (result & 0x2008 || *(_BYTE *)(a1 + 16) & 2) )
  {
    if ( result & 0x10000 )
    {
      qmemcpy(v25, (const void *)(a1 + 172), sizeof(v25));
      if ( *(_DWORD *)(a1 + 172) == 2 )
      {
        v3 = *(float *)&byte_587000[234176] + *(float *)(a1 + 176);
        *(float *)(a1 + 176) = v3;
        *(float *)(a1 + 180) = v3 * v3;
      }
      else if ( *(_DWORD *)(a1 + 172) == 3 )
      {
        *(float *)(a1 + 184) = *(float *)&byte_587000[234176] + *(float *)&byte_587000[234176] + *(float *)(a1 + 184);
        *(float *)(a1 + 188) = *(float *)&byte_587000[234176] + *(float *)&byte_587000[234176] + *(float *)(a1 + 188);
        sub_428270((shape *)(a1 + 172));
      }
      sub_4E7290(a1);
    }
    v14 = *(float *)(a1 + 232) * 0.043478262;
    v4 = sub_419A70(v14);
    v5 = *(float *)(a1 + 236) * 0.043478262;
    v6 = v4;
    v24 = v4;
    v15 = v5;
    v7 = sub_419A70(v15);
    v16 = *(float *)(a1 + 240) * 0.043478262;
    v19 = sub_419A70(v16);
    v17 = *(float *)(a1 + 244) * 0.043478262;
    v8 = sub_419A70(v17);
    v9 = v7;
    v20 = v8;
    for ( a1a = v7; v9 <= v8; a1a = v9 )
    {
      v18 = v6;
      if ( v6 <= v19 )
      {
        v10 = &byte_5D4594[12 * (v9 + (v6 << 8)) + 1599724];
        do
        {
          v11 = (float *)&byte_587000[234108];
          while ( 1 )
          {
            v21 = (double)v18 * 23.0;
            a2.field_0 = v21 + *(v11 - 1);
            v22 = (double)a1a * 23.0;
            a2.field_4 = v22 + *v11;
            if ( sub_547DB0(v1, &a2) )
              break;
            v11 += 2;
            if ( (int)v11 >= (int)&byte_587000[234180] )
              goto LABEL_25;
          }
          *((_DWORD *)v10 - 1) = *(_DWORD *)&byte_5D4594[2386164];
          v12 = *(_DWORD *)(v1 + 8);
          if ( v12 & 8 || *(_BYTE *)(v1 + 16) & 2 )
          {
            v13 = *(_WORD *)v10 | 0x100;
            *(_WORD *)v10 = v13;
            if ( !(*(_BYTE *)(v1 + 16) & 0x10) )
            {
              HIBYTE(v13) |= 2u;
              *(_WORD *)v10 = v13;
            }
          }
          else if ( v12 & 0x2000 )
          {
            v10[1] |= 4u;
          }
LABEL_25:
          ++v6;
          v10 += 3072;
          v18 = v6;
        }
        while ( v6 <= v19 );
        v9 = a1a;
        v8 = v20;
        v6 = v24;
      }
      ++v9;
    }
    result = *(_DWORD *)(v1 + 8);
    if ( result & 0x10000 )
    {
      qmemcpy((void *)(v1 + 172), v25, 0x3Cu);
      result = sub_4E7290(v1);
    }
  }
  return result;
}

//----- (0050B500) --------------------------------------------------------
void sub_50B500()
{
  *(_DWORD *)&byte_5D4594[2386168] = 0;
}

//----- (0050B510) --------------------------------------------------------
int sub_50B510()
{
  int result; // eax

  result = 0;
  *(_DWORD *)&byte_5D4594[2386168] = 0;
  *(_DWORD *)&byte_5D4594[2386172] = 0;
  return result;
}

//----- (0050B520) --------------------------------------------------------
int sub_50B520()
{
  int result; // eax
  int i; // esi

  result = *(_DWORD *)&byte_5D4594[2598000];
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)&byte_5D4594[2386172]) >= 0xF )
  {
    *(_DWORD *)&byte_5D4594[2386172] = *(_DWORD *)&byte_5D4594[2598000];
    ++*(_DWORD *)&byte_5D4594[2386164];
    result = sub_4DA790();
    for ( i = result; result; i = result )
    {
      sub_50B2C0(i);
      result = sub_4DA7A0(i);
    }
    *(_DWORD *)&byte_5D4594[2386168] = 1;
  }
  return result;
}

//----- (0050B580) --------------------------------------------------------
int __cdecl sub_50B580(int a1, float4 *a3)
{
  float v2; // edx
  bool v3; // c0
  float v4; // edx
  float4 a1a; // [esp+0h] [ebp-10h]

  if ( a3->field_0 >= (double)a3->field_8 )
  {
    v2 = a3->field_0;
    a1a.field_0 = a3->field_8;
  }
  else
  {
    v2 = a3->field_8;
    a1a.field_0 = a3->field_0;
  }
  v3 = a3->field_4 < (double)a3->field_C;
  a1a.field_8 = v2;
  if ( v3 )
  {
    v4 = a3->field_C;
    a1a.field_4 = a3->field_4;
  }
  else
  {
    v4 = a3->field_4;
    a1a.field_4 = a3->field_C;
  }
  a1a.field_C = v4;
  *(_DWORD *)&byte_5D4594[2386156] = 1;
  *(_DWORD *)&byte_5D4594[2386148] = a1;
  sub_517C10(&a1a, (void (__cdecl *)(float *, int))sub_50B600, (int)a3);
  return *(_DWORD *)&byte_5D4594[2386156];
}

//----- (0050B600) --------------------------------------------------------
void __cdecl sub_50B600(float *arg0, float4 *a1)
{
  int v2; // eax
  int v3; // eax
  double v4; // st6
  double v5; // st7
  double v6; // st7
  double v7; // st7
  double v8; // st7
  float v9; // [esp+10h] [ebp-30h]
  float v10; // [esp+14h] [ebp-2Ch]
  float v11; // [esp+1Ch] [ebp-24h]
  float v12; // [esp+20h] [ebp-20h]
  float v13; // [esp+24h] [ebp-1Ch]
  float2 a3; // [esp+28h] [ebp-18h]
  float4 a2; // [esp+30h] [ebp-10h]

  if ( *(_DWORD *)&byte_5D4594[2386156] && *(float **)&byte_5D4594[2386148] != arg0 )
  {
    v2 = *((_DWORD *)arg0 + 2);
    if ( v2 & 6 )
    {
      if ( sub_5330C0(*(int *)&byte_5D4594[2386148], (int)arg0) )
        return;
    }
    else if ( !(v2 & 0x400008) )
    {
      return;
    }
    if ( !((_BYTE)arg0[4] & 0x48) && (signed char)*((_BYTE *)arg0 + 8) >= 0 )
    {
      v3 = *((_DWORD *)arg0 + 43);
      if ( v3 == 2 )
      {
        if ( sub_57C8A0(a1, (float2 *)arg0 + 7, &a3) )
        {
          v4 = a3.field_4 - arg0[15];
          if ( v4 * v4 + (a3.field_0 - arg0[14]) * (a3.field_0 - arg0[14]) <= arg0[45] )
            *(_DWORD *)&byte_5D4594[2386156] = 0;
        }
      }
      else if ( v3 == 3 )
      {
        v12 = arg0[48] + arg0[14];
        v5 = arg0[49] + arg0[15];
        a2.field_0 = v12;
        v13 = v5;
        v6 = arg0[50] + arg0[14];
        a2.field_4 = v13;
        v9 = v6;
        v7 = arg0[51] + arg0[15];
        a2.field_8 = v9;
        v10 = v7;
        v8 = arg0[52] + arg0[14];
        a2.field_C = v10;
        v11 = arg0[53] + arg0[15];
        a3.field_0 = arg0[54] + arg0[14];
        a3.field_4 = arg0[55] + arg0[15];
        if ( sub_427980(a1, &a2) )
        {
          *(_DWORD *)&byte_5D4594[2386156] = 0;
        }
        else
        {
          a2.field_0 = v12;
          a2.field_4 = v13;
          a2.field_8 = v8;
          a2.field_C = v11;
          if ( sub_427980(a1, &a2) )
            goto LABEL_22;
          a2.field_0 = a3.field_0;
          a2.field_4 = a3.field_4;
          a2.field_8 = v8;
          a2.field_C = v11;
          if ( sub_427980(a1, &a2)
            || (a2.field_0 = a3.field_0, a2.field_4 = a3.field_4, a2.field_8 = v9, a2.field_C = v10, sub_427980(a1, &a2)) )
          {
LABEL_22:
            *(_DWORD *)&byte_5D4594[2386156] = 0;
          }
        }
      }
    }
  }
}

//----- (0050B810) --------------------------------------------------------
BOOL __cdecl sub_50B810(int a1, float *a2)
{
  int v2; // esi
  int v3; // edi
  BOOL result; // eax
  float v5; // [esp+0h] [ebp-10h]
  float v6; // [esp+0h] [ebp-10h]

  v5 = *a2 * 0.043478262;
  v2 = sub_419A70(v5);
  v6 = a2[1] * 0.043478262;
  v3 = sub_419A70(v6);
  if ( sub_50B870(a1, v2, v3) )
    result = 0;
  else
    result = sub_50B8A0(a1, v2, v3);
  return result;
}

//----- (0050B870) --------------------------------------------------------
BOOL __cdecl sub_50B870(int a1, int a2, int a3)
{
  return sub_57B630(a1, a2, a3) != -1;
}

//----- (0050B8A0) --------------------------------------------------------
BOOL __cdecl sub_50B8A0(int a1, int a2, int a3)
{
  BOOL result; // eax

  if ( sub_50B950(a1, a2, a3) )
    result = 0;
  else
    result = sub_50B8E0(a1, a2, a3) == 0;
  return result;
}

//----- (0050B8E0) --------------------------------------------------------
unsigned int __cdecl sub_50B8E0(int a1, int a2, int a3)
{
  int v3; // esi
  unsigned int v4; // eax
  int v5; // ecx
  unsigned int result; // eax

  v3 = 12 * (a3 + (a2 << 8));
  if ( *(_DWORD *)&byte_5D4594[v3 + 1599720] != *(_DWORD *)&byte_5D4594[2386164] )
    goto LABEL_12;
  HIWORD(v4) = HIWORD(a1);
  v5 = *(_DWORD *)(a1 + 16);
  if ( v5 & 0x4000 )
  {
    LOWORD(v4) = *(_WORD *)&byte_5D4594[v3 + 1599724];
    return (v4 >> 9) & 1;
  }
  if ( byte_5D4594[v3 + 1599725] & 1 )
    return 1;
  if ( sub_534020(a1) || !(byte_5D4594[v3 + 1599725] & 4) )
LABEL_12:
    result = 0;
  else
    result = 1;
  return result;
}

//----- (0050B950) --------------------------------------------------------
int __cdecl sub_50B950(int a1, int a2, int a3)
{
  int v3; // ecx
  int result; // eax

  v3 = *(_DWORD *)(a1 + 16);
  if ( v3 & 0x4000 )
    result = (byte_5D4594[12 * (a3 + (a2 << 8)) + 1599724] >> 1) & 1;
  else
    result = byte_5D4594[12 * (a3 + (a2 << 8)) + 1599724] & 1;
  return result;
}

//----- (0050B9A0) --------------------------------------------------------
int __cdecl sub_50B9A0(int a1, int a2, int a3, float *a4)
{
  *(_BYTE *)(*(_DWORD *)(a3 + 748) + 2172) = 0;
  sub_50BA00(0, a3, (float *)(a3 + 56), a4, 0, 0);
  if ( *(_DWORD *)&byte_5D4594[2386180] > a2 && !*(_DWORD *)&byte_5D4594[1599712] )
    *(_DWORD *)&byte_5D4594[1599712] = 1;
  return sub_50C990(a1, 0, a2);
}

//----- (0050BA00) --------------------------------------------------------
LPVOID __cdecl sub_50BA00(int a1, int a2, float *a3, float *a4, int (__cdecl *a5)(int, int, int), int a6)
{
  int v6; // eax
  double v7; // st7
  int v8; // eax
  double v9; // st7
  LPVOID result; // eax
  unsigned __int16 *v11; // eax
  unsigned __int16 v12; // cx
  unsigned __int16 v13; // dx
  unsigned __int16 *v14; // ebx
  unsigned __int16 *v15; // esi
  int v16; // edx
  int v17; // edi
  int v18; // eax
  int v19; // edi
  int v20; // edx
  int v21; // ecx
  unsigned __int16 v22; // bp
  int v23; // ebp
  int v24; // ebx
  unsigned __int16 v25; // ax
  int v26; // ecx
  float v27; // edx
  float v28; // eax
  int v29; // ecx
  int v30; // edi
  _WORD *v31; // eax
  unsigned __int16 *v32; // eax
  unsigned __int16 *v33; // ebp
  unsigned __int16 *v34; // esi
  unsigned __int16 *v35; // edi
  int v36; // eax
  int v37; // eax
  bool v38; // zf
  int v39; // eax
  int v40; // eax
  int v41; // eax
  int v42; // eax
  BOOL v43; // eax
  int v44; // eax
  unsigned __int16 *v45; // esi
  unsigned __int16 *v46; // edi
  int v47; // [esp-4h] [ebp-70h]
  int v48; // [esp-4h] [ebp-70h]
  int v49; // [esp-4h] [ebp-70h]
  int v50; // [esp-4h] [ebp-70h]
  float v51; // [esp+0h] [ebp-6Ch]
  float v52; // [esp+0h] [ebp-6Ch]
  float v53; // [esp+0h] [ebp-6Ch]
  float v54; // [esp+0h] [ebp-6Ch]
  int v55; // [esp+0h] [ebp-6Ch]
  int v56; // [esp+0h] [ebp-6Ch]
  int v57; // [esp+0h] [ebp-6Ch]
  int v58; // [esp+0h] [ebp-6Ch]
  int v59; // [esp+14h] [ebp-58h]
  char v60; // [esp+18h] [ebp-54h]
  int v61; // [esp+1Ch] [ebp-50h]
  int i; // [esp+20h] [ebp-4Ch]
  BOOL v63; // [esp+24h] [ebp-48h]
  int v64; // [esp+28h] [ebp-44h]
  int v65; // [esp+2Ch] [ebp-40h]
  int v66; // [esp+30h] [ebp-3Ch]
  int v67; // [esp+34h] [ebp-38h]
  __int16 v68[2]; // [esp+38h] [ebp-34h]
  int v69; // [esp+3Ch] [ebp-30h]
  int v70; // [esp+40h] [ebp-2Ch]
  unsigned __int8 *v71; // [esp+44h] [ebp-28h]
  unsigned __int8 *v72; // [esp+48h] [ebp-24h]
  int v73; // [esp+4Ch] [ebp-20h]
  int v74; // [esp+50h] [ebp-1Ch]
  int2 a2a; // [esp+54h] [ebp-18h]
  float4 v76; // [esp+5Ch] [ebp-10h]
  unsigned __int16 *v77; // [esp+78h] [ebp+Ch]

  v67 = 0;
  v64 = 0;
  v65 = 0;
  v59 = a1 != 0 ? 0 : 999999;
  *(_DWORD *)&byte_5D4594[1599712] = 0;
  ++*(_DWORD *)&byte_5D4594[2386160];
  if ( !*(_DWORD *)&byte_5D4594[2386168] )
    sub_50B520();
  v51 = *a3 * 0.043478262;
  v6 = sub_419A70(v51);
  v7 = a3[1] * 0.043478262;
  a2a.field_0 = v6;
  v52 = v7;
  a2a.field_4 = sub_419A70(v52);
  sub_50C8D0(a2, &a2a);
  v61 = 0;
  v63 = !sub_50B8A0(a2, a2a.field_0, a2a.field_4);
  if ( a5 && !a5(a2, a2a.field_0, a2a.field_4) )
    v61 = 1;
  v53 = *a4 * 0.043478262;
  v8 = sub_419A70(v53);
  v9 = a4[1] * 0.043478262;
  v73 = v8;
  v54 = v9;
  v74 = sub_419A70(v54);
  result = *(LPVOID *)&byte_5D4594[2386184];
  if ( !*(_DWORD *)&byte_5D4594[2386184] )
  {
    *(_DWORD *)&byte_5D4594[2386180] = 0;
    *(_DWORD *)&byte_5D4594[1599712] = 2;
    return result;
  }
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386184]);
  v11 = (unsigned __int16 *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386184]);
  *v11 = a2a.field_0;
  v11[1] = a2a.field_4;
  v12 = *v11;
  v13 = v11[1];
  *((_DWORD *)v11 + 1) = 0;
  *((_DWORD *)v11 + 2) = 0;
  v14 = v11;
  v66 = 0;
  *(_DWORD *)&byte_5D4594[12 * (v13 + (v12 << 8)) + 1599716] = *(_DWORD *)&byte_5D4594[2386160];
  while ( 2 )
  {
    v15 = v14;
    v14 = 0;
    v77 = 0;
    if ( !v15 )
      goto LABEL_40;
    while ( 2 )
    {
      v16 = *v15;
      v17 = v15[1];
      v18 = ((unsigned __int16)v16 - v73) * ((unsigned __int16)v16 - v73)
          + ((unsigned __int16)v17 - v74) * ((unsigned __int16)v17 - v74);
      if ( a1 )
      {
        if ( v18 > v59 )
        {
          v67 = (int)v15;
          v59 = ((unsigned __int16)v16 - v73) * ((unsigned __int16)v16 - v73)
              + ((unsigned __int16)v17 - v74) * ((unsigned __int16)v17 - v74);
        }
      }
      else
      {
        if ( v18 < v59 )
        {
          v67 = (int)v15;
          v59 = ((unsigned __int16)v16 - v73) * ((unsigned __int16)v16 - v73)
              + ((unsigned __int16)v17 - v74) * ((unsigned __int16)v17 - v74);
        }
        if ( !v63 && !v61 && v16 == v73 && v17 == v74 )
        {
          *(_DWORD *)&byte_5D4594[1599712] = 0;
          return (LPVOID)sub_50C320(a2, (int)v15, a4);
        }
      }
      v69 = sub_415FA0(0, 7);
      for ( i = 0; i < 8; ++i )
      {
        v19 = (i + v69) % 8;
        v20 = *(_DWORD *)&byte_587000[8 * v19 + 234216];
        v21 = *(_DWORD *)&byte_587000[8 * v19 + 234220];
        v22 = *v15;
        v72 = &byte_587000[8 * v19 + 234216];
        v23 = v20 + v22;
        v24 = v21 + v15[1];
        v71 = &byte_587000[8 * v19 + 234220];
        if ( v23 < 0
          || v23 >= 256
          || v24 < 0
          || v24 >= 256
          || *(_DWORD *)&byte_5D4594[12 * (v24 + (v23 << 8)) + 1599716] == *(_DWORD *)&byte_5D4594[2386160] )
        {
          continue;
        }
        *(_DWORD *)&byte_5D4594[12 * (v24 + (v23 << 8)) + 1599716] = *(_DWORD *)&byte_5D4594[2386160];
        if ( v23 == v73 && v24 == v74 )
        {
          v25 = v15[1];
          v70 = 23 * *v15 + 11;
          v76.field_0 = (double)v70;
          v26 = 23 * v25;
          v27 = *a4;
          v28 = a4[1];
          v70 = v26 + 11;
          v76.field_8 = v27;
          v76.field_4 = (double)(v26 + 11);
          v76.field_C = v28;
          if ( sub_50B580(a2, &v76) )
          {
            v29 = *(_DWORD *)(a2 + 16);
            if ( v29 & 0x4000 )
            {
              if ( sub_535250(&v76, 0, 0, 5) )
                goto LABEL_31;
            }
            else if ( sub_535250(&v76, 0, 0, 1) )
            {
LABEL_31:
              v30 = a2;
              goto LABEL_32;
            }
          }
        }
        if ( v19 < 4 )
        {
          v30 = a2;
        }
        else
        {
          v60 = ~(*(_WORD *)(a2 + 16) >> 8) & 0xD8 | 0x98;
          sub_57B4D0(a2);
          switch ( v19 )
          {
            case 4:
              v36 = (unsigned __int8)sub_57B500(*v15, v15[1] + 1, v60);
              if ( v36 != 1 && v36 != 6 && v36 != 10 && v36 != 9 && v36 != 255 )
                continue;
              LOBYTE(v37) = sub_57B500(*v15 + 1, v15[1], v60);
              goto LABEL_54;
            case 5:
              v39 = (unsigned __int8)sub_57B500(*v15 - 1, v15[1], v60);
              if ( v39 != 1 && v39 != 6 && v39 != 10 && v39 != 9 && v39 != 255 )
                continue;
              LOBYTE(v37) = sub_57B500(*v15, v15[1] - 1, v60);
LABEL_54:
              v37 = (unsigned __int8)v37;
              if ( (unsigned __int8)v37 == 1 || v37 == 4 || v37 == 7 )
                goto LABEL_86;
              v38 = v37 == 8;
              break;
            case 6:
              v40 = (unsigned __int8)sub_57B500(*v15, v15[1] + 1, v60);
              if ( v40 && v40 != 5 && v40 != 9 && v40 != 8 && v40 != 255 )
                continue;
              v37 = (unsigned __int8)sub_57B500(*v15 - 1, v15[1], v60);
              if ( !v37 || v37 == 3 || v37 == 10 )
                goto LABEL_86;
              v38 = v37 == 7;
              break;
            case 7:
              v41 = (unsigned __int8)sub_57B500(*v15 + 1, v15[1], v60);
              if ( v41 && v41 != 5 && v41 != 9 && v41 != 8 && v41 != 255 )
                continue;
              v42 = (unsigned __int8)sub_57B500(*v15, v15[1] - 1, v60);
              if ( v42 )
              {
                if ( v42 != 3 && v42 != 10 && v42 != 7 && v42 != 255 )
                  continue;
              }
              goto LABEL_86;
            default:
              goto LABEL_86;
          }
          if ( !v38 && v37 != 255 )
            continue;
LABEL_86:
          v30 = a2;
          if ( sub_50B950(a2, *v15, *(_DWORD *)v71 + v15[1]) || sub_50B950(a2, *(_DWORD *)v72 + *v15, v15[1]) )
            continue;
        }
        if ( sub_50B870(v30, v23, v24) )
          continue;
        if ( v73 != v23 || v74 != v24 )
        {
          if ( !sub_50C830(v30, v23, v24) )
            continue;
        }
        else if ( !sub_50C830(v30, v23, v24) )
        {
          continue;
        }
        v43 = sub_50B8A0(v30, v23, v24);
        if ( v63 )
        {
          if ( v43 )
          {
            v64 = 1;
          }
          else if ( !sub_50B950(v30, *v15, v15[1]) && sub_50B950(v30, v23, v24) )
          {
            continue;
          }
        }
        else
        {
          if ( !v43 )
            continue;
          if ( a5 )
          {
            v44 = a5(v30, v23, v24);
            if ( v61 )
            {
              if ( v44 )
                v65 = 1;
            }
            else if ( !v44 )
            {
              continue;
            }
          }
        }
LABEL_32:
        v31 = sub_4142F0(*(_DWORD **)&byte_5D4594[2386184]);
        if ( !v31 )
        {
          v55 = *(_DWORD *)(v30 + 36);
          v47 = sub_4E39D0(v30);
          sub_5341A0((char *)&byte_587000[234404], *(_DWORD *)&byte_5D4594[2598000], v47, v55);
LABEL_130:
          *(_DWORD *)&byte_5D4594[1599712] = 1;
          return (LPVOID)sub_50C320(v30, v67, 0);
        }
        *v31 = v23;
        v31[1] = v24;
        *((_DWORD *)v31 + 1) = v15;
        *((_DWORD *)v31 + 2) = v77;
        v77 = v31;
      }
      if ( !sub_50AC20((int)v15, v68) )
        goto LABEL_38;
      *((_BYTE *)v15 + 12) |= 2u;
      v32 = (unsigned __int16 *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386184]);
      if ( !v32 )
      {
        v30 = a2;
        v56 = *(_DWORD *)(a2 + 36);
        v48 = sub_4E39D0(a2);
        sub_5341A0((char *)&byte_587000[234456], *(_DWORD *)&byte_5D4594[2598000], v48, v56);
        goto LABEL_130;
      }
      *(_DWORD *)v32 = *(_DWORD *)v68;
      *((_DWORD *)v32 + 1) = v15;
      *((_DWORD *)v32 + 2) = v77;
      v77 = v32;
LABEL_38:
      v15 = (unsigned __int16 *)*((_DWORD *)v15 + 2);
      if ( v15 )
        continue;
      break;
    }
    v14 = v77;
LABEL_40:
    v33 = 0;
    if ( v64 )
    {
      v34 = v14;
      if ( v14 )
      {
        do
        {
          v35 = (unsigned __int16 *)*((_DWORD *)v34 + 2);
          if ( sub_50B8A0(a2, *v34, v34[1]) )
          {
            v33 = v34;
          }
          else if ( v33 )
          {
            *((_DWORD *)v33 + 2) = *((_DWORD *)v34 + 2);
          }
          else
          {
            v14 = (unsigned __int16 *)*((_DWORD *)v34 + 2);
          }
          v34 = v35;
        }
        while ( v35 );
        v33 = 0;
      }
      v63 = 0;
      v64 = 0;
    }
    if ( v65 )
    {
      v45 = v14;
      if ( v14 )
      {
        do
        {
          v46 = (unsigned __int16 *)*((_DWORD *)v45 + 2);
          if ( a5(a2, *v45, v45[1]) )
          {
            v33 = v45;
          }
          else if ( v33 )
          {
            *((_DWORD *)v33 + 2) = *((_DWORD *)v45 + 2);
          }
          else
          {
            v14 = (unsigned __int16 *)*((_DWORD *)v45 + 2);
          }
          v45 = v46;
        }
        while ( v46 );
      }
      v61 = 0;
      v65 = 0;
    }
    if ( v14 )
    {
      if ( a6 && v66 >= a6 )
      {
        v58 = *(_DWORD *)(a2 + 36);
        v50 = sub_4E39D0(a2);
        sub_5341A0((char *)&byte_587000[234556], *(_DWORD *)&byte_5D4594[2598000], v50, v58);
        goto LABEL_134;
      }
      ++v66;
      continue;
    }
    break;
  }
  v57 = *(_DWORD *)(a2 + 36);
  v49 = sub_4E39D0(a2);
  sub_5341A0((char *)&byte_587000[234508], *(_DWORD *)&byte_5D4594[2598000], v49, v57);
LABEL_134:
  v30 = a2;
  *(_DWORD *)&byte_5D4594[1599712] = 2;
  return (LPVOID)sub_50C320(v30, v67, 0);
}

//----- (0050C320) --------------------------------------------------------
int __cdecl sub_50C320(int a1, int a2, _DWORD *a3)
{
  int result; // eax
  unsigned __int16 *v4; // edi
  int v5; // esi
  _DWORD *v6; // eax
  unsigned __int16 *v7; // esi
  int v8; // ebp
  int v9; // eax
  char v10; // cl
  int v11; // ebx
  int v12; // ecx
  unsigned __int16 v13; // ax
  int v14; // edx
  unsigned __int16 v15; // ax
  int v16; // ecx
  unsigned __int16 v17; // ax
  double v18; // st7
  double v19; // st7
  double v20; // st7
  int v21; // ecx
  _DWORD *v22; // eax
  _DWORD *v23; // edx
  int v24; // eax
  int v25; // [esp+Ch] [ebp-1Ch]
  float2 v26; // [esp+10h] [ebp-18h]
  float4 v27; // [esp+18h] [ebp-10h]

  result = a1;
  v4 = (unsigned __int16 *)a2;
  v5 = *(_DWORD *)(a1 + 748);
  v25 = *(_DWORD *)(a1 + 748);
  if ( !a2 )
  {
    *(_DWORD *)&byte_5D4594[2386180] = 0;
    return result;
  }
  v6 = a3;
  if ( a3 )
  {
    **(_DWORD **)&byte_5D4594[2386176] = *a3;
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386176] + 4) = v6[1];
  }
  else if ( *(_BYTE *)(a2 + 12) & 2 && sub_50AEA0(a2, &v26, &a1) )
  {
    **(float **)&byte_5D4594[2386176] = v26.field_0;
    *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 4) = v26.field_4;
    if ( *(_BYTE *)(v5 + 2172) < 8u )
      *(_DWORD *)(v5 + 4 * (unsigned __int8)(*(_BYTE *)(v5 + 2172))++ + 2140) = a1;
  }
  else
  {
    a2 = *v4;
    **(float **)&byte_5D4594[2386176] = (double)a2 * 23.0 + 11.5;
    a2 = v4[1];
    *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 4) = (double)a2 * 23.0 + 11.5;
  }
  v7 = (unsigned __int16 *)*((_DWORD *)v4 + 1);
  v8 = 1;
  if ( v7 )
  {
    while ( 1 )
    {
      v9 = *v7 - *v4;
      v10 = *((_BYTE *)v7 + 12);
      v11 = v7[1] - v4[1];
      a2 = *v7 - *v4;
      if ( !(v10 & 2) )
        goto LABEL_19;
      if ( !sub_50AEA0((int)v7, &v26, &a1) )
        break;
      v12 = v25;
      *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = v26.field_0;
      *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8 + 4) = v26.field_4;
      if ( *(_BYTE *)(v25 + 2172) < 8u )
      {
        a2 = a2 * a2 + v11 * v11;
        if ( (double)a2 > 4761.0 )
          goto LABEL_17;
        v13 = v7[1];
        a2 = 23 * *v7 + 11;
        v14 = 23 * v13;
        v15 = *v4;
        v27.field_0 = (double)a2;
        a2 = v14 + 11;
        v16 = 23 * v15;
        v17 = v4[1];
        v27.field_4 = (double)(v14 + 11);
        v27.field_8 = (double)(v16 + 11);
        a2 = 23 * v17 + 11;
        v27.field_C = (double)a2;
        if ( !sub_535250(&v27, 0, 0, 1) )
        {
          v12 = v25;
LABEL_17:
          *(_DWORD *)(v12 + 4 * (unsigned __int8)(*(_BYTE *)(v12 + 2172))++ + 2140) = a1;
          goto LABEL_38;
        }
      }
LABEL_38:
      v4 = v7;
      v7 = (unsigned __int16 *)*((_DWORD *)v7 + 1);
      ++v8;
      if ( !v7 )
        goto LABEL_39;
    }
    v9 = a2;
LABEL_19:
    if ( v9 <= 0 )
    {
      if ( v9 < 0 )
      {
        if ( v11 > 0 )
        {
          a2 = *v7;
          *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 23.0 - 2.3;
          a2 = v7[1];
          v20 = (double)a2;
LABEL_29:
          *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8 + 4) = v20 * 23.0 + 2.3;
          goto LABEL_38;
        }
        if ( v11 < 0 )
        {
          a2 = *v7;
          *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 23.0 - 2.3;
          a2 = v7[1];
          v18 = (double)a2;
          goto LABEL_37;
        }
        a2 = *v7;
        *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 23.0 - 2.3;
        a2 = v7[1];
        v19 = (double)a2;
        goto LABEL_25;
      }
      if ( v11 > 0 )
      {
        a2 = *v7;
        *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 11.5;
        a2 = v7[1];
        v20 = (double)a2;
        goto LABEL_29;
      }
      if ( v11 < 0 )
      {
        a2 = *v7;
        *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 11.5;
        a2 = v7[1];
        v18 = (double)a2;
        goto LABEL_37;
      }
    }
    else
    {
      if ( v11 <= 0 )
      {
        if ( v11 < 0 )
        {
          a2 = *v7;
          *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 2.3;
          a2 = v7[1];
          v18 = (double)a2;
LABEL_37:
          *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8 + 4) = v18 * 23.0 + 23.0 - 2.3;
          goto LABEL_38;
        }
        a2 = *v7;
        *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 2.3;
        a2 = v7[1];
        v19 = (double)a2;
LABEL_25:
        *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8 + 4) = v19 * 23.0 + 11.5;
        goto LABEL_38;
      }
      a2 = *v7;
      *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8) = (double)a2 * 23.0 + 2.3;
      a2 = v7[1];
      *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v8 + 4) = (double)a2 * 23.0 + 2.3;
    }
    goto LABEL_38;
  }
LABEL_39:
  v21 = 0;
  *(_DWORD *)&byte_5D4594[2386180] = v8;
  for ( result = v8 / 2; v21 < *(int *)&byte_5D4594[2386180] / 2; result = *(_DWORD *)&byte_5D4594[2386180] / 2 )
  {
    v22 = (_DWORD *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v21);
    v23 = (_DWORD *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * (v8 - v21) - 8);
    v26 = *(float2 *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v21);
    *v22 = *v23;
    v22[1] = v23[1];
    v24 = *(_DWORD *)&byte_5D4594[2386180] - v21++;
    *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v24 - 8) = v26.field_0;
    *(float *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v24 - 4) = v26.field_4;
    v8 = *(_DWORD *)&byte_5D4594[2386180];
  }
  return result;
}

//----- (0050C830) --------------------------------------------------------
int __cdecl sub_50C830(int a1, int a2, int a3)
{
  int v3; // ecx
  float *v4; // esi
  float2 v6; // [esp+4h] [ebp-8h]
  float v7; // [esp+10h] [ebp+4h]
  float v8; // [esp+14h] [ebp+8h]

  v3 = *(_DWORD *)(a1 + 16);
  if ( v3 & 0x4000 || sub_534020(a1) )
    return 1;
  v4 = (float *)&byte_587000[234188];
  v8 = (double)(23 * a2);
  while ( 1 )
  {
    v6.field_0 = v8 + *(v4 - 1);
    v7 = (double)(23 * a3);
    v6.field_4 = v7 + *v4;
    if ( sub_411160(&v6) == 6 )
      break;
    v4 += 2;
    if ( (int)v4 >= (int)&byte_587000[234220] )
      return 1;
  }
  return 0;
}

//----- (0050C8D0) --------------------------------------------------------
void __cdecl sub_50C8D0(int a1, int2 *a2)
{
  int v2; // ecx
  int v3; // edx
  long double v4; // st7
  float v5; // [esp+Ch] [ebp-4h]
  float v6; // [esp+Ch] [ebp-4h]

  if ( sub_50B870(a1, a2->field_0, a2->field_4) )
  {
    v2 = a2->field_0;
    v3 = a2->field_4;
    v5 = (double)v3 * 23.0 + 11.5;
    v4 = *(float *)(a1 + 56) - ((double)a2->field_0 * 23.0 + 11.5);
    v6 = *(float *)(a1 + 60) - v5;
    if ( fabs(v6) >= fabs(v4) )
    {
      if ( v6 <= 0.0 )
        a2->field_4 = v3 - 1;
      else
        a2->field_4 = v3 + 1;
    }
    else if ( v4 <= 0.0 )
    {
      a2->field_0 = v2 - 1;
    }
    else
    {
      a2->field_0 = v2 + 1;
    }
  }
}

//----- (0050C990) --------------------------------------------------------
int __cdecl sub_50C990(int a1, int a2, int a3)
{
  int v3; // ecx
  int v4; // esi
  int v5; // eax
  _DWORD *v6; // edi

  v3 = 0;
  if ( *(int *)&byte_5D4594[2386180] <= 0 )
    return a2;
  v4 = a2;
  v5 = a1 + 8 * a2;
  while ( v4 != a3 - 1 )
  {
    ++v4;
    v5 += 8;
    v6 = (_DWORD *)(*(_DWORD *)&byte_5D4594[2386176] + 8 * v3++);
    *(_DWORD *)(v5 - 8) = *v6;
    *(_DWORD *)(v5 - 4) = v6[1];
    if ( v3 >= *(int *)&byte_5D4594[2386180] )
      return v4;
  }
  sub_5341A0((char *)&byte_587000[234608]);
  return v4;
}

//----- (0050CA00) --------------------------------------------------------
int __cdecl sub_50CA00(int a1, int a2, int a3, float *a4)
{
  *(_BYTE *)(*(_DWORD *)(a3 + 748) + 2172) = 0;
  sub_50BA00(1, a3, (float *)(a3 + 56), a4, sub_50CA60, 6);
  if ( *(_DWORD *)&byte_5D4594[2386180] > a2 && !*(_DWORD *)&byte_5D4594[1599712] )
    *(_DWORD *)&byte_5D4594[1599712] = 1;
  return sub_50C990(a1, 0, a2);
}

//----- (0050CA60) --------------------------------------------------------
BOOL __cdecl sub_50CA60(int a4, int a2, int a3)
{
  float2 a1; // [esp+0h] [ebp-8h]

  *(_DWORD *)&byte_5D4594[1599708] = 0;
  a1.field_0 = (double)a2 * 23.0 + 11.5;
  a1.field_4 = (double)a3 * 23.0 + 11.5;
  sub_517F90(&a1, 100.0, sub_50CAC0, a4);
  return *(_DWORD *)&byte_5D4594[1599708] == 0;
}

//----- (0050CAC0) --------------------------------------------------------
void __cdecl sub_50CAC0(int a1, int a2)
{
  if ( *(_DWORD *)&byte_5D4594[1599708] != 1 )
  {
    if ( sub_5330C0(a2, a1) )
      *(_DWORD *)&byte_5D4594[1599708] = 1;
  }
}

//----- (0050CAF0) --------------------------------------------------------
int sub_50CAF0()
{
  return *(_DWORD *)&byte_5D4594[1599712];
}

//----- (0050CB00) --------------------------------------------------------
int sub_50CB00()
{
  return *(_DWORD *)&byte_5D4594[2386180];
}

//----- (0050CB10) --------------------------------------------------------
LPVOID sub_50CB10()
{
  return *(LPVOID *)&byte_5D4594[2386176];
}

//----- (0050CB20) --------------------------------------------------------
int __cdecl sub_50CB20(int a1, float *a2)
{
  int v2; // eax
  double v3; // st7
  unsigned __int16 *v4; // eax
  int v5; // ecx
  unsigned __int16 *v6; // ebp
  int v7; // esi
  int v8; // edi
  unsigned __int8 *v9; // ebx
  int v10; // esi
  int v11; // edi
  _WORD *v12; // eax
  float v14; // [esp+0h] [ebp-24h]
  float v15; // [esp+0h] [ebp-24h]
  int v16; // [esp+0h] [ebp-24h]
  int2 a2a; // [esp+14h] [ebp-10h]
  float2 v18; // [esp+1Ch] [ebp-8h]
  unsigned __int16 *v19; // [esp+2Ch] [ebp+8h]

  ++*(_DWORD *)&byte_5D4594[2386160];
  v14 = *a2 * 0.043478262;
  v2 = sub_419A70(v14);
  v3 = a2[1] * 0.043478262;
  a2a.field_0 = v2;
  v15 = v3;
  a2a.field_4 = sub_419A70(v15);
  sub_50C8D0(a1, &a2a);
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386184]);
  v4 = (unsigned __int16 *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386184]);
  *v4 = a2a.field_0;
  v4[1] = a2a.field_4;
  v5 = v4[1] + (*v4 << 8);
  *((_DWORD *)v4 + 1) = 0;
  *((_DWORD *)v4 + 2) = 0;
  *(_DWORD *)&byte_5D4594[12 * v5 + 1599716] = *(_DWORD *)&byte_5D4594[2386160];
  do
  {
    v6 = v4;
    v19 = 0;
    if ( !v4 )
      break;
    do
    {
      v7 = *v6;
      v8 = v6[1];
      if ( byte_5D4594[12 * ((unsigned __int16)v8 + (v7 << 8)) + 1599724] & 0x40 && !sub_50B870(a1, v7, v8) )
      {
        v18.field_0 = (double)(23 * v7 + 11);
        v18.field_4 = (double)(23 * v8 + 11);
        return sub_518740(&v18, 0x80u);
      }
      v9 = &byte_587000[234284];
      do
      {
        v10 = *v6 + *((_DWORD *)v9 - 1);
        v11 = *(_DWORD *)v9 + v6[1];
        if ( v10 >= 0
          && v10 < 256
          && v11 >= 0
          && v11 < 256
          && *(_DWORD *)&byte_5D4594[12 * (v11 + (v10 << 8)) + 1599716] != *(_DWORD *)&byte_5D4594[2386160] )
        {
          v16 = *(_DWORD *)v9 + v6[1];
          *(_DWORD *)&byte_5D4594[12 * (v11 + (v10 << 8)) + 1599716] = *(_DWORD *)&byte_5D4594[2386160];
          if ( !sub_50B870(a1, v10, v16) )
          {
            if ( sub_50C830(a1, v10, v11) )
            {
              v12 = sub_4142F0(*(_DWORD **)&byte_5D4594[2386184]);
              if ( v12 )
              {
                *v12 = v10;
                v12[1] = v11;
                *((_DWORD *)v12 + 1) = v6;
                *((_DWORD *)v12 + 2) = v19;
                v19 = v12;
              }
            }
          }
        }
        v9 += 8;
      }
      while ( (int)v9 < (int)&byte_587000[234316] );
      v6 = (unsigned __int16 *)*((_DWORD *)v6 + 2);
    }
    while ( v6 );
    v4 = v19;
  }
  while ( v19 );
  return 0;
}

//----- (0050CD30) --------------------------------------------------------
unsigned __int8 *sub_50CD30()
{
  return &byte_5D4594[2386196];
}

//----- (0050CD40) --------------------------------------------------------
char *__cdecl sub_50CD40(int a1, int a2, _DWORD *a3)
{
  char *result; // eax

  result = (char *)sub_501900(a1);
  if ( result )
  {
    if ( *(_DWORD *)&byte_5D4594[2386188]
      || (result = sub_413FE0((const char *)&byte_587000[234656], 24, 128),
          (*(_DWORD *)&byte_5D4594[2386188] = result) != 0) )
    {
      result = (char *)sub_534160(a2);
      if ( result )
      {
        result = (char *)sub_414190(*(_DWORD **)&byte_5D4594[2386188]);
        if ( result )
        {
          *(_DWORD *)result = a1;
          *((_DWORD *)result + 1) = a2;
          *((_DWORD *)result + 2) = *a3;
          *((_DWORD *)result + 3) = a3[1];
          *((_DWORD *)result + 4) = *(_DWORD *)&byte_5D4594[2598000];
          *((_DWORD *)result + 5) = *(_DWORD *)&byte_5D4594[2386192];
          *(_DWORD *)&byte_5D4594[2386192] = result;
        }
      }
    }
  }
  return result;
}

//----- (0050CDD0) --------------------------------------------------------
unsigned __int8 *__cdecl sub_50CDD0(int a1)
{
  int v1; // ebx
  int v2; // edi
  unsigned __int8 *result; // eax
  int v4; // esi
  unsigned int v5; // eax
  int v6; // ebp
  int v7; // eax
  int v8; // eax
  int v9; // [esp-4h] [ebp-18h]
  int *v10; // [esp+Ch] [ebp-8h]
  int v11; // [esp+10h] [ebp-4h]
  int v12; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = 0;
  v9 = a1;
  v11 = *(_DWORD *)(a1 + 748);
  v10 = 0;
  v12 = 0;
  result = (unsigned __int8 *)sub_528190(v9);
  if ( result )
  {
    result = (unsigned __int8 *)sub_534B10(v1);
    if ( !result )
    {
      result = (unsigned __int8 *)sub_534B90(v1);
      if ( !result )
      {
        result = (unsigned __int8 *)sub_534B60(v1);
        if ( !result )
        {
          v4 = *(_DWORD *)&byte_5D4594[2386192];
          if ( *(_DWORD *)&byte_5D4594[2386192] )
          {
            do
            {
              v5 = *(_DWORD *)(v4 + 16);
              v6 = *(_DWORD *)(v4 + 20);
              if ( *(_DWORD *)&byte_5D4594[2598000] < v5 || *(_DWORD *)&byte_5D4594[2598000] - v5 > 2 )
              {
                if ( v2 )
                  *(_DWORD *)(v2 + 20) = v6;
                else
                  *(_DWORD *)&byte_5D4594[2386192] = *(_DWORD *)(v4 + 20);
                sub_414330(*(unsigned int **)&byte_5D4594[2386188], (_QWORD *)v4);
              }
              else
              {
                v7 = *(_DWORD *)(v4 + 4);
                if ( v7 && *(_BYTE *)(v7 + 16) & 0x20 )
                  *(_DWORD *)(v4 + 4) = 0;
                if ( *(_DWORD *)(v11 + 404) <= *(int *)(v4 + 16) )
                {
                  if ( sub_50CF10(v1, v4) )
                  {
                    v8 = sub_50D000(v1, v4);
                    if ( v8 > 0 && v8 > v12 )
                    {
                      v12 = v8;
                      v10 = (int *)v4;
                    }
                  }
                }
                v2 = v4;
              }
              v4 = v6;
            }
            while ( v6 );
            result = (unsigned __int8 *)v10;
            if ( v10 && ((unsigned int)v10[4] > *(int *)(v11 + 404) || v12 > *(int *)(v11 + 408)) )
              result = sub_50D110(v1, v10, v12);
          }
        }
      }
    }
  }
  return result;
}

//----- (0050CF10) --------------------------------------------------------
BOOL __cdecl sub_50CF10(int a1, int a2)
{
  int v2; // ebx
  int v3; // edi
  int v4; // ebp
  int v5; // eax
  BOOL result; // eax
  int v7; // eax
  float v8; // edx
  struc_19 *v9; // eax
  int2 v10; // [esp+10h] [ebp-8h]
  int v11; // [esp+1Ch] [ebp+4h]
  char v12; // [esp+1Ch] [ebp+4h]

  v2 = a1;
  v3 = *(_DWORD *)(a1 + 748);
  v4 = sub_4EC580(*(_DWORD *)(a2 + 4));
  v5 = sub_501900(*(_DWORD *)a2);
  v11 = v5;
  if ( *(_DWORD *)(v3 + 404) > *(int *)&byte_5D4594[2598000] )
    return 0;
  if ( !v4 )
  {
LABEL_6:
    if ( !v5 )
      return 0;
    goto LABEL_10;
  }
  if ( sub_5330C0(v2, v4) )
  {
    v5 = v11;
    goto LABEL_6;
  }
  if ( !(v11 & 0x10) )
    return 0;
LABEL_10:
  v12 = sub_501C00((float *)(a2 + 8), *(_DWORD *)(a2 + 4));
  result = 1;
  if ( v12 )
  {
    v7 = sub_419A70(*(float *)(v2 + 56));
    v8 = *(float *)(v2 + 60);
    v10.field_0 = v7;
    v10.field_4 = sub_419A70(v8);
    v9 = sub_4217B0(&v10, 0);
    if ( v9 )
    {
      if ( v12 != BYTE2(v9->field_0[32]) )
        result = 0;
    }
  }
  return result;
}

//----- (0050D000) --------------------------------------------------------
int __cdecl sub_50D000(int a1, int a2)
{
  char v2; // bp
  int v3; // esi
  int result; // eax
  float v5; // eax
  float v6; // edx
  float v7; // eax
  float v8; // [esp+0h] [ebp-24h]
  float4 v9; // [esp+14h] [ebp-10h]

  v2 = sub_501900(*(_DWORD *)a2);
  v3 = sub_501AF0(*(_DWORD *)a2, (float *)(a2 + 8), (float *)(a1 + 56));
  if ( !sub_50D0C0(v2, v3) )
    return -1;
  v5 = *(float *)(a1 + 56);
  v6 = *(float *)(a2 + 8);
  v9.field_4 = *(float *)(a1 + 60);
  v9.field_0 = v5;
  v7 = *(float *)(a2 + 12);
  v9.field_8 = v6;
  v9.field_C = v7;
  if ( !sub_535250(&v9, 0, 0, 5) )
  {
    v8 = (double)v3 * 0.5;
    v3 = sub_419A70(v8);
  }
  if ( sub_50D0C0(v2, v3) )
    result = v3;
  else
    result = -1;
  return result;
}

//----- (0050D0C0) --------------------------------------------------------
int __cdecl sub_50D0C0(char a1, int a2)
{
  if ( a1 & 0x20 )
  {
    if ( a2 < *(int *)&byte_587000[234644] )
      return 0;
  }
  else if ( a1 & 0x40 )
  {
    if ( a2 < *(int *)&byte_587000[234652] )
      return 0;
  }
  else if ( a2 < *(int *)&byte_587000[234648] )
  {
    return 0;
  }
  return 1;
}

//----- (0050D110) --------------------------------------------------------
unsigned __int8 *__cdecl sub_50D110(int a1, _DWORD *a2, int a3)
{
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // eax

  v3 = *(_DWORD **)(a1 + 748);
  v3[97] = *a2;
  v3[101] = *(_DWORD *)&byte_5D4594[2598000];
  v3[102] = a3;
  v4 = a2[1];
  if ( v4 )
    v3[98] = *(_DWORD *)(v4 + 36);
  else
    v3[98] = 0;
  sub_50D190(a1, a2 + 2, v3 + 99);
  v5 = sub_4EC580(a2[1]);
  return sub_502490(v3 + 320, v5, a1);
}

//----- (0050D190) --------------------------------------------------------
_DWORD *__cdecl sub_50D190(int a1, _DWORD *a2, _DWORD *a3)
{
  _DWORD *result; // eax

  result = a2;
  *a3 = *a2;
  a3[1] = a2[1];
  *(_DWORD *)&byte_5D4594[2386196] = *a2;
  *(_DWORD *)&byte_5D4594[2386200] = a2[1];
  return result;
}

//----- (0050D1C0) --------------------------------------------------------
int sub_50D1C0()
{
  int result; // eax

  sub_4144D0(*(_DWORD **)&byte_5D4594[2386188]);
  result = 0;
  *(_DWORD *)&byte_5D4594[2386188] = 0;
  *(_DWORD *)&byte_5D4594[2386192] = 0;
  return result;
}

//----- (0050D1E0) --------------------------------------------------------
void sub_50D1E0()
{
  if ( *(_DWORD *)&byte_5D4594[2386188] )
  {
    sub_414100(*(LPVOID *)&byte_5D4594[2386188]);
    *(_DWORD *)&byte_5D4594[2386188] = 0;
  }
  *(_DWORD *)&byte_5D4594[2386192] = 0;
}

//----- (0050D210) --------------------------------------------------------
int sub_50D210()
{
  return *(_DWORD *)&byte_5D4594[2386204];
}

//----- (0050D220) --------------------------------------------------------
int __cdecl sub_50D220(int a1, int a2)
{
  int result; // eax
  int v3; // esi
  int v4; // edi

  result = 0;
  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(_DWORD *)(v3 + 280);
  *(_DWORD *)(v3 + 268) = 0;
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v4) >= 0xA )
  {
    *(_DWORD *)(v3 + 272) = *(_DWORD *)a2;
    *(_DWORD *)(v3 + 276) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(v3 + 8) = sub_50B9A0(v3 + 12, 32, a1, (float *)a2);
    result = sub_50CAF0();
    *(_BYTE *)(v3 + 284) = result;
    *(_DWORD *)(v3 + 280) = *(_DWORD *)&byte_5D4594[2598000];
  }
  else
  {
    *(_DWORD *)(v3 + 8) = 0;
    *(_BYTE *)(v3 + 284) = 1;
  }
  return result;
}

//----- (0050D2A0) --------------------------------------------------------
int __cdecl sub_50D2A0(int a1, int a2)
{
  _DWORD *v2; // esi
  int result; // eax

  v2 = *(_DWORD **)(a1 + 748);
  v2[92] = *(_DWORD *)a2;
  v2[93] = *(_DWORD *)(a2 + 4);
  result = sub_547F20(a1, (float *)a2);
  v2[74] = result;
  v2[91] = 0;
  return result;
}

//----- (0050D2E0) --------------------------------------------------------
BOOL __cdecl sub_50D2E0(int a1)
{
  int v1; // esi
  int v2; // edi
  int v3; // edx
  int v4; // ecx
  double v5; // st7
  double v6; // st6
  _DWORD *v8; // edi
  int v9; // eax

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 296);
  if ( v2 && !*(_DWORD *)(v1 + 8) )
  {
    v3 = *(_DWORD *)(v1 + 364);
    v4 = *(_DWORD *)(v1 + 4 * v3 + 300);
    v5 = *(float *)(v4 + 8) - *(float *)(a1 + 56);
    v6 = *(float *)(v4 + 12) - *(float *)(a1 + 60);
    if ( v6 * v6 + v5 * v5 < 64.0 )
    {
      if ( v3 == v2 - 1 )
      {
        *(_DWORD *)(v1 + 296) = 0;
        return 1;
      }
      *(_DWORD *)(v1 + 364) = v3 + 1;
      v4 = *(_DWORD *)(v1 + 4 * (v3 + 1) + 300);
    }
    v8 = (_DWORD *)(v4 + 8);
    sub_50D220(a1, v4 + 8);
    if ( !*(_BYTE *)(v1 + 284) )
    {
      v9 = *(_DWORD *)(v1 + 8);
      *(_DWORD *)(v1 + 8 * v9 + 4) = *v8;
      *(_DWORD *)(v1 + 8 * v9 + 8) = v8[1];
    }
  }
  return sub_50D3B0((float *)a1) && *(_BYTE *)(v1 + 284) == 2;
}

//----- (0050D3B0) --------------------------------------------------------
int __cdecl sub_50D3B0(float *a1)
{
  int v1; // esi
  int v2; // ebp
  float v3; // edx
  int v4; // edi
  float *v5; // ebx
  double v6; // st7
  double v7; // st6
  double v8; // st5
  float *v10; // edi
  double v11; // st7
  double v12; // st7
  __int16 v13; // ax
  int v14; // eax
  double v15; // st7
  float *v16; // [esp+10h] [ebp-2Ch]
  float v17; // [esp+14h] [ebp-28h]
  float *v18; // [esp+18h] [ebp-24h]
  int v19; // [esp+1Ch] [ebp-20h]
  float v20; // [esp+1Ch] [ebp-20h]
  float v21; // [esp+20h] [ebp-1Ch]
  float2 v22; // [esp+24h] [ebp-18h]
  float4 v23; // [esp+2Ch] [ebp-10h]
  float v24; // [esp+40h] [ebp+4h]

  v1 = *((_DWORD *)a1 + 187);
  v2 = 0;
  if ( *(_DWORD *)(v1 + 8) )
  {
    v3 = a1[15];
    v23.field_0 = a1[14];
    v23.field_4 = v3;
    v4 = *(_DWORD *)(v1 + 268);
    v16 = 0;
    v18 = 0;
    v19 = 0;
    v17 = 10000000.0;
    if ( v4 >= *(int *)(v1 + 8) )
    {
LABEL_14:
      *(_DWORD *)(v1 + 8) = 0;
      return 0;
    }
    v5 = (float *)(v1 + 8 * v4 + 12);
    do
    {
      v23.field_8 = *v5;
      v23.field_C = v5[1];
      if ( sub_535250(&v23, 0, 0, 132) )
      {
        v6 = v23.field_8 - a1[14];
        v7 = v23.field_C - a1[15];
        v8 = v7 * v7 + v6 * v6;
        if ( v8 > 64.0 )
        {
          if ( !v16 || v17 > v8 )
          {
            v17 = v8;
            v16 = v5;
            v2 = v4;
          }
        }
        else
        {
          if ( v4 == *(_DWORD *)(v1 + 8) - 1 )
          {
            *(_DWORD *)(v1 + 8) = 0;
            return 1;
          }
          v18 = v5;
          v19 = v4;
        }
      }
      ++v4;
      v5 += 2;
    }
    while ( v4 < *(int *)(v1 + 8) );
    if ( !v16 )
    {
      if ( !v18 )
        goto LABEL_14;
      v2 = v19;
    }
    v10 = a1;
    *(_DWORD *)&byte_5D4594[2386204] = v2;
    *(_DWORD *)(v1 + 268) = v2;
    v20 = *(float *)(v1 + 8 * v2 + 12) - a1[14];
    v11 = *(float *)(v1 + 8 * v2 + 16) - a1[15];
    v21 = v11;
    v24 = sqrt(v11 * v21 + v20 * v20) + *(double *)&byte_581450[10288];
    if ( v2 <= 0 )
    {
      v22.field_0 = *(float *)(v1 + 20) - *(float *)(v1 + 12);
      v12 = *(float *)(v1 + 24) - *(float *)(v1 + 16);
    }
    else
    {
      v22.field_0 = *(float *)(v1 + 8 * v2 + 12) - *(float *)(v1 + 8 * v2 + 4);
      v12 = *(float *)(v1 + 8 * v2 + 16) - *(float *)(v1 + 8 * v2 + 8);
    }
    v22.field_4 = v12;
    v13 = sub_509ED0(&v22);
    *((_WORD *)v10 + 62) = v13;
    *((_WORD *)v10 + 63) = v13;
    v14 = *(_DWORD *)(v1 + 1440);
    if ( v14 & 0x4000 )
      v15 = *(float *)(*(_DWORD *)(v1 + 484) + 96) * v10[136];
    else
      v15 = v10[136];
    v10[22] = v15 * v20 / v24;
    v10[23] = v15 * v21 / v24;
  }
  return 0;
}

//----- (0050D5A0) --------------------------------------------------------
int __cdecl sub_50D5A0(int a1)
{
  int v1; // esi
  double v2; // st7
  float *v3; // edi
  double v4; // st6
  float v6; // edx
  char v7; // al
  bool v8; // zf
  int v9; // eax
  double v10; // st7
  double v11; // st6
  double v12; // st7
  double v13; // st6
  float4 v14; // [esp+Ch] [ebp-10h]

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(float *)(v1 + 24 * *(char *)(v1 + 544) + 556) - *(float *)(a1 + 56);
  v3 = (float *)(v1 + 24 * *(char *)(v1 + 544) + 556);
  v4 = *(float *)(v1 + 24 * *(char *)(v1 + 544) + 560) - *(float *)(a1 + 60);
  if ( sqrt(v4 * v4 + v2 * v2) + *(double *)&byte_581450[10288] <= 8.0 )
    return 1;
  v6 = *(float *)(a1 + 60);
  v14.field_0 = *(float *)(a1 + 56);
  v14.field_4 = v6;
  v14.field_8 = *v3;
  v7 = (*(_DWORD *)(a1 + 16) >> 12) & 4;
  v14.field_C = v3[1];
  v8 = sub_535250(&v14, 0, 0, v7) == 0;
  v9 = *(_DWORD *)(v1 + 8);
  if ( v8 )
  {
    if ( !v9 )
    {
      if ( !*(_DWORD *)(v1 + 296)
        || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 280)) > 0xA
        && (v12 = *(float *)(v1 + 368) - *v3, v13 = *(float *)(v1 + 372) - v3[1], v13 * v13 + v12 * v12 > 10000.0) )
      {
        sub_50D2A0(a1, (int)v3);
      }
      if ( *(_DWORD *)(v1 + 296) )
      {
LABEL_16:
        if ( sub_50D2E0(a1) )
        {
          *(_DWORD *)(v1 + 8) = 0;
          *(_DWORD *)(v1 + 296) = 0;
          return 1;
        }
        return 0;
      }
      sub_5341A0((char *)&byte_587000[234672]);
      sub_50D220(a1, (int)v3);
    }
  }
  else if ( !v9
         || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 280)) > 0xA
         && (v10 = *(float *)(v1 + 272) - *v3, v11 = *(float *)(v1 + 276) - v3[1], v11 * v11 + v10 * v10 > 2500.0) )
  {
    sub_50D220(a1, (int)v3);
  }
  if ( *(_DWORD *)(v1 + 296) )
    goto LABEL_16;
  if ( *(_DWORD *)(v1 + 8) && sub_50D3B0((float *)a1) )
  {
    *(_DWORD *)(v1 + 8) = 0;
    return 1;
  }
  return 0;
}

//----- (0050D780) --------------------------------------------------------
int sub_50D780()
{
  int result; // eax

  result = sub_413FE0((const char *)&byte_587000[234720], 12, 96);
  *(_DWORD *)&byte_5D4594[2386216] = result;
  if ( result )
  {
    *(_DWORD *)&byte_5D4594[2386212] = 0;
    result = sub_413FE0((const char *)&byte_587000[234732], 148, 96);
    *(_DWORD *)&byte_5D4594[2386220] = result;
    if ( result )
    {
      *(_DWORD *)&byte_5D4594[2386224] = 0;
      *(_DWORD *)&byte_5D4594[2386228] = 0;
      result = 1;
    }
  }
  return result;
}

//----- (0050D7E0) --------------------------------------------------------
void sub_50D7E0()
{
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386216]);
  *(_DWORD *)&byte_5D4594[2386212] = 0;
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386220]);
  *(_DWORD *)&byte_5D4594[2386224] = 0;
  *(_DWORD *)&byte_5D4594[2386228] = 0;
}

//----- (0050D820) --------------------------------------------------------
void sub_50D820()
{
  sub_414100(*(LPVOID *)&byte_5D4594[2386216]);
  *(_DWORD *)&byte_5D4594[2386216] = 0;
  *(_DWORD *)&byte_5D4594[2386212] = 0;
  sub_414100(*(LPVOID *)&byte_5D4594[2386220]);
  *(_DWORD *)&byte_5D4594[2386220] = 0;
  *(_DWORD *)&byte_5D4594[2386224] = 0;
  *(_DWORD *)&byte_5D4594[2386228] = 0;
}

//----- (0050D860) --------------------------------------------------------
int __cdecl sub_50D860(int a1, int a2)
{
  if ( *(float *)(a1 + 4) == *(float *)(a2 + 4) )
    return 0;
  if ( *(float *)(a1 + 4) <= (double)*(float *)(a2 + 4) )
    return -1;
  return 1;
}

//----- (0050D890) --------------------------------------------------------
unsigned int sub_50D890()
{
  unsigned int result; // eax

  if ( !(*(_DWORD *)&byte_5D4594[2598000] % (unsigned int)(5 * *(_DWORD *)&byte_5D4594[2649704])) )
    sub_50D8D0();
  result = *(_DWORD *)&byte_5D4594[2598000] / 0xFu;
  if ( !(*(_DWORD *)&byte_5D4594[2598000] % 0xFu) )
    result = sub_50D960();
  return result;
}

//----- (0050D8D0) --------------------------------------------------------
void sub_50D8D0()
{
  int *v0; // edi
  int *v1; // ebp
  int v2; // ebx
  int v3; // esi
  int v4; // eax

  v0 = *(int **)&byte_5D4594[2386212];
  if ( *(_DWORD *)&byte_5D4594[2386212] )
  {
    do
    {
      v1 = (int *)v0[1];
      v2 = 1;
      v3 = sub_4DA7C0();
      if ( !v3 )
        goto LABEL_13;
      do
      {
        v4 = *(_DWORD *)(v3 + 748);
        if ( *(_DWORD *)(*(_DWORD *)(v4 + 276) + 4792) == 1 && !*(_DWORD *)(v4 + 312) && sub_4E6C00(v3, *v0) < 700.0 )
          v2 = 0;
        v3 = sub_4DA7F0(v3);
      }
      while ( v3 );
      if ( v2 == 1 )
LABEL_13:
        sub_4E5CC0(*v0);
      v0 = v1;
    }
    while ( v1 );
  }
}

//----- (0050D960) --------------------------------------------------------
int sub_50D960()
{
  int v0; // ebx
  int v1; // edi
  int v2; // eax
  int *v3; // ebp
  int v4; // ecx
  _DWORD *v5; // esi
  _DWORD *v6; // eax
  int v7; // eax
  int i; // edx
  double v9; // st7
  int v10; // edi
  float *v11; // ecx
  int v12; // esi
  int j; // edx
  int k; // ecx
  int v15; // ebx
  int v16; // eax
  int v17; // eax
  int v18; // eax
  int v19; // esi
  int v20; // edi
  int v21; // eax
  int v22; // esi
  int v23; // ebp
  int v24; // edx
  unsigned __int8 *v25; // eax
  int *v26; // esi
  int *v27; // ebx
  char v28; // cl
  unsigned __int8 *v29; // eax
  int v30; // eax
  int v31; // eax
  int v32; // eax
  float v34; // [esp+0h] [ebp-40h]
  int v35; // [esp+14h] [ebp-2Ch]
  int v36; // [esp+18h] [ebp-28h]
  int v37; // [esp+18h] [ebp-28h]
  float4 a2; // [esp+20h] [ebp-20h]
  float4 v39; // [esp+30h] [ebp-10h]

  v34 = sub_419D40(&byte_587000[234752]);
  v35 = sub_419A70(v34);
  v36 = 0;
  memset(&byte_5D4594[2386232], 0, 0x80u);
  v0 = sub_4DA7C0();
  if ( v0 )
  {
    do
    {
      v1 = *(_DWORD *)(v0 + 748);
      *(_DWORD *)&byte_5D4594[4 * *(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064) + 2386232] = 0;
      v2 = *(_DWORD *)(v1 + 276);
      if ( *(_DWORD *)(v2 + 4792) )
      {
        v3 = *(int **)&byte_5D4594[2386212];
        a2.field_0 = *(float *)(v0 + 56) - (double)*(unsigned __int16 *)(v2 + 10) - 100.0;
        a2.field_4 = *(float *)(v0 + 60) - (double)*(unsigned __int16 *)(*(_DWORD *)(v1 + 276) + 12) - 100.0;
        a2.field_8 = (double)*(unsigned __int16 *)(*(_DWORD *)(v1 + 276) + 10) + *(float *)(v0 + 56) + 100.0;
        a2.field_C = (double)*(unsigned __int16 *)(*(_DWORD *)(v1 + 276) + 12) + *(float *)(v0 + 60) + 100.0;
        if ( *(_DWORD *)&byte_5D4594[2386212] )
        {
          do
          {
            if ( sub_428220((float2 *)(*v3 + 56), &a2) )
            {
              v39.field_0 = *(float *)(v0 + 56);
              v39.field_4 = *(float *)(v0 + 60);
              v4 = *v3;
              v39.field_8 = *(float *)(*v3 + 56);
              v39.field_C = *(float *)(v4 + 60);
              if ( sub_535250(&v39, 0, 0, 69) )
              {
                v5 = sub_50DE60(*v3);
                if ( !v5 )
                {
                  v6 = sub_4142F0(*(_DWORD **)&byte_5D4594[2386220]);
                  v5 = v6;
                  if ( !v6 )
                    break;
                  v6[35] = *(_DWORD *)&byte_5D4594[2386224];
                  if ( *(_DWORD *)&byte_5D4594[2386224] )
                    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386224] + 144) = v6;
                  *(_DWORD *)&byte_5D4594[2386224] = v6;
                  ++*(_DWORD *)&byte_5D4594[2386228];
                  *v6 = *v3;
                }
                v5[2] |= 1 << *(_BYTE *)(*(_DWORD *)(v1 + 276) + 2064);
                v7 = *(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064);
                ++*(_DWORD *)&byte_5D4594[4 * v7 + 2386232];
                if ( *(_DWORD *)&byte_5D4594[4 * *(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064) + 2386232] > v35 )
                  v36 = 1;
                *(float *)&v5[*(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064) + 3] = sub_4E6C00(*v3, v0);
              }
            }
            v3 = (int *)v3[1];
          }
          while ( v3 );
        }
      }
      v0 = sub_4DA7F0(v0);
    }
    while ( v0 );
    if ( v36 )
    {
      for ( i = *(_DWORD *)&byte_5D4594[2386224]; i; i = *(_DWORD *)(i + 140) )
      {
        v9 = 0.0;
        v10 = 0;
        v11 = (float *)(i + 12);
        v12 = 32;
        do
        {
          if ( *v11 != 0.0 )
          {
            v9 = v9 + *v11;
            ++v10;
          }
          ++v11;
          --v12;
        }
        while ( v12 );
        *(float *)(i + 4) = v9 / (double)v10;
      }
      for ( j = *(_DWORD *)&byte_5D4594[2386224]; j; j = *(_DWORD *)(j + 140) )
      {
        for ( k = *(_DWORD *)(j + 140); k; k = *(_DWORD *)(k + 140) )
        {
          if ( *(float *)(k + 4) > (double)*(float *)(j + 4) )
          {
            v15 = *(_DWORD *)(j + 140);
            if ( v15 == k )
            {
              v16 = *(_DWORD *)(j + 144);
              *(_DWORD *)(k + 144) = v16;
              if ( v16 )
                *(_DWORD *)(v16 + 140) = k;
              v17 = *(_DWORD *)(k + 140);
              *(_DWORD *)(j + 140) = v17;
              if ( v17 )
                *(_DWORD *)(v17 + 144) = j;
              *(_DWORD *)(j + 144) = k;
              *(_DWORD *)(k + 140) = j;
            }
            else
            {
              v18 = *(_DWORD *)(j + 144);
              v19 = *(_DWORD *)(k + 140);
              v20 = *(_DWORD *)(k + 144);
              if ( v18 )
                *(_DWORD *)(v18 + 140) = k;
              if ( v20 )
                *(_DWORD *)(v20 + 140) = j;
              if ( v15 )
                *(_DWORD *)(v15 + 144) = k;
              if ( v19 )
                *(_DWORD *)(v19 + 144) = j;
              *(_DWORD *)(j + 144) = v20;
              *(_DWORD *)(j + 140) = v19;
              *(_DWORD *)(k + 144) = v18;
              *(_DWORD *)(k + 140) = v15;
            }
            if ( j == *(_DWORD *)&byte_5D4594[2386224] )
              *(_DWORD *)&byte_5D4594[2386224] = k;
            v21 = k;
            k = j;
            j = v21;
          }
        }
      }
      while ( 1 )
      {
        v22 = 0;
        v23 = 0;
        v24 = 0;
        v25 = &byte_5D4594[2386232];
        do
        {
          if ( *(_DWORD *)v25 > v22 )
          {
            v22 = *(_DWORD *)v25;
            v23 = v24;
          }
          v25 += 4;
          ++v24;
        }
        while ( (int)v25 < (int)&byte_5D4594[2386360] );
        if ( v22 <= v35 )
          break;
        v26 = *(int **)&byte_5D4594[2386224];
        v37 = 1;
        if ( *(_DWORD *)&byte_5D4594[2386224] )
        {
          do
          {
            if ( v37 != 1 )
              break;
            v27 = (int *)v26[35];
            if ( v26[2] & (1 << v23) )
            {
              sub_4E5CC0(*v26);
              v28 = 0;
              v29 = &byte_5D4594[2386232];
              do
              {
                if ( (1 << v28) & v26[2] )
                  --*(_DWORD *)v29;
                v29 += 4;
                ++v28;
              }
              while ( (int)v29 < (int)&byte_5D4594[2386360] );
              v30 = v26[35];
              if ( v30 )
                *(_DWORD *)(v30 + 144) = v26[36];
              v31 = v26[36];
              if ( v31 )
                *(_DWORD *)(v31 + 140) = v26[35];
              else
                *(_DWORD *)&byte_5D4594[2386224] = v26[35];
              sub_414330(*(unsigned int **)&byte_5D4594[2386220], v26);
              v32 = *(_DWORD *)&byte_5D4594[4 * v23 + 2386232];
              --*(_DWORD *)&byte_5D4594[2386228];
              if ( v32 <= v35 )
                v37 = 0;
            }
            v26 = v27;
          }
          while ( v27 );
        }
      }
    }
  }
  return sub_50DE10();
}

//----- (0050DE10) --------------------------------------------------------
int sub_50DE10()
{
  int result; // eax
  int v1; // esi

  result = *(_DWORD *)&byte_5D4594[2386224];
  if ( *(_DWORD *)&byte_5D4594[2386224] )
  {
    do
    {
      v1 = *(_DWORD *)(result + 140);
      sub_414330(*(unsigned int **)&byte_5D4594[2386220], (_QWORD *)result);
      result = v1;
      --*(_DWORD *)&byte_5D4594[2386228];
    }
    while ( v1 );
    *(_DWORD *)&byte_5D4594[2386224] = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2386224] = 0;
  }
  return result;
}

//----- (0050DE60) --------------------------------------------------------
_DWORD *__cdecl sub_50DE60(int a1)
{
  _DWORD *result; // eax

  result = *(_DWORD **)&byte_5D4594[2386224];
  if ( !*(_DWORD *)&byte_5D4594[2386224] )
    return 0;
  while ( *result != a1 )
  {
    result = (_DWORD *)result[35];
    if ( !result )
      return 0;
  }
  return result;
}

//----- (0050DE80) --------------------------------------------------------
int __cdecl sub_50DE80(int a1, float *a2)
{
  int v2; // edi
  int v3; // esi
  int v4; // eax
  int v5; // ecx
  float v7; // [esp+0h] [ebp-20h]
  float4 a2a; // [esp+10h] [ebp-10h]

  v7 = sub_419D40(&byte_587000[234776]);
  v2 = sub_419A70(v7);
  v3 = sub_4DA7C0();
  if ( !v3 )
    return 1;
  while ( 1 )
  {
    v4 = *(_DWORD *)(v3 + 748);
    v5 = *(_DWORD *)(v4 + 276);
    if ( *(_DWORD *)(v5 + 4792) )
    {
      a2a.field_0 = *(float *)(v3 + 56) - (double)*(unsigned __int16 *)(v5 + 10) - 100.0;
      a2a.field_4 = *(float *)(v3 + 60) - (double)*(unsigned __int16 *)(*(_DWORD *)(v4 + 276) + 12) - 100.0;
      a2a.field_8 = (double)*(unsigned __int16 *)(*(_DWORD *)(v4 + 276) + 10) + *(float *)(v3 + 56) + 100.0;
      a2a.field_C = (double)*(unsigned __int16 *)(*(_DWORD *)(v4 + 276) + 12) + *(float *)(v3 + 60) + 100.0;
      if ( sub_428220((float2 *)a2, &a2a) )
      {
        *(_DWORD *)&byte_5D4594[2386208] = 0;
        sub_517C10(&a2a, sub_50DFB0, v3);
        if ( *(_DWORD *)&byte_5D4594[2386208] >= v2 )
          break;
      }
    }
    v3 = sub_4DA7F0(v3);
    if ( !v3 )
      return 1;
  }
  return 0;
}

//----- (0050DFB0) --------------------------------------------------------
void __cdecl sub_50DFB0(float *a1, int a2)
{
  float v2; // ecx
  float v3; // eax
  float v4; // ecx
  float4 v5; // [esp+4h] [ebp-10h]

  if ( (_BYTE)a1[2] & 2 && !((_DWORD)a1[4] & 0x20) && (((_DWORD)a1[4] & 0x8000) != 0x8000 || sub_534A40((int)a1)) )
  {
    v2 = *(float *)(a2 + 56);
    v3 = a1[14];
    v5.field_4 = *(float *)(a2 + 60);
    v5.field_0 = v2;
    v4 = a1[15];
    v5.field_8 = v3;
    v5.field_C = v4;
    if ( sub_535250(&v5, 0, 0, 69) == 1 )
      ++*(_DWORD *)&byte_5D4594[2386208];
  }
}

//----- (0050E030) --------------------------------------------------------
int __cdecl sub_50E030(int a1, _DWORD *a2)
{
  int v2; // ebp
  _DWORD *v3; // esi
  int result; // eax
  _DWORD *v5; // edi
  int v6; // eax
  _DWORD *v7; // eax
  int v8; // ecx
  int *v9; // edx
  _DWORD *v10; // edi
  int v11; // esi
  int v12; // ebp
  _DWORD *v13; // edx
  int v14; // esi

  v2 = *(_DWORD *)(a1 + 748);
  v3 = (_DWORD *)a2[187];
  if ( !v3[549] )
  {
    result = sub_4142F0(*(_DWORD **)&byte_5D4594[2386216]);
    v5 = (_DWORD *)result;
    if ( !result )
      return result;
    sub_50E110(result);
    *v5 = a2;
    ++*(_BYTE *)(v2 + 86);
    v3[549] = v5;
    v3[548] = a1;
    v6 = a2[3];
    if ( v6 & 0x2000 )
    {
      v7 = sub_4E3810((CHAR *)&byte_587000[234800]);
      if ( v7 )
      {
        v8 = v7[173];
        v9 = v3 + 511;
        v10 = (_DWORD *)v7[173];
        v11 = 3;
        do
        {
          v12 = *v9;
          ++v9;
          *v10 = v12;
          ++v10;
          --v11;
        }
        while ( v11 );
        *(_DWORD *)(v8 + 24) = 0;
        *(_DWORD *)(v8 + 28) = a2[14];
        *(_DWORD *)(v8 + 32) = a2[15];
        *(_BYTE *)(v8 + 20) = 0;
        v13 = (_DWORD *)v8;
        v14 = 3;
        do
        {
          if ( *v13 )
            ++*(_BYTE *)(v8 + 20);
          ++v13;
          --v14;
        }
        while ( v14 );
      }
      sub_4F3070((int)a2, (int)v7, 1);
    }
  }
  return 1;
}

//----- (0050E110) --------------------------------------------------------
int __cdecl sub_50E110(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 8) = 0;
  *(_DWORD *)(a1 + 4) = *(_DWORD *)&byte_5D4594[2386212];
  if ( *(_DWORD *)&byte_5D4594[2386212] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386212] + 8) = a1;
  *(_DWORD *)&byte_5D4594[2386212] = a1;
  return result;
}

//----- (0050E140) --------------------------------------------------------
void __cdecl sub_50E140(int a1)
{
  int v1; // esi
  int v2; // eax

  if ( a1 )
  {
    v1 = *(_DWORD *)(a1 + 748);
    v2 = *(_DWORD *)(v1 + 2192);
    if ( v2 )
    {
      --*(_BYTE *)(*(_DWORD *)(v2 + 748) + 86);
      *(_DWORD *)(v1 + 2192) = 0;
    }
    if ( *(_DWORD *)(v1 + 2196) )
    {
      sub_50E1B0(*(_DWORD *)(v1 + 2196));
      sub_414330(*(unsigned int **)&byte_5D4594[2386216], *(_QWORD **)(v1 + 2196));
      *(_DWORD *)(v1 + 2196) = 0;
    }
  }
}

//----- (0050E1B0) --------------------------------------------------------
int __cdecl sub_50E1B0(int a1)
{
  int result; // eax
  int v2; // ecx
  int v3; // ecx

  result = a1;
  v2 = *(_DWORD *)(a1 + 4);
  if ( v2 )
    *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 8);
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 )
  {
    result = *(_DWORD *)(a1 + 4);
    *(_DWORD *)(v3 + 4) = result;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2386212] = *(_DWORD *)(a1 + 4);
  }
  return result;
}

//----- (0050E1E0) --------------------------------------------------------
void __cdecl sub_50E1E0(int a1)
{
  if ( a1 )
  {
    if ( !sub_534A40(a1) )
      sub_50E140(a1);
  }
}

//----- (0050E210) --------------------------------------------------------
void __cdecl sub_50E210(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // esi
  int v4; // edi

  v1 = *(_DWORD *)(a1 + 748);
  if ( !*(_DWORD *)&byte_5D4594[2386360] )
    *(_DWORD *)&byte_5D4594[2386360] = sub_4E3AA0((CHAR *)&byte_587000[234808]);
  if ( *(_BYTE *)(a1 + 8) & 2 )
  {
    v2 = *(_DWORD *)(a1 + 12);
    if ( v2 & 0x2000 )
    {
      if ( *(_DWORD *)(v1 + 2196) )
      {
        v3 = sub_4E7980(a1);
        if ( v3 )
        {
          do
          {
            v4 = sub_4E7990(v3);
            if ( *(unsigned __int16 *)(v3 + 4) == *(_DWORD *)&byte_5D4594[2386360] )
              sub_4E5CC0(v3);
            v3 = v4;
          }
          while ( v4 );
        }
      }
    }
  }
  sub_50E140(a1);
}

//----- (0050E2A0) --------------------------------------------------------
int sub_50E2A0()
{
  int result; // eax

  result = sub_413FE0((const char *)&byte_587000[235580], 64, 64);
  *(_DWORD *)&byte_5D4594[2386492] = result;
  if ( result )
  {
    *(_DWORD *)&byte_5D4594[2386496] = sub_413FE0((const char *)&byte_587000[235596], 16, 500);
    if ( *(_DWORD *)&byte_5D4594[2386496] )
    {
      memset(&byte_5D4594[2386364], 0, 0x80u);
      *(_DWORD *)&byte_5D4594[2386500] = 0;
      result = 1;
    }
    else
    {
      sub_50E300();
      result = 0;
    }
  }
  return result;
}

//----- (0050E300) --------------------------------------------------------
int sub_50E300()
{
  int result; // eax

  if ( *(_DWORD *)&byte_5D4594[2386492] )
    sub_414100(*(LPVOID *)&byte_5D4594[2386492]);
  *(_DWORD *)&byte_5D4594[2386492] = 0;
  if ( *(_DWORD *)&byte_5D4594[2386496] )
    sub_414100(*(LPVOID *)&byte_5D4594[2386496]);
  result = 0;
  memset(&byte_5D4594[2386364], 0, 0x80u);
  *(_DWORD *)&byte_5D4594[2386496] = 0;
  *(_DWORD *)&byte_5D4594[2386500] = 0;
  return result;
}

//----- (0050E360) --------------------------------------------------------
int sub_50E360()
{
  _DWORD *v0; // edi
  int *i; // esi
  int result; // eax

  v0 = *(_DWORD **)&byte_5D4594[2386500];
  if ( *(_DWORD *)&byte_5D4594[2386500] )
  {
    do
    {
      if ( v0[4] )
      {
        for ( i = (int *)v0[5]; i; i = (int *)i[2] )
          sub_4E38A0(*i);
        v0[5] = 0;
      }
      v0 = (_DWORD *)v0[14];
    }
    while ( v0 );
  }
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386492]);
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386496]);
  result = 0;
  memset(&byte_5D4594[2386364], 0, 0x80u);
  *(_DWORD *)&byte_5D4594[2386500] = 0;
  return result;
}

//----- (0050E3D0) --------------------------------------------------------
int __cdecl sub_50E3D0(int a1, int a2, float a3)
{
  float v3; // ebp
  int v4; // edi
  int v5; // ebx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  double v9; // st7
  int v10; // eax
  int v11; // esi
  int v12; // edi
  double v13; // st7
  int v14; // eax
  _BYTE *v15; // esi
  double v16; // st7
  int v17; // eax
  double v18; // st7
  int v19; // ecx
  int v20; // ecx
  unsigned __int16 *v21; // ecx
  double v22; // st7
  int v23; // eax
  double v24; // st7
  float v26; // [esp+0h] [ebp-20h]
  int v27; // [esp+14h] [ebp-Ch]
  float v28; // [esp+18h] [ebp-8h]
  int v29; // [esp+28h] [ebp+8h]
  float v30; // [esp+28h] [ebp+8h]
  float v31; // [esp+2Ch] [ebp+Ch]

  v3 = a3;
  v4 = 0;
  v27 = 0;
  v31 = (double)*(unsigned int *)(LODWORD(a3) + 32);
  if ( !*(_DWORD *)&byte_5D4594[2386504] )
  {
    *(_DWORD *)&byte_5D4594[2386504] = sub_4E3AA0((CHAR *)&byte_587000[235608]);
    *(_DWORD *)&byte_5D4594[2386508] = sub_4E3AA0((CHAR *)&byte_587000[235616]);
    *(_DWORD *)&byte_5D4594[2386512] = sub_4E3AA0((CHAR *)&byte_587000[235624]);
  }
  v5 = a2;
  if ( a2 && *(_DWORD *)(a2 + 16) )
  {
    v6 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(v6 + 8) & 4 )
      v6 = *(_DWORD *)(a2 + 12);
    v27 = *(_DWORD *)(v6 + 692);
    v4 = *(_DWORD *)(v6 + 692);
  }
  v7 = *(_DWORD *)(LODWORD(v3) + 8);
  if ( v7 & 0x100 )
  {
    v8 = *(_DWORD *)(LODWORD(v3) + 12);
    if ( v8 & 1 )
    {
      v9 = (double)(unsigned __int16)sub_424C40(COERCE_FLOAT(**(_BYTE **)(LODWORD(v3) + 736)));
LABEL_16:
      v31 = v9;
      goto LABEL_17;
    }
    if ( v8 & 2 )
    {
      v10 = sub_4E3B60(*(CHAR **)(LODWORD(v3) + 736));
      if ( v10 )
        v31 = (double)*(unsigned int *)(v10 + 48);
      if ( sub_40A5C0(4096) )
      {
        v9 = sub_419D40(&byte_587000[235632]) * v31;
        goto LABEL_16;
      }
    }
  }
LABEL_17:
  if ( *(_DWORD *)(LODWORD(v3) + 8) & 0x13001000 )
  {
    v11 = *(_DWORD *)(LODWORD(v3) + 692);
    v12 = 4;
    do
    {
      if ( *(_DWORD *)v11 )
      {
        *(float *)&v29 = (double)*(int *)(*(_DWORD *)v11 + 20);
        if ( sub_40A5C0(4096) )
          v13 = sub_419D40(&byte_587000[235660]) * *(float *)&v29;
        else
          v13 = *(float *)&v29;
        v31 = v13 + v31;
      }
      v11 += 4;
      --v12;
    }
    while ( v12 );
    v4 = v27;
  }
  v14 = *(_DWORD *)(LODWORD(v3) + 8);
  v30 = v31;
  if ( v14 & 0x1000000 && *(_BYTE *)(LODWORD(v3) + 12) & 0x82 )
  {
    v15 = *(_BYTE **)(LODWORD(v3) + 736);
    if ( !v15[2] && *v15 )
    {
      if ( sub_40A5C0(4096) )
        v16 = sub_419D40(&byte_587000[235692]);
      else
        v16 = sub_419D40(&byte_587000[235716]);
      v26 = v16;
      v17 = sub_419A70(v26);
      v18 = (double)v17;
      v19 = (unsigned __int8)v15[1];
      if ( v19 > v17 )
      {
        v28 = v31 / v18;
        v31 = (double)(v19 - v17) * v28 + v31;
      }
      else
      {
        v31 = (double)(unsigned __int8)v15[1] / v18 * v31;
      }
    }
  }
  else if ( v14 & 0x1000 )
  {
    if ( *(_DWORD *)(LODWORD(v3) + 12) & 0x47F0000 )
    {
      v20 = *(_DWORD *)(LODWORD(v3) + 736);
      if ( *(_BYTE *)(v20 + 109) )
      {
        v4 = v27;
        v31 = (double)*(unsigned __int8 *)(v20 + 108) / (double)*(unsigned __int8 *)(v20 + 109) * v31;
      }
    }
  }
  if ( v4 && v5 && *(_DWORD *)(v5 + 16) && a1 )
  {
    v31 = v31 * *(float *)(v4 + 1716);
    v30 = v30 * *(float *)(v4 + 1716);
  }
  v21 = *(unsigned __int16 **)(LODWORD(v3) + 556);
  if ( v21 && v21[2] )
    v31 = (double)*v21 / (double)v21[2] * v31;
  if ( v4 && !a1 )
  {
    v22 = sub_40A5C0(4096) ? sub_419D40(&byte_587000[235736]) : *(float *)(v4 + 1720);
    v23 = *(unsigned __int16 *)(LODWORD(v3) + 4);
    if ( (unsigned __int16)v23 != *(_DWORD *)&byte_5D4594[2386504]
      && v23 != *(_DWORD *)&byte_5D4594[2386512]
      && v23 != *(_DWORD *)&byte_5D4594[2386508] )
    {
      v31 = v22 * v31;
      v30 = v22 * v30;
    }
  }
  if ( sub_40A5C0(4096)
    && !a1
    && *(_DWORD *)(LODWORD(v3) + 8) & 0x3001000
    && *(_BYTE *)(*(_DWORD *)(LODWORD(v3) + 748) + 4) & 1 )
  {
    v30 = 0.0;
  }
  else if ( v31 >= 1.0 )
  {
    goto LABEL_64;
  }
  v31 = 1.0;
LABEL_64:
  if ( v30 < 1.0 )
    v30 = 1.0;
  if ( a1 == 2 )
  {
    v24 = sub_419D40(&byte_587000[235756]) * (v30 - v31);
    v31 = v24;
    if ( v24 < 1.0 )
      v31 = 1.0;
  }
  return sub_419A70(v31);
}

//----- (0050E7A0) --------------------------------------------------------
int __cdecl sub_50E7A0(_DWORD *a1, int a2)
{
  int *v2; // esi
  int v4; // eax
  int v5; // eax
  int v6; // eax

  v2 = (int *)a1[5];
  if ( !v2 )
    return 0;
  while ( *v2 != a2 )
  {
    v2 = (int *)v2[2];
    if ( !v2 )
      return 0;
  }
  v4 = v2[2];
  if ( v4 )
    *(_DWORD *)(v4 + 12) = v2[3];
  v5 = v2[3];
  if ( v5 )
    *(_DWORD *)(v5 + 8) = v2[2];
  if ( v2 == (int *)a1[5] )
    a1[5] = v2[2];
  v6 = a1[2];
  if ( !(*(_BYTE *)(v6 + 8) & 4) )
    v6 = a1[3];
  sub_50E820(v6, *v2);
  sub_414330(*(unsigned int **)&byte_5D4594[2386496], v2);
  return 1;
}

//----- (0050E820) --------------------------------------------------------
int __cdecl sub_50E820(int a1, int a2)
{
  int v3; // ecx
  int v5; // [esp+0h] [ebp-4h]

  HIWORD(v5) = *(_WORD *)(a2 + 36);
  v3 = *(_DWORD *)(a1 + 748);
  LOWORD(v5) = 2505;
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)&v5, 4, 0, 1);
}

//----- (0050E870) --------------------------------------------------------
_DWORD *sub_50E870()
{
  _DWORD *v0; // eax
  _DWORD *v1; // esi

  v0 = sub_4142F0(*(_DWORD **)&byte_5D4594[2386492]);
  v1 = v0;
  if ( !v0 )
    return 0;
  v0[2] = 0;
  v0[3] = 0;
  v0[6] = 0;
  v0[7] = 0;
  v0[8] = 0;
  v0[9] = 0;
  v0[10] = 0;
  v0[11] = 0;
  v0[5] = 0;
  v0[12] = sub_4E3810((CHAR *)&byte_587000[235776]);
  v1[13] = sub_4E3810((CHAR *)&byte_587000[235784]);
  v1[15] = 0;
  v1[14] = *(_DWORD *)&byte_5D4594[2386500];
  if ( *(_DWORD *)&byte_5D4594[2386500] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386500] + 60) = v1;
  *(_DWORD *)&byte_5D4594[2386500] = v1;
  return v1;
}

//----- (0050E8F0) --------------------------------------------------------
_DWORD *__cdecl sub_50E8F0(int a1, int a2)
{
  int v2; // ebx
  int v3; // eax
  _DWORD *v4; // esi
  _DWORD *result; // eax

  v2 = 0;
  if ( sub_40A5C0(4096)
    && (v3 = *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064),
        v4 = *(_DWORD **)&byte_5D4594[4 * v3 + 2386364],
        *(_DWORD *)&byte_5D4594[4 * v3 + 2386364] = 0,
        v4) )
  {
    v2 = 1;
  }
  else
  {
    result = sub_50E870();
    v4 = result;
    if ( !result )
      return result;
  }
  v4[2] = a1;
  v4[3] = a2;
  v4[4] = 1;
  if ( !v2 )
    sub_50E970((int)v4);
  return v4;
}

//----- (0050E970) --------------------------------------------------------
void __cdecl sub_50E970(int a1)
{
  int v1; // edi
  int v2; // eax
  int v3; // esi
  unsigned int v4; // esi
  _DWORD *v5; // eax
  CHAR **v6; // eax
  unsigned __int8 *v7; // esi
  _DWORD *v8; // eax
  int v9; // ecx
  _DWORD *v10; // eax
  int v11; // edi
  _DWORD *v12; // ebx
  int v13; // eax
  unsigned int v14; // esi
  _DWORD *v15; // eax
  _DWORD *v16; // eax
  _DWORD *v17; // eax
  _DWORD *v18; // eax
  _DWORD *v19; // eax
  _DWORD *v20; // eax
  _DWORD *v21; // eax
  _DWORD *v22; // eax
  _DWORD *v23; // eax
  _DWORD *v24; // eax
  _DWORD *v25; // eax
  _DWORD *v26; // eax
  _DWORD *v27; // eax
  _DWORD *v28; // eax
  _DWORD *v29; // eax
  _DWORD *v30; // eax
  _DWORD *v31; // eax
  _DWORD *v32; // eax
  _BYTE *v33; // esi
  unsigned __int8 *v34; // ebp
  _DWORD *v35; // eax
  int v36; // ebx
  int v37; // eax
  int v38; // edx
  int v39; // eax
  float v40; // [esp+0h] [ebp-38h]
  int v41; // [esp+14h] [ebp-24h]
  int v42; // [esp+18h] [ebp-20h]
  _BYTE *v43; // [esp+20h] [ebp-18h]
  unsigned __int8 v44[20]; // [esp+24h] [ebp-14h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 && *(_BYTE *)(v2 + 8) & 2 && *(_BYTE *)(v2 + 12) & 8
    || (v2 = *(_DWORD *)(a1 + 12)) != 0 && *(_BYTE *)(v2 + 8) & 2 && *(_BYTE *)(v2 + 12) & 8 )
  {
    v3 = v2;
    if ( sub_40A5C0(4096) )
    {
      v40 = sub_419D40(&byte_587000[235792]);
      v4 = sub_419A70(v40);
      if ( sub_4E3CC0() < v4 )
      {
        v5 = sub_4E3810((CHAR *)&byte_587000[235812]);
        if ( v5 )
          sub_50EE00(a1, *(float *)&v5);
      }
      if ( *(_DWORD *)&byte_587000[234816] )
      {
        v6 = (CHAR **)&byte_587000[234816];
        v7 = &byte_587000[234816];
        do
        {
          v8 = sub_4E3810(*v6);
          if ( v8 )
            sub_50EE00(a1, *(float *)&v8);
          v9 = *((_DWORD *)v7 + 1);
          v7 += 4;
          v6 = (CHAR **)v7;
        }
        while ( v9 );
      }
      v10 = sub_4E3810((CHAR *)&byte_587000[235828]);
      v11 = (int)v10;
      if ( v10 )
      {
        v12 = (_DWORD *)v10[173];
        v13 = sub_4E3CC0();
        *v12 = 8;
        v14 = v13 + 2;
        v15 = sub_4F0720(v11, v13 + 2);
        if ( v15 )
          sub_50EE00(a1, *(float *)&v15);
        *v12 = 8;
        v16 = sub_4F0720(v11, v14);
        if ( v16 )
          sub_50EE00(a1, *(float *)&v16);
        *v12 = 8;
        v17 = sub_4F0720(v11, v14);
        if ( v17 )
          sub_50EE00(a1, *(float *)&v17);
        *v12 = 8;
        v18 = sub_4F0720(v11, v14);
        if ( v18 )
          sub_50EE00(a1, *(float *)&v18);
        *v12 = 16;
        v19 = sub_4F0720(v11, v14);
        if ( v19 )
          sub_50EE00(a1, *(float *)&v19);
        *v12 = 16;
        v20 = sub_4F0720(v11, v14);
        if ( v20 )
          sub_50EE00(a1, *(float *)&v20);
        *v12 = 16;
        v21 = sub_4F0720(v11, v14);
        if ( v21 )
          sub_50EE00(a1, *(float *)&v21);
        *v12 = 16;
        v22 = sub_4F0720(v11, v14);
        if ( v22 )
          sub_50EE00(a1, *(float *)&v22);
        *v12 = 1;
        v23 = sub_4F0720(v11, v14);
        if ( v23 )
          sub_50EE00(a1, *(float *)&v23);
        *v12 = 1;
        v24 = sub_4F0720(v11, v14);
        if ( v24 )
          sub_50EE00(a1, *(float *)&v24);
        *v12 = 1;
        v25 = sub_4F0720(v11, v14);
        if ( v25 )
          sub_50EE00(a1, *(float *)&v25);
        *v12 = 1;
        v26 = sub_4F0720(v11, v14);
        if ( v26 )
          sub_50EE00(a1, *(float *)&v26);
        *v12 = 1;
        v27 = sub_4F0720(v11, v14);
        if ( v27 )
          sub_50EE00(a1, *(float *)&v27);
        *v12 = 1;
        v28 = sub_4F0720(v11, v14);
        if ( v28 )
          sub_50EE00(a1, *(float *)&v28);
        *v12 = 4;
        v29 = sub_4F0720(v11, v14);
        if ( v29 )
          sub_50EE00(a1, *(float *)&v29);
        *v12 = 4;
        v30 = sub_4F0720(v11, v14);
        if ( v30 )
          sub_50EE00(a1, *(float *)&v30);
        *v12 = 4;
        v31 = sub_4F0720(v11, v14);
        if ( v31 )
          sub_50EE00(a1, *(float *)&v31);
        if ( sub_415FA0(0, 100) > 90 )
        {
          *v12 = 2;
          v32 = sub_4F0720(v11, v14);
          if ( v32 )
            sub_50EE00(a1, *(float *)&v32);
        }
        sub_4E5CC0(v11);
      }
    }
    else
    {
      v33 = *(_BYTE **)(v3 + 692);
      v43 = v33;
      if ( v33 )
      {
        if ( *v33 )
        {
          v42 = 0;
          if ( *v33 )
          {
            v34 = v33 + 8;
            do
            {
              v41 = 0;
              if ( *v34 )
              {
                do
                {
                  v35 = sub_4E3810(*(CHAR **)(*((_DWORD *)v34 - 1) + 4));
                  v36 = (int)v35;
                  if ( v35 )
                  {
                    if ( v35[2] & 0x13001000 )
                    {
                      v37 = *((_DWORD *)v34 + 2);
                      v38 = *((_DWORD *)v34 + 4);
                      *(_DWORD *)&v44[4] = *((_DWORD *)v34 + 3);
                      *(_DWORD *)v44 = v37;
                      v39 = *((_DWORD *)v34 + 5);
                      *(_DWORD *)&v44[8] = v38;
                      *(_DWORD *)&v44[12] = v39;
                      sub_4E4990(v36, (int *)v44);
                    }
                    if ( *(int (__cdecl **)(int *))(v36 + 704) == sub_4F5F30 )
                      **(_BYTE **)(v36 + 736) = v34[4];
                    if ( *(int (__cdecl **)(int *))(v36 + 704) == sub_4F6240 )
                      **(_BYTE **)(v36 + 736) = v34[4];
                    if ( *(int (__cdecl **)(int *))(v36 + 704) == sub_4F6390 )
                    {
                      strcpy(*(char **)(v36 + 736), (const char *)sub_4E3A80(*((_DWORD *)v34 + 1)));
                      v1 = a1;
                      v33 = v43;
                    }
                    sub_50EE00(v1, *(float *)&v36);
                  }
                  ++v41;
                }
                while ( v41 < *v34 );
              }
              v34 += 28;
              ++v42;
            }
            while ( v42 < (unsigned __int8)*v33 );
          }
        }
      }
    }
  }
}

//----- (0050EE00) --------------------------------------------------------
float *__cdecl sub_50EE00(int a1, float a2)
{
  float *result; // eax
  float *v3; // esi
  unsigned int v4; // ebx
  int v5; // edi
  _DWORD *i; // eax
  int v7; // eax

  result = (float *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386496]);
  v3 = result;
  if ( result )
  {
    *result = a2;
    *((_DWORD *)result + 1) = sub_50E3D0(1, a1, a2);
    v4 = sub_50EEC0(v3);
    if ( *(_DWORD *)(a1 + 20) )
    {
      if ( v4 <= sub_50EEC0(*(_DWORD **)(a1 + 20)) )
      {
        v3[3] = 0.0;
        v3[2] = *(float *)(a1 + 20);
        *(_DWORD *)(*(_DWORD *)(a1 + 20) + 12) = v3;
        *(_DWORD *)(a1 + 20) = v3;
        result = v3;
      }
      else
      {
        v5 = *(_DWORD *)(a1 + 20);
        for ( i = *(_DWORD **)(v5 + 8); i; i = *(_DWORD **)(v5 + 8) )
        {
          if ( v4 <= sub_50EEC0(i) )
            break;
          v5 = *(_DWORD *)(v5 + 8);
        }
        v3[2] = *(float *)(v5 + 8);
        v7 = *(_DWORD *)(v5 + 8);
        if ( v7 )
          *(_DWORD *)(v7 + 12) = v3;
        *(_DWORD *)(v5 + 8) = v3;
        *((_DWORD *)v3 + 3) = v5;
        result = v3;
      }
    }
    else
    {
      v3[2] = 0.0;
      v3[3] = 0.0;
      *(_DWORD *)(a1 + 20) = v3;
      result = v3;
    }
  }
  return result;
}

//----- (0050EEC0) --------------------------------------------------------
int __cdecl sub_50EEC0(_DWORD *a1)
{
  int v1; // ecx
  int v2; // eax
  unsigned __int8 *v3; // edx

  v1 = 16781312;
  v2 = 255;
  v3 = &byte_581450[10308];
  do
  {
    if ( *(_DWORD *)(*a1 + 8) & v1 && (!*(_DWORD *)v3 || *(_DWORD *)v3 & *(_DWORD *)(*a1 + 12)) )
      break;
    v1 = *((_DWORD *)v3 + 1);
    v3 += 8;
    --v2;
  }
  while ( v1 );
  return a1[1] | (v2 << 24);
}

//----- (0050EF10) --------------------------------------------------------
_DWORD *__cdecl sub_50EF10(int a1, int a2)
{
  int v2; // edx
  int v3; // eax
  wchar_t *v4; // eax
  int v6; // ecx
  int v7; // eax
  wchar_t *v8; // eax
  _DWORD *v9; // esi
  char v10; // al
  int v11; // eax
  int v12; // eax
  int v13; // [esp-4h] [ebp-114h]
  wchar_t v14[128]; // [esp+10h] [ebp-100h]

  v2 = *(_DWORD *)(a1 + 8) & 4;
  if ( v2 )
  {
    v3 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 280);
    if ( v3 )
    {
      if ( *(_DWORD *)(v3 + 12) != a2 )
      {
        v4 = sub_40F1D0((char *)&byte_587000[235924], 0, (const char *)&byte_587000[235884], 1836);
        sub_4D9EB0(a1, v4);
      }
      return 0;
    }
  }
  v6 = *(_DWORD *)(a2 + 8) & 4;
  if ( v6 )
  {
    v7 = *(_DWORD *)(a2 + 748);
    if ( *(_DWORD *)(v7 + 280) )
    {
      if ( v2 )
      {
        v13 = *(_DWORD *)(v7 + 276) + 4704;
        v8 = sub_40F1D0((char *)&byte_587000[235988], 0, (const char *)&byte_587000[235948], 1878);
        nox_swprintf(v14, v8, v13);
        sub_4D9EB0(a1, v14);
      }
      return 0;
    }
  }
  if ( v2 )
  {
    if ( !v6 )
    {
      v9 = sub_50E8F0(a1, a2);
      goto LABEL_18;
    }
  }
  else if ( !v6 )
  {
    goto LABEL_17;
  }
  if ( !v2 )
  {
    v9 = sub_50E8F0(a2, a1);
    goto LABEL_18;
  }
LABEL_17:
  v9 = sub_50E870();
  v9[2] = a1;
  v9[3] = a2;
LABEL_18:
  if ( !v9 )
    return 0;
  v9[1] = *(_DWORD *)&byte_5D4594[2598000];
  sub_50F370(v9, a1);
  sub_50F370(v9, a2);
  v10 = *(_BYTE *)(a1 + 8);
  if ( v9[4] )
  {
    if ( v10 & 4 )
      sub_50F0F0(a1, (int)v9);
    if ( *(_BYTE *)(a2 + 8) & 4 )
      sub_50F0F0(a2, (int)v9);
  }
  else
  {
    if ( v10 & 4 )
      sub_50F1A0(a1, (int)v9);
    if ( *(_BYTE *)(a2 + 8) & 4 )
      sub_50F1A0(a2, (int)v9);
  }
  if ( v9[4] )
  {
    v11 = v9[2];
    if ( *(_BYTE *)(v11 + 8) & 4 )
      sub_50F280(v11, (int)v9);
    else
      sub_50F280(v9[3], (int)v9);
    if ( v9[4] && sub_40A5C0(2048) )
    {
      v12 = v9[2];
      if ( !(*(_BYTE *)(v12 + 8) & 4) )
        v12 = v9[3];
      sub_4E79C0(v12, 0);
    }
  }
  return v9;
}

//----- (0050F0F0) --------------------------------------------------------
int __cdecl sub_50F0F0(int a1, int a2)
{
  int v2; // ebx
  int v3; // ebp
  wchar_t *v4; // eax
  char v6[86]; // [esp+10h] [ebp-58h]

  *(_WORD *)v6 = 3529;
  v2 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(v2 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a2 + 8);
    v2 = *(_DWORD *)(a2 + 12);
  }
  else
  {
    v3 = *(_DWORD *)(a2 + 12);
  }
  v4 = sub_4E39F0((const char **)v2);
  nox_wcsncpy((wchar_t *)&v6[4], v4, 0x18u);
  *(_WORD *)&v6[52] = 0;
  strcpy(&v6[54], (const char *)(*(_DWORD *)(v2 + 692) + 1684));
  *(_WORD *)&v6[2] = *(_WORD *)(v2 + 4);
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(v3 + 748) + 276) + 2064), (int)v6, 86, 0, 1);
}

//----- (0050F1A0) --------------------------------------------------------
int __cdecl sub_50F1A0(int a1, int a2)
{
  int v2; // eax
  int v3; // esi
  int v4; // edx
  wchar_t *v6; // [esp-8h] [ebp-40h]
  wchar_t *v7; // [esp-8h] [ebp-40h]
  char v8[52]; // [esp+4h] [ebp-34h]

  *(_WORD *)v8 = 3273;
  v2 = *(_DWORD *)(a2 + 8);
  v3 = *(_DWORD *)(a1 + 748);
  if ( a1 != v2 )
  {
    if ( *(_BYTE *)(v2 + 8) & 4 )
    {
      nox_wcscpy((wchar_t *)&v8[2], (const wchar_t *)(*(_DWORD *)(*(_DWORD *)(v2 + 748) + 276) + 4704));
      return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)v8, 52, 0, 1);
    }
    v7 = sub_4E39F0(*(const char ***)(a2 + 12));
    nox_wcsncpy((wchar_t *)&v8[2], v7, 0x18u);
LABEL_8:
    *(_WORD *)&v8[50] = 0;
    return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)v8, 52, 0, 1);
  }
  v4 = *(_DWORD *)(a2 + 12);
  if ( !(*(_BYTE *)(v4 + 8) & 4) )
  {
    v6 = sub_4E39F0((const char **)v4);
    nox_wcsncpy((wchar_t *)&v8[2], v6, 0x18u);
    goto LABEL_8;
  }
  nox_wcscpy((wchar_t *)&v8[2], (const wchar_t *)(*(_DWORD *)(*(_DWORD *)(v4 + 748) + 276) + 4704));
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)v8, 52, 0, 1);
}

//----- (0050F280) --------------------------------------------------------
int __cdecl sub_50F280(int a1, int a2)
{
  int result; // eax
  _DWORD *i; // esi

  result = a2;
  for ( i = *(_DWORD **)(a2 + 20); i; i = (_DWORD *)i[2] )
    result = sub_50F2B0(a1, i);
  return result;
}

//----- (0050F2B0) --------------------------------------------------------
int __cdecl sub_50F2B0(int a1, _DWORD *a2)
{
  int v2; // eax
  int v3; // ecx
  int v4; // esi
  int v5; // edx
  unsigned __int16 *v6; // ecx
  int i; // eax
  char v9[18]; // [esp+8h] [ebp-14h]

  v2 = *a2;
  v3 = a2[1];
  v4 = *(_DWORD *)(a1 + 748);
  v5 = *(_DWORD *)(*a2 + 692);
  v9[0] = -55;
  v9[1] = 8;
  *(_WORD *)&v9[4] = *(_WORD *)(v2 + 36);
  *(_WORD *)&v9[2] = *(_WORD *)(v2 + 4);
  *(_DWORD *)&v9[6] = v3;
  v6 = *(unsigned __int16 **)(v2 + 556);
  if ( v6 )
    *(_DWORD *)&v9[10] = *v6;
  else
    *(_DWORD *)&v9[10] = 0;
  if ( *(_DWORD *)(v2 + 8) & 0x13001000 )
  {
    for ( i = 0; i < 4; ++i )
    {
      if ( *(_DWORD *)v5 )
        v9[i + 14] = *(_BYTE *)(*(_DWORD *)v5 + 4);
      else
        v9[i + 14] = -1;
      v5 += 4;
    }
  }
  else
  {
    *(_DWORD *)&v9[14] = -1;
  }
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), (int)v9, 18, 0, 1);
}

//----- (0050F370) --------------------------------------------------------
_DWORD *__cdecl sub_50F370(_DWORD *a1, int a2)
{
  _DWORD *result; // eax

  result = a1;
  *a1 = 1;
  if ( *(_BYTE *)(a2 + 8) & 4 )
    *(_DWORD *)(*(_DWORD *)(a2 + 748) + 280) = a1;
  return result;
}

//----- (0050F3A0) --------------------------------------------------------
void __cdecl sub_50F3A0(_DWORD *a1)
{
  int *i; // edi
  int *j; // edi

  for ( i = (int *)a1[8]; i; i = (int *)i[2] )
    sub_4F3070(a1[2], *i, 1);
  sub_4FA590(a1[2], **(_DWORD **)(a1[12] + 692));
  sub_50F450(a1[2]);
  for ( j = (int *)a1[9]; j; j = (int *)j[2] )
    sub_4F3070(a1[3], *j, 1);
  sub_4FA590(a1[3], **(_DWORD **)(a1[13] + 692));
  sub_50F450(a1[3]);
  sub_50F490(a1, a1[2]);
  sub_50F490(a1, a1[3]);
  sub_510000((int)a1);
}

//----- (0050F450) --------------------------------------------------------
int __cdecl sub_50F450(int a1)
{
  int v2; // edx
  char v4[2]; // [esp+0h] [ebp-2h]

  v2 = *(_DWORD *)(a1 + 748);
  *(_WORD *)v4 = 457;
  return sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), v4, 2, 0, 1);
}

//----- (0050F490) --------------------------------------------------------
int __cdecl sub_50F490(_DWORD *a1, int a2)
{
  int result; // eax

  result = a2;
  *a1 = 0;
  if ( *(_BYTE *)(a2 + 8) & 4 )
  {
    result = *(_DWORD *)(a2 + 748);
    if ( *(_DWORD **)(result + 280) == a1 )
      *(_DWORD *)(result + 280) = 0;
  }
  return result;
}

//----- (0050F4C0) --------------------------------------------------------
void __cdecl sub_50F4C0(_DWORD *a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // edi

  sub_50F490(a1, a1[2]);
  sub_50F490(a1, a1[3]);
  v1 = a1[2];
  if ( *(_BYTE *)(v1 + 8) & 4 )
    sub_4E7A60(v1, 0);
  else
    sub_4E7A60(a1[3], 0);
  v2 = a1[2];
  if ( *(_BYTE *)(v2 + 8) & 4 )
  {
    sub_50F560(v2);
    v3 = a1[2];
  }
  else
  {
    sub_50F560(a1[3]);
    v3 = a1[3];
  }
  if ( sub_40A5C0(4096) )
    *(_DWORD *)&byte_5D4594[4 * *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(v3 + 748) + 276) + 2064) + 2386364] = a1;
  else
    sub_510000((int)a1);
}

//----- (0050F560) --------------------------------------------------------
int __cdecl sub_50F560(int a1)
{
  int v2; // edx
  __int16 v4; // [esp+0h] [ebp-2h]

  v2 = *(_DWORD *)(a1 + 748);
  v4 = 713;
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), (int)&v4, 2, 0, 1);
}

//----- (0050F5A0) --------------------------------------------------------
void __cdecl sub_50F5A0(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  int v7; // [esp-34h] [ebp-3Ch]

  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 == a2 )
  {
    *(_DWORD *)(a1 + 24) = 1;
  }
  else if ( *(_DWORD *)(a1 + 12) == a2 )
  {
    *(_DWORD *)(a1 + 28) = 1;
  }
  if ( *(_BYTE *)(v2 + 8) & 4 )
    sub_50F720(v2, (_DWORD *)a1);
  v3 = *(_DWORD *)(a1 + 12);
  if ( *(_BYTE *)(v3 + 8) & 4 )
    sub_50F720(v3, (_DWORD *)a1);
  if ( *(_DWORD *)(a1 + 24) == 1 && *(_DWORD *)(a1 + 28) == 1 )
  {
    sub_50F790(a1, *(_DWORD *)(a1 + 12), *(int **)(a1 + 32));
    sub_50F790(a1, *(_DWORD *)(a1 + 8), *(int **)(a1 + 36));
    sub_50F7F0(*(_DWORD *)(a1 + 12), *(_DWORD *)(a1 + 48));
    sub_50F7F0(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 52));
    sub_50F6B0(*(_DWORD *)(a1 + 32));
    v7 = *(_DWORD *)(a1 + 36);
    *(_DWORD *)(a1 + 32) = 0;
    sub_50F6B0(v7);
    v4 = *(_DWORD *)(a1 + 48);
    *(_DWORD *)(a1 + 36) = 0;
    **(_DWORD **)(v4 + 692) = 0;
    **(_DWORD **)(*(_DWORD *)(a1 + 52) + 692) = 0;
    v5 = *(_DWORD *)(a1 + 16);
    *(_DWORD *)(a1 + 40) = 0;
    *(_DWORD *)(a1 + 44) = 0;
    if ( v5 == 1 )
    {
      v6 = *(_DWORD *)(a1 + 8);
      if ( *(_BYTE *)(v6 + 8) & 4 )
        sub_50F6E0(v6);
      else
        sub_50F6E0(*(_DWORD *)(a1 + 12));
    }
    else
    {
      sub_50F3A0((_DWORD *)a1);
    }
  }
}

//----- (0050F6B0) --------------------------------------------------------
int __cdecl sub_50F6B0(int a1)
{
  int result; // eax
  int v2; // esi

  result = a1;
  if ( a1 )
  {
    do
    {
      v2 = *(_DWORD *)(result + 8);
      sub_414330(*(unsigned int **)&byte_5D4594[2386496], (_QWORD *)result);
      result = v2;
    }
    while ( v2 );
  }
  return result;
}

//----- (0050F6E0) --------------------------------------------------------
int __cdecl sub_50F6E0(int a1)
{
  int v2; // edx
  __int16 v4; // [esp+0h] [ebp-2h]

  v2 = *(_DWORD *)(a1 + 748);
  v4 = 1993;
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), (int)&v4, 2, 0, 1);
}

//----- (0050F720) --------------------------------------------------------
int __cdecl sub_50F720(int a1, _DWORD *a2)
{
  int v2; // edx
  int v3; // edi
  int v4; // esi
  char v5; // al
  char v6; // al

  v2 = a1;
  v3 = a2[6];
  v4 = *(_DWORD *)(a1 + 748);
  v5 = 0;
  LOWORD(a1) = 969;
  BYTE2(a1) = 0;
  if ( v3 )
  {
    v5 = (a2[2] != v2) + 1;
    BYTE2(a1) = (a2[2] != v2) + 1;
  }
  if ( a2[7] )
  {
    if ( a2[3] == v2 )
      v6 = v5 | 1;
    else
      v6 = v5 | 2;
    BYTE2(a1) = v6;
  }
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), (int)&a1, 3, 0, 1);
}

//----- (0050F790) --------------------------------------------------------
void __cdecl sub_50F790(int a1, int a2, int *a3)
{
  int *i; // esi
  float *v4; // eax
  int v5; // ecx

  for ( i = a3; i; i = (int *)i[2] )
  {
    if ( *(_BYTE *)(a2 + 8) & 4 )
    {
      sub_4F3070(a2, *i, 1);
    }
    else
    {
      v4 = sub_50EE00(a1, *(float *)i);
      if ( v4 )
      {
        v5 = *(_DWORD *)(a1 + 8);
        if ( *(_BYTE *)(v5 + 8) & 4 )
          sub_50F2B0(v5, v4);
        else
          sub_50F2B0(*(_DWORD *)(a1 + 12), v4);
      }
    }
  }
}

//----- (0050F7F0) --------------------------------------------------------
_DWORD *__cdecl sub_50F7F0(int a1, int a2)
{
  _DWORD *result; // eax

  result = (_DWORD *)a1;
  if ( *(_BYTE *)(a1 + 8) & 4 )
    result = sub_4FA590(a1, **(_DWORD **)(a2 + 692));
  return result;
}

//----- (0050F820) --------------------------------------------------------
int __cdecl sub_50F820(int a1, int a2, float a3)
{
  float v3; // ebx
  int result; // eax
  int *v5; // eax
  int *v6; // edi
  wchar_t *v7; // eax
  wchar_t *v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax

  if ( !*(_DWORD *)&byte_5D4594[2386516] )
    *(_DWORD *)&byte_5D4594[2386516] = sub_4E3AA0((CHAR *)&byte_587000[236008]);
  if ( *(_DWORD *)(a1 + 8) == a2 )
  {
    v3 = a3;
    if ( !sub_50FD60(*(_DWORD **)(a1 + 32), SLODWORD(a3)) )
      return 0;
  }
  else
  {
    if ( *(_DWORD *)(a1 + 12) != a2 )
      return 0;
    v3 = a3;
    if ( !sub_50FD60(*(_DWORD **)(a1 + 36), SLODWORD(a3)) )
      return 0;
  }
  v5 = (int *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386496]);
  v6 = v5;
  if ( v5 )
  {
    *(float *)v5 = v3;
    v5[2] = 0;
    v5[3] = 0;
    v5[1] = sub_50E3D0(1, a1, v3);
    if ( *(_DWORD *)(a1 + 8) == a2 )
    {
      v6[2] = *(_DWORD *)(a1 + 32);
      v9 = *(_DWORD *)(a1 + 32);
      if ( v9 )
        *(_DWORD *)(v9 + 12) = v6;
      *(_DWORD *)(a1 + 32) = v6;
    }
    else
    {
      v6[2] = *(_DWORD *)(a1 + 36);
      v10 = *(_DWORD *)(a1 + 36);
      if ( v10 )
        *(_DWORD *)(v10 + 12) = v6;
      *(_DWORD *)(a1 + 36) = v6;
    }
    sub_50FB90((_DWORD *)a1);
    v11 = *(_DWORD *)(a1 + 8);
    *(_DWORD *)(a1 + 24) = 0;
    *(_DWORD *)(a1 + 28) = 0;
    if ( *(_BYTE *)(v11 + 8) & 4 )
    {
      if ( !(*(_BYTE *)(*(_DWORD *)(a1 + 12) + 8) & 4) && *(_DWORD *)(a1 + 44) <= *(int *)(a1 + 40) )
        *(_DWORD *)(a1 + 28) = 1;
    }
    else if ( *(_DWORD *)(a1 + 40) <= *(int *)(a1 + 44) )
    {
      *(_DWORD *)(a1 + 24) = 1;
    }
    if ( *(_BYTE *)(v11 + 8) & 4 )
    {
      sub_50FA00(v11, (_DWORD *)a1);
      sub_50FAE0(*(_DWORD *)(a1 + 8), a2, a1, *v6, v6[1]);
      sub_50F720(*(_DWORD *)(a1 + 8), (_DWORD *)a1);
    }
    v12 = *(_DWORD *)(a1 + 12);
    if ( *(_BYTE *)(v12 + 8) & 4 )
    {
      sub_50FA00(v12, (_DWORD *)a1);
      sub_50FAE0(*(_DWORD *)(a1 + 12), a2, a1, *v6, v6[1]);
      sub_50F720(*(_DWORD *)(a1 + 12), (_DWORD *)a1);
    }
    result = 1;
  }
  else
  {
    if ( *(_BYTE *)(*(_DWORD *)(a1 + 8) + 8) & 4 )
    {
      v7 = sub_40F1D0((char *)&byte_587000[236056], 0, (const char *)&byte_587000[236016], 2487);
      sub_4D9EB0(*(_DWORD *)(a1 + 8), v7);
    }
    if ( !(*(_BYTE *)(*(_DWORD *)(a1 + 12) + 8) & 4) )
      return 0;
    v8 = sub_40F1D0((char *)&byte_587000[236120], 0, (const char *)&byte_587000[236080], 2490);
    sub_4D9EB0(*(_DWORD *)(a1 + 12), v8);
    result = 0;
  }
  return result;
}

//----- (0050FA00) --------------------------------------------------------
int __cdecl sub_50FA00(int a1, _DWORD *a2)
{
  int v2; // edx
  int v3; // esi
  int v4; // edx
  int v5; // edx
  char v7[14]; // [esp+4h] [ebp-10h]

  v7[0] = -55;
  v2 = a2[2];
  v3 = *(_DWORD *)(a1 + 748);
  v7[1] = 6;
  if ( v2 == a1 )
  {
    v4 = a2[3];
    *(_DWORD *)&v7[2] = **(_DWORD **)(a2[12] + 692);
    if ( *(_BYTE *)(v4 + 8) & 4 )
    {
      v5 = a2[13];
      *(_DWORD *)&v7[6] = 0;
    }
    else
    {
      v5 = a2[13];
      *(_DWORD *)&v7[6] = a2[11] - a2[10];
    }
    *(_DWORD *)&v7[10] = **(_DWORD **)(v5 + 692);
  }
  else if ( a2[3] == a1 )
  {
    *(_DWORD *)&v7[2] = **(_DWORD **)(a2[13] + 692);
    if ( *(_BYTE *)(v2 + 8) & 4 )
      *(_DWORD *)&v7[6] = 0;
    else
      *(_DWORD *)&v7[6] = a2[10] - a2[11];
    *(_DWORD *)&v7[10] = **(_DWORD **)(a2[12] + 692);
  }
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)v7, 14, 0, 1);
}

//----- (0050FAE0) --------------------------------------------------------
int __cdecl sub_50FAE0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // esi
  __int16 v6; // dx
  int v7; // ecx
  int v8; // edx
  int i; // eax
  char v11[15]; // [esp+4h] [ebp-10h]

  v5 = *(_DWORD *)(a1 + 748);
  v11[0] = -55;
  v11[2] = a1 == a2;
  v11[1] = 4;
  v6 = *(_WORD *)(a4 + 36);
  *(_WORD *)&v11[3] = *(_WORD *)(a4 + 4);
  *(_DWORD *)&v11[7] = a5;
  v7 = *(_DWORD *)(a4 + 8);
  *(_WORD *)&v11[5] = v6;
  if ( v7 & 0x13001000 )
  {
    v8 = *(_DWORD *)(a4 + 692);
    for ( i = 0; i < 4; ++i )
    {
      if ( *(_DWORD *)v8 )
        v11[i + 11] = *(_BYTE *)(*(_DWORD *)v8 + 4);
      else
        v11[i + 11] = -1;
      v8 += 4;
    }
  }
  else
  {
    *(_DWORD *)&v11[11] = -1;
  }
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), (int)v11, 15, 0, 1);
}

//----- (0050FB90) --------------------------------------------------------
_DWORD *__cdecl sub_50FB90(_DWORD *a1)
{
  int v1; // ecx
  _DWORD *result; // eax
  int *v3; // edi
  int v4; // eax
  int *v5; // edi
  int v6; // eax
  int v7; // ecx
  unsigned int v8; // ecx
  unsigned int v9; // edi
  unsigned int v10; // eax
  int v11; // eax
  unsigned int v12; // edi
  unsigned int v13; // eax
  int v14; // ecx

  v1 = a1[2];
  result = (_DWORD *)(*(_DWORD *)(v1 + 8) & 4);
  if ( result != (_DWORD *)4 || (*(_BYTE *)(a1[3] + 8) & 4) != 4 )
  {
    v3 = *(int **)(a1[12] + 692);
    if ( result )
      sub_4FA590(v1, *v3);
    *v3 = 0;
    v4 = a1[3];
    v5 = *(int **)(a1[13] + 692);
    if ( *(_BYTE *)(v4 + 8) & 4 )
      sub_4FA590(v4, *v5);
    *v5 = 0;
    v6 = sub_50FD20(a1, a1[2]);
    v7 = a1[3];
    a1[10] = v6;
    result = (_DWORD *)sub_50FD20(a1, v7);
    v8 = a1[10];
    a1[11] = result;
    if ( (unsigned int)result <= v8 )
    {
      if ( (unsigned int)result < v8 )
      {
        v12 = v8 - (_DWORD)result;
        if ( *(_BYTE *)(a1[3] + 8) & 4 )
        {
          v13 = sub_4FA6B0(a1[3]);
          if ( v13 < v12 )
          {
            a1[11] += v13;
            **(_DWORD **)(a1[13] + 692) += v13;
            result = sub_4FA5D0(a1[3], v13);
          }
          else
          {
            v14 = a1[13];
            a1[11] += v12;
            **(_DWORD **)(v14 + 692) += v12;
            result = sub_4FA5D0(a1[3], v12);
          }
        }
        else
        {
          a1[11] = v8;
          result = *(_DWORD **)(a1[13] + 692);
          *result += v12;
        }
      }
    }
    else
    {
      v9 = (unsigned int)result - v8;
      if ( *(_BYTE *)(a1[2] + 8) & 4 )
      {
        v10 = sub_4FA6B0(a1[2]);
        if ( v10 < v9 )
        {
          a1[10] += v10;
          **(_DWORD **)(a1[12] + 692) += v10;
          result = sub_4FA5D0(a1[2], v10);
        }
        else
        {
          a1[10] += v9;
          **(_DWORD **)(a1[12] + 692) += v9;
          result = sub_4FA5D0(a1[2], v9);
        }
      }
      else
      {
        v11 = a1[12];
        a1[10] = v9 + v8;
        result = *(_DWORD **)(v11 + 692);
        *result += v9;
      }
    }
  }
  return result;
}

//----- (0050FD20) --------------------------------------------------------
int __cdecl sub_50FD20(_DWORD *a1, int a2)
{
  int v2; // edx
  int v3; // ecx
  int result; // eax
  int v5; // edx

  if ( a1[2] == a2 )
  {
    v2 = a1[12];
    v3 = a1[8];
  }
  else
  {
    v2 = a1[13];
    v3 = a1[9];
  }
  for ( result = **(_DWORD **)(v2 + 692); v3; result += v5 )
  {
    v5 = *(_DWORD *)(v3 + 4);
    v3 = *(_DWORD *)(v3 + 8);
  }
  return result;
}

//----- (0050FD60) --------------------------------------------------------
BOOL __cdecl sub_50FD60(_DWORD *a1, int a2)
{
  _DWORD *v2; // esi
  unsigned int v3; // edi
  unsigned int v4; // ecx
  int v5; // eax
  int *v6; // edx
  int v7; // ecx
  int v8; // eax
  int v9; // edx
  int *i; // ecx
  int v12[4]; // [esp+8h] [ebp-20h]
  int v13[4]; // [esp+18h] [ebp-10h]

  v13[0] = 0;
  v12[0] = 0;
  v2 = a1;
  v13[1] = 0;
  v12[1] = 0;
  v3 = 0;
  v13[2] = 0;
  v12[2] = 0;
  v13[3] = 0;
  for ( v12[3] = 0; v2; v2 = (_DWORD *)v2[2] )
  {
    v4 = 0;
    v5 = *(unsigned __int16 *)(*v2 + 4);
    v6 = v13;
    while ( *v6 != v5 )
    {
      ++v4;
      ++v6;
      if ( v4 >= 4 )
      {
        v7 = v12[v3];
        v13[v3] = v5;
        v12[v3++] = v7 + 1;
        goto LABEL_6;
      }
    }
    ++v12[v4];
LABEL_6:
    ;
  }
  v8 = 0;
  if ( !v3 )
    return 1;
  HIWORD(v9) = 0;
  for ( i = v13; ; ++i )
  {
    LOWORD(v9) = *(_WORD *)(a2 + 4);
    if ( *i == v9 && !(*(_DWORD *)(a2 + 8) & 0x13001000) )
      break;
    if ( ++v8 >= v3 )
      return v3 < 4;
  }
  return 1;
}

//----- (0050FE20) --------------------------------------------------------
int __cdecl sub_50FE20(int a1, int a2)
{
  int *v2; // edi
  int v3; // ebp
  int result; // eax
  float *v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax

  v2 = sub_50FFE0(*(_DWORD **)(a1 + 32), a2);
  if ( v2 )
  {
    v3 = *(_DWORD *)(a1 + 8);
  }
  else
  {
    result = sub_50FFE0(*(_DWORD **)(a1 + 36), a2);
    v2 = (int *)result;
    if ( !result )
      return result;
    v3 = *(_DWORD *)(a1 + 12);
  }
  if ( *(_BYTE *)(v3 + 8) & 4 )
  {
    sub_4F3070(v3, *v2, 1);
  }
  else
  {
    v5 = sub_50EE00(a1, *(float *)v2);
    if ( v5 )
    {
      v6 = *(_DWORD *)(a1 + 8);
      if ( !(*(_BYTE *)(v6 + 8) & 4) )
        v6 = *(_DWORD *)(a1 + 12);
      sub_50F2B0(v6, v5);
    }
  }
  v7 = v2[2];
  if ( v7 )
    *(_DWORD *)(v7 + 12) = v2[3];
  v8 = v2[3];
  if ( v8 )
    *(_DWORD *)(v8 + 8) = v2[2];
  if ( *(_DWORD *)(a1 + 8) == v3 )
  {
    if ( *(int **)(a1 + 32) == v2 )
      *(_DWORD *)(a1 + 32) = v2[2];
  }
  else if ( *(int **)(a1 + 36) == v2 )
  {
    *(_DWORD *)(a1 + 36) = v2[2];
  }
  sub_50FB90((_DWORD *)a1);
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  v9 = *(_DWORD *)(a1 + 8);
  if ( *(_BYTE *)(v9 + 8) & 4 )
  {
    if ( !(*(_BYTE *)(*(_DWORD *)(a1 + 12) + 8) & 4) && *(_DWORD *)(a1 + 44) <= *(int *)(a1 + 40) )
      *(_DWORD *)(a1 + 28) = 1;
  }
  else if ( *(_DWORD *)(a1 + 40) <= *(int *)(a1 + 44) )
  {
    *(_DWORD *)(a1 + 24) = 1;
  }
  if ( *(_BYTE *)(v9 + 8) & 4 )
  {
    sub_50FA00(v9, (_DWORD *)a1);
    sub_50FF90(*(_DWORD *)(a1 + 8), a1, *v2);
    sub_50F720(*(_DWORD *)(a1 + 8), (_DWORD *)a1);
  }
  v10 = *(_DWORD *)(a1 + 12);
  if ( *(_BYTE *)(v10 + 8) & 4 )
  {
    sub_50FA00(v10, (_DWORD *)a1);
    sub_50FF90(*(_DWORD *)(a1 + 12), a1, *v2);
    sub_50F720(*(_DWORD *)(a1 + 12), (_DWORD *)a1);
  }
  sub_414330(*(unsigned int **)&byte_5D4594[2386496], v2);
  return 1;
}

//----- (0050FF90) --------------------------------------------------------
int __cdecl sub_50FF90(int a1, int a2, int a3)
{
  int v4; // ecx
  int v6; // [esp+0h] [ebp-4h]

  HIWORD(v6) = *(_WORD *)(a3 + 36);
  v4 = *(_DWORD *)(a1 + 748);
  LOWORD(v6) = 1481;
  return sub_4E5390(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), (int)&v6, 4, 0, 1);
}

//----- (0050FFE0) --------------------------------------------------------
_DWORD *__cdecl sub_50FFE0(_DWORD *a1, int a2)
{
  _DWORD *result; // eax

  result = a1;
  if ( !a1 )
    return 0;
  while ( *(_DWORD *)(*result + 36) != a2 )
  {
    result = (_DWORD *)result[2];
    if ( !result )
      return 0;
  }
  return result;
}

//----- (00510000) --------------------------------------------------------
void __cdecl sub_510000(int a1)
{
  int *v1; // esi
  int *v2; // ebx
  int v3; // eax
  int v4; // eax

  v1 = *(int **)(a1 + 20);
  if ( v1 )
  {
    do
    {
      v2 = (int *)v1[2];
      sub_4E38A0(*v1);
      sub_414330(*(unsigned int **)&byte_5D4594[2386496], v1);
      v1 = v2;
    }
    while ( v2 );
  }
  sub_4E38A0(*(_DWORD *)(a1 + 48));
  sub_4E38A0(*(_DWORD *)(a1 + 52));
  sub_50F6B0(*(_DWORD *)(a1 + 32));
  sub_50F6B0(*(_DWORD *)(a1 + 36));
  v3 = *(_DWORD *)(a1 + 56);
  if ( v3 )
    *(_DWORD *)(v3 + 60) = *(_DWORD *)(a1 + 60);
  v4 = *(_DWORD *)(a1 + 60);
  if ( v4 )
    *(_DWORD *)(v4 + 56) = *(_DWORD *)(a1 + 56);
  if ( a1 == *(_DWORD *)&byte_5D4594[2386500] )
    *(_DWORD *)&byte_5D4594[2386500] = *(_DWORD *)(a1 + 56);
  sub_414330(*(unsigned int **)&byte_5D4594[2386492], (_QWORD *)a1);
}

//----- (005100A0) --------------------------------------------------------
int __cdecl sub_5100A0(int a1, int a2)
{
  int *v2; // eax
  int result; // eax

  v2 = sub_50FFE0(*(_DWORD **)(a1 + 20), a2);
  if ( v2 )
    result = *v2;
  else
    result = 0;
  return result;
}

//----- (005100C0) --------------------------------------------------------
float *__cdecl sub_5100C0(int a1, _DWORD *a2, int a3)
{
  int v3; // edi
  unsigned int v4; // ebx
  float *result; // eax
  int v6; // esi
  unsigned int v7; // eax
  unsigned int v8; // ebp
  int v9; // ebx
  wchar_t *v10; // eax
  int v11; // eax
  int v12; // ebx
  _DWORD *v13; // eax
  void (__cdecl *v14)(int, _DWORD *, int, int); // ecx
  int v15; // [esp+0h] [ebp-14h]
  float v16; // [esp+0h] [ebp-14h]
  float v17; // [esp+0h] [ebp-14h]
  int v18; // [esp+18h] [ebp+4h]

  v3 = a1;
  v15 = a1;
  v18 = *(_DWORD *)(a1 + 748);
  v4 = sub_4FA6B0(v15);
  if ( !*(_DWORD *)&byte_5D4594[2386548] )
    *(_DWORD *)&byte_5D4594[2386548] = sub_4E3AA0((CHAR *)&byte_587000[236144]);
  result = (float *)a2[5];
  if ( result )
  {
    while ( !*(_DWORD *)result || *(_DWORD *)(*(_DWORD *)result + 36) != a3 )
    {
      result = (float *)*((_DWORD *)result + 2);
      if ( !result )
        return result;
    }
    v6 = *(_DWORD *)result;
    if ( *(_DWORD *)result )
    {
      v7 = sub_50E3D0(1, (int)a2, *result);
      v8 = v7;
      if ( v7 > v4 )
        return (float *)sub_5104F0(v3, v7 - v4);
      if ( *(_BYTE *)(v6 + 8) & 0x10 )
      {
        v9 = sub_4E7D30(v3, *(unsigned __int16 *)(v6 + 4));
        if ( v9 >= (sub_40A5C0(6144) ? 9 : 3) )
        {
          v10 = sub_40F1D0((char *)&byte_587000[236200], 0, (const char *)&byte_587000[236160], 2943);
          return (float *)sub_4D9EB0(v3, v10);
        }
      }
      if ( *(unsigned __int16 *)(v6 + 4) == *(_DWORD *)&byte_5D4594[2386548] )
      {
        v16 = sub_419D40(&byte_587000[236224]);
        if ( *(_DWORD *)(v18 + 320) >= sub_419A70(v16) )
        {
          sub_4DA2C0(v3, (const char *)&byte_587000[236240], 0);
          return (float *)sub_501960(925, v3, 0, 0);
        }
      }
      if ( sub_40A5C0(4096) )
      {
        v11 = *(_DWORD *)(v6 + 8);
        if ( v11 & 0x1000 )
        {
          if ( *(_DWORD *)(v6 + 12) & 0x200000 )
          {
            v17 = sub_419D40(&byte_587000[236276]);
            v12 = sub_419A70(v17);
            if ( sub_4E7D30(v3, *(unsigned __int16 *)(v6 + 4)) >= v12 )
            {
              sub_4DA2C0(v3, (const char *)&byte_587000[236300], 0);
              return (float *)sub_501960(925, v3, 0, 0);
            }
          }
        }
      }
      if ( sub_40A5C0(4096) && (sub_5105D0(v6) || *(unsigned __int16 *)(v6 + 4) == *(_DWORD *)&byte_5D4594[2386548]) )
        v13 = sub_4E3450(*(unsigned __int16 *)(v6 + 4));
      else
        v13 = (_DWORD *)v6;
      if ( v13[2] & 0x110 || (v14 = (void (__cdecl *)(int, _DWORD *, int, int))v13[177]) == 0 )
      {
        sub_4F3070(v3, (int)v13, 1);
        sub_501960(307, v3, 2, *(_DWORD *)(v3 + 36));
      }
      else
      {
        v14(v3, v13, 1, 1);
      }
      sub_510320(v6, (int)a2);
      if ( sub_510540(v6) )
        sub_50E7A0(a2, v6);
      sub_4FA5D0(v3, v8);
      result = (float *)sub_4D8870(*(unsigned __int8 *)(*(_DWORD *)(v18 + 276) + 2064), v3);
    }
  }
  return result;
}

//----- (00510320) --------------------------------------------------------
void __cdecl sub_510320(int a1, int a2)
{
  int v2; // ecx
  _BYTE *v3; // ebp
  int v4; // eax
  int v5; // esi
  char v6; // cl
  int v7; // edx
  int v8; // eax

  if ( a1 && a2 )
  {
    v2 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(v2 + 8) & 4 )
      v2 = *(_DWORD *)(a2 + 12);
    v3 = *(_BYTE **)(v2 + 692);
    v4 = sub_5103A0(a2, a1);
    if ( v4 != -1 )
    {
      v5 = (int)&v3[28 * v4];
      v6 = v3[28 * v4 + 8] - 1;
      *(_BYTE *)(v5 + 8) = v6;
      if ( !v6 )
      {
        v7 = v4;
        if ( v4 < (unsigned __int8)*v3 - 1 )
        {
          v8 = v5 + 4;
          do
          {
            ++v7;
            qmemcpy((void *)v8, (const void *)(v8 + 28), 0x1Cu);
            v8 += 28;
          }
          while ( v7 < (unsigned __int8)*v3 - 1 );
        }
        --*v3;
      }
    }
  }
}

//----- (005103A0) --------------------------------------------------------
int __cdecl sub_5103A0(int a1, int a2)
{
  int v2; // eax
  _BYTE *v3; // edi
  int v4; // esi
  int i; // ebx

  v2 = *(_DWORD *)(a1 + 8);
  if ( *(_BYTE *)(v2 + 8) & 4 )
    v2 = *(_DWORD *)(a1 + 12);
  v3 = *(_BYTE **)(v2 + 692);
  v4 = 0;
  if ( !*v3 )
    return -1;
  for ( i = (int)(v3 + 4); !sub_5103F0(a2, i); i += 28 )
  {
    if ( ++v4 >= (unsigned __int8)*v3 )
      return -1;
  }
  return v4;
}

//----- (005103F0) --------------------------------------------------------
int __cdecl sub_5103F0(int a1, int a2)
{
  int v2; // ebp
  int v3; // esi
  _DWORD *v4; // edx
  int v5; // edx

  v2 = 0;
  if ( !a1 || !a2 )
    return 0;
  if ( *(_WORD *)(a1 + 4) == **(_WORD **)a2 )
  {
    v3 = *(_DWORD *)(a1 + 8);
    v2 = 1;
    if ( v3 & 0x13001000 )
    {
      v4 = *(_DWORD **)(a1 + 692);
      if ( *(_DWORD *)(a2 + 12) != *v4 )
        v2 = 0;
      if ( *(_DWORD *)(a2 + 16) != v4[1] )
        v2 = 0;
      if ( *(_DWORD *)(a2 + 20) != v4[2] )
        v2 = 0;
      if ( *(_DWORD *)(a2 + 24) != v4[3] )
        v2 = 0;
    }
    if ( v3 & 0x100 )
    {
      v5 = *(_DWORD *)(a1 + 12);
      if ( v5 & 1 || v5 & 4 )
      {
        if ( **(unsigned __int8 **)(a1 + 736) != *(_DWORD *)(a2 + 8) )
          return 0;
      }
      else if ( strcmp(*(const char **)(a1 + 736), (const char *)sub_4E3A80(*(_DWORD *)(a2 + 8))) )
      {
        v2 = 0;
      }
    }
  }
  return v2;
}

//----- (005104F0) --------------------------------------------------------
int __cdecl sub_5104F0(int a1, __int16 a2)
{
  int v2; // eax
  char v4[4]; // [esp+0h] [ebp-4h]

  *(_WORD *)&v4[2] = a2;
  v2 = *(_DWORD *)(a1 + 748);
  v4[0] = -55;
  v4[1] = 27;
  return sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), v4, 4, 0, 1);
}

//----- (00510540) --------------------------------------------------------
int __cdecl sub_510540(int a1)
{
  int v1; // eax
  int result; // eax

  if ( !sub_40A5C0(4096) )
    goto LABEL_12;
  if ( !*(_DWORD *)&byte_5D4594[2386520] )
  {
    *(_DWORD *)&byte_5D4594[2386520] = sub_4E3AA0((CHAR *)&byte_587000[236324]);
    *(_DWORD *)&byte_5D4594[2386528] = sub_4E3AA0((CHAR *)&byte_587000[236332]);
    *(_DWORD *)&byte_5D4594[2386524] = sub_4E3AA0((CHAR *)&byte_587000[236340]);
    *(_DWORD *)&byte_5D4594[2386532] = sub_4E3AA0((CHAR *)&byte_587000[236348]);
  }
  v1 = *(unsigned __int16 *)(a1 + 4);
  if ( (unsigned __int16)v1 == *(_DWORD *)&byte_5D4594[2386520]
    || v1 == *(_DWORD *)&byte_5D4594[2386524]
    || v1 == *(_DWORD *)&byte_5D4594[2386528]
    || v1 == *(_DWORD *)&byte_5D4594[2386532] )
  {
    result = 0;
  }
  else
  {
LABEL_12:
    result = 1;
  }
  return result;
}

//----- (005105D0) --------------------------------------------------------
BOOL __cdecl sub_5105D0(int a1)
{
  int v1; // eax

  if ( !*(_DWORD *)&byte_5D4594[2386536] )
  {
    *(_DWORD *)&byte_5D4594[2386536] = sub_4E3AA0((CHAR *)&byte_587000[236364]);
    *(_DWORD *)&byte_5D4594[2386544] = sub_4E3AA0((CHAR *)&byte_587000[236372]);
    *(_DWORD *)&byte_5D4594[2386540] = sub_4E3AA0((CHAR *)&byte_587000[236380]);
  }
  v1 = *(unsigned __int16 *)(a1 + 4);
  return (unsigned __int16)v1 == *(_DWORD *)&byte_5D4594[2386536]
      || v1 == *(_DWORD *)&byte_5D4594[2386540]
      || v1 == *(_DWORD *)&byte_5D4594[2386544];
}

//----- (00510640) --------------------------------------------------------
float *__cdecl sub_510640(int a1, int a2, int a3, float *a4)
{
  int v4; // ebp
  float *result; // eax
  _DWORD *v6; // edi
  int v7; // esi
  unsigned int v8; // ebx
  int v9; // edi
  int v10; // eax
  int v11; // edi
  _DWORD *v12; // eax
  void (__cdecl *v13)(int, _DWORD *, int, int); // ecx
  wchar_t *v14; // eax
  int v15; // [esp+0h] [ebp-1Ch]
  float v16; // [esp+0h] [ebp-1Ch]
  float v17; // [esp+0h] [ebp-1Ch]
  unsigned int v18; // [esp+14h] [ebp-8h]
  unsigned int v19; // [esp+18h] [ebp-4h]
  int v20; // [esp+20h] [ebp+4h]

  v4 = a1;
  v15 = a1;
  v20 = *(_DWORD *)(a1 + 748);
  v19 = sub_4FA6B0(v15);
  if ( !*(_DWORD *)&byte_5D4594[2386552] )
    *(_DWORD *)&byte_5D4594[2386552] = sub_4E3AA0((CHAR *)&byte_587000[236388]);
  result = a4;
  v18 = 0;
  if ( a4 )
  {
    while ( 1 )
    {
      v6 = (_DWORD *)a2;
      result = *(float **)(a2 + 20);
      if ( !result )
        return result;
      while ( *(unsigned __int16 *)(*(_DWORD *)result + 4) != a3 )
      {
        result = (float *)*((_DWORD *)result + 2);
        if ( !result )
          return result;
      }
      v7 = *(_DWORD *)result;
      if ( !*(_DWORD *)result )
        return result;
      v8 = sub_50E3D0(1, a2, *result);
      if ( v8 > v19 )
        return (float *)sub_5104F0(v4, v8 - v19);
      if ( *(_BYTE *)(v7 + 8) & 0x10 )
      {
        v9 = sub_4E7D30(v4, *(unsigned __int16 *)(v7 + 4));
        if ( v9 >= (sub_40A5C0(6144) ? 9 : 3) )
        {
          v14 = sub_40F1D0((char *)&byte_587000[236444], 0, (const char *)&byte_587000[236404], 3108);
          return (float *)sub_4D9EB0(v4, v14);
        }
        v6 = (_DWORD *)a2;
      }
      if ( *(unsigned __int16 *)(v7 + 4) == *(_DWORD *)&byte_5D4594[2386552] )
      {
        v16 = sub_419D40(&byte_587000[236468]);
        if ( *(_DWORD *)(v20 + 320) >= sub_419A70(v16) )
          break;
      }
      if ( sub_40A5C0(4096) )
      {
        v10 = *(_DWORD *)(v7 + 8);
        if ( v10 & 0x1000 )
        {
          if ( *(_DWORD *)(v7 + 12) & 0x200000 )
          {
            v17 = sub_419D40(&byte_587000[236520]);
            v11 = sub_419A70(v17);
            if ( sub_4E7D30(v4, *(unsigned __int16 *)(v7 + 4)) >= v11 )
            {
              sub_4DA2C0(v4, (const char *)&byte_587000[236544], 0);
              goto LABEL_36;
            }
            v6 = (_DWORD *)a2;
          }
        }
      }
      if ( sub_40A5C0(4096) && (sub_5105D0(v7) || *(unsigned __int16 *)(v7 + 4) == *(_DWORD *)&byte_5D4594[2386552]) )
        v12 = sub_4E3450(*(unsigned __int16 *)(v7 + 4));
      else
        v12 = (_DWORD *)v7;
      v13 = (void (__cdecl *)(int, _DWORD *, int, int))v12[177];
      if ( v13 )
        v13(v4, v12, 1, 1);
      else
        sub_4F3070(v4, (int)v12, 1);
      sub_510320(v7, (int)v6);
      if ( sub_510540(v7) )
        sub_50E7A0(v6, v7);
      sub_4FA5D0(v4, v8);
      sub_4D8870(*(unsigned __int8 *)(*(_DWORD *)(v20 + 276) + 2064), v4);
      result = (float *)++v18;
      if ( v18 >= (unsigned int)a4 )
        return result;
    }
    sub_4DA2C0(v4, (const char *)&byte_587000[236484], 0);
LABEL_36:
    result = (float *)sub_501960(925, v4, 0, 0);
  }
  return result;
}

//----- (005108D0) --------------------------------------------------------
_DWORD *__cdecl sub_5108D0(int a1, int a2, int a3)
{
  int v3; // edi
  _DWORD *result; // eax
  int v5; // ebx
  int v6; // ecx
  int v7; // ecx
  unsigned __int8 v8; // dl
  _WORD *v9; // ecx
  __int16 v10; // dx
  char v11[8]; // [esp+Ch] [ebp-8h]

  v3 = 0;
  result = *(_DWORD **)(a1 + 504);
  v5 = *(_DWORD *)(a1 + 748);
  v11[0] = -55;
  v11[1] = 31;
  *(_WORD *)&v11[2] = a3;
  if ( result )
  {
    while ( result[9] != a3 )
    {
      result = (_DWORD *)result[124];
      if ( !result )
        return result;
    }
    v6 = result[2];
    if ( v6 & 0x1000 )
    {
      if ( result[3] & 0x47F0000 )
      {
        v7 = result[184];
        v8 = *(_BYTE *)(v7 + 109);
        if ( *(_BYTE *)(v7 + 108) < v8 )
        {
          if ( v8 )
            v3 = 1;
        }
      }
    }
    v9 = (_WORD *)result[139];
    if ( v9 && (v10 = v9[2], *v9 != v10) && v10 || v3 )
    {
      *(_DWORD *)&v11[4] = sub_50E3D0(2, a2, *(float *)&result);
      result = (_DWORD *)sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), v11, 8, 0, 1);
    }
    else
    {
      result = sub_501960(925, a1, 0, 0);
    }
  }
  return result;
}

//----- (005109C0) --------------------------------------------------------
_DWORD *__cdecl sub_5109C0(int *a1, int a2, _DWORD *a3)
{
  int v3; // ebx
  int v4; // esi
  _DWORD *result; // eax
  wchar_t *v6; // eax
  wchar_t *v7; // eax
  char v8[8]; // [esp+Ch] [ebp-8h]

  v3 = a1[187];
  if ( !*(_DWORD *)&byte_5D4594[2386556] )
    *(_DWORD *)&byte_5D4594[2386556] = sub_4E3AA0((CHAR *)&byte_587000[236568]);
  v4 = a1[126];
  result = a3;
  v8[0] = -55;
  v8[1] = 29;
  *(_WORD *)&v8[2] = (_WORD)a3;
  if ( v4 )
  {
    while ( *(_DWORD **)(v4 + 36) != a3 )
    {
      v4 = *(_DWORD *)(v4 + 496);
      if ( !v4 )
        return result;
    }
    if ( sub_53EBF0(v4) == 1 )
    {
      v6 = sub_40F1D0((char *)&byte_587000[236616], 0, (const char *)&byte_587000[236576], 3298);
      sub_4D9EB0((int)a1, v6);
      result = sub_501960(925, (int)a1, 2, a1[9]);
    }
    else if ( *(unsigned __int16 *)(v4 + 4) == *(_DWORD *)&byte_5D4594[2386556] )
    {
      v7 = sub_40F1D0((char *)&byte_587000[236676], 0, (const char *)&byte_587000[236636], 3308);
      sub_4D9EB0((int)a1, v7);
      result = sub_501960(925, (int)a1, 2, a1[9]);
    }
    else
    {
      *(_DWORD *)&v8[4] = sub_50E3D0(0, a2, *(float *)&v4);
      result = (_DWORD *)sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), v8, 8, 0, 1);
    }
  }
  return result;
}

//----- (00510AE0) --------------------------------------------------------
_DWORD *__cdecl sub_510AE0(int *a1, int a2, _DWORD *a3)
{
  _DWORD *result; // eax
  int v4; // esi
  int v5; // ebp
  unsigned int v6; // eax
  int v7; // eax
  int v8; // ebx

  result = (_DWORD *)sub_4FA6B0((int)a1);
  v4 = a1[126];
  v5 = a1[187];
  if ( v4 )
  {
    result = a3;
    while ( *(_DWORD **)(v4 + 36) != a3 )
    {
      v4 = *(_DWORD *)(v4 + 496);
      if ( !v4 )
        return result;
    }
    v6 = sub_50E3D0(2, a2, *(float *)&v4);
    sub_4FA5D0((int)a1, v6);
    sub_4E4560(v4, *(_WORD *)(*(_DWORD *)(v4 + 556) + 4));
    sub_4D87A0(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), (_DWORD *)v4);
    v7 = *(_DWORD *)(v4 + 8);
    if ( v7 & 0x1000 && *(_DWORD *)(v4 + 12) & 0x47F0000 )
    {
      v8 = *(_DWORD *)(v4 + 736);
      if ( sub_53C520(v4, 100) )
        sub_4D82B0(
          *(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064),
          (_DWORD *)v4,
          *(_BYTE *)(v8 + 108),
          *(_BYTE *)(v8 + 109));
    }
    sub_4D8870(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), (int)a1);
    result = sub_501960(803, (int)a1, 2, a1[9]);
  }
  return result;
}

//----- (00510BE0) --------------------------------------------------------
_DWORD *__cdecl sub_510BE0(int *a1, int a2, _DWORD *a3)
{
  _DWORD *result; // eax
  int v4; // ebx
  int v5; // esi
  wchar_t *v6; // eax
  wchar_t *v7; // eax
  int v8; // eax

  sub_4FA6B0((int)a1);
  result = *(_DWORD **)&byte_5D4594[2386560];
  v4 = a1[187];
  if ( !*(_DWORD *)&byte_5D4594[2386560] )
  {
    result = (_DWORD *)sub_4E3AA0((CHAR *)&byte_587000[236692]);
    *(_DWORD *)&byte_5D4594[2386560] = result;
  }
  v5 = a1[126];
  if ( v5 )
  {
    result = a3;
    while ( *(_DWORD **)(v5 + 36) != a3 )
    {
      v5 = *(_DWORD *)(v5 + 496);
      if ( !v5 )
        return result;
    }
    if ( sub_53EBF0(v5) == 1 )
    {
      v6 = sub_40F1D0((char *)&byte_587000[236740], 0, (const char *)&byte_587000[236700], 3413);
      sub_4D9EB0((int)a1, v6);
      result = sub_501960(925, (int)a1, 2, a1[9]);
    }
    else if ( *(unsigned __int16 *)(v5 + 4) == *(_DWORD *)&byte_5D4594[2386560] )
    {
      v7 = sub_40F1D0((char *)&byte_587000[236800], 0, (const char *)&byte_587000[236760], 3423);
      sub_4D9EB0((int)a1, v7);
      result = sub_501960(925, (int)a1, 2, a1[9]);
    }
    else
    {
      sub_4ED0C0((int)a1, (int *)v5);
      sub_4E5CC0(v5);
      v8 = sub_50E3D0(0, a2, *(float *)&v5);
      sub_4FA590((int)a1, v8);
      sub_4D8870(*(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064), (int)a1);
      result = sub_501960(307, (int)a1, 2, a1[9]);
    }
  }
  return result;
}

//----- (00510D10) --------------------------------------------------------
unsigned __int16 __cdecl sub_510D10(int *a1, int a2, int a3, unsigned int a4)
{
  unsigned __int16 result; // ax
  int v5; // ebp
  int v6; // ebx
  int v7; // esi
  int v8; // eax

  sub_4FA6B0((int)a1);
  result = a4;
  v5 = a1[187];
  v6 = 0;
  if ( a4 )
  {
    while ( 1 )
    {
      v7 = a1[126];
      if ( !v7 )
        break;
      while ( 1 )
      {
        result = *(_WORD *)(v7 + 4);
        if ( result == a3 )
          break;
        v7 = *(_DWORD *)(v7 + 496);
        if ( !v7 )
          return result;
      }
      sub_4ED0C0((int)a1, (int *)v7);
      sub_4E5CC0(v7);
      v8 = sub_50E3D0(0, a2, *(float *)&v7);
      sub_4FA590((int)a1, v8);
      sub_4D8870(*(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064), (int)a1);
      result = a4;
      if ( ++v6 >= a4 )
        return (unsigned int)sub_501960(307, (int)a1, 2, a1[9]);
    }
  }
  return result;
}

//----- (00510DC0) --------------------------------------------------------
void __cdecl sub_510DC0(_DWORD *a1)
{
  if ( a1[4] )
    sub_50F4C0(a1);
  else
    sub_50F3A0(a1);
}

//----- (00510DE0) --------------------------------------------------------
int __cdecl sub_510DE0(int a1, int a2)
{
  int v2; // eax
  _DWORD *v3; // eax

  v2 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 280);
  if ( !v2 )
    return 0;
  v3 = *(_DWORD **)(v2 + 20);
  if ( !v3 )
    return 0;
  while ( *(_DWORD *)(*v3 + 36) != a2 )
  {
    v3 = (_DWORD *)v3[2];
    if ( !v3 )
      return 0;
  }
  return *v3;
}

//----- (00510E20) --------------------------------------------------------
void __cdecl sub_510E20(int a1)
{
  if ( *(_DWORD *)&byte_5D4594[4 * a1 + 2386364] )
    sub_510000(*(_DWORD *)&byte_5D4594[4 * a1 + 2386364]);
  *(_DWORD *)&byte_5D4594[4 * a1 + 2386364] = 0;
}

//----- (00510E50) --------------------------------------------------------
void sub_510E50()
{
  *(_DWORD *)&byte_5D4594[2386564] = 0;
}

//----- (00510E60) --------------------------------------------------------
signed int __cdecl sub_510E60(int a1)
{
  signed int result; // eax
  int v2; // edi
  float v3; // eax
  float v4; // ecx
  float v5; // eax
  float v6; // ecx
  float2 a2; // [esp+8h] [ebp-30h]
  int v8[2]; // [esp+10h] [ebp-28h]
  float4 a1a; // [esp+18h] [ebp-20h]
  float4 v10; // [esp+28h] [ebp-10h]

  result = *(_DWORD *)(a1 + 16);
  v2 = *(_DWORD *)(a1 + 748);
  if ( result >= 0 )
  {
    *(_DWORD *)(a1 + 500) = 0;
    *(_DWORD *)(a1 + 496) = *(_DWORD *)&byte_5D4594[2386564];
    if ( *(_DWORD *)&byte_5D4594[2386564] )
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386564] + 500) = a1;
    *(_DWORD *)&byte_5D4594[2386564] = a1;
    result = *(_DWORD *)(a1 + 16) | 0x80000000;
    *(_DWORD *)(a1 + 16) = result;
  }
  if ( *(_BYTE *)(a1 + 16) & 0x20 )
    result = (signed int)sub_510FD0((_DWORD *)a1);
  if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
  {
    v3 = *(float *)(a1 + 60);
    a1a.field_0 = *(float *)(a1 + 56);
    a1a.field_4 = v3;
    a1a.field_8 = cos(*(float *)v2) * 600.0 + *(float *)(a1 + 56);
    a1a.field_C = sin(*(float *)v2) * 600.0 + *(float *)(a1 + 60);
    if ( sub_535250(&a1a, &a2, 0, 5) )
    {
      v4 = a1a.field_C;
      *(float *)(a1 + 156) = a1a.field_8;
      *(float *)(a1 + 160) = v4;
    }
    else
    {
      v5 = a2.field_0;
      v6 = a2.field_4;
      *(float *)(a1 + 156) = a2.field_0;
      *(float *)(a1 + 160) = v6;
      a1a.field_8 = v5;
      a1a.field_C = v6;
    }
    *(float *)v2 = *(float *)(v2 + 8) + *(float *)v2;
    if ( a1a.field_0 >= (double)a1a.field_8 )
    {
      v10.field_8 = a1a.field_0;
      v10.field_0 = a1a.field_8;
    }
    else
    {
      v10.field_0 = a1a.field_0;
      v10.field_8 = a1a.field_8;
    }
    if ( a1a.field_4 >= (double)a1a.field_C )
    {
      v10.field_C = a1a.field_4;
      v10.field_4 = a1a.field_C;
    }
    else
    {
      v10.field_4 = a1a.field_4;
      v10.field_C = a1a.field_C;
    }
    v8[0] = a1;
    v8[1] = (int)&a1a;
    sub_517C10(&v10, sub_511020, (int)v8);
  }
  else
  {
    *(_DWORD *)v2 = *(_DWORD *)(v2 + 4);
  }
  return result;
}

//----- (00510FD0) --------------------------------------------------------
_DWORD *__cdecl sub_510FD0(_DWORD *a1)
{
  _DWORD *result; // eax
  int v2; // ecx
  int v3; // ecx

  result = a1;
  if ( a1[4] < 0 )
  {
    v2 = a1[125];
    if ( v2 )
      *(_DWORD *)(v2 + 496) = a1[124];
    else
      *(_DWORD *)&byte_5D4594[2386564] = a1[124];
    v3 = a1[124];
    if ( v3 )
      *(_DWORD *)(v3 + 500) = a1[125];
  }
  a1[4] &= 0x7FFFFFFFu;
  return result;
}

//----- (00511020) --------------------------------------------------------
void __cdecl sub_511020(int a1, int a2)
{
  int v2; // eax
  double v3;
  int v6; // eax
  int v7; // [esp-Ch] [ebp-20h]
  float2 a3; // [esp+Ch] [ebp-8h]

  v2 = *(_DWORD *)(a1 + 16);
  if ( !(v2 & 0x41)
    && (!(v2 & 0x10) || sub_40A5C0(4096) && *(_BYTE *)(a1 + 8) & 2 && (*(_DWORD *)(a1 + 16) & 0x8000) != 0x8000)
    && *(_DWORD *)(a1 + 556)
    && sub_57C8A0(*(float4 **)(a2 + 4), (float2 *)(a1 + 56), &a3))
  {
	v3 = *(float *)(a1 + 60) - a3.field_4;
    if ( *(float *)(a1 + 176) * *(float *)(a1 + 176) > v3 * v3
                                                     + (*(float *)(a1 + 56) - a3.field_0)
                                                     * (*(float *)(a1 + 56) - a3.field_0) )
	{
      v7 = *(_DWORD *)a2;
      v6 = sub_4EC580(*(_DWORD *)a2);
      (*(void (__cdecl **)(int, int, int, int, int))(a1 + 716))(a1, v6, v7, 500, 16);
      sub_501960(298, a1, 0, 0);
	}
  }
}

//----- (00511100) --------------------------------------------------------
void __cdecl sub_511100(int a1)
{
  int v1; // edi
  char *v2; // eax
  int v3; // esi
  double v4; // st7
  double v5; // st7
  float v6; // [esp+8h] [ebp-20h]
  float v7; // [esp+Ch] [ebp-1Ch]
  float v8; // [esp+14h] [ebp-14h]
  float v9; // [esp+18h] [ebp-10h]
  float v10; // [esp+1Ch] [ebp-Ch]
  float v11; // [esp+20h] [ebp-8h]
  float i; // [esp+24h] [ebp-4h]
  float v13; // [esp+2Ch] [ebp+4h]

  v1 = a1;
  v2 = sub_417090(a1);
  v3 = *(_DWORD *)&byte_5D4594[2386564];
  v4 = (double)*((unsigned __int16 *)v2 + 5);
  v9 = *((float *)v2 + 908) - v4;
  v13 = (double)*((unsigned __int16 *)v2 + 6);
  v10 = *((float *)v2 + 909) - v13;
  v11 = v4 + *((float *)v2 + 908);
  for ( i = v13 + *((float *)v2 + 909); v3; v3 = *(_DWORD *)(v3 + 496) )
  {
    if ( *(_DWORD *)(v3 + 16) & 0x1000000 )
    {
      if ( *(float *)(v3 + 56) >= (double)*(float *)(v3 + 156) )
      {
        v5 = *(float *)(v3 + 56);
        v6 = *(float *)(v3 + 156);
      }
      else
      {
        v5 = *(float *)(v3 + 156);
        v6 = *(float *)(v3 + 56);
      }
      if ( *(float *)(v3 + 60) >= (double)*(float *)(v3 + 160) )
      {
        v8 = *(float *)(v3 + 60);
        v7 = *(float *)(v3 + 160);
      }
      else
      {
        v7 = *(float *)(v3 + 60);
        v8 = *(float *)(v3 + 160);
      }
      if ( v9 < v5 && v11 > (double)v6 && v10 < (double)v8 && i > (double)v7 )
        sub_511250(v1, (float *)v3);
    }
    else
    {
      **(_DWORD **)(v3 + 748) = *(_DWORD *)(*(_DWORD *)(v3 + 748) + 4);
    }
  }
}

//----- (00511250) --------------------------------------------------------
int __cdecl sub_511250(int a1, float *a2)
{
  __int16 v2; // ax
  float v3; // ecx
  __int16 v4; // ax
  float v5; // edx
  char v7[9]; // [esp+4h] [ebp-Ch]

  v7[0] = -107;
  v2 = sub_419A30(a2[14]);
  v3 = a2[15];
  *(_WORD *)&v7[1] = v2;
  v4 = sub_419A30(v3);
  v5 = a2[39];
  *(_WORD *)&v7[3] = v4;
  *(_WORD *)&v7[5] = sub_419A30(v5);
  *(_WORD *)&v7[7] = sub_419A30(a2[40]);
  return sub_40EBC0(a1, 1, v7, 9);
}

//----- (005112C0) --------------------------------------------------------
BOOL sub_5112C0()
{
  *(_DWORD *)&byte_5D4594[2386568] = sub_413FE0((const char *)&byte_587000[236816], 52, 256);
  return *(_DWORD *)&byte_5D4594[2386568] != 0;
}

//----- (005112F0) --------------------------------------------------------
void sub_5112F0()
{
  *(_DWORD *)&byte_5D4594[2386572] = 0;
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386568]);
}

//----- (00511310) --------------------------------------------------------
int sub_511310()
{
  sub_414100(*(LPVOID *)&byte_5D4594[2386568]);
  *(_DWORD *)&byte_5D4594[2386572] = 0;
  return 1;
}

//----- (00511330) --------------------------------------------------------
void __cdecl sub_511330(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2386572];
  if ( *(_DWORD *)&byte_5D4594[2386572] )
  {
    while ( *(_DWORD *)(v1 + 8) != a1 )
    {
      v1 = *(_DWORD *)(v1 + 44);
      if ( !v1 )
        return;
    }
    if ( v1 )
      sub_511360(v1);
  }
}

//----- (00511360) --------------------------------------------------------
void __cdecl sub_511360(int a1)
{
  int v1; // ecx
  int v2; // ecx

  v1 = *(_DWORD *)(a1 + 48);
  if ( v1 )
    *(_DWORD *)(v1 + 44) = *(_DWORD *)(a1 + 44);
  else
    *(_DWORD *)&byte_5D4594[2386572] = *(_DWORD *)(a1 + 44);
  v2 = *(_DWORD *)(a1 + 44);
  if ( v2 )
    *(_DWORD *)(v2 + 48) = *(_DWORD *)(a1 + 48);
  sub_414330(*(unsigned int **)&byte_5D4594[2386568], (_QWORD *)a1);
}

//----- (005113A0) --------------------------------------------------------
void sub_5113A0()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  int v3; // ecx
  int v4; // eax
  int v5; // ecx
  double v6; // st7
  long double v7; // st7
  double v8; // st7
  double v9; // st7
  float v10; // [esp+0h] [ebp-1Ch]
  float v11; // [esp+4h] [ebp-18h]
  float v12; // [esp+14h] [ebp-8h]
  float v13; // [esp+14h] [ebp-8h]
  float v14; // [esp+18h] [ebp-4h]
  float v15; // [esp+18h] [ebp-4h]

  v0 = *(_DWORD *)&byte_5D4594[2386572];
  if ( *(_DWORD *)&byte_5D4594[2386572] )
  {
    do
    {
      v1 = *(_DWORD *)(v0 + 8);
      v2 = *(_DWORD *)(v0 + 44);
      if ( !v1 )
        goto LABEL_16;
      v3 = *(_DWORD *)(v0 + 12);
      if ( !v3 )
        goto LABEL_16;
      if ( !(*(_BYTE *)(v1 + 16) & 0x20)
        && !(*(_BYTE *)(v3 + 16) & 0x20)
        && (v4 = *(_DWORD *)(v0 + 12),
            v5 = *(_DWORD *)(v0 + 8),
            v12 = *(float *)(v4 + 64) - *(float *)(v5 + 64),
            v6 = *(float *)(v4 + 68) - *(float *)(v5 + 68),
            v14 = v6,
            v7 = sqrt(v6 * v14 + v12 * v12),
            *(float *)(v0 + 32) = v7,
            v7 <= *(float *)(v0 + 28)) )
      {
        v8 = *(float *)(v0 + 32) - *(float *)(v0 + 24);
        if ( !(*(_BYTE *)(v0 + 40) & 1) || v8 >= 0.0 )
        {
          if ( v8 > *(float *)(v0 + 24) )
            v8 = *(float *)(v0 + 24);
          v9 = -(v8 * *(float *)(v0 + 16));
          v15 = v9 * (v14 / *(float *)(v0 + 32));
          v13 = v9 * (v12 / *(float *)(v0 + 32));
          v11 = -v15;
          v10 = -v13;
          sub_548600(*(_DWORD *)(v0 + 8), v10, v11);
          sub_537610(*(_DWORD *)(v0 + 8));
          sub_548600(*(_DWORD *)(v0 + 12), v13, v15);
          sub_537610(*(_DWORD *)(v0 + 12));
          *(_DWORD *)(v0 + 36) = *(_DWORD *)(v0 + 32);
        }
      }
      else
      {
LABEL_16:
        sub_511360(v0);
      }
      v0 = v2;
    }
    while ( v2 );
  }
}

//----- (005114D0) --------------------------------------------------------
void __cdecl sub_5114D0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  float *v6; // eax
  double v7; // st7
  double v8; // st6
  long double v9; // st7

  if ( a1 && a2 && !(*(_BYTE *)(a1 + 16) & 0x20) && !(*(_BYTE *)(a2 + 16) & 0x20) )
  {
    v6 = (float *)sub_4142F0(*(_DWORD **)&byte_5D4594[2386568]);
    if ( v6 )
    {
      *((_DWORD *)v6 + 4) = a3;
      *((_DWORD *)v6 + 5) = a4;
      *((_DWORD *)v6 + 2) = a1;
      *((_DWORD *)v6 + 3) = a2;
      *((_DWORD *)v6 + 6) = a5;
      *((_DWORD *)v6 + 7) = a6;
      v7 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
      v8 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
      v9 = sqrt(v8 * v8 + v7 * v7);
      v6[8] = v9;
      v6[9] = v9;
      sub_511560((int)v6);
    }
  }
}

//----- (00511560) --------------------------------------------------------
int __cdecl sub_511560(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 48) = 0;
  *(_DWORD *)(a1 + 44) = *(_DWORD *)&byte_5D4594[2386572];
  if ( *(_DWORD *)&byte_5D4594[2386572] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386572] + 48) = a1;
  *(_DWORD *)&byte_5D4594[2386572] = a1;
  return result;
}

//----- (00511590) --------------------------------------------------------
void __cdecl sub_511590(int a1, int a2)
{
  int v2; // ebx
  _DWORD *v3; // eax
  int v4; // esi
  double v5; // st7
  double v6; // st6
  char v7; // dl
  long double v8; // st7
  float v9; // [esp+10h] [ebp+4h]

  v2 = a1;
  if ( a1 )
  {
    if ( a2 )
    {
      if ( !(*(_BYTE *)(a1 + 16) & 0x20) && !(*(_BYTE *)(a2 + 16) & 0x20) )
      {
        v3 = sub_4142F0(*(_DWORD **)&byte_5D4594[2386568]);
        v4 = (int)v3;
        if ( v3 )
        {
          v3[2] = a1;
          v3[3] = a2;
          v3[4] = 1114636288;
          v9 = sub_4E4A70(a1);
          if ( sub_4E4A70(a2) >= v9 )
            sub_4E4A70(a2);
          else
            sub_4E4A70(v2);
          *(_DWORD *)(v4 + 20) = 0;
          v5 = *(float *)(a2 + 56) - *(float *)(v2 + 56);
          v6 = *(float *)(a2 + 60) - *(float *)(v2 + 60);
          v7 = *(_BYTE *)(v4 + 40) | 1;
          *(_DWORD *)(v4 + 28) = 1132462080;
          *(_BYTE *)(v4 + 40) = v7;
          v8 = sqrt(v6 * v6 + v5 * v5);
          *(float *)(v4 + 32) = v8;
          *(float *)(v4 + 36) = v8;
          *(float *)(v4 + 24) = v8;
          sub_511560(v4);
        }
      }
    }
  }
}

//----- (00511660) --------------------------------------------------------
int __cdecl sub_511660(_DWORD *a1, int a2)
{
  int result; // eax
  unsigned int v3; // edx
  int v4; // ecx
  int v5; // eax
  int v6; // eax

  result = a1[4];
  if ( !(result & 0x10000) )
  {
    if ( result & 0x400000 )
      sub_5116F0((int)a1);
    v3 = *(_DWORD *)&byte_5D4594[2598000] + a2;
    v4 = 0;
    a1[34] = *(_DWORD *)&byte_5D4594[2598000] + a2;
    v5 = *(_DWORD *)&byte_5D4594[2386576];
    if ( !*(_DWORD *)&byte_5D4594[2386576] )
      goto LABEL_14;
    do
    {
      if ( v3 < *(int *)(v5 + 136) )
        break;
      v4 = v5;
      v5 = *(_DWORD *)(v5 + 468);
    }
    while ( v5 );
    if ( v4 )
    {
      *(_DWORD *)(v4 + 468) = a1;
      if ( !v5 )
      {
        v6 = a1[4];
        a1[117] = 0;
        result = v6 | 0x400000;
        a1[4] = result;
        return result;
      }
    }
    else
    {
LABEL_14:
      *(_DWORD *)&byte_5D4594[2386576] = a1;
    }
    a1[117] = v5;
    result = a1[4] | 0x400000;
    a1[4] = result;
  }
  return result;
}

//----- (005116F0) --------------------------------------------------------
int __cdecl sub_5116F0(int a1)
{
  int result; // eax
  int v2; // ecx

  result = *(_DWORD *)(a1 + 16);
  if ( result & 0x400000 )
  {
    v2 = 0;
    *(_DWORD *)(a1 + 16) = result & 0xFFBFFFFF;
    result = *(_DWORD *)&byte_5D4594[2386576];
    if ( *(_DWORD *)&byte_5D4594[2386576] )
    {
      while ( result != a1 )
      {
        v2 = result;
        result = *(_DWORD *)(result + 468);
        if ( !result )
          return result;
      }
      if ( result )
      {
        if ( v2 )
        {
          result = *(_DWORD *)(a1 + 468);
          *(_DWORD *)(v2 + 468) = result;
        }
        else
        {
          *(_DWORD *)&byte_5D4594[2386576] = *(_DWORD *)(a1 + 468);
        }
      }
    }
  }
  return result;
}

//----- (00511750) --------------------------------------------------------
void sub_511750()
{
  _DWORD *v0; // esi
  _DWORD *v1; // edi
  int v2; // edx

  v0 = *(_DWORD **)&byte_5D4594[2386576];
  if ( *(_DWORD *)&byte_5D4594[2386576] )
  {
    do
    {
      v1 = (_DWORD *)v0[117];
      if ( v0[123] )
      {
        sub_5116F0((int)v0);
      }
      else
      {
        if ( v0[34] > *(int *)&byte_5D4594[2598000] )
          return;
        sub_5116F0((int)v0);
        v2 = v0[5];
        LOBYTE(v2) = v2 | 0x80;
        v0[5] = v2;
        sub_4E5CC0((int)v0);
      }
      v0 = v1;
    }
    while ( v1 );
  }
}

//----- (005117B0) --------------------------------------------------------
int sub_5117B0()
{
  int result; // eax
  int v1; // esi

  result = *(_DWORD *)&byte_5D4594[2386576];
  if ( *(_DWORD *)&byte_5D4594[2386576] )
  {
    do
    {
      v1 = *(_DWORD *)(result + 468);
      sub_5116F0(result);
      result = v1;
    }
    while ( v1 );
    *(_DWORD *)&byte_5D4594[2386576] = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2386576] = 0;
  }
  return result;
}

//----- (005117F0) --------------------------------------------------------
char __cdecl sub_5117F0(int a1)
{
  char result; // al

  result = a1;
  if ( !(*(_BYTE *)(a1 + 8) & 1) )
    result = sub_537610(a1);
  return result;
}

//----- (00511810) --------------------------------------------------------
void __cdecl sub_511810(int a1)
{
  if ( !(*(_BYTE *)(a1 + 8) & 1) )
  {
    if ( sub_537580(a1) )
      sub_5375A0(a1);
  }
}

//----- (00511850) --------------------------------------------------------
void sub_511850()
{
  int v0; // esi
  int v1; // eax

  sub_5486D0();
  v0 = 5;
  do
  {
    sub_5118A0(0.2);
    sub_548B60();
    --v0;
  }
  while ( v0 );
  while ( !sub_537590() )
  {
    v1 = sub_537700();
    if ( (signed char)*(_BYTE *)(v1 + 8) >= 0 )
      sub_4DA8D0(v1);
  }
  sub_548740();
}

//----- (005118A0) --------------------------------------------------------
int __cdecl sub_5118A0(float a1)
{
  int i; // esi
  int result; // eax
  int j; // esi
  double v4; // st7
  float v5; // ecx
  float *v6; // edi
  unsigned __int8 *v7; // edx
  char v8; // al
  int v9; // eax
  double v10; // st7
  double v11; // st6
  float v12; // [esp+8h] [ebp-24h]
  float v13; // [esp+10h] [ebp-1Ch]
  float v14; // [esp+10h] [ebp-1Ch]
  float2 v15; // [esp+14h] [ebp-18h]
  float4 v16; // [esp+1Ch] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2386580] )
  {
    *(_DWORD *)&byte_5D4594[2386580] = sub_4E3AA0((CHAR *)&byte_587000[236824]);
    *(_DWORD *)&byte_5D4594[2386584] = sub_4E3AA0((CHAR *)&byte_587000[236844]);
    *(_DWORD *)&byte_5D4594[2386588] = sub_4E3AA0((CHAR *)&byte_587000[236864]);
    *(_DWORD *)&byte_5D4594[2386592] = sub_4E3AA0((CHAR *)&byte_587000[236884]);
    *(_DWORD *)&byte_5D4594[2386596] = sub_4E3AA0((CHAR *)&byte_587000[236900]);
    *(_DWORD *)&byte_5D4594[2386600] = sub_4E3AA0((CHAR *)&byte_587000[236920]);
    *(_DWORD *)&byte_5D4594[2386604] = sub_4E3AA0((CHAR *)&byte_587000[236944]);
    *(_DWORD *)&byte_5D4594[2386608] = sub_4E3AA0((CHAR *)&byte_587000[236968]);
    *(_DWORD *)&byte_5D4594[2386612] = sub_4E3AA0((CHAR *)&byte_587000[236992]);
    *(_DWORD *)&byte_5D4594[2386616] = sub_4E3AA0((CHAR *)&byte_587000[237012]);
  }
  for ( i = sub_537740(); i; i = sub_537750(i) )
    sub_5481C0(i);
  sub_5113A0();
  result = sub_537740();
  for ( j = result; result; j = result )
  {
    if ( *(_BYTE *)(j + 16) & 2 || *(_BYTE *)(j + 8) & 2 && sub_50A0D0(j, 67) )
    {
      *(_DWORD *)(j + 100) = 0;
      *(_DWORD *)(j + 96) = 0;
      *(_DWORD *)(j + 84) = 0;
      *(_DWORD *)(j + 80) = 0;
    }
    else
    {
      if ( sub_4FF350(j, 5) || sub_4FF350(j, 25) || sub_4FF350(j, 28) )
      {
        v4 = *(float *)(j + 96);
        v13 = *(float *)(j + 100);
      }
      else
      {
        v4 = *(float *)(j + 96) + *(float *)(j + 88);
        v13 = *(float *)(j + 100) + *(float *)(j + 92);
      }
      v5 = *(float *)(j + 64);
      v6 = (float *)(j + 64);
      v14 = v13 - *(float *)(j + 84) * *(float *)(j + 112);
      *(float *)(j + 80) = (v4 - *(float *)(j + 112) * *(float *)(j + 80)) * a1 + *(float *)(j + 80);
      *(float *)(j + 84) = v14 * a1 + *(float *)(j + 84);
      v16.field_0 = v5;
      v16.field_4 = *(float *)(j + 68);
      v7 = &byte_5D4594[2386580];
      v16.field_8 = a1 * *(float *)(j + 80) + *(float *)(j + 64);
      v16.field_C = a1 * *(float *)(j + 84) + *(float *)(j + 68);
      v8 = (*(_DWORD *)(j + 16) >> 12) & 4 | 1;
      while ( *(unsigned __int16 *)(j + 4) != *(_DWORD *)v7 )
      {
        v7 += 4;
        if ( (int)v7 >= (int)&byte_5D4594[2386620] )
          goto LABEL_20;
      }
      v8 = (*(_DWORD *)(j + 16) >> 12) & 4 | 0x41;
LABEL_20:
      if ( sub_535250(&v16, 0, 0, v8) )
      {
        *v6 = v16.field_8;
        *(float *)(j + 68) = v16.field_C;
      }
      v9 = *(_DWORD *)(j + 16);
      if ( !(v9 & 0x4000) && *(_DWORD *)(j + 556) && sub_411160((float2 *)(j + 64)) == 6 )
      {
        v15.field_0 = 0.0;
        v15.field_4 = 0.0;
        sub_548630(j, 6u, &v15);
      }
      v10 = *v6 - *(float *)(j + 56);
      if ( v10 < 0.0 )
        v10 = -v10;
      v11 = *(float *)(j + 68) - *(float *)(j + 60);
      if ( v11 < 0.0 )
        v11 = -v11;
      if ( v10 > 0.0099999998 || (v12 = v11, v12 > 0.0099999998) )
      {
        sub_4E44F0(j);
        sub_4E7290(j);
        sub_517970(j);
      }
    }
    result = sub_537750(j);
  }
  return result;
}

//----- (00511B60) --------------------------------------------------------
int __cdecl sub_511B60(int a1)
{
  int result; // eax
  int v2; // edi
  int v3; // esi

  if ( a1 == -1 )
  {
    result = *(_DWORD *)&byte_5D4594[3821964];
    if ( *(_DWORD *)&byte_5D4594[3821964] && !(*(_BYTE *)(*(_DWORD *)&byte_5D4594[3821964] + 16) & 0x20) )
      return result;
    return 0;
  }
  if ( a1 != -2 )
  {
    result = sub_511C50(a1);
    if ( result )
      return result;
    v2 = sub_4DA790();
    if ( v2 )
    {
      while ( 1 )
      {
        if ( !(*(_BYTE *)(v2 + 16) & 0x20) && *(_DWORD *)(v2 + 44) == a1 )
        {
          sub_511D70(v2);
          return v2;
        }
        v3 = *(_DWORD *)(v2 + 504);
        if ( v3 )
          break;
LABEL_17:
        v2 = sub_4DA7A0(v2);
        if ( !v2 )
          goto LABEL_18;
      }
      while ( *(_BYTE *)(v3 + 16) & 0x20 || *(_DWORD *)(v3 + 44) != a1 )
      {
        v3 = *(_DWORD *)(v3 + 496);
        if ( !v3 )
          goto LABEL_17;
      }
    }
    else
    {
LABEL_18:
      v3 = sub_4DA870();
      if ( !v3 )
        return 0;
      while ( *(_BYTE *)(v3 + 16) & 0x20 || *(_DWORD *)(v3 + 44) != a1 )
      {
        result = sub_4DA880(v3);
        v3 = result;
        if ( !result )
          return result;
      }
    }
    sub_511D70(v3);
    return v3;
  }
  result = *(_DWORD *)&byte_5D4594[3821968];
  if ( !*(_DWORD *)&byte_5D4594[3821968] || *(_BYTE *)(*(_DWORD *)&byte_5D4594[3821968] + 16) & 0x20 )
    return 0;
  return result;
}

//----- (00511C50) --------------------------------------------------------
int __cdecl sub_511C50(int a1)
{
  _DWORD *v1; // esi

  if ( *(_DWORD *)&byte_587000[237036] )
    sub_511D20();
  v1 = *(_DWORD **)&byte_5D4594[2386820];
  if ( !*(_DWORD *)&byte_5D4594[2386820] )
    return 0;
  while ( *(_BYTE *)(*v1 + 16) & 0x20 || *(_DWORD *)(*v1 + 44) != a1 )
  {
    v1 = (_DWORD *)v1[2];
    if ( !v1 )
      return 0;
  }
  sub_511CE0(&byte_5D4594[2386820], (int)v1);
  sub_511CB0(&byte_5D4594[2386820], (int)v1);
  return *v1;
}

//----- (00511CB0) --------------------------------------------------------
int __cdecl sub_511CB0(_DWORD *a1, int a2)
{
  int result; // eax

  result = a2;
  *(_DWORD *)(a2 + 4) = 0;
  *(_DWORD *)(a2 + 8) = *a1;
  if ( *a1 )
    *(_DWORD *)(*a1 + 4) = a2;
  else
    a1[1] = a2;
  *a1 = a2;
  return result;
}

//----- (00511CE0) --------------------------------------------------------
int __cdecl sub_511CE0(_DWORD *a1, int a2)
{
  int result; // eax
  int v3; // ecx
  int v4; // ecx

  result = a2;
  v3 = *(_DWORD *)(a2 + 8);
  if ( v3 )
    *(_DWORD *)(v3 + 4) = *(_DWORD *)(a2 + 4);
  else
    a1[1] = *(_DWORD *)(a2 + 4);
  v4 = *(_DWORD *)(a2 + 4);
  if ( v4 )
  {
    *(_DWORD *)(v4 + 8) = *(_DWORD *)(a2 + 8);
  }
  else
  {
    result = *(_DWORD *)(a2 + 8);
    *a1 = result;
  }
  return result;
}

//----- (00511D20) --------------------------------------------------------
int sub_511D20()
{
  unsigned __int8 *v0; // esi
  int result; // eax

  v0 = &byte_5D4594[2386628];
  *(_DWORD *)&byte_5D4594[2386820] = 0;
  *(_DWORD *)&byte_5D4594[2386824] = 0;
  *(_DWORD *)&byte_5D4594[2386620] = 0;
  *(_DWORD *)&byte_5D4594[2386624] = 0;
  do
  {
    result = sub_511CB0(&byte_5D4594[2386620], (int)v0);
    v0 += 12;
  }
  while ( (int)v0 < (int)&byte_5D4594[2386820] );
  *(_DWORD *)&byte_587000[237036] = 0;
  return result;
}

//----- (00511D70) --------------------------------------------------------
int __cdecl sub_511D70(int a1)
{
  int *v1; // eax
  int v2; // esi
  int result; // eax
  int v4; // [esp-8h] [ebp-8h]

  v1 = (int *)sub_511DC0();
  if ( v1 )
  {
    *v1 = a1;
    result = sub_511CB0(&byte_5D4594[2386820], (int)v1);
  }
  else
  {
    v2 = *(_DWORD *)&byte_5D4594[2386824];
    v4 = *(_DWORD *)&byte_5D4594[2386824];
    **(_DWORD **)&byte_5D4594[2386824] = a1;
    sub_511CE0(&byte_5D4594[2386820], v4);
    result = sub_511CB0(&byte_5D4594[2386820], v2);
  }
  return result;
}

//----- (00511DC0) --------------------------------------------------------
int sub_511DC0()
{
  int result; // eax

  result = *(_DWORD *)&byte_5D4594[2386620];
  if ( !*(_DWORD *)&byte_5D4594[2386620] )
    return 0;
  *(_DWORD *)&byte_5D4594[2386620] = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386620] + 8);
  return result;
}

//----- (00511DE0) --------------------------------------------------------
int __cdecl sub_511DE0(int a1)
{
  int result; // eax
  _DWORD *v2; // esi

  result = *(_DWORD *)&byte_587000[237036];
  if ( !*(_DWORD *)&byte_587000[237036] )
  {
    v2 = *(_DWORD **)&byte_5D4594[2386820];
    if ( *(_DWORD *)&byte_5D4594[2386820] )
    {
      result = a1;
      while ( *v2 != a1 )
      {
        v2 = (_DWORD *)v2[2];
        if ( !v2 )
          return result;
      }
      sub_511CE0(&byte_5D4594[2386820], (int)v2);
      result = sub_511CB0(&byte_5D4594[2386620], (int)v2);
    }
  }
  return result;
}

//----- (00511E20) --------------------------------------------------------
int sub_511E20()
{
  int result; // eax
  int v1; // esi
  int v2; // edi

  result = *(_DWORD *)&byte_587000[237036];
  if ( !*(_DWORD *)&byte_587000[237036] )
  {
    v1 = *(_DWORD *)&byte_5D4594[2386820];
    if ( *(_DWORD *)&byte_5D4594[2386820] )
    {
      do
      {
        v2 = *(_DWORD *)(v1 + 8);
        sub_511CE0(&byte_5D4594[2386820], v1);
        result = sub_511CB0(&byte_5D4594[2386620], v1);
        v1 = v2;
      }
      while ( v2 );
    }
  }
  return result;
}

//----- (00511E60) --------------------------------------------------------
void sub_511E60()
{
  if ( !*(_DWORD *)&byte_5D4594[2386836] )
    *(_DWORD *)&byte_5D4594[2386836] = sub_4E3AA0((CHAR *)&byte_587000[246804]);
  sub_5058F0();
  sub_51AC60();
  *(_DWORD *)&byte_5D4594[2386844] = 0;
  *(_DWORD *)&byte_5D4594[2386848] = 0;
  *(_DWORD *)&byte_5D4594[2386852] = 0;
}

//----- (00511EB0) --------------------------------------------------------
int sub_511EB0()
{
  int v0; // edi
  int v1; // esi

  v0 = script_pop();
  v1 = script_pop();
  if ( *(_DWORD *)&byte_5D4594[3821636] || *(_DWORD *)&byte_5D4594[3821640] )
  {
    v1 = (*(int *)&byte_5D4594[3821636] + 23 * v1) / 23;
    v0 = (*(int *)&byte_5D4594[3821640] + 23 * v0) / 23;
  }
  if ( sub_410580(v1, v0) )
    sub_507230(v0 | (v1 << 16));
  else
    sub_507230(0);
  return 0;
}

//----- (00511F50) --------------------------------------------------------
int sub_511F50()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_410580(v0 >> 16, (unsigned __int16)v0);
  if ( v1 )
    sub_511F80(v1);
  return 0;
}

//----- (00511F80) --------------------------------------------------------
void __cdecl sub_511F80(int a1)
{
  int v1; // edx
  int v2; // ecx
  char v3; // al
  int v4; // eax
  char *v5; // eax
  int v6; // eax
  float2 v7; // [esp+0h] [ebp-8h]
  int v8; // [esp+Ch] [ebp+4h]

  v1 = a1;
  if ( *(_BYTE *)(a1 + 4) & 4 )
  {
    v2 = *(_DWORD *)(a1 + 28);
    v3 = *(_BYTE *)(v2 + 21);
    if ( v3 != 3 && v3 != 4 )
    {
      v4 = *(_DWORD *)(v2 + 4);
      *(_BYTE *)(v2 + 21) = 4;
      v8 = 23 * *(_DWORD *)(v2 + 8);
      v7.field_0 = (double)(23 * v4) + 11.5;
      v7.field_4 = (double)v8 + 11.5;
      if ( !*(_DWORD *)&byte_5D4594[2386840] )
      {
        v5 = sub_410EE0(*(unsigned __int8 *)(v1 + 1));
        v6 = sub_40AF50(v5);
        sub_501A30(v6, &v7, 0, 0);
      }
    }
  }
}

//----- (00512010) --------------------------------------------------------
int sub_512010()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 2, (void (__cdecl *)(int, int))sub_511F80, 0);
  return 0;
}

//----- (00512040) --------------------------------------------------------
int sub_512040()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_410580(v0 >> 16, (unsigned __int16)v0);
  if ( v1 )
    sub_512070(v1);
  return 0;
}

//----- (00512070) --------------------------------------------------------
void __cdecl sub_512070(int a1)
{
  int v1; // edx
  int v2; // ecx
  char v3; // al
  int v4; // eax
  char *v5; // eax
  int v6; // eax
  float2 v7; // [esp+0h] [ebp-8h]
  int v8; // [esp+Ch] [ebp+4h]

  v1 = a1;
  if ( *(_BYTE *)(a1 + 4) & 4 )
  {
    v2 = *(_DWORD *)(a1 + 28);
    v3 = *(_BYTE *)(v2 + 21);
    if ( v3 != 1 && v3 != 2 )
    {
      v4 = *(_DWORD *)(v2 + 4);
      *(_BYTE *)(v2 + 21) = 2;
      v8 = 23 * *(_DWORD *)(v2 + 8);
      v7.field_0 = (double)(23 * v4) + 11.5;
      v7.field_4 = (double)v8 + 11.5;
      if ( !*(_DWORD *)&byte_5D4594[2386840] )
      {
        v5 = sub_410F20(*(unsigned __int8 *)(v1 + 1));
        v6 = sub_40AF50(v5);
        sub_501A30(v6, &v7, 0, 0);
      }
    }
  }
}

//----- (00512100) --------------------------------------------------------
int sub_512100()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 2, (void (__cdecl *)(int, int))sub_512070, 0);
  return 0;
}

//----- (00512130) --------------------------------------------------------
int sub_512130()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_410580(v0 >> 16, (unsigned __int16)v0);
  if ( v1 )
    sub_512160(v1);
  return 0;
}

//----- (00512160) --------------------------------------------------------
void __cdecl sub_512160(int a1)
{
  int v1; // eax
  char v2; // cl
  int v3; // ecx
  char *v4; // eax
  int v5; // ecx
  int v6; // eax
  float2 v7; // [esp+4h] [ebp-8h]

  if ( *(_BYTE *)(a1 + 4) & 4 )
  {
    v1 = *(_DWORD *)(a1 + 28);
    v2 = *(_BYTE *)(v1 + 21);
    if ( v2 == 1 || v2 == 2 )
    {
      v5 = *(_DWORD *)(v1 + 4);
      *(_BYTE *)(v1 + 21) = 4;
      v7.field_0 = (double)(23 * v5) + 11.5;
      v7.field_4 = (double)(int)(23 * *(_DWORD *)(v1 + 8)) + 11.5;
      if ( *(_DWORD *)&byte_5D4594[2386840] )
        return;
      v4 = sub_410EE0(*(unsigned __int8 *)(a1 + 1));
    }
    else
    {
      v3 = *(_DWORD *)(v1 + 4);
      *(_BYTE *)(v1 + 21) = 2;
      v7.field_0 = (double)(23 * v3) + 11.5;
      v7.field_4 = (double)(int)(23 * *(_DWORD *)(v1 + 8)) + 11.5;
      if ( *(_DWORD *)&byte_5D4594[2386840] )
        return;
      v4 = sub_410F20(*(unsigned __int8 *)(a1 + 1));
    }
    v6 = sub_40AF50(v4);
    sub_501A30(v6, &v7, 0, 0);
  }
}

//----- (00512260) --------------------------------------------------------
int sub_512260()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 2, (void (__cdecl *)(int, int))sub_512160, 0);
  return 0;
}

//----- (00512290) --------------------------------------------------------
int sub_512290()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_410580(v0 >> 16, (unsigned __int16)v0);
  if ( v1 )
    sub_5122C0(v1);
  return 0;
}

//----- (005122C0) --------------------------------------------------------
int __cdecl sub_5122C0(int a1)
{
  int v1; // edx
  int2 v3; // [esp+0h] [ebp-8h]

  v1 = *(unsigned __int8 *)(a1 + 6);
  v3.field_0 = *(unsigned __int8 *)(a1 + 5);
  v3.field_4 = v1;
  return sub_534DA0(&v3);
}

//----- (005122F0) --------------------------------------------------------
int sub_5122F0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 2, (void (__cdecl *)(int, int))sub_5122C0, 0);
  return 0;
}

//----- (00512320) --------------------------------------------------------
int sub_512320()
{
  int v0; // esi
  int v1; // eax

  v0 = script_pop();
  v1 = script_pop();
  sub_51ACA0(v1 * *(_DWORD *)&byte_5D4594[2649704], v0, 0);
  return 0;
}

//----- (00512350) --------------------------------------------------------
int sub_512350()
{
  int v0; // esi
  int v1; // eax

  v0 = script_pop();
  v1 = script_pop();
  sub_51ACA0(v1, v0, 0);
  return 0;
}

//----- (00512370) --------------------------------------------------------
int sub_512370()
{
  int v0; // edi
  int v1; // eax
  int v2; // eax
  int v3; // esi
  int v4; // eax
  _DWORD *v5; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = v2;
  if ( v2 )
  {
    v4 = *(_DWORD *)(v2 + 16);
    if ( (v4 & 0x8000) == 0 )
    {
      v5 = sub_579C40(v0);
      if ( v5 )
        sub_5123C0(v3, (int)v5);
    }
  }
  return 0;
}

//----- (005123C0) --------------------------------------------------------
int *__cdecl sub_5123C0(int a1, int a2)
{
  int *result; // eax
  int v3; // ebx
  int *v4; // eax
  int *v5; // eax
  int *i; // esi

  result = *(int **)(a1 + 16);
  if ( SBYTE1(result) >= 0 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      v3 = *(_DWORD *)(a1 + 748);
      sub_50A3A0(a1);
      v4 = sub_50A260(a1, 32);
      if ( v4 )
        v4[1] = 8;
      if ( *(_BYTE *)(a2 + 476) )
      {
        v5 = sub_50A260(a1, 10);
        if ( v5 )
        {
          v5[1] = a2;
          *((_BYTE *)v5 + 12) = *(_BYTE *)(v3 + 1332);
        }
      }
      result = sub_50A260(a1, 8);
      if ( result )
      {
        result[1] = *(_DWORD *)(a2 + 8);
        result[2] = *(_DWORD *)(a2 + 12);
        result[3] = 0;
      }
    }
    else if ( *(unsigned __int16 *)(a1 + 4) == *(_DWORD *)&byte_5D4594[2386836] )
    {
      result = (int *)sub_5124C0((_DWORD *)a1, (_DWORD *)a2);
    }
    else
    {
      result = (int *)sub_4DA790();
      for ( i = result; result; i = result )
      {
        if ( *((unsigned __int16 *)i + 2) == *(_DWORD *)&byte_5D4594[2386836]
          && *(_DWORD *)(i[187] + 32) == *(_DWORD *)(a1 + 40) )
        {
          sub_5124C0(i, (_DWORD *)a2);
        }
        result = (int *)sub_4DA7A0((int)i);
      }
    }
  }
  return result;
}

//----- (005124C0) --------------------------------------------------------
int __cdecl sub_5124C0(_DWORD *a1, _DWORD *a2)
{
  int v2; // edi

  v2 = a1[187];
  sub_4E75B0((int)a1);
  a1[20] = 0;
  a1[21] = 0;
  *(_BYTE *)v2 = 0;
  *(_DWORD *)(v2 + 8) = *a2;
  return sub_4DA8D0((int)a1);
}

//----- (00512500) --------------------------------------------------------
int sub_512500()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  _DWORD *v3; // ebx
  int *i; // esi
  int v5; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_57C0A0(v1);
  v3 = sub_579C40(v0);
  if ( v3 )
  {
    if ( v2 )
    {
      for ( i = *(int **)(v2 + 84); i; i = (int *)i[2] )
      {
        v5 = sub_4ED020(*i);
        if ( v5 )
          sub_5123C0(v5, (int)v3);
      }
    }
  }
  return 0;
}

//----- (00512560) --------------------------------------------------------
int sub_512560()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax
  int v3; // ecx

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    if ( *(_BYTE *)(v2 + 8) & 2 )
    {
      v3 = *(_DWORD *)(v2 + 16);
      if ( (v3 & 0x8000) == 0 )
        sub_5125A0(v2, v0);
    }
  }
  return 0;
}

//----- (005125A0) --------------------------------------------------------
float *__cdecl sub_5125A0(int a1, int a2)
{
  float *result; // eax
  int v3; // edx
  float v4; // [esp+0h] [ebp-8h]
  float v5; // [esp+4h] [ebp-4h]

  result = (float *)sub_509E90(a2);
  if ( *(_BYTE *)(a1 + 8) & 2 )
  {
    v3 = *(_DWORD *)(a1 + 16);
    if ( (v3 & 0x8000) == 0 )
    {
      v4 = *(float *)&byte_587000[8 * (_DWORD)result + 194136] * 10.0 + *(float *)(a1 + 56);
      v5 = *(float *)&byte_587000[8 * (_DWORD)result + 194140] * 10.0 + *(float *)(a1 + 60);
      result = (float *)sub_50A260(a1, 25);
      if ( result )
      {
        result[1] = v4;
        result[2] = v5;
      }
    }
  }
  return result;
}

//----- (00512610) --------------------------------------------------------
int sub_512610()
{
  int v0; // edi
  int v1; // eax
  int result; // eax
  int *i; // esi
  int v4; // eax
  int v5; // ecx

  v0 = script_pop();
  v1 = script_pop();
  result = sub_57C0A0(v1);
  if ( result )
  {
    for ( i = *(int **)(result + 84); i; i = (int *)i[2] )
    {
      v4 = sub_4ED020(*i);
      if ( v4 && *(_BYTE *)(v4 + 8) & 2 )
      {
        v5 = *(_DWORD *)(v4 + 16);
        if ( (v5 & 0x8000) == 0 )
          sub_5125A0(v4, v0);
      }
    }
    result = 0;
  }
  return result;
}

//----- (00512670) --------------------------------------------------------
int sub_512670()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_4E75B0(v1);
  return 0;
}

//----- (00512690) --------------------------------------------------------
int sub_512690()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_5126C0, 0);
  return 0;
}

//----- (005126C0) --------------------------------------------------------
char __cdecl sub_5126C0(int a1)
{
  return sub_4E75B0(a1);
}

//----- (005126D0) --------------------------------------------------------
int sub_5126D0()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 )
    v1[120] |= 1u;
  return 0;
}

//----- (005126F0) --------------------------------------------------------
int sub_5126F0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 1, (void (__cdecl *)(int, int))sub_512720, 0);
  return 0;
}

//----- (00512720) --------------------------------------------------------
int __cdecl sub_512720(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 480) |= 1u;
  return result;
}

//----- (00512730) --------------------------------------------------------
int sub_512730()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_4E7600(v1);
  return 0;
}

//----- (00512750) --------------------------------------------------------
int sub_512750()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_512780, 0);
  return 0;
}

//----- (00512780) --------------------------------------------------------
int __cdecl sub_512780(int a1)
{
  return sub_4E7600(a1);
}

//----- (00512790) --------------------------------------------------------
int sub_512790()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 )
    v1[120] &= 0xFFFFFFFE;
  return 0;
}

//----- (005127B0) --------------------------------------------------------
int sub_5127B0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 1, (void (__cdecl *)(int, int))sub_5127E0, 0);
  return 0;
}

//----- (005127E0) --------------------------------------------------------
int __cdecl sub_5127E0(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 480) &= 0xFFFFFFFE;
  return result;
}

//----- (005127F0) --------------------------------------------------------
int sub_5127F0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_4E7650(v1);
  return 0;
}

//----- (00512810) --------------------------------------------------------
int sub_512810()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_512840, 0);
  return 0;
}

//----- (00512840) --------------------------------------------------------
char __cdecl sub_512840(int a1)
{
  return sub_4E7650(a1);
}

//----- (00512850) --------------------------------------------------------
int sub_512850()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 )
    v1[120] ^= 1u;
  return 0;
}

//----- (00512870) --------------------------------------------------------
int sub_512870()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 1, (void (__cdecl *)(int, int))sub_5128A0, 0);
  return 0;
}

//----- (005128A0) --------------------------------------------------------
int __cdecl sub_5128A0(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(a1 + 480) ^= 1u;
  return result;
}

//----- (005128B0) --------------------------------------------------------
int sub_5128B0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_4E5CC0(v1);
  return 0;
}

//----- (005128D0) --------------------------------------------------------
int sub_5128D0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_512900, 0);
  return 0;
}

//----- (00512900) --------------------------------------------------------
void __cdecl sub_512900(int a1)
{
  sub_4E5CC0(a1);
}

//----- (00512910) --------------------------------------------------------
int sub_512910()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_512930(v1);
  return 0;
}

//----- (00512930) --------------------------------------------------------
void __cdecl sub_512930(int a1)
{
  int v1; // eax
  int v2; // edi
  int *v3; // eax
  int *v4; // eax

  if ( *(_BYTE *)(a1 + 8) & 2 )
  {
    v1 = *(_DWORD *)(a1 + 16);
    if ( (v1 & 0x8000) == 0 )
    {
      v2 = *(_DWORD *)(a1 + 748);
      sub_50A3A0(a1);
      v3 = sub_50A260(a1, 32);
      if ( v3 )
        v3[1] = 10;
      v4 = sub_50A260(a1, 10);
      if ( v4 )
      {
        v4[1] = 0;
        *((_BYTE *)v4 + 12) = *(_BYTE *)(v2 + 1332);
      }
    }
  }
}

//----- (00512990) --------------------------------------------------------
int sub_512990()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_512930, 0);
  return 0;
}

//----- (005129C0) --------------------------------------------------------
int sub_5129C0()
{
  int v0; // eax

  v0 = script_pop();
  sub_511B60(v0);
  return 0;
}

//----- (005129E0) --------------------------------------------------------
int sub_5129E0()
{
  int v0; // eax

  v0 = script_pop();
  sub_511B60(v0);
  return 0;
}

//----- (00512A00) --------------------------------------------------------
int sub_512A00()
{
  int v0; // eax
  int result; // eax
  int v2; // esi
  int v3; // eax
  _DWORD *v4; // edi
  int *v5; // eax
  int *v6; // eax
  int *v7; // eax

  v0 = script_pop();
  result = sub_511B60(v0);
  v2 = result;
  if ( result )
  {
    if ( *(_BYTE *)(result + 8) & 2 )
    {
      v3 = *(_DWORD *)(result + 16);
      if ( (v3 & 0x8000) == 0 )
      {
        v4 = *(_DWORD **)(v2 + 748);
        sub_50A3A0(v2);
        v5 = sub_50A260(v2, 32);
        if ( v5 )
          v5[1] = 37;
        v6 = sub_50A260(v2, 25);
        if ( v6 )
        {
          *((float *)v6 + 1) = *(float *)&byte_587000[8 * v4[94] + 194136] * 10.0 + *(float *)(v2 + 56);
          *((float *)v6 + 2) = *(float *)&byte_587000[8 * v4[94] + 194140] * 10.0 + *(float *)(v2 + 60);
        }
        v7 = sub_50A260(v2, 37);
        if ( v7 )
        {
          v7[1] = v4[95];
          v7[2] = v4[96];
          v7[3] = 0;
        }
        result = 0;
      }
      else
      {
        result = 0;
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (00512AC0) --------------------------------------------------------
int sub_512AC0()
{
  int v0; // esi
  int v1; // edi
  float2 *v2; // eax
  int v3; // eax
  float2 *v5; // [esp-Ch] [ebp-14h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = (float2 *)sub_579C40(v0);
  if ( v2 )
  {
    v5 = v2 + 1;
    v3 = sub_40AF50(*(void **)&byte_5D4594[4 * v1 + 3831212]);
    sub_501A30(v3, v5, 0, 0);
  }
  return 0;
}

//----- (00512B10) --------------------------------------------------------
int sub_512B10()
{
  int v0; // eax
  wchar_t *v1; // eax

  v0 = script_pop();
  if ( *(_DWORD *)&byte_5D4594[3821964] && *(_BYTE *)(*(_DWORD *)&byte_5D4594[3821964] + 8) & 4 )
  {
    v1 = sub_40F1D0(*(char **)&byte_5D4594[4 * v0 + 3831212], 0, (const char *)&byte_587000[246812], 1285);
    sub_4D9EB0(*(int *)&byte_5D4594[3821964], v1);
  }
  return 0;
}

//----- (00512B60) --------------------------------------------------------
int sub_512B60()
{
  int v0; // eax
  wchar_t *v1; // eax

  v0 = script_pop();
  v1 = sub_40F1D0(*(char **)&byte_5D4594[4 * v0 + 3831212], 0, (const char *)&byte_587000[246852], 1310);
  sub_4D9FD0(0, v1);
  return 0;
}

//----- (00512B90) --------------------------------------------------------
int sub_512B90()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  char *v3; // ecx
  wchar_t *v4; // eax
  int v6; // [esp+8h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = *(char **)&byte_5D4594[4 * v0 + 3831212];
    v6 = 0;
    v4 = sub_40F1D0(v3, &v6, (const char *)&byte_587000[246892], 1342);
    sub_528AC0(v2, v4, 0);
    if ( sub_40A5C0(2048) )
      sub_44D900(v6, 100);
  }
  return 0;
}

//----- (00512C10) --------------------------------------------------------
int sub_512C10()
{
  return 1;
}

//----- (00512C20) --------------------------------------------------------
int sub_512C20()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && (*(_BYTE *)(v1 + 8) & 0x80) )
  {
    *(_BYTE *)(*(_DWORD *)(v1 + 748) + 1) = 0;
    sub_501960(234, v1, 0, 0);
  }
  return 0;
}

//----- (00512C60) --------------------------------------------------------
int sub_512C60()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && (*(_BYTE *)(v1 + 8) & 0x80) )
  {
    *(_BYTE *)(*(_DWORD *)(v1 + 748) + 1) = 5;
    sub_501960(233, v1, 0, 0);
  }
  return 0;
}

//----- (00512CA0) --------------------------------------------------------
int sub_512CA0()
{
  int v0; // eax
  int v1; // eax
  int result; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && *(_DWORD *)(v1 + 16) & 0x1000000 )
  {
    sub_507230(1);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00512CE0) --------------------------------------------------------
int sub_512CE0()
{
  int v0; // eax
  _DWORD *v1; // eax
  int result; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 && v1[120] & 1 )
  {
    sub_507230(1);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00512D20) --------------------------------------------------------
int sub_512D20()
{
  int v0; // eax
  int v1; // eax
  int result; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && (*(_BYTE *)(v1 + 8) & 0x80) )
  {
    sub_507230(*(_BYTE *)(*(_DWORD *)(v1 + 748) + 1) != 0);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00512D70) --------------------------------------------------------
int sub_512D70()
{
  int v0; // esi
  int v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  *(float *)&v3 = sub_416030(*(float *)&v1, *(float *)&v0);
  sub_507230(v3);
  return 0;
}

//----- (00512DB0) --------------------------------------------------------
int sub_512DB0()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_415FA0(v1, v0);
  sub_507230(v2);
  return 0;
}

//----- (00512DE0) --------------------------------------------------------
int sub_512DE0()
{
  int v0; // esi
  int v1; // edi
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  sub_51ACA0(v2 * *(_DWORD *)&byte_5D4594[2649704], v0, v1);
  return 0;
}

//----- (00512E10) --------------------------------------------------------
int sub_512E10()
{
  int v0; // esi
  int v1; // edi
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  sub_51ACA0(v2, v0, v1);
  return 0;
}

//----- (00512E40) --------------------------------------------------------
int __cdecl sub_512E40(char *a1)
{
  char *v1; // eax
  int v2; // ecx

  if ( *(_DWORD *)&byte_5D4594[1599632] >= 1024 )
    return *(_DWORD *)&byte_5D4594[1599632] - 1;
  v1 = _strdup(a1);
  v2 = *(_DWORD *)&byte_5D4594[1599632];
  *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[1599632] + 3831212] = v1;
  *(_DWORD *)&byte_5D4594[1599632] = v2 + 1;
  return v2;
}

//----- (00512E80) --------------------------------------------------------
int __cdecl sub_512E80(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[1599628];
  if ( *(int *)&byte_5D4594[1599628] < 1024 )
  {
    *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[1599628] + 3826092] = a1;
    *(_DWORD *)&byte_5D4594[1599628] = ++v1;
  }
  return v1 - 1;
}

//----- (00512EA0) --------------------------------------------------------
int sub_512EA0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  _itoa(v0, (char *)&byte_5D4594[3821708], 10);
  v1 = sub_512E40((char *)&byte_5D4594[3821708]);
  sub_507230(v1);
  return 0;
}

//----- (00512ED0) --------------------------------------------------------
int sub_512ED0()
{
  float v0; // eax
  int v1; // eax

  v0 = COERCE_FLOAT(script_pop());
  nox_sprintf((char *)&byte_5D4594[3821708], (const char *)&byte_587000[247012], v0, v0);
  v1 = sub_512E40((char *)&byte_5D4594[3821708]);
  sub_507230(v1);
  return 0;
}

//----- (00512F10) --------------------------------------------------------
int sub_512F10()
{
  int v0; // esi
  int v1; // edi
  float *v2; // esi
  _DWORD *v3; // eax
  _DWORD *v4; // edi

  v0 = script_pop();
  v1 = script_pop();
  v2 = (float *)sub_579C40(v0);
  if ( v2 )
  {
    v3 = sub_4E3810(*(CHAR **)&byte_5D4594[4 * v1 + 3831212]);
    v4 = v3;
    if ( !v3 )
    {
      sub_507230(0);
      return 0;
    }
    sub_4DAA50((int)v3, 0, v2[2], v2[3]);
    sub_507230(v4[11]);
  }
  return 0;
}

//----- (00512F80) --------------------------------------------------------
int sub_512F80()
{
  int v0; // edi
  int v1; // ebx
  int v2; // ebp
  int v3; // eax
  int v4; // esi
  int v6[3]; // [esp+10h] [ebp-Ch]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = script_pop();
  v4 = sub_511B60(v3);
  if ( v4 )
  {
    v6[0] = sub_511B60(v2);
    v6[1] = v1;
    v6[2] = v0;
    sub_512FE0(v4, v6);
  }
  return 0;
}

//----- (00512FE0) --------------------------------------------------------
void __cdecl sub_512FE0(int a1, int *a2)
{
  int v2; // eax
  int v3; // [esp-Ch] [ebp-Ch]
  int v4; // [esp-8h] [ebp-8h]
  int v5; // [esp-4h] [ebp-4h]

  if ( a2[1] > 0 )
  {
    v5 = a2[2];
    v4 = a2[1];
    v3 = *a2;
    v2 = sub_4EC580(*a2);
    (*(void (__cdecl **)(int, int, int, int, int))(a1 + 716))(a1, v2, v3, v4, v5);
  }
}

//----- (00513010) --------------------------------------------------------
int sub_513010()
{
  int v0; // esi
  int v1; // edi
  int v2; // ebx
  int v3; // ebp
  unsigned __int8 *v4; // eax
  int v6[3];

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = script_pop();
  v6[0] = sub_511B60(v2);
  v6[1] = v1;
  v6[2] = v0;
  v4 = (unsigned __int8 *)sub_57C0A0(v3);
  sub_502670(v4, 0, (void (__cdecl *)(int, int))sub_512FE0, (int)v6);
  return 0;
}

//----- (00513070) --------------------------------------------------------
int sub_513070()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  float v4; // [esp+8h] [ebp-10h]
  int v5[3]; // [esp+Ch] [ebp-Ch]

  v4 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v5[1] = v0;
    v5[0] = (__int64)v4;
    sub_5130E0(v2, v5);
    sub_507230(v5[2]);
  }
  else
  {
    sub_507230(0);
  }
  return 0;
}

//----- (005130E0) --------------------------------------------------------
_DWORD *__cdecl sub_5130E0(int a1, _DWORD *a2)
{
  _DWORD *v2; // eax
  _DWORD *v3; // esi
  _DWORD *result; // eax
  int v5; // eax

  v2 = sub_4E3810((CHAR *)&byte_587000[247016]);
  v3 = v2;
  if ( v2 )
  {
    sub_4DAA50((int)v2, 0, *(float *)(a1 + 56), *(float *)(a1 + 60));
    v5 = v3[187];
    *(_DWORD *)(v5 + 28) = a1;
    *(_DWORD *)(v5 + 8) = a2[1];
    *(_DWORD *)(v5 + 4) = *a2;
    *(_BYTE *)v5 = 0;
    v3[20] = 0;
    v3[21] = 0;
    sub_4E75B0((int)v3);
    sub_4DA8D0((int)v3);
    result = (_DWORD *)v3[11];
    a2[2] = result;
  }
  else
  {
    result = a2;
    a2[2] = 0;
  }
  return result;
}

//----- (00513160) --------------------------------------------------------
int sub_513160()
{
  int v0; // esi
  int v1; // edi
  unsigned __int8 *v2; // eax
  float v4; // [esp+8h] [ebp-10h]
  int v5[3]; // [esp+Ch] [ebp-Ch]

  v4 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = script_pop();
  v5[1] = v0;
  v5[0] = (__int64)v4;
  v2 = (unsigned __int8 *)sub_57C0A0(v1);
  sub_502670(v2, 0, (void (__cdecl *)(int, int))sub_5130E0, (int)v5);
  return 0;
}

//----- (005131C0) --------------------------------------------------------
int sub_5131C0()
{
  int v0; // esi
  int v1; // edi
  int v2; // esi
  int result; // eax
  int v4; // eax
  int v5; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_4243F0(*(const char **)&byte_5D4594[4 * v0 + 3831212]);
  if ( v2 )
  {
    v4 = sub_511B60(v1);
    if ( v4 )
    {
      v5 = sub_4FB550(v4, v2, 1, 0, 0);
      sub_507230(v5);
    }
    else
    {
      sub_507230(0);
    }
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00513230) --------------------------------------------------------
int sub_513230()
{
  int v0; // esi
  int v1; // edi
  unsigned __int8 *v2; // eax
  int v4; // [esp+8h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v4 = sub_4243F0(*(const char **)&byte_5D4594[4 * v0 + 3831212]);
  if ( v4 )
  {
    v2 = (unsigned __int8 *)sub_57C0A0(v1);
    sub_502670(v2, 0, (void (__cdecl *)(int, int))sub_513280, (int)&v4);
  }
  return 0;
}

//----- (00513280) --------------------------------------------------------
int __cdecl sub_513280(int a1, int *a2)
{
  int v2; // esi

  v2 = 0;
  if ( sub_40A5C0(2048)
    && *(_BYTE *)(a1 + 8) & 4
    && !*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 4 * *a2 + 3696) )
  {
    v2 = 1;
  }
  return sub_4FB550(a1, *a2, 1, v2, 0);
}

//----- (005132E0) --------------------------------------------------------
int sub_5132E0()
{
  int v0; // esi
  int v1; // ebx
  int v2; // esi
  int v3; // edi
  float v5; // [esp+Ch] [ebp-54h]
  int v6[2]; // [esp+18h] [ebp-48h]
  char v8[64]; // [esp+20h] [ebp-40h]

  v5 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = script_pop();
  strcpy(v8, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  v2 = sub_424880(v8);
  if ( v2 != -1 )
  {
    v3 = sub_511B60(v1);
    if ( v3 )
    {
      v6[0] = v2;
      v6[1] = (__int64)((double)*(unsigned int *)&byte_5D4594[2649704] * v5);
      sub_513390(v3, v6);
    }
  }
  return 0;
}

//----- (00513390) --------------------------------------------------------
__int16 __cdecl sub_513390(int a1, int *a2)
{
  return sub_4FF380(a1, *a2, a2[1], 5);
}

//----- (005133B0) --------------------------------------------------------
int sub_5133B0()
{
  int v0; // esi
  int v1; // ebx
  int v2; // eax
  unsigned __int8 *v3; // eax
  float v5; // [esp+Ch] [ebp-54h]
  int v6[2]; // [esp+18h] [ebp-48h]
  char v7[64]; // [esp+20h] [ebp-40h]

  v5 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = script_pop();
  strcpy(v7, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  v2 = sub_424880(v7);
  if ( v2 != -1 )
  {
    v6[0] = v2;
    v6[1] = (__int64)((double)*(unsigned int *)&byte_5D4594[2649704] * v5);
    v3 = (unsigned __int8 *)sub_57C0A0(v1);
    sub_502670(v3, 0, (void (__cdecl *)(int, int))sub_513390, (int)v6);
  }
  return 0;
}

//----- (00513460) --------------------------------------------------------
int sub_513460()
{
  int v0; // eax

  v0 = *((_DWORD *)sub_417090(31) + 514);
  if ( v0 )
    sub_507230(*(_DWORD *)(v0 + 44));
  else
    sub_507230(0);
  return 0;
}

//----- (00513490) --------------------------------------------------------
int sub_513490()
{
  int v0; // eax
  char v2[76]; // [esp+4h] [ebp-4Ch]

  strcpy(v2, *(const char **)&byte_5D4594[4 * script_pop() + 3831212]);
  strcat(v2, (const char *)&byte_5D4594[3821644]);
  v0 = sub_4DA4F0(v2);
  if ( v0 )
    sub_507230(*(_DWORD *)(v0 + 44));
  else
    sub_507230(0);
  return 0;
}

//----- (00513530) --------------------------------------------------------
int sub_513530()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_507230(*(_DWORD *)(v1 + 56));
  else
    sub_507230(0);
  return 0;
}

//----- (00513570) --------------------------------------------------------
int sub_513570()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 )
    sub_507230(v1[2]);
  else
    sub_507230(0);
  return 0;
}

//----- (005135B0) --------------------------------------------------------
int sub_5135B0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_507230(*(_DWORD *)(v1 + 60));
  else
    sub_507230(0);
  return 0;
}

//----- (005135F0) --------------------------------------------------------
int sub_5135F0()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = sub_579C40(v0);
  if ( v1 )
    sub_507230(v1[3]);
  else
    sub_507230(0);
  return 0;
}

//----- (00513630) --------------------------------------------------------
int sub_513630()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_507230(*(_DWORD *)(v1 + 104));
  else
    sub_507230(0);
  return 0;
}

//----- (00513670) --------------------------------------------------------
int sub_513670()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_507230(*(__int16 *)(v1 + 124));
  else
    sub_507230(0);
  return 0;
}

//----- (005136A0) --------------------------------------------------------
int sub_5136A0()
{
  int v0; // eax
  int v1; // eax
  float2 v3; // [esp+0h] [ebp-Ch]
  float v4; // [esp+8h] [ebp-4h]

  v4 = COERCE_FLOAT(script_pop());
  LODWORD(v3.field_0) = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v3.field_0 = (double)*(int *)&byte_5D4594[3821636] + v3.field_0;
    v3.field_4 = (double)*(int *)&byte_5D4594[3821640] + v4;
    sub_4E7010(v1, &v3);
  }
  return 0;
}

//----- (00513700) --------------------------------------------------------
int sub_513700()
{
  int v0; // eax
  float *v1; // eax
  float v3; // [esp+0h] [ebp-8h]
  float v4; // [esp+4h] [ebp-4h]

  v4 = COERCE_FLOAT(script_pop());
  v3 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = (float *)sub_579C40(v0);
  if ( v1 )
  {
    v1[2] = (double)*(int *)&byte_5D4594[3821636] + v3;
    v1[3] = (double)*(int *)&byte_5D4594[3821640] + v4;
  }
  return 0;
}

//----- (00513750) --------------------------------------------------------
int sub_513750()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_4E46F0(v2, *(float *)&v0);
  return 0;
}

//----- (00513780) --------------------------------------------------------
int sub_513780()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax
  unsigned int v3; // ecx

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = v0;
    if ( v0 < 0 )
      v3 = v0 + ((unsigned int)(255 - v0) >> 8 << 8);
    if ( (int)v3 >= 256 )
      LOWORD(v3) = -256 * (v3 >> 8) + v3;
    *(_WORD *)(v2 + 126) = v3;
    *(_WORD *)(v2 + 124) = v3;
  }
  return 0;
}

//----- (005137D0) --------------------------------------------------------
int sub_5137D0()
{
  int v0; // eax
  int v1; // eax
  float v3; // [esp+0h] [ebp-8h]
  float v4; // [esp+4h] [ebp-4h]

  v4 = COERCE_FLOAT(script_pop());
  v3 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    *(float *)(v1 + 88) = v3 + *(float *)(v1 + 88);
    *(float *)(v1 + 92) = v4 + *(float *)(v1 + 92);
  }
  return 0;
}

//----- (00513820) --------------------------------------------------------
int sub_513820()
{
  int v0; // eax
  float *v1; // eax
  double v2; // st7
  double v3; // st6
  float v5; // [esp+0h] [ebp-Ch]
  float v6; // [esp+0h] [ebp-Ch]
  float v7; // [esp+4h] [ebp-8h]
  float v8; // [esp+8h] [ebp-4h]
  float v9; // [esp+8h] [ebp-4h]

  v5 = COERCE_FLOAT(script_pop());
  v8 = COERCE_FLOAT(script_pop());
  v7 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = (float *)sub_511B60(v0);
  if ( v1 )
  {
    v2 = v1[14] - v8 + (double)*(int *)&byte_5D4594[3821636];
    v3 = v1[15] - v5 + (double)*(int *)&byte_5D4594[3821640];
    v6 = v3;
    v9 = sqrt(v3 * v6 + v2 * v2);
    v1[22] = v7 * v2 / v9 + v1[22];
    v1[23] = v7 * v6 / v9 + v1[23];
  }
  return 0;
}

//----- (005138B0) --------------------------------------------------------
int sub_5138B0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax
  int v3; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 504);
    if ( v3 )
      v1 = *(_DWORD *)(v3 + 44);
  }
  sub_507230(v1);
  return 0;
}

//----- (005138E0) --------------------------------------------------------
int sub_5138E0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax
  int v3; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 496);
    if ( v3 )
      v1 = *(_DWORD *)(v3 + 44);
  }
  sub_507230(v1);
  return 0;
}

//----- (00513910) --------------------------------------------------------
int sub_513910()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // edi

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  v4 = 0;
  if ( v2 && v3 && sub_4F78E0(v2, v3) )
    v4 = 1;
  sub_507230(v4);
  return 0;
}

//----- (00513960) --------------------------------------------------------
int sub_513960()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_507230(*(_DWORD *)(*(_DWORD *)(v1 + 492) + 44));
  else
    sub_507230(0);
  return 0;
}

//----- (005139A0) --------------------------------------------------------
int sub_5139A0()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // ebp
  int v5; // eax
  int v6; // edi

  if ( !*(_DWORD *)&byte_5D4594[2386860] )
  {
    *(_DWORD *)&byte_5D4594[2386860] = sub_4E3AA0((CHAR *)&byte_587000[247024]);
    *(_DWORD *)&byte_5D4594[2386864] = sub_4E3AA0((CHAR *)&byte_587000[247032]);
    *(_DWORD *)&byte_5D4594[2386868] = sub_4E3AA0((CHAR *)&byte_587000[247048]);
  }
  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  v4 = v3;
  if ( v2 && v3 )
  {
    if ( sub_40A5C0(2048)
      && (*(_BYTE *)(v2 + 8) & 4) == 4
      && *(_DWORD *)&byte_5D4594[2386844] != *(_DWORD *)&byte_5D4594[2598000] )
    {
      *(_DWORD *)&byte_5D4594[2386844] = *(_DWORD *)&byte_5D4594[2598000];
      *(_DWORD *)&byte_5D4594[2386848] = 0;
      *(_DWORD *)&byte_5D4594[2386852] = 0;
    }
    if ( *(_BYTE *)(v2 + 8) & 4 )
    {
      if ( sub_40A5C0(2048) )
      {
        v5 = *(unsigned __int16 *)(v2 + 4);
        if ( (unsigned __int16)v5 != *(_DWORD *)&byte_5D4594[2386860]
          && v5 != *(_DWORD *)&byte_5D4594[2386864]
          && v5 != *(_DWORD *)&byte_5D4594[2386868] )
        {
          sub_513B00(v2, v4);
        }
      }
    }
    v6 = sub_4F36F0(v2, v4, 1, 1);
    if ( v6 == 1
      && *(_BYTE *)(v2 + 8) & 4
      && sub_40A5C0(2048)
      && *(unsigned __int16 *)(v4 + 4) != *(_DWORD *)&byte_5D4594[2386860] )
    {
      ++*(_DWORD *)&byte_5D4594[2386848];
      sub_507230(1);
      return 0;
    }
  }
  else
  {
    v6 = 0;
  }
  sub_507230(v6);
  return 0;
}

//----- (00513B00) --------------------------------------------------------
void __cdecl sub_513B00(int a1, int a2)
{
  _DWORD *v2; // ebp
  int v3; // edi
  int v4; // esi
  int v5; // eax
  int v6; // eax
  float2 v7; // [esp+0h] [ebp-8h]

  if ( !*(_DWORD *)&byte_5D4594[2386856] )
    *(_DWORD *)&byte_5D4594[2386856] = sub_4E3AA0((CHAR *)&byte_587000[247064]);
  if ( sub_467B00(*(unsigned __int16 *)(a2 + 4), 1) - *(int *)&byte_5D4594[2386848] <= 0 )
  {
    v2 = 0;
    v3 = 999999;
    v4 = sub_4E7980(a1);
    if ( v4 )
    {
      do
      {
        if ( !(*(_BYTE *)(v4 + 8) & 0x10) )
        {
          v5 = *(_DWORD *)(v4 + 16);
          if ( !(v5 & 0x100) && *(unsigned __int16 *)(v4 + 4) != *(_DWORD *)&byte_5D4594[2386856] && !sub_53EBF0(v4) )
          {
            v6 = sub_50E3D0(1, 0, *(float *)&v4);
            if ( v6 < v3 )
            {
              v3 = v6;
              v2 = (_DWORD *)v4;
            }
          }
        }
        v4 = sub_4E7990(v4);
      }
      while ( v4 );
      if ( v2 )
      {
        sub_4ED970(50.0, (float2 *)(a1 + 56), &v7);
        sub_4ED790(a1, v2, &v7);
        if ( !*(_DWORD *)&byte_5D4594[2386852] )
        {
          sub_4DA2C0(a1, (const char *)&byte_587000[247072], 0);
          *(_DWORD *)&byte_5D4594[2386852] = 1;
        }
      }
    }
  }
}

//----- (00513C10) --------------------------------------------------------
int sub_513C10()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  _DWORD *v3; // eax
  int v4; // eax
  int result; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = (_DWORD *)sub_511B60(v0);
  if ( v2 && v3 )
  {
    v4 = sub_4ED930(v2, v3);
    sub_507230(v4);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00513C60) --------------------------------------------------------
int sub_513C60()
{
  return 0;
}

//----- (00513C70) --------------------------------------------------------
int sub_513C70()
{
  int v0; // esi
  int v1; // ebx
  int v2; // eax
  char v3; // si
  int v4; // eax
  int v5; // eax
  int result; // eax
  char v7[64]; // [esp+Ch] [ebp-40h]

  v0 = script_pop();
  v1 = script_pop();
  strcpy(v7, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  v2 = sub_424880(v7);
  v3 = v2;
  if ( v2 != -1 && (v4 = sub_511B60(v1)) != 0 )
  {
    v5 = sub_4FF350(v4, v3);
    sub_507230(v5);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00513D00) --------------------------------------------------------
int sub_513D00()
{
  int v0; // esi
  int v1; // ebx
  int v2; // esi
  int v3; // eax
  char v5[64]; // [esp+Ch] [ebp-40h]

  v0 = script_pop();
  v1 = script_pop();
  strcpy(v5, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  v2 = sub_424880(v5);
  if ( v2 != -1 )
  {
    v3 = sub_511B60(v1);
    if ( v3 )
      sub_4FF5B0(v3, v2);
  }
  return 0;
}

//----- (00513D70) --------------------------------------------------------
int sub_513D70()
{
  int v0; // eax
  int v1; // eax
  unsigned __int16 *v2; // ecx
  int result; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && (v2 = *(unsigned __int16 **)(v1 + 556)) != 0 )
  {
    sub_507230(*v2);
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00513DB0) --------------------------------------------------------
int sub_513DB0()
{
  int v0; // eax
  int v1; // eax
  int v2; // ecx
  int result; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 && (v2 = *(_DWORD *)(v1 + 556)) != 0 )
  {
    sub_507230(*(unsigned __int16 *)(v2 + 4));
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (00513DF0) --------------------------------------------------------
int sub_513DF0()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 && v0 > 0 )
    sub_4EE460(v2, v0);
  return 0;
}

//----- (00513E20) --------------------------------------------------------
int sub_513E20()
{
  float v0; // eax
  float v2; // [esp+4h] [ebp-Ch]
  float v3; // [esp+8h] [ebp-8h]
  float v4; // [esp+Ch] [ebp-4h]
  int v5; // [esp+Ch] [ebp-4h]

  v4 = COERCE_FLOAT(script_pop());
  v2 = COERCE_FLOAT(script_pop());
  v3 = COERCE_FLOAT(script_pop());
  v0 = COERCE_FLOAT(script_pop());
  *(float *)&v5 = sqrt((v3 - v4) * (v3 - v4) + (v0 - v2) * (v0 - v2));
  sub_507230(v5);
  return 0;
}

//----- (00513E80) --------------------------------------------------------
int sub_513E80()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // edx
  double v5; // st7
  double v6; // st7

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  v4 = 0;
  if ( v2 && v3 )
  {
    v5 = *(float *)(v2 + 56) - *(float *)(v3 + 56);
    if ( v5 < 0.0 )
      v5 = -v5;
    if ( v5 <= 512.0 )
    {
      v6 = *(float *)(v2 + 60) - *(float *)(v3 + 60);
      if ( v6 < 0.0 )
        v6 = -v6;
      if ( v6 <= 512.0 )
        v4 = sub_5370E0(v2, v3, 0);
    }
  }
  sub_507230(v4);
  return 0;
}

//----- (00513F10) --------------------------------------------------------
int sub_513F10()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F20) --------------------------------------------------------
int sub_513F20()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F30) --------------------------------------------------------
int sub_513F30()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F40) --------------------------------------------------------
int sub_513F40()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F50) --------------------------------------------------------
int sub_513F50()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F60) --------------------------------------------------------
int sub_513F60()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00513F70) --------------------------------------------------------
int sub_513F70()
{
  int v0; // eax
  wchar_t *v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = sub_40F1D0(*(char **)&byte_5D4594[4 * v0 + 3831212], 0, (const char *)&byte_587000[247100], 2901);
  v2 = sub_512E80((int)v1);
  sub_507230(v2);
  return 0;
}

//----- (00513FA0) --------------------------------------------------------
int sub_513FA0()
{
  int v0; // esi
  char *v1; // eax
  int result; // eax

  v0 = script_pop();
  v1 = sub_431770();
  switch ( v0 )
  {
    case 0:
      sub_507230(*(_DWORD *)(v1 + 50));
      result = 0;
      break;
    case 1:
      sub_507230(*(_DWORD *)(v1 + 54));
      result = 0;
      break;
    case 2:
      sub_507230(*(_DWORD *)(v1 + 58));
      result = 0;
      break;
    case 3:
      sub_507230(*(_DWORD *)(v1 + 62));
      result = 0;
      break;
    case 4:
      sub_507230((unsigned __int8)v1[66]);
      result = 0;
      break;
    case 5:
      sub_507230((unsigned __int8)v1[67]);
      result = 0;
      break;
    default:
      sub_507230(0);
      result = 0;
      break;
  }
  return result;
}

//----- (00514050) --------------------------------------------------------
int sub_514050()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  __int16 v4; // ax
  float2 v6; // [esp+8h] [ebp-8h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  if ( v2 && v3 )
  {
    v6.field_0 = *(float *)(v3 + 56) - *(float *)(v2 + 56);
    v6.field_4 = *(float *)(v3 + 60) - *(float *)(v2 + 60);
    v4 = sub_509ED0(&v6);
    *(_WORD *)(v2 + 126) = v4;
    *(_WORD *)(v2 + 124) = v4;
  }
  return 0;
}

//----- (005140B0) --------------------------------------------------------
int sub_5140B0()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-10h]
  int v4; // [esp+4h] [ebp-Ch]
  float v5; // [esp+8h] [ebp-8h]
  float v6; // [esp+Ch] [ebp-4h]

  v5 = COERCE_FLOAT(script_pop());
  v6 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    *(float *)&v4 = (double)*(int *)&byte_5D4594[3821640] + v5;
    *(float *)&v3 = (double)*(int *)&byte_5D4594[3821636] + v6;
    sub_514110(v1, v3, v4);
  }
  return 0;
}

//----- (00514110) --------------------------------------------------------
int *__cdecl sub_514110(int a1, int a2, int a3)
{
  int *result; // eax
  int *v4; // eax

  result = *(int **)(a1 + 16);
  if ( SBYTE1(result) >= 0 && *(_BYTE *)(a1 + 8) & 2 )
  {
    sub_50A3A0(a1);
    v4 = sub_50A260(a1, 32);
    if ( v4 )
      v4[1] = 8;
    result = sub_50A260(a1, 8);
    if ( result )
    {
      result[1] = a2;
      result[2] = a3;
      result[3] = 0;
    }
  }
  return result;
}

//----- (00514170) --------------------------------------------------------
int sub_514170()
{
  int v0; // eax
  int result; // eax
  int *i; // esi
  int v3; // eax
  int v4; // [esp+0h] [ebp-14h]
  int v5; // [esp+4h] [ebp-10h]
  float v6; // [esp+Ch] [ebp-8h]
  float v7; // [esp+10h] [ebp-4h]

  v6 = COERCE_FLOAT(script_pop());
  v7 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  result = sub_57C0A0(v0);
  if ( result )
  {
    for ( i = *(int **)(result + 84); i; i = (int *)i[2] )
    {
      v3 = sub_4ED020(*i);
      if ( v3 )
      {
        *(float *)&v5 = (double)*(int *)&byte_5D4594[3821640] + v6;
        *(float *)&v4 = (double)*(int *)&byte_5D4594[3821636] + v7;
        sub_514110(v3, v4, v5);
      }
    }
    result = 0;
  }
  return result;
}

//----- (005141F0) --------------------------------------------------------
int sub_5141F0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_51AD60(v0);
  sub_507230(v1 != 0);
  return 0;
}

//----- (00514210) --------------------------------------------------------
int sub_514210()
{
  int v0; // ebp
  const char *v1; // edi
  const char *v2; // esi
  unsigned int v3; // ebx
  char *v4; // edi
  char *v5; // edi
  const char *v6; // esi
  char v7; // cl
  char v8; // bl
  char v9; // si
  int result; // eax
  int v11; // eax
  char v12; // al
  unsigned __int8 v13; // [esp+10h] [ebp-68h]
  float v14; // [esp+14h] [ebp-64h]
  float v15; // [esp+18h] [ebp-60h]
  int v16; // [esp+1Ch] [ebp-5Ch]
  float2 v17; // [esp+20h] [ebp-58h]
  int v19[4]; // [esp+28h] [ebp-50h]
  char v20[64]; // [esp+38h] [ebp-40h]

  v16 = script_pop();
  v0 = script_pop();
  v15 = COERCE_FLOAT(script_pop());
  v14 = COERCE_FLOAT(script_pop());
  v1 = *(const char **)&byte_5D4594[4 * script_pop() + 3831212];
  strcpy(v20, "MSG_FX_");
  v17.field_0 = (double)*(int *)&byte_5D4594[3821636] + v14;
  v17.field_4 = (double)*(int *)&byte_5D4594[3821640] + v15;
  v2 = v1;
  v3 = strlen(v1) + 1;
  v4 = &v20[strlen(v20)];
  qmemcpy(v4, v2, 4 * (v3 >> 2));
  v6 = &v2[4 * (v3 >> 2)];
  v5 = &v4[4 * (v3 >> 2)];
  v7 = v3;
  v8 = 87;
  v13 = 87;
  qmemcpy(v5, v6, v7 & 3);
  do
  {
    if ( !_strcmpi(*(const char **)&byte_587000[4 * v13 + 238648], v20) )
      break;
    v13 = ++v8;
  }
  while ( (unsigned __int8)v8 <= 0x73u );
  v9 = v8 + 39;
  switch ( (unsigned __int8)(v8 + 39) )
  {
    case 0x81u:
    case 0x82u:
    case 0x83u:
    case 0x84u:
    case 0x85u:
    case 0x86u:
    case 0x87u:
    case 0x88u:
    case 0x89u:
    case 0x8Au:
    case 0x8Bu:
    case 0x96u:
    case 0x9Au:
    case 0xA0u:
    case 0xA3u:
      sub_522FF0(v8 + 39, &v17);
      result = 0;
      break;
    case 0x8Cu:
    case 0x8Fu:
    case 0x90u:
    case 0x91u:
    case 0x94u:
    case 0x95u:
      v19[0] = *(_DWORD *)&byte_5D4594[3821636] + sub_419A70(v14);
      v19[1] = *(_DWORD *)&byte_5D4594[3821640] + sub_419A70(v15);
      v19[2] = *(_DWORD *)&byte_5D4594[3821636] + sub_419A70(*(float *)&v0);
      v19[3] = *(_DWORD *)&byte_5D4594[3821640] + sub_419A70(*(float *)&v16);
      sub_5232F0(v9, (int)v19);
      result = 0;
      break;
    case 0x93u:
      v12 = sub_419AD0(*(float *)&v0);
      sub_5231B0(&v17, v12);
      goto LABEL_11;
    case 0x97u:
      v11 = sub_419A70(*(float *)&v0);
      sub_4D9110(&v17, v11);
      result = 0;
      break;
    case 0x98u:
      sub_523790((int4 *)v19, 30);
      result = 0;
      break;
    case 0xA2u:
      v19[0] = *(_DWORD *)&byte_5D4594[3821636] + sub_419A70(v14);
      v19[1] = *(_DWORD *)&byte_5D4594[3821640] + sub_419A70(v15);
      v19[2] = *(_DWORD *)&byte_5D4594[3821636] + sub_419A70(*(float *)&v0);
      v19[3] = *(_DWORD *)&byte_5D4594[3821640] + sub_419A70(*(float *)&v16);
      sub_523270(v9, (__int16 *)v19, 100);
      result = 0;
      break;
    default:
LABEL_11:
      result = 0;
      break;
  }
  return result;
}

//----- (00514490) --------------------------------------------------------
int sub_514490()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  int v3; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  sub_4EC290(v2, v3);
  return 0;
}

//----- (005144C0) --------------------------------------------------------
int sub_5144C0()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  int v3; // eax
  int *i; // esi
  int v5; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_57C0A0(v0);
  if ( v3 )
  {
    for ( i = *(int **)(v3 + 84); i; i = (int *)i[2] )
    {
      v5 = sub_4ED020(*i);
      if ( v5 )
        sub_4EC290(v2, v5);
    }
  }
  return 0;
}

//----- (00514510) --------------------------------------------------------
int sub_514510()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int *v4; // esi
  int i; // edi
  int v6; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_57C0A0(v1);
  if ( v2 )
  {
    v3 = sub_511B60(v0);
    v4 = *(int **)(v2 + 84);
    for ( i = v3; v4; v4 = (int *)v4[2] )
    {
      v6 = sub_4ED020(*v4);
      if ( v6 )
        sub_4EC290(v6, i);
    }
  }
  return 0;
}

//----- (00514570) --------------------------------------------------------
int sub_514570()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // ebp
  int *i; // edi
  int v6; // ebx
  int *j; // esi
  int v8; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_57C0A0(v1);
  v3 = sub_57C0A0(v0);
  v4 = v3;
  if ( v2 )
  {
    if ( v3 )
    {
      for ( i = *(int **)(v2 + 84); i; i = (int *)i[2] )
      {
        v6 = sub_4ED020(*i);
        if ( v6 )
        {
          for ( j = *(int **)(v4 + 84); j; j = (int *)j[2] )
          {
            v8 = sub_4ED020(*j);
            if ( v8 )
              sub_4EC290(v6, v8);
          }
        }
      }
    }
  }
  return 0;
}

//----- (005145F0) --------------------------------------------------------
int sub_5145F0()
{
  int v0; // esi
  int v1; // edi
  int v2; // esi
  int v3; // eax
  int v4; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v0);
  v3 = sub_511B60(v1);
  v4 = sub_4EC4F0(v3, v2);
  sub_507230(v4);
  return 0;
}

//----- (00514630) --------------------------------------------------------
int sub_514630()
{
  int v0; // esi
  int v1; // edi
  int result; // eax
  int v3; // esi
  int v4; // eax
  int *v5; // esi
  int v6; // edi
  int v7; // ebx
  int v8; // eax

  v0 = script_pop();
  v1 = script_pop();
  result = sub_57C0A0(v0);
  v3 = result;
  if ( result )
  {
    v4 = sub_511B60(v1);
    v5 = *(int **)(v3 + 84);
    v6 = v4;
    v7 = 1;
    if ( v5 )
    {
      while ( 1 )
      {
        v8 = sub_4ED020(*v5);
        if ( v8 )
        {
          if ( !sub_4EC4F0(v6, v8) )
            break;
        }
        v5 = (int *)v5[2];
        if ( !v5 )
        {
          sub_507230(1);
          return 0;
        }
      }
      v7 = 0;
    }
    sub_507230(v7);
    result = 0;
  }
  return result;
}

//----- (005146B0) --------------------------------------------------------
int sub_5146B0()
{
  int v0; // edi
  int v1; // eax
  int result; // eax
  int v3; // esi
  int v4; // eax
  int *v5; // esi
  int v6; // edi
  int v7; // ebx
  int v8; // eax

  v0 = script_pop();
  v1 = script_pop();
  result = sub_57C0A0(v1);
  v3 = result;
  if ( result )
  {
    v4 = sub_511B60(v0);
    v5 = *(int **)(v3 + 84);
    v6 = v4;
    v7 = 1;
    if ( v5 )
    {
      while ( 1 )
      {
        v8 = sub_4ED020(*v5);
        if ( v8 )
        {
          if ( !sub_4EC4F0(v8, v6) )
            break;
        }
        v5 = (int *)v5[2];
        if ( !v5 )
        {
          sub_507230(1);
          return 0;
        }
      }
      v7 = 0;
    }
    sub_507230(v7);
    result = 0;
  }
  return result;
}

//----- (00514730) --------------------------------------------------------
int sub_514730()
{
  int v0; // esi
  int v1; // edi
  int v2; // esi
  int v3; // eax
  int *v4; // ebx
  int i; // ebp
  int v6; // edi
  int *v7; // esi
  int v8; // eax
  int v10; // [esp+8h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_57C0A0(v0);
  v3 = sub_57C0A0(v1);
  v10 = v3;
  if ( !v2 || !v3 )
    return 0;
  v4 = *(int **)(v2 + 84);
  for ( i = 1; v4; v4 = (int *)v4[2] )
  {
    if ( !i )
      break;
    v6 = sub_4ED020(*v4);
    if ( v6 )
    {
      v7 = *(int **)(v10 + 84);
      if ( v7 )
      {
        while ( 1 )
        {
          v8 = sub_4ED020(*v7);
          if ( v8 )
          {
            if ( !sub_4EC4F0(v8, v6) )
              break;
          }
          v7 = (int *)v7[2];
          if ( !v7 )
            goto LABEL_12;
        }
        i = 0;
      }
    }
LABEL_12:
    ;
  }
  sub_507230(i);
  return 0;
}

//----- (005147E0) --------------------------------------------------------
int sub_5147E0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  sub_4EC300(v1);
  return 0;
}

//----- (00514800) --------------------------------------------------------
int sub_514800()
{
  int *v0; // eax
  char v2[76]; // [esp+4h] [ebp-4Ch]

  strcpy(v2, *(const char **)&byte_5D4594[4 * script_pop() + 3831212]);
  strcat(v2, (const char *)&byte_5D4594[3821644]);
  v0 = (int *)sub_579E30(v2);
  if ( v0 )
    sub_507230(*v0);
  else
    sub_507230(0);
  return 0;
}

//----- (005148A0) --------------------------------------------------------
int sub_5148A0()
{
  int v0; // eax
  char v2[76]; // [esp+4h] [ebp-4Ch]

  strcpy(v2, *(const char **)&byte_5D4594[4 * script_pop() + 3831212]);
  strcat(v2, (const char *)&byte_5D4594[3821644]);
  v0 = sub_57C280(v2, 1);
  if ( v0 )
    sub_507230(*(_DWORD *)(v0 + 4));
  else
    sub_507230(0);
  return 0;
}

//----- (00514940) --------------------------------------------------------
int sub_514940()
{
  int v0; // eax
  char v2[76]; // [esp+4h] [ebp-4Ch]

  strcpy(v2, *(const char **)&byte_5D4594[4 * script_pop() + 3831212]);
  strcat(v2, (const char *)&byte_5D4594[3821644]);
  v0 = sub_57C280(v2, 0);
  if ( v0 )
    sub_507230(*(_DWORD *)(v0 + 4));
  else
    sub_507230(0);
  return 0;
}

//----- (005149E0) --------------------------------------------------------
int sub_5149E0()
{
  int v0; // eax
  char v2[76];

  strcpy(v2, *(const char **)&byte_5D4594[4 * script_pop() + 3831212]);
  strcat(v2, (const char *)&byte_5D4594[3821644]);
  v0 = sub_57C280(v2, 2);
  if ( v0 )
    sub_507230(*(_DWORD *)(v0 + 4));
  else
    sub_507230(0);
  return 0;
}

//----- (00514A80) --------------------------------------------------------
int sub_514A80()
{
  __int16 v0; // di
  int v1; // ebx
  int v2; // eax
  int v3; // esi
  char *v4; // edx
  wchar_t *v5; // eax
  wchar_t v7; // [esp-4h] [ebp-14h]
  int v8; // [esp+Ch] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = sub_511B60(v2);
  if ( v3 )
  {
    v4 = *(char **)&byte_5D4594[4 * v1 + 3831212];
    v7 = v0 * *(_WORD *)&byte_5D4594[2649704];
    v8 = 0;
    v5 = sub_40F1D0(v4, &v8, (const char *)&byte_587000[247148], 3629);
    sub_528AC0(v3, v5, v7);
    if ( sub_40A5C0(2048) )
      sub_44D900(v8, 100);
  }
  return 0;
}

//----- (00514B10) --------------------------------------------------------
int sub_514B10()
{
  wchar_t v0; // di
  int v1; // ebx
  int v2; // eax
  int v3; // esi
  char *v4; // ecx
  wchar_t *v5; // eax
  int v7; // [esp+Ch] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = sub_511B60(v2);
  if ( v3 )
  {
    v4 = *(char **)&byte_5D4594[4 * v1 + 3831212];
    v7 = 0;
    v5 = sub_40F1D0(v4, &v7, (const char *)&byte_587000[247188], 3670);
    sub_528AC0(v3, v5, v0);
    if ( v7 )
    {
      if ( sub_40A5C0(2048) )
        sub_44D900(v7, 100);
    }
  }
  return 0;
}

//----- (00514BA0) --------------------------------------------------------
int sub_514BA0()
{
  script_pop();
  script_pop();
  return 0;
}

//----- (00514BB0) --------------------------------------------------------
int sub_514BB0()
{
  int v0; // eax
  _DWORD *v1; // eax

  v0 = script_pop();
  v1 = (_DWORD *)sub_511B60(v0);
  if ( v1 )
    sub_528D00(v1);
  return 0;
}

//----- (00514BD0) --------------------------------------------------------
int sub_514BD0()
{
  sub_528D60();
  return 0;
}

//----- (00514BE0) --------------------------------------------------------
int sub_514BE0()
{
  int v0; // esi
  int v1; // eax

  v0 = script_pop();
  v1 = script_pop();
  sub_500540(*(char **)&byte_5D4594[4 * v0 + 3831212], v1);
  return 0;
}

//----- (00514C10) --------------------------------------------------------
int sub_514C10()
{
  int v0; // esi
  int v1; // eax

  v0 = script_pop();
  v1 = script_pop();
  sub_5006B0(*(char **)&byte_5D4594[4 * v0 + 3831212], v1);
  return 0;
}

//----- (00514C40) --------------------------------------------------------
int sub_514C40()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_500750(*(char **)&byte_5D4594[4 * v0 + 3831212]);
  sub_507230(v1);
  return 0;
}

//----- (00514C60) --------------------------------------------------------
int sub_514C60()
{
  int v0; // eax
  int v2; // [esp+0h] [ebp-4h]

  v0 = script_pop();
  *(float *)&v2 = sub_500770((char *)*(_DWORD *)&byte_5D4594[4 * v0 + 3831212]);
  sub_507230(v2);
  return 0;
}

//----- (00514C90) --------------------------------------------------------
int sub_514C90()
{
  int v0; // eax

  v0 = script_pop();
  sub_5007E0(*(char **)&byte_5D4594[4 * v0 + 3831212]);
  return 0;
}

//----- (00514CB0) --------------------------------------------------------
int sub_514CB0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2
    && *(_DWORD *)&byte_5D4594[3821968]
    && *(_DWORD *)(v2 + 44) == *(_DWORD *)(*(_DWORD *)&byte_5D4594[3821968] + 44) )
  {
    v1 = 1;
  }
  sub_507230(v1);
  return 0;
}

//----- (00514CF0) --------------------------------------------------------
int sub_514CF0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2
    && *(_DWORD *)&byte_5D4594[3821964]
    && *(_DWORD *)(v2 + 44) == *(_DWORD *)(*(_DWORD *)&byte_5D4594[3821964] + 44) )
  {
    v1 = 1;
  }
  sub_507230(v1);
  return 0;
}

//----- (00514D30) --------------------------------------------------------
int sub_514D30()
{
  if ( *(_DWORD *)&byte_5D4594[3821968] )
    sub_507230(*(_DWORD *)(*(_DWORD *)&byte_5D4594[3821968] + 44));
  else
    sub_507230(*(int *)&byte_5D4594[3821968]);
  return 0;
}

//----- (00514D60) --------------------------------------------------------
int sub_514D60()
{
  if ( *(_DWORD *)&byte_5D4594[3821964] )
    sub_507230(*(_DWORD *)(*(_DWORD *)&byte_5D4594[3821964] + 44));
  else
    sub_507230(*(int *)&byte_5D4594[3821964]);
  return 0;
}

//----- (00514D90) --------------------------------------------------------
int sub_514D90()
{
  int v0; // ebx
  int v1; // ebp
  int v2; // esi
  int v3; // edi
  int v4; // eax
  char v6; // [esp+10h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = script_pop();
  v6 = sub_548F70(*(const char **)&byte_5D4594[4 * v2 + 3831212]);
  v4 = sub_511B60(v3);
  if ( v4 )
    sub_548C80(v4, v6, v1, v0);
  return 0;
}

//----- (00514DF0) --------------------------------------------------------
int sub_514DF0()
{
  int v0; // eax
  int v1; // eax
  int v2; // ecx

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = *(_DWORD *)(v1 + 748);
    if ( *(_BYTE *)(v1 + 8) & 2 )
    {
      *(_DWORD *)(v2 + 2096) = -1;
      *(_DWORD *)(v2 + 2100) = -1;
      sub_4E4780(v1, 16);
    }
  }
  return 0;
}

//----- (00514E30) --------------------------------------------------------
int sub_514E30()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 && *(_BYTE *)(v2 + 8) & 2 )
    strcpy((char *)(*(_DWORD *)(v2 + 748) + 2106), *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  return 0;
}

//----- (00514E90) --------------------------------------------------------
int sub_514E90()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax
  const char *v4; // [esp-4h] [ebp-8h]

  v0 = script_pop();
  v1 = script_pop();
  v4 = *(const char **)&byte_5D4594[4 * v0 + 3831212];
  v2 = sub_40AF50(*(void **)&byte_5D4594[4 * v1 + 3831212]);
  sub_548DE0(*(int *)&byte_5D4594[3821964], *(int *)&byte_5D4594[3821968], v2, v4);
  return 0;
}

//----- (00514ED0) --------------------------------------------------------
int sub_514ED0()
{
  int v0; // esi
  int v1; // edi
  int v2; // esi
  int v3; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v0);
  v3 = sub_511B60(v1);
  if ( v2 && v3 )
    sub_548CD0(v2, v3);
  return 0;
}

//----- (00514F10) --------------------------------------------------------
int sub_514F10()
{
  int v0; // ebp
  int v1; // esi
  int v2; // eax
  int v3; // ebx
  int v4; // eax
  int v5; // edi
  int v6; // eax
  int v7; // esi
  float2 v9; // [esp+10h] [ebp-14h]
  int v10[3]; // [esp+18h] [ebp-Ch]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = sub_4243F0(*(const char **)&byte_5D4594[4 * v2 + 3831212]);
  if ( v3 )
  {
    v4 = sub_511B60(v1);
    v5 = v4;
    if ( v4 )
    {
      if ( !(*(_DWORD *)(v4 + 16) & 0x8020) )
      {
        v6 = sub_511B60(v0);
        v7 = v6;
        if ( v6 )
        {
          v9.field_0 = *(float *)(v6 + 56) - *(float *)(v5 + 56);
          v9.field_4 = *(float *)(v6 + 60) - *(float *)(v5 + 60);
          *(_WORD *)(v5 + 124) = sub_509ED0(&v9);
          v10[0] = v7;
          v10[1] = *(_DWORD *)(v7 + 56);
          v10[2] = *(_DWORD *)(v7 + 60);
          sub_4FDD20(v3, (_DWORD *)v5, v10);
        }
      }
    }
  }
  return 0;
}

//----- (00514FC0) --------------------------------------------------------
int sub_514FC0()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  int v3; // eax
  _DWORD *v4; // esi
  float v6; // [esp+8h] [ebp-1Ch]
  float v7; // [esp+Ch] [ebp-18h]
  float2 v8; // [esp+10h] [ebp-14h]
  float v9[3]; // [esp+18h] [ebp-Ch]

  v7 = COERCE_FLOAT(script_pop());
  v6 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_4243F0(*(const char **)&byte_5D4594[4 * v1 + 3831212]);
  if ( v2 )
  {
    v3 = sub_511B60(v0);
    v4 = (_DWORD *)v3;
    if ( v3 )
    {
      v8.field_0 = v6 - *(float *)(v3 + 56);
      v8.field_4 = v7 - *(float *)(v3 + 60);
      *(_WORD *)(v3 + 124) = sub_509ED0(&v8);
      v9[0] = 0.0;
      v9[1] = v6;
      v9[2] = v7;
      sub_4FDD20(v2, v4, v9);
    }
  }
  return 0;
}

//----- (00515060) --------------------------------------------------------
int sub_515060()
{
  int v0; // esi
  int v1; // eax
  int v2; // edi
  int v3; // esi
  float2 v5; // [esp+8h] [ebp-1Ch]
  float2 v6; // [esp+10h] [ebp-14h]
  int v7[3]; // [esp+18h] [ebp-Ch]

  v0 = script_pop();
  LODWORD(v5.field_4) = script_pop();
  LODWORD(v5.field_0) = script_pop();
  v1 = script_pop();
  v2 = sub_4243F0(*(const char **)&byte_5D4594[4 * v1 + 3831212]);
  if ( v2 )
  {
    v3 = sub_511B60(v0);
    if ( v3 )
    {
      v6 = v5;
      sub_4E7010(*(int *)&byte_5D4594[1569664], &v6);
      v6.field_0 = *(float *)(v3 + 56) - v5.field_0;
      v6.field_4 = *(float *)(v3 + 60) - v5.field_4;
      *(_WORD *)(*(_DWORD *)&byte_5D4594[1569664] + 124) = sub_509ED0(&v6);
      v7[0] = v3;
      v7[1] = *(_DWORD *)(v3 + 56);
      v7[2] = *(_DWORD *)(v3 + 60);
      sub_4FDD20(v2, *(_DWORD **)&byte_5D4594[1569664], &v7);
    }
  }
  return 0;
}

//----- (00515130) --------------------------------------------------------
int sub_515130()
{
  int v0; // eax
  int v1; // esi
  float2 v3; // [esp+4h] [ebp-24h]
  float v4; // [esp+Ch] [ebp-1Ch]
  float v5; // [esp+10h] [ebp-18h]
  float2 v6; // [esp+14h] [ebp-14h]
  float v7[3]; // [esp+1Ch] [ebp-Ch]

  v5 = COERCE_FLOAT(script_pop());
  v4 = COERCE_FLOAT(script_pop());
  LODWORD(v3.field_4) = script_pop();
  LODWORD(v3.field_0) = script_pop();
  v0 = script_pop();
  v1 = sub_4243F0(*(const char **)&byte_5D4594[4 * v0 + 3831212]);
  if ( v1 )
  {
    v6 = v3;
    sub_4E7010(*(int *)&byte_5D4594[1569664], &v6);
    v6.field_0 = v4 - v3.field_0;
    v6.field_4 = v5 - v3.field_4;
    *(_WORD *)(*(_DWORD *)&byte_5D4594[1569664] + 124) = sub_509ED0(&v6);
    v7[1] = v4;
    v7[0] = 0.0;
    v7[2] = v5;
    sub_4FDD20(v1, *(_DWORD **)&byte_5D4594[1569664], &v7);
  }
  return 0;
}

//----- (00515200) --------------------------------------------------------
int sub_515200()
{
  *(_DWORD *)&byte_5D4594[2650672] = 0;
  sub_44DB30(25, 0, 0);
  return 0;
}

//----- (00515220) --------------------------------------------------------
int sub_515220()
{
  sub_44DAB0(25, 0, (void (*)(void))sub_44E000);
  return 0;
}

//----- (00515240) --------------------------------------------------------
int sub_515240()
{
  BOOL v0; // esi
  int v1; // esi
  int v2; // edi
  int v3; // esi
  int v4; // edi
  int v5; // eax
  int v6; // eax
  int i; // eax
  int v9; // ecx

  if ( !*(_DWORD *)&byte_5D4594[2386872] )
    *(_DWORD *)&byte_5D4594[2386872] = sub_4E3AA0((CHAR *)&byte_587000[247228]);
  if ( script_pop() != 1 )
  {
    if ( sub_44DCA0(16, 30) )
      sub_477530(0);
    for ( i = sub_4DA790(); i; i = sub_4DA7A0(i) )
    {
      if ( *(unsigned __int16 *)(i + 4) == *(_DWORD *)&byte_5D4594[2386872] )
      {
        v9 = *(_DWORD *)(i + 16);
        if ( v9 & 0x40 )
          *(_DWORD *)(i + 16) = v9 & 0xFFFFFFBF;
      }
    }
    return 0;
  }
  v0 = sub_44DD00();
  if ( sub_44DC40(16, 10) )
    sub_477530(1);
  if ( v0 )
    return 0;
  if ( !*(_DWORD *)&byte_5D4594[2386876] )
  {
    *(_DWORD *)&byte_5D4594[2386876] = sub_4E3AA0((CHAR *)&byte_587000[247244]);
    *(_DWORD *)&byte_5D4594[2386880] = sub_4E3AA0((CHAR *)&byte_587000[247256]);
    *(_DWORD *)&byte_5D4594[2386884] = sub_4E3AA0((CHAR *)&byte_587000[247272]);
    *(_DWORD *)&byte_5D4594[2386888] = sub_4E3AA0((CHAR *)&byte_587000[247280]);
    *(_DWORD *)&byte_5D4594[2386892] = sub_4E3AA0((CHAR *)&byte_587000[247292]);
    *(_DWORD *)&byte_5D4594[2386896] = sub_4E3AA0((CHAR *)&byte_587000[247304]);
    *(_DWORD *)&byte_5D4594[2386900] = sub_4E3AA0((CHAR *)&byte_587000[247316]);
  }
  v1 = sub_4DA840();
  if ( v1 )
  {
    do
    {
      v2 = sub_4DA850(v1);
      if ( *(unsigned __int16 *)(v1 + 4) != *(_DWORD *)&byte_5D4594[2386900] )
        sub_4E5CC0(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  v3 = sub_4DA790();
  if ( !v3 )
    return 0;
  do
  {
    v4 = sub_4DA7A0(v3);
    if ( *(_DWORD *)(v3 + 508)
      && ((v5 = *(unsigned __int16 *)(v3 + 4), (unsigned __int16)v5 == *(_DWORD *)&byte_5D4594[2386876])
       || v5 == *(_DWORD *)&byte_5D4594[2386880]
       || v5 == *(_DWORD *)&byte_5D4594[2386884]
       || v5 == *(_DWORD *)&byte_5D4594[2386888]
       || v5 == *(_DWORD *)&byte_5D4594[2386892]
       || v5 == *(_DWORD *)&byte_5D4594[2386896]) )
    {
      sub_4E5CC0(v3);
    }
    else
    {
      if ( *(unsigned __int16 *)(v3 + 4) == *(_DWORD *)&byte_5D4594[2386872] )
      {
        v6 = *(_DWORD *)(v3 + 16);
        if ( !(v6 & 0x40) )
        {
          LOBYTE(v6) = v6 | 0x40;
          *(_DWORD *)(v3 + 16) = v6;
        }
      }
      sub_4FEB10(132, v3);
      sub_4FEB10(56, v3);
      sub_4FEB10(24, v3);
      sub_4FEB10(43, v3);
      sub_4FEB10(22, v3);
      sub_4FEB10(31, v3);
      sub_4FEB10(35, v3);
      sub_4FEB10(8, v3);
      sub_4FEB10(9, v3);
      sub_4FEB10(4, v3);
      sub_4FEB10(115, v3);
      sub_4FEB10(21, v3);
      sub_4FEB10(59, v3);
      sub_4FEB10(75, v3);
    }
    v3 = v4;
  }
  while ( v4 );
  return 0;
}

//----- (005154A0) --------------------------------------------------------
int sub_5154A0()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax
  int v3; // ecx

  v0 = -1;
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 8);
    if ( v3 & 0x4000 )
      v0 = *(unsigned __int8 *)(*(_DWORD *)(v2 + 748) + 12);
  }
  sub_507230(v0);
  return 0;
}

//----- (005154E0) --------------------------------------------------------
int sub_5154E0()
{
  __int16 v0; // bx
  int v1; // edi
  int v2; // eax
  int v3; // esi

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  if ( v2 )
  {
    v3 = sub_511B60(v2);
    if ( v3 )
    {
      sub_427500(v3, *(char **)&byte_5D4594[4 * v1 + 3831212], v0);
      if ( v0 & 0xB )
      {
        sub_501960(903, v3, 0, 0);
        return 0;
      }
    }
  }
  else
  {
    sub_427550(*(char **)&byte_5D4594[4 * v1 + 3831212], v0);
  }
  return 0;
}

//----- (00515550) --------------------------------------------------------
int sub_515550()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  if ( v1 )
  {
    v2 = sub_511B60(v1);
    if ( v2 )
    {
      sub_427630(v2, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
      return 0;
    }
  }
  else
  {
    sub_427680(*(const char **)&byte_5D4594[4 * v0 + 3831212]);
  }
  return 0;
}

//----- (005155A0) --------------------------------------------------------
int sub_5155A0()
{
  __int16 v0; // si
  int v1; // edi
  int v2; // eax
  int v3; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  if ( v2 )
  {
    v3 = sub_511B60(v2);
    if ( v3 )
    {
      sub_427720(v3, *(const char **)&byte_5D4594[4 * v1 + 3831212], v0);
      return 0;
    }
  }
  else
  {
    sub_427770(*(const char **)&byte_5D4594[4 * v1 + 3831212], v0);
  }
  return 0;
}

//----- (00515600) --------------------------------------------------------
int sub_515600()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-28h]
  int v4; // [esp+4h] [ebp-24h]
  int v5; // [esp+8h] [ebp-20h]
  int v6; // [esp+Ch] [ebp-1Ch]
  int v7; // [esp+10h] [ebp-18h]
  int v8[5]; // [esp+14h] [ebp-14h]

  v7 = script_pop();
  v6 = script_pop();
  v5 = script_pop();
  v4 = script_pop();
  v3 = script_pop();
  v0 = script_pop();
  v8[0] = v3;
  v8[1] = v4;
  v8[2] = v5;
  v8[3] = v6;
  v8[4] = v7;
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_515680(v1, v8);
  return 0;
}

//----- (00515680) --------------------------------------------------------
void __cdecl sub_515680(int a1, int a2)
{
  int v2; // ebx
  int v3; // eax
  int *v4; // edi
  float2 v5; // [esp+8h] [ebp-8h]

  v2 = *(_DWORD *)(a1 + 748);
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      v3 = *(_DWORD *)(a1 + 16);
      if ( (v3 & 0x8000) == 0 )
      {
        v5.field_0 = *(float *)(a2 + 8) - *(float *)a2;
        v5.field_4 = *(float *)(a2 + 12) - *(float *)(a2 + 4);
        sub_50A3A0(a1);
        v4 = sub_50A260(a1, 4);
        if ( v4 )
        {
          v4[1] = *(_DWORD *)a2;
          v4[2] = *(_DWORD *)(a2 + 4);
          v4[3] = sub_509ED0(&v5);
        }
        *(_DWORD *)(v2 + 1312) = *(_DWORD *)(a2 + 16);
      }
    }
  }
}

//----- (00515700) --------------------------------------------------------
int sub_515700()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3; // [esp+0h] [ebp-28h]
  int v4; // [esp+4h] [ebp-24h]
  int v5; // [esp+8h] [ebp-20h]
  int v6; // [esp+Ch] [ebp-1Ch]
  int v7; // [esp+10h] [ebp-18h]
  int v8[5]; // [esp+14h] [ebp-14h]

  v7 = script_pop();
  v6 = script_pop();
  v5 = script_pop();
  v4 = script_pop();
  v3 = script_pop();
  v0 = script_pop();
  v8[1] = v4;
  v8[3] = v6;
  v8[0] = v3;
  v8[2] = v5;
  v8[4] = v7;
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, sub_515680, (int)v8);
  return 0;
}

//----- (00515780) --------------------------------------------------------
int sub_515780()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_5157A0(v1);
  return 0;
}

//----- (005157A0) --------------------------------------------------------
void __cdecl sub_5157A0(int a1)
{
  int result; // eax

  if ( a1 && *(_BYTE *)(a1 + 8) & 2 )
  {
    result = *(int *)(a1 + 16);
    if ( SBYTE1(result) >= 0 )
    {
      sub_50A3A0(a1);
      sub_50A260(a1, 5);
    }
  }
}

//----- (005157D0) --------------------------------------------------------
int sub_5157D0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_5157A0, 0);
  return 0;
}

//----- (00515800) --------------------------------------------------------
int sub_515800()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_515820(v1);
  return 0;
}

//----- (00515820) --------------------------------------------------------
void __cdecl sub_515820(int a1)
{
  int result; // eax

  if ( a1 && *(_BYTE *)(a1 + 8) & 2 )
  {
    result = *(int *)(a1 + 16);
    if ( SBYTE1(result) >= 0 )
    {
      sub_50A3A0(a1);
      sub_50A260(a1, 0);
    }
  }
}

//----- (00515850) --------------------------------------------------------
int sub_515850()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515820, 0);
  return 0;
}

//----- (00515880) --------------------------------------------------------
int sub_515880()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = sub_511B60(v0);
    if ( v3 )
      sub_5158C0(v2, v3);
  }
  return 0;
}

//----- (005158C0) --------------------------------------------------------
void __cdecl sub_5158C0(int a1, int a2)
{
  int v2; // eax
  int *v3; // eax

  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 )
      {
        if ( a1 != a2 )
        {
          v2 = *(_DWORD *)(a1 + 16);
          if ( (v2 & 0x8000) == 0 )
          {
            sub_50A3A0(a1);
            v3 = sub_50A260(a1, 3);
            if ( v3 )
            {
              v3[1] = *(_DWORD *)(a2 + 56);
              v3[2] = *(_DWORD *)(a2 + 60);
              v3[3] = a2;
            }
          }
        }
      }
    }
  }
}

//----- (00515910) --------------------------------------------------------
int sub_515910()
{
  int v0; // esi
  int v1; // edi
  int v2; // eax
  unsigned __int8 *v3; // eax
  int v5; // [esp-4h] [ebp-Ch]

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v0);
  if ( v2 )
  {
    v5 = v2;
    v3 = (unsigned __int8 *)sub_57C0A0(v1);
    sub_502670(v3, 0, sub_5158C0, v5);
  }
  return 0;
}

//----- (00515950) --------------------------------------------------------
int sub_515950()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_515980(v1, &v3);
  return 0;
}

//----- (00515980) --------------------------------------------------------
int __cdecl sub_515980(int a1, _DWORD *a2)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 748);
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      *(_DWORD *)(result + 1308) = *a2;
      *(_DWORD *)(result + 1304) = *a2;
    }
  }
  return result;
}

//----- (005159B0) --------------------------------------------------------
int sub_5159B0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515980, (int)&v3);
  return 0;
}

//----- (005159E0) --------------------------------------------------------
int sub_5159E0()
{
  int v0; // eax
  int v1; // eax
  float v3; // [esp+0h] [ebp-10h]
  float v4; // [esp+4h] [ebp-Ch]
  float2 v5;

  v4 = COERCE_FLOAT(script_pop());
  v3 = COERCE_FLOAT(script_pop());
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v5.field_0 = v3;
    v5.field_4 = v4;
    sub_515A30(v1, (float2 *)&v5);
  }
  return 0;
}

//----- (00515A30) --------------------------------------------------------
void __cdecl sub_515A30(int a1, float2 *a2)
{
  int v2; // eax
  int *v3; // eax
  float *v4; // edi
  float *v5; // eax

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      v2 = *(_DWORD *)(a1 + 16);
      if ( (v2 & 0x8000) == 0 )
      {
        if ( sub_534220(a1) )
        {
          sub_50A3A0(a1);
          v3 = sub_50A260(a1, 32);
          if ( v3 )
            v3[1] = 16;
          sub_50A260(a1, 16);
          v4 = (float *)sub_50A260(a1, 51);
          if ( v4 )
          {
            v4[1] = sub_534470(a1) + *(float *)(a1 + 176);
            v4[3] = a2->field_0;
            v4[4] = a2->field_4;
          }
          v5 = (float *)sub_50A260(a1, 7);
          if ( v5 )
          {
            v5[1] = a2->field_0;
            v5[2] = a2->field_4;
            v5[3] = 0;
          }
        }
      }
    }
  }
}

//----- (00515AE0) --------------------------------------------------------
int sub_515AE0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  float2 v3; // [esp+0h] [ebp-10h]
  float2 v4; // [esp+8h] [ebp-8h]

  LODWORD(v3.field_4) = script_pop();
  LODWORD(v3.field_0) = script_pop();
  v0 = script_pop();
  v4 = v3;
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515A30, (int)&v4);
  return 0;
}

//----- (00515B30) --------------------------------------------------------
int sub_515B30()
{
  int v0; // eax
  int v1; // eax
  int v3[2]; // [esp+0h] [ebp-10h]
  int v4[2]; // [esp+8h] [ebp-8h]

  v3[1] = script_pop();
  v3[0] = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    *(_QWORD *)v4 = *(_QWORD *)v3;
    sub_515B80(v1, v4);
  }
  return 0;
}

//----- (00515B80) --------------------------------------------------------
void __cdecl sub_515B80(int a1, _DWORD *a2)
{
  int v2; // eax
  int *v3; // eax
  int *v4; // eax

  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 )
      {
        v2 = *(_DWORD *)(a1 + 16);
        if ( (v2 & 0x8000) == 0 )
        {
          if ( sub_534280(a1) )
          {
            sub_50A3A0(a1);
            v3 = sub_50A260(a1, 32);
            if ( v3 )
              v3[1] = 17;
            v4 = sub_50A260(a1, 17);
            if ( v4 )
            {
              v4[1] = *a2;
              v4[2] = a2[1];
              v4[3] = 0;
            }
          }
        }
      }
    }
  }
}

//----- (00515BF0) --------------------------------------------------------
int sub_515BF0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3[2]; // [esp+0h] [ebp-10h]
  int v4[2]; // [esp+8h] [ebp-8h]

  v3[1] = script_pop();
  v3[0] = script_pop();
  v0 = script_pop();
  *(_QWORD *)v4 = *(_QWORD *)v3;
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515B80, (int)v4);
  return 0;
}

//----- (00515C40) --------------------------------------------------------
int __fastcall sub_515C40(int a1)
{
  char v1; // bl
  int v2; // eax
  int v3; // eax
  char v5; // [esp+1h] [ebp-1h]

  v5 = HIBYTE(a1);
  v1 = script_pop();
  v2 = script_pop();
  v3 = sub_511B60(v2);
  if ( v3 )
  {
    v5 = v1;
    sub_515C80(v3, &v5);
  }
  return 0;
}

//----- (00515C80) --------------------------------------------------------
int __cdecl sub_515C80(int a1, _BYTE *a2)
{
  int result; // eax

  result = a1;
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      result = *(_DWORD *)(a1 + 748);
      *(_BYTE *)(result + 1332) = *a2;
    }
  }
  return result;
}

//----- (00515CB0) --------------------------------------------------------
int sub_515CB0()
{
  char v0; // bl
  int v1; // eax
  unsigned __int8 *v2; // eax
  char v4; // [esp+1h] [ebp-1h]

  v0 = script_pop();
  v1 = script_pop();
  v4 = v0;
  v2 = (unsigned __int8 *)sub_57C0A0(v1);
  sub_502670(v2, 0, (void (__cdecl *)(int, int))sub_515C80, (int)&v4);
  return 0;
}

//----- (00515CF0) --------------------------------------------------------
int sub_515CF0()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = sub_511B60(v0);
    sub_515D30(v2, v3);
  }
  return 0;
}

//----- (00515D30) --------------------------------------------------------
void __cdecl sub_515D30(int a1, int a2)
{
  int v2; // ebx
  int v3; // eax
  int *v4; // eax
  int *v5; // eax

  v2 = *(_DWORD *)(a1 + 748);
  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 )
      {
        if ( a1 != a2 )
        {
          v3 = *(_DWORD *)(a1 + 16);
          if ( (v3 & 0x8000) == 0 )
          {
            sub_50A3A0(a1);
            *(_DWORD *)(v2 + 1216) = a2;
            sub_5281D0();
            v4 = sub_50A260(a1, 32);
            if ( v4 )
              v4[1] = 15;
            v5 = sub_50A260(a1, 15);
            if ( v5 )
            {
              v5[1] = *(_DWORD *)(a2 + 56);
              v5[2] = *(_DWORD *)(a2 + 60);
              v5[3] = *(_DWORD *)&byte_5D4594[2598000];
            }
          }
        }
      }
    }
  }
}

//----- (00515DB0) --------------------------------------------------------
int sub_515DB0()
{
  int v0; // esi
  int v1; // edi
  unsigned __int8 *v2; // eax
  int v4; // [esp-4h] [ebp-Ch]

  v0 = script_pop();
  v1 = script_pop();
  v4 = sub_511B60(v0);
  v2 = (unsigned __int8 *)sub_57C0A0(v1);
  sub_502670(v2, 0, sub_515D30, v4);
  return 0;
}

//----- (00515DF0) --------------------------------------------------------
int sub_515DF0()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_515E20(v1, &v3);
  return 0;
}

//----- (00515E20) --------------------------------------------------------
int __cdecl sub_515E20(int a1, _DWORD *a2)
{
  int result; // eax

  result = a1;
  if ( a1 && a2 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      result = *(_DWORD *)(a1 + 748);
      *(_DWORD *)(result + 1336) = *a2;
    }
  }
  return result;
}

//----- (00515E50) --------------------------------------------------------
int sub_515E50()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515E20, (int)&v3);
  return 0;
}

//----- (00515E80) --------------------------------------------------------
int sub_515E80()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_515EB0(v1, &v3);
  return 0;
}

//----- (00515EB0) --------------------------------------------------------
int __cdecl sub_515EB0(int a1, _DWORD *a2)
{
  int result; // eax

  result = a1;
  if ( a1 && a2 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      result = *(_DWORD *)(a1 + 748);
      *(_DWORD *)(result + 1344) = *a2;
    }
  }
  return result;
}

//----- (00515EE0) --------------------------------------------------------
int sub_515EE0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_515EB0, (int)&v3);
  return 0;
}

//----- (00515F10) --------------------------------------------------------
int sub_515F10()
{
  int v0; // ebx
  int v1; // esi
  int v2; // edi
  int v3; // eax
  int v5[2]; // [esp+Ch] [ebp-8h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v5[0] = sub_511B60(v1);
  if ( v5[0] )
  {
    v3 = sub_511B60(v2);
    if ( v3 )
    {
      v5[1] = v0;
      sub_515F70(v3, v5);
    }
  }
  return 0;
}

//----- (00515F70) --------------------------------------------------------
void __cdecl sub_515F70(int a1, _DWORD *a2)
{
  int v2; // eax
  int *v3; // eax
  int *v4; // eax
  int *v5; // eax
  int v6; // edx
  int v7; // edx

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
    {
      v2 = *(_DWORD *)(a1 + 16);
      if ( (v2 & 0x8000) == 0 && !sub_50A0D0(a1, 24) )
      {
        v3 = sub_50A260(a1, 32);
        if ( v3 )
          v3[1] = 24;
        v4 = sub_50A260(a1, 41);
        if ( v4 )
          v4[1] = *(_DWORD *)&byte_5D4594[2598000] + a2[1];
        v5 = sub_50A260(a1, 24);
        if ( v5 )
        {
          v6 = *a2;
          v5[1] = *(_DWORD *)(*a2 + 56);
          v7 = *(_DWORD *)(v6 + 60);
          v5[3] = 0;
          v5[2] = v7;
        }
      }
    }
  }
}

//----- (00516000) --------------------------------------------------------
int sub_516000()
{
  int v0; // edi
  int v1; // esi
  int v2; // ebx
  unsigned __int8 *v3; // eax
  int v5[2]; // [esp+Ch] [ebp-8h]

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v5[0] = sub_511B60(v1);
  if ( v5[0] )
  {
    v5[1] = v0;
    v3 = (unsigned __int8 *)sub_57C0A0(v2);
    sub_502670(v3, 0, (void (__cdecl *)(int, int))sub_515F70, (int)v5);
  }
  return 0;
}

//----- (00516060) --------------------------------------------------------
int sub_516060()
{
  int v0; // eax
  int v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_516090(v1, &v3);
  return 0;
}

//----- (00516090) --------------------------------------------------------
void __cdecl sub_516090(int a1, _DWORD *a2)
{
  int v2; // eax
  int *v3; // eax
  int *v4; // eax

  if ( a1 )
  {
    if ( a2 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 )
      {
        v2 = *(_DWORD *)(a1 + 16);
        if ( (v2 & 0x8000) == 0 )
        {
          v3 = sub_50A260(a1, 32);
          if ( v3 )
            v3[1] = 1;
          v4 = sub_50A260(a1, 1);
          if ( v4 )
            v4[1] = *(_DWORD *)&byte_5D4594[2598000] + *a2;
        }
      }
    }
  }
}

//----- (005160F0) --------------------------------------------------------
int sub_5160F0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax
  int v3; // [esp+0h] [ebp-4h]

  v3 = script_pop();
  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_516090, (int)&v3);
  return 0;
}

//----- (00516120) --------------------------------------------------------
int sub_516120()
{
  int v0; // eax
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = sub_4FA6D0(v1);
    sub_507230(v2);
  }
  else
  {
    sub_507230(0);
  }
  return 0;
}

//----- (00516160) --------------------------------------------------------
int sub_516160()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_4FA620(v2, v0);
  return 0;
}

//----- (00516190) --------------------------------------------------------
int sub_516190()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_4EF3A0(v2, *(float *)&v0);
  return 0;
}

//----- (005161C0) --------------------------------------------------------
int sub_5161C0()
{
  int v0; // edi
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // edi

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = sub_511B60(v0);
  v4 = 0;
  if ( v2 && v3 && sub_5330C0(v2, v3) )
    v4 = 1;
  sub_507230(v4);
  return 0;
}

//----- (00516210) --------------------------------------------------------
int sub_516210()
{
  int v0; // esi
  int v1; // eax
  int result; // eax
  const char *v3; // ecx
  int v4; // ebp
  const char *v5; // ebx
  unsigned __int8 *v6; // edi
  int v7; // [esp+10h] [ebp-4h]

  v0 = script_pop();
  v1 = script_pop();
  v7 = sub_511B60(v1);
  if ( v7 )
  {
    v3 = *(const char **)&byte_587000[237172];
    v4 = 1;
    if ( *(_DWORD *)&byte_587000[237172] )
    {
      v5 = *(const char **)&byte_5D4594[4 * v0 + 3831212];
      v6 = &byte_587000[237172];
      while ( strcmp(v3, v5) )
      {
        v3 = (const char *)*((_DWORD *)v6 + 1);
        v6 += 4;
        v4 *= 2;
        if ( !v3 )
          return 0;
      }
      sub_507230((v4 & *(_DWORD *)(v7 + 8)) != 0);
    }
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (005162D0) --------------------------------------------------------
int sub_5162D0()
{
  int v0; // eax
  int result; // eax
  unsigned __int8 *v2; // edi
  int v3; // ebp
  const char *v4; // ecx
  bool v5; // zf
  const char **i; // [esp+10h] [ebp-10h]
  unsigned __int8 *v7; // [esp+14h] [ebp-Ch]
  int v8; // [esp+18h] [ebp-8h]
  int v9; // [esp+1Ch] [ebp-4h]

  v8 = script_pop();
  v0 = script_pop();
  v9 = sub_511B60(v0);
  if ( v9 )
  {
    v2 = &byte_587000[237304];
    if ( byte_587000 != (unsigned __int8 *)-237304 )
    {
      v7 = &byte_587000[237304];
      for ( i = (const char **)&byte_587000[237304]; ; i += 32 )
      {
        v3 = 1;
        v4 = *i;
        if ( *i )
          break;
LABEL_8:
        v5 = v7 + 128 == 0;
        v2 = v7 + 128;
        v7 += 128;
        if ( v5 )
          return 0;
      }
      while ( strcmp(v4, *(const char **)&byte_5D4594[4 * v8 + 3831212]) )
      {
        v4 = (const char *)*((_DWORD *)v2 + 1);
        v2 += 4;
        v3 *= 2;
        if ( !v4 )
          goto LABEL_8;
      }
      sub_507230((v3 & *(_DWORD *)(v9 + 12)) != 0);
    }
    result = 0;
  }
  else
  {
    sub_507230(0);
    result = 0;
  }
  return result;
}

//----- (005163C0) --------------------------------------------------------
int sub_5163C0()
{
  int v0; // eax
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = sub_548F40(v1);
    sub_507230(v2);
  }
  else
  {
    sub_507230(0);
  }
  return 0;
}

//----- (00516400) --------------------------------------------------------
int sub_516400()
{
  if ( sub_40A5C0(2048) )
  {
    sub_4DB130((const char *)&byte_587000[247324]);
    sub_4DB170(1, 0, 0);
  }
  return 0;
}

//----- (00516430) --------------------------------------------------------
int sub_516430()
{
  int v0; // ebx
  char v2[3]; // [esp+4h] [ebp-8h]
  int v3; // [esp+8h] [ebp-4h]

  v0 = script_pop();
  v3 = script_pop();
  if ( sub_40A5C0(2048) )
  {
    sub_43D9B0(v3, v0);
  }
  else
  {
    v2[1] = v3;
    v2[2] = v0;
    v2[0] = -27;
    sub_4E5390(255, (int)v2, 3, 0, 1);
  }
  return 0;
}

//----- (005164A0) --------------------------------------------------------
int __thiscall sub_5164A0(void *this)
{
  void *v2; // [esp+0h] [ebp-4h]

  v2 = this;
  if ( sub_40A5C0(2048) )
  {
    sub_43DA80();
  }
  else
  {
    LOBYTE(v2) = -26;
    sub_4E5390(255, (int)&v2, 3, 0, 1);
  }
  return 0;
}

//----- (005164E0) --------------------------------------------------------
int __thiscall sub_5164E0(void *this)
{
  void *v2; // [esp+0h] [ebp-4h]

  v2 = this;
  if ( sub_40A5C0(2048) )
  {
    sub_43DAD0();
  }
  else
  {
    LOBYTE(v2) = -25;
    sub_4E5390(255, (int)&v2, 3, 0, 1);
  }
  return 0;
}

//----- (00516520) --------------------------------------------------------
int __thiscall sub_516520(void *this)
{
  void *v2; // [esp+0h] [ebp-4h]

  v2 = this;
  if ( sub_40A5C0(2048) )
  {
    sub_43D9B0(0, 0);
  }
  else
  {
    LOWORD(v2) = 229;
    sub_4E5390(255, (int)&v2, 3, 0, 1);
  }
  return 0;
}

//----- (00516570) --------------------------------------------------------
int __thiscall sub_516570(_BYTE *this)
{
  int v1; // eax
  _BYTE *v2; // esi
  _BYTE *v4; // [esp+0h] [ebp-4h]

  v4 = this;
  v1 = sub_4DA7C0();
  if ( v1 )
  {
    do
    {
      v2 = *(_BYTE **)(*(_DWORD *)(v1 + 748) + 276);
      if ( v2[2064] == 31 )
        break;
      v1 = sub_4DA7F0(v1);
    }
    while ( v1 );
  }
  else
  {
    v2 = v4;
  }
  *(_DWORD *)&byte_5D4594[2650672] = 1;
  return sub_4D9560((unsigned __int8)v2[2064], byte_5D4594[2386828], *(int *)&byte_5D4594[2386832]);
}

//----- (005165D0) --------------------------------------------------------
int sub_5165D0()
{
  *(_DWORD *)&byte_5D4594[2386828] = script_pop() - 1;
  sub_413A00(1);
  return sub_44DAB0(25, 1, (void (*)(void))sub_516570);
}

//----- (00516600) --------------------------------------------------------
int sub_516600()
{
  int i; // esi
  int v1; // esi
  int v2; // edi

  for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
  {
    if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064) == 31 )
      break;
  }
  sub_4277B0(i, 0xEu);
  v1 = sub_4E7980(i);
  if ( v1 )
  {
    do
    {
      v2 = sub_4E7990(v1);
      if ( *(_BYTE *)(v1 + 8) & 0x40 )
        sub_4E5CC0(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  *(_DWORD *)&byte_5D4594[2386832] = 1;
  sub_5165D0();
  return 0;
}

//----- (00516680) --------------------------------------------------------
int sub_516680()
{
  *(_DWORD *)&byte_5D4594[2386832] = 0;
  sub_5165D0();
  return 0;
}

//----- (005166A0) --------------------------------------------------------
int sub_5166A0()
{
  char *v0; // eax
  int v1; // ecx

  v0 = sub_417090(31);
  v1 = 0;
  if ( v0 && *(_DWORD *)(*(_DWORD *)(*((_DWORD *)v0 + 514) + 748) + 284) )
    v1 = 1;
  sub_507230(v1);
  return 0;
}

//----- (005166E0) --------------------------------------------------------
int sub_5166E0()
{
  char *v0; // eax
  int v1; // ecx

  v0 = sub_417090(31);
  v1 = 0;
  if ( v0 && *(_DWORD *)(*(_DWORD *)(*((_DWORD *)v0 + 514) + 748) + 280) )
    v1 = 1;
  sub_507230(v1);
  return 0;
}

//----- (00516720) --------------------------------------------------------
int sub_516720()
{
  char *v0; // esi
  int v1; // eax
  int v2; // eax
  int v3; // ecx
  int v4; // ecx

  v0 = sub_417090(31);
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 12);
    BYTE1(v3) |= 1u;
    *(_DWORD *)(v2 + 12) = v3;
    v4 = *((_DWORD *)v0 + 514);
    if ( v4 )
      sub_4EC290(v4, v2);
  }
  return 0;
}

//----- (00516760) --------------------------------------------------------
int sub_516760()
{
  int v0; // eax
  int v1; // eax
  int v2; // edx

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = *(_DWORD *)(v1 + 12);
    BYTE1(v2) &= 0xFEu;
    *(_DWORD *)(v1 + 12) = v2;
    sub_4EC300(v1);
  }
  return 0;
}

//----- (00516790) --------------------------------------------------------
int __thiscall sub_516790(void *this)
{
  int v1; // eax
  int v2; // eax
  void *v4; // [esp+0h] [ebp-4h]

  v4 = this;
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_507230((*(_DWORD *)(v2 + 12) >> 8) & 1);
  else
    sub_507230((int)v4);
  return 0;
}

//----- (005167D0) --------------------------------------------------------
int sub_5167D0()
{
  char *v0; // esi
  int v1; // eax
  int v2; // eax
  int v3; // ecx

  v0 = sub_417090(31);
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    v3 = *((_DWORD *)v0 + 514);
    if ( v3 )
      sub_4E7B00(v3, v2);
  }
  return 0;
}

//----- (00516810) --------------------------------------------------------
int sub_516810()
{
  char *v0; // esi
  int v1; // eax
  _DWORD *v2; // eax
  int v3; // ecx

  v0 = sub_417090(31);
  v1 = script_pop();
  v2 = (_DWORD *)sub_511B60(v1);
  if ( v2 )
  {
    v3 = *((_DWORD *)v0 + 514);
    if ( v3 )
      sub_4E7B60(v3, v2);
  }
  return 0;
}

//----- (00516850) --------------------------------------------------------
int __thiscall sub_516850(void *this)
{
  int v1; // eax
  int v2; // eax
  void *v4; // [esp+0h] [ebp-4h]

  v4 = this;
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_507230((*(_DWORD *)(v2 + 12) & 0xFFu) >> 7);
  else
    sub_507230((int)v4);
  return 0;
}

//----- (00516890) --------------------------------------------------------
int sub_516890()
{
  _DWORD *v0; // edi
  int v1; // esi
  int v2; // ebx
  _DWORD *v3; // eax
  _DWORD *v4; // eax

  v0 = (_DWORD *)*((_DWORD *)sub_417090(31) + 514);
  v1 = 0;
  v2 = script_pop();
  v3 = (_DWORD *)v0[126];
  if ( v3 )
  {
    while ( !(v3[2] & 0x1000000) || !(v3[3] & 0x7800000) )
    {
      v3 = (_DWORD *)v3[124];
      if ( !v3 )
        goto LABEL_7;
    }
    v1 = (v3[4] >> 8) & 1;
    sub_4E5CC0((int)v3);
  }
LABEL_7:
  v4 = sub_4EF750((int)v0, *(CHAR **)&byte_587000[4 * v2 + 247336], 0, 1, 1);
  if ( v1 )
    sub_4F2F70(v0, (int)v4);
  return 0;
}

//----- (00516920) --------------------------------------------------------
int sub_516920()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
  {
    if ( v0 == 1 )
    {
      sub_4E79C0(v2, 1);
      return 0;
    }
    sub_4E7A60(v2, 1);
  }
  return 0;
}

//----- (00516960) --------------------------------------------------------
int sub_516960()
{
  *(_DWORD *)&byte_5D4594[2386840] = script_pop();
  return 0;
}

//----- (00516970) --------------------------------------------------------
int sub_516970()
{
  int v0; // esi
  int v1; // edi
  int v2; // eax
  int v3; // eax
  _DWORD *v4; // eax
  int result; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = sub_511B60(v2);
  if ( !v3 || !(*(_BYTE *)(v3 + 8) & 2) )
    return 0;
  v4 = *(_DWORD **)(v3 + 748);
  switch ( v1 )
  {
    case 3:
      v4[309] = v0;
      result = 0;
      break;
    case 4:
      v4[307] = v0;
      result = 0;
      break;
    case 5:
      v4[317] = v0;
      result = 0;
      break;
    case 6:
      v4[311] = v0;
      result = 0;
      break;
    case 7:
      v4[313] = v0;
      result = 0;
      break;
    case 8:
      v4[315] = v0;
      result = 0;
      break;
    case 9:
      v4[319] = v0;
      result = 0;
      break;
    case 10:
      v4[321] = v0;
      result = 0;
      break;
    case 11:
      v4[323] = v0;
      result = 0;
      break;
    case 13:
      v4[325] = v0;
      return 0;
    default:
      return 0;
  }
  return result;
}

//----- (00516A50) --------------------------------------------------------
int sub_516A50()
{
  int v0; // esi
  int v1; // eax
  _DWORD *v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = (_DWORD *)sub_511B60(v1);
  if ( v2 )
    sub_511660(v2, v0);
  return 0;
}

//----- (00516A80) --------------------------------------------------------
void __cdecl sub_516A80(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  _DWORD *v5; // eax
  int v6; // ecx

  if ( !*(_DWORD *)&byte_5D4594[2386904] )
    *(_DWORD *)&byte_5D4594[2386904] = sub_4E3AA0((CHAR *)&byte_587000[247416]);
  v4 = sub_4E7980(a1);
  if ( v4 )
  {
    while ( *(unsigned __int16 *)(v4 + 4) != *(_DWORD *)&byte_5D4594[2386904] )
    {
      v4 = sub_4E7990(v4);
      if ( !v4 )
        goto LABEL_8;
    }
    sub_4E5CC0(v4);
  }
LABEL_8:
  v5 = sub_4E3810((CHAR *)&byte_587000[247424]);
  if ( v5 )
  {
    v6 = v5[173];
    *(_DWORD *)v6 = a2;
    *(_DWORD *)(v6 + 4) = a3;
    *(_DWORD *)(v6 + 8) = a4;
    *(_BYTE *)(v6 + 20) = 0;
    if ( a2 )
      *(_BYTE *)(v6 + 20) = 1;
    if ( a3 )
      ++*(_BYTE *)(v6 + 20);
    if ( a4 )
      ++*(_BYTE *)(v6 + 20);
    *(_DWORD *)(v6 + 24) = 0;
    *(_DWORD *)(v6 + 28) = *(_DWORD *)(a1 + 56);
    *(_DWORD *)(v6 + 32) = *(_DWORD *)(a1 + 60);
    sub_4F3070(a1, (int)v5, 1);
  }
}

//----- (00516B40) --------------------------------------------------------
int sub_516B40()
{
  int v0; // ebp
  int v1; // ebx
  int v2; // edi
  int v3; // eax
  int v4; // eax
  int v5; // esi
  int v6; // eax
  int v7; // edi
  int v8; // ebx
  int v9; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = script_pop();
  v3 = script_pop();
  v4 = sub_511B60(v3);
  v5 = v4;
  if ( v4 )
  {
    if ( *(_BYTE *)(v4 + 8) & 2 )
    {
      v6 = *(_DWORD *)(v4 + 12);
      if ( v6 & 0x2000 )
      {
        v7 = sub_4243F0(*(const char **)&byte_5D4594[4 * v2 + 3831212]);
        v8 = sub_4243F0(*(const char **)&byte_5D4594[4 * v1 + 3831212]);
        v9 = sub_4243F0(*(const char **)&byte_5D4594[4 * v0 + 3831212]);
        sub_516A80(v5, v7, v8, v9);
      }
    }
  }
  return 0;
}

//----- (00516BC0) --------------------------------------------------------
int sub_516BC0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_4D9760(v1);
  return 0;
}

//----- (00516BE0) --------------------------------------------------------
int sub_516BE0()
{
  int v0; // esi
  int v1; // eax
  int v2; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  if ( v2 )
    sub_548FE0(v2, *(const char **)&byte_5D4594[4 * v0 + 3831212]);
  return 0;
}

//----- (00516C10) --------------------------------------------------------
int sub_516C10()
{
  sub_44E040();
  return 0;
}

//----- (00516C20) --------------------------------------------------------
int sub_516C20()
{
  sub_44E0B0(1);
  return 0;
}

//----- (00516C30) --------------------------------------------------------
int sub_516C30()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2 && *(_BYTE *)(v2 + 8) & 2 )
    v1 = (*(_DWORD *)(*(_DWORD *)(v2 + 748) + 1440) >> 7) & 1;
  sub_507230(v1);
  return 0;
}

//----- (00516C70) --------------------------------------------------------
int sub_516C70()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_516C90(v1);
  return 0;
}

//----- (00516C90) --------------------------------------------------------
int __cdecl sub_516C90(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 2 )
      *(_DWORD *)(*(_DWORD *)(a1 + 748) + 1440) |= 0x100000u;
  }
  return result;
}

//----- (00516CB0) --------------------------------------------------------
int sub_516CB0()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_516C90, 0);
  return 0;
}

//----- (00516CE0) --------------------------------------------------------
int sub_516CE0()
{
  int v0; // eax
  int v1; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
    sub_516D00(v1);
  return 0;
}

//----- (00516D00) --------------------------------------------------------
unsigned int __cdecl sub_516D00(int a1)
{
  unsigned int result; // eax
  int v2; // edx

  result = a1;
  if ( a1 && *(_BYTE *)(a1 + 8) & 2 )
  {
    v2 = *(_DWORD *)(a1 + 16);
    if ( (v2 & 0x8000) != 0 )
    {
      *(_DWORD *)(*(_DWORD *)(a1 + 748) + 1440) &= 0xFFEFFFFF;
      result = sub_534AB0(a1);
    }
  }
  return result;
}

//----- (00516D40) --------------------------------------------------------
int sub_516D40()
{
  int v0; // eax
  unsigned __int8 *v1; // eax

  v0 = script_pop();
  v1 = (unsigned __int8 *)sub_57C0A0(v0);
  sub_502670(v1, 0, (void (__cdecl *)(int, int))sub_516D00, 0);
  return 0;
}

//----- (00516D70) --------------------------------------------------------
int sub_516D70()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = *(_DWORD *)&byte_5D4594[2386908];
    if ( !*(_DWORD *)&byte_5D4594[2386908] )
    {
      v2 = sub_4E3AA0((CHAR *)&byte_587000[247432]);
      *(_DWORD *)&byte_5D4594[2386908] = v2;
    }
    sub_507230(*(unsigned __int16 *)(v1 + 4) == v2);
  }
  return 0;
}

//----- (00516DC0) --------------------------------------------------------
int sub_516DC0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = sub_511B60(v0);
  if ( v1 )
  {
    v2 = *(_DWORD *)&byte_5D4594[2386912];
    if ( !*(_DWORD *)&byte_5D4594[2386912] )
    {
      v2 = sub_4E3AA0((CHAR *)&byte_587000[247444]);
      *(_DWORD *)&byte_5D4594[2386912] = v2;
    }
    sub_507230(*(unsigned __int16 *)(v1 + 4) == v2);
  }
  return 0;
}

//----- (00516E10) --------------------------------------------------------
int sub_516E10()
{
  int v0; // eax

  v0 = script_pop();
  sub_578C90(v0);
  return 0;
}

//----- (00516E30) --------------------------------------------------------
int sub_516E30()
{
  int v0; // edi
  int v1; // eax
  int v2; // eax
  int v3; // esi
  char *v4; // eax

  v0 = script_pop();
  v1 = script_pop();
  v2 = sub_511B60(v1);
  v3 = v2;
  if ( v2 && *(_BYTE *)(v2 + 8) & 4 )
  {
    if ( v0 <= 0 )
      sub_4D8EC0(v2, -v0);
    else
      sub_4D8E90(v2, v0);
    v4 = sub_418AB0(*(unsigned __int8 *)(v3 + 52));
    if ( v4 )
      sub_419090((int)v4, v0 + *((_DWORD *)v4 + 13));
    sub_4D8EF0(v3);
  }
  return 0;
}

//----- (00516EA0) --------------------------------------------------------
int sub_516EA0()
{
  int v0; // eax
  int v1; // esi
  int v2; // eax

  v0 = script_pop();
  v1 = 0;
  v2 = sub_511B60(v0);
  if ( v2 && *(_BYTE *)(v2 + 8) & 4 )
    v1 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v2 + 748) + 276) + 2136);
  sub_507230(v1);
  return 0;
}

//----- (00516EE0) --------------------------------------------------------
BOOL sub_516EE0()
{
  *(_DWORD *)&byte_5D4594[2386920] = 0;
  *(_DWORD *)&byte_5D4594[2386916] = sub_413FE0((const char *)&byte_587000[247452], 12, 512);
  return *(_DWORD *)&byte_5D4594[2386916] != 0;
}

//----- (00516F10) --------------------------------------------------------
int sub_516F10()
{
  int result; // eax

  sub_414100(*(LPVOID *)&byte_5D4594[2386916]);
  result = 0;
  *(_DWORD *)&byte_5D4594[2386916] = 0;
  *(_DWORD *)&byte_5D4594[2386920] = 0;
  return result;
}

//----- (00516F30) --------------------------------------------------------
void sub_516F30()
{
  sub_4144D0(*(_DWORD **)&byte_5D4594[2386916]);
  *(_DWORD *)&byte_5D4594[2386920] = 0;
}

//----- (00516F50) --------------------------------------------------------
int __cdecl sub_516F50(int a1, int a2)
{
  int v2; // eax

  v2 = sub_4DA870();
  if ( !v2 )
    return 0;
  while ( *(_DWORD *)(v2 + 44) != a2 )
  {
    v2 = sub_4DA880(v2);
    if ( !v2 )
      return 0;
  }
  sub_4EC290(a1, v2);
  return 1;
}

//----- (00516F90) --------------------------------------------------------
_DWORD *__cdecl sub_516F90(int a1, int a2)
{
  _DWORD *result; // eax

  result = sub_4142F0(*(_DWORD **)&byte_5D4594[2386916]);
  if ( result )
  {
    *result = a1;
    result[1] = a2;
    result[2] = *(_DWORD *)&byte_5D4594[2386920];
    *(_DWORD *)&byte_5D4594[2386920] = result;
  }
  return result;
}

//----- (00516FC0) --------------------------------------------------------
void sub_516FC0()
{
  int *v0; // esi
  int v1; // edi
  int v2; // eax

  v0 = *(int **)&byte_5D4594[2386920];
  if ( *(_DWORD *)&byte_5D4594[2386920] )
  {
    do
    {
      v1 = sub_4ECF10(*v0);
      v2 = sub_4ECF10(v0[1]);
      if ( v1 && v2 )
        sub_4EC290(v1, v2);
      v0 = (int *)v0[2];
    }
    while ( v0 );
  }
  sub_516F30();
}

//----- (00517010) --------------------------------------------------------
int sub_517010()
{
  int result; // eax
  FILE *v1; // esi
  char v2[256]; // [esp+4h] [ebp-100h]

  *(_DWORD *)&byte_5D4594[2386924] = 0;
  result = sub_408CC0((char *)&byte_587000[249116], 0);
  v1 = (FILE *)result;
  if ( result )
  {
    result = sub_408D40(result, 23);
    if ( result )
    {
      while ( sub_517090(v1, v2) && sub_517170(v1, v2) )
        ;
      sub_408D90(v1);
      result = 1;
    }
  }
  return result;
}

//----- (00517090) --------------------------------------------------------
int __cdecl sub_517090(FILE *a1, _BYTE *a2)
{
  _BYTE *v2; // ebx
  int v3; // ecx
  int v4; // edi
  int v5; // ebp
  int v6; // eax
  WORD CharType[2]; // [esp+10h] [ebp-4h]

  v2 = a2;
  v3 = 0;
  *(_DWORD *)CharType = 0;
  v4 = 1;
  do
  {
    while ( 1 )
    {
      v5 = v3;
      sub_408E40((char *)CharType, 1, 1, a1);
      if ( sub_409370() == -1 )
        return 0;
      if ( *(_DWORD *)&byte_587000[1668] <= 1 )
      {
        v3 = *(_DWORD *)CharType;
        v6 = isspace(CharType[0]);
      }
      else
      {
        v6 = isspace(CharType[0]);
        v3 = *(_DWORD *)CharType;
      }
      if ( v6 )
        break;
      v4 = 0;
      if ( v3 != 47 || v5 != 47 )
      {
        *v2++ = v3;
      }
      else
      {
        sub_517140(a1);
        v2 = a2;
        v3 = *(_DWORD *)CharType;
        v4 = 1;
      }
    }
  }
  while ( v4 );
  *v2 = 0;
  return 1;
}

//----- (00517140) --------------------------------------------------------
int __cdecl sub_517140(FILE *a1)
{
  FILE *v1; // esi
  int result; // eax

  v1 = a1;
  do
  {
    LOBYTE(a1) = 0;
    sub_408E40((char *)&a1, 1, 1, v1);
    result = sub_409370();
  }
  while ( result != -1 && (_BYTE)a1 != 10 );
  return result;
}

//----- (00517170) --------------------------------------------------------
int __cdecl sub_517170(FILE *a1, const char *a2)
{
  int result; // eax
  _DWORD *v3; // ebx
  unsigned __int8 *v4; // esi
  int v5; // eax
  char *v6; // edi
  int v7; // edi
  unsigned __int8 *v8; // esi
  int v9; // [esp+10h] [ebp-104h]
  char v10[256]; // [esp+14h] [ebp-100h]

  result = (int)nox_calloc(1u, 0xF8u);
  v3 = (_DWORD *)result;
  if ( result )
  {
    strcpy((char *)result, a2);
    while ( 1 )
    {
      if ( !sub_517090(a1, v10) || !_strcmpi((const char *)&byte_587000[249128], v10) )
      {
        v3[61] = *(_DWORD *)&byte_5D4594[2386924];
        *(_DWORD *)&byte_5D4594[2386924] = v3;
        return 1;
      }
      if ( sub_40A5C0(2048) || sub_40A5C0(0x200000) )
      {
        if ( _strcmpi((const char *)&byte_587000[249132], v10) )
        {
          if ( _strcmpi((const char *)&byte_587000[249140], v10) )
            goto LABEL_10;
        }
        else
        {
          sub_517140(a1);
        }
      }
      else
      {
LABEL_10:
        if ( !sub_40A5C0(0x2000) )
          goto LABEL_14;
        if ( _strcmpi((const char *)&byte_587000[249148], v10) )
        {
          if ( _strcmpi((const char *)&byte_587000[249156], v10) )
          {
LABEL_14:
            v4 = &byte_587000[248192];
            if ( *(_DWORD *)&byte_587000[248192] )
            {
              do
              {
                if ( !_strcmpi(*(const char **)v4, v10) )
                  break;
                v5 = *((_DWORD *)v4 + 3);
                v4 += 12;
              }
              while ( v5 );
            }
            if ( !*(_DWORD *)v4 )
            {
              free(v3);
              return 0;
            }
            v6 = (char *)v3 + *((_DWORD *)v4 + 2);
            switch ( *((_DWORD *)v4 + 1) )
            {
              case 0:
                sub_517090(a1, v10);
                *(_DWORD *)v6 = atoi(v10);
                continue;
              case 1:
                sub_517090(a1, v10);
                *(float *)v6 = atof(v10);
                continue;
              case 2:
                sub_517090(a1, v10);
                *(_DWORD *)v6 = sub_40AF50(v10);
                continue;
              case 3:
                sub_517090(a1, v10);
                if ( sub_549040((int)v3, v10) )
                  continue;
                return 0;
              case 4:
                sub_517090(a1, v10);
                if ( sub_5490E0((int)v3, v10) )
                  continue;
                return 0;
              case 5:
                sub_517090(a1, v10);
                if ( sub_549180((int)v3, v10) )
                  continue;
                return 0;
              case 6:
                v9 = 0;
                sub_517090(a1, v10);
                sub_423930(v10, &v9, (const char **)&byte_587000[247536]);
                *(_WORD *)v6 = v9;
                continue;
              case 7:
                sub_517090(a1, v6);
                if ( !strcmp((const char *)&byte_587000[249164], v6) )
                  *v6 = 0;
                continue;
              case 8:
                sub_517090(a1, v10);
                v3[31] = 18;
                v7 = 0;
                v8 = &byte_587000[247464];
                break;
              default:
                continue;
            }
            while ( _strcmpi(v10, (const char *)(*(_DWORD *)v8 + 7)) )
            {
              v8 += 4;
              ++v7;
              if ( (int)v8 >= (int)&byte_587000[247536] )
                goto LABEL_27;
            }
            v3[31] = v7;
LABEL_27:
            if ( v3[31] == 18 )
              return 0;
          }
        }
        else
        {
          sub_517140(a1);
        }
      }
    }
  }
  return result;
}

//----- (005174F0) --------------------------------------------------------
_DWORD *sub_5174F0()
{
  _DWORD *result; // eax
  _DWORD *v1; // esi

  result = *(_DWORD **)&byte_5D4594[2386924];
  if ( *(_DWORD *)&byte_5D4594[2386924] )
  {
    do
    {
      v1 = (_DWORD *)result[61];
      free(result);
      result = v1;
    }
    while ( v1 );
    *(_DWORD *)&byte_5D4594[2386924] = 0;
  }
  return result;
}

//----- (00517520) --------------------------------------------------------
int sub_517520()
{
  int v0; // esi
  int v1; // eax

  v0 = *(_DWORD *)&byte_5D4594[2386924];
  if ( !*(_DWORD *)&byte_5D4594[2386924] )
    return 1;
  while ( 1 )
  {
    v1 = sub_4E3AA0((CHAR *)v0);
    *(_DWORD *)(v0 + 240) = v1;
    if ( !v1 )
      break;
    v0 = *(_DWORD *)(v0 + 244);
    if ( !v0 )
      return 1;
  }
  sub_5174F0();
  return 0;
}

//----- (00517560) --------------------------------------------------------
_DWORD *__cdecl sub_517560(int a1)
{
  _DWORD *result; // eax

  result = *(_DWORD **)&byte_5D4594[2386924];
  if ( !*(_DWORD *)&byte_5D4594[2386924] )
    return 0;
  while ( result[60] != a1 )
  {
    result = (_DWORD *)result[61];
    if ( !result )
      return 0;
  }
  return result;
}

//----- (00517590) --------------------------------------------------------
BOOL __cdecl sub_517590(float a1, float a2)
{
  int v4; // [esp+0h] [ebp-4h]

  sub_5175E0(a1, (int)&a1);
  sub_5175E0(a2, (int)&v4);
  return a1 >= 0.0
      && SLODWORD(a1) < *(int *)&byte_5D4594[2386944]
      && v4 >= 0
      && v4 < *(int *)&byte_5D4594[2386944];
}

//----- (005175E0) --------------------------------------------------------
int __cdecl sub_5175E0(float a1, int a2)
{
  int result; // eax

  if ( a1 >= 0.0 )
  {
    result = a2;
    *(_DWORD *)&byte_5D4594[2386932] = &byte_5D4594[2386952];
    *(float *)&byte_5D4594[2386952] = a1 * 0.011764706 + 8388608.0;
    *(_DWORD *)a2 = 0x7FFFFF & *(_DWORD *)&byte_5D4594[2386952];
  }
  else
  {
    result = sub_419A70(a1);
    *(_DWORD *)a2 = result;
  }
  return result;
}

//----- (00517640) --------------------------------------------------------
__int16 __cdecl sub_517640(signed int a1)
{
  int v1; // edi
  int v2; // eax
  signed int v3; // esi
  int v4; // ebx
  signed int v5; // eax
  int v6; // ecx
  int v8; // [esp+4h] [ebp-14h]
  int v9; // [esp+8h] [ebp-10h]
  int v10; // [esp+Ch] [ebp-Ch]
  int v11; // [esp+10h] [ebp-8h]
  int v12; // [esp+14h] [ebp-4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 16);
  if ( !(v2 & 0x20) && !(v2 & 0x200) && v2 & 4 )
  {
    if ( !(*(_BYTE *)(a1 + 8) & 1) )
    {
      sub_4E7350(a1);
      sub_5175E0(*(float *)(v1 + 232), (int)&v8);
      sub_5175E0(*(float *)(v1 + 236), (int)&v10);
      sub_5175E0(*(float *)(v1 + 240), (int)&a1);
      sub_5175E0(*(float *)(v1 + 244), (int)&v9);
      v3 = v8;
      if ( v8 < 0 )
      {
        v3 = 0;
        v8 = 0;
      }
      v4 = v10;
      if ( v10 < 0 )
      {
        v4 = 0;
        v10 = 0;
      }
      v5 = a1;
      if ( a1 >= *(int *)&byte_5D4594[2386944] )
      {
        v5 = *(_DWORD *)&byte_5D4594[2386944] - 1;
        a1 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      }
      v6 = v9;
      if ( v9 >= *(int *)&byte_5D4594[2386944] )
      {
        v6 = *(_DWORD *)&byte_5D4594[2386944] - 1;
        v9 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      }
      for ( *(_BYTE *)(v1 + 336) = 0; v4 <= v6; ++v4 )
      {
        if ( v3 <= v5 )
        {
          do
          {
            sub_517780(1, v3, v4, v1);
            v5 = a1;
            ++v3;
          }
          while ( v3 <= a1 );
          v3 = v8;
          v6 = v9;
        }
      }
    }
    sub_5175E0(*(float *)(v1 + 64), (int)&v12);
    sub_5175E0(*(float *)(v1 + 68), (int)&v11);
    sub_517780(0, v12, v11, v1);
    v2 = *(_DWORD *)(v1 + 16);
    BYTE1(v2) |= 2u;
    *(_DWORD *)(v1 + 16) = v2;
  }
  return v2;
}

//----- (00517780) --------------------------------------------------------
int __cdecl sub_517780(int a1, int a2, int a3, int a4)
{
  int result; // eax
  unsigned __int8 v5; // cl
  int v6; // esi
  int v7; // esi

  if ( a1 )
  {
    result = a1 - 1;
    if ( a1 == 1 )
    {
      v5 = *(_BYTE *)(a4 + 336);
      if ( v5 < 4u )
      {
        result = a4 + 16 * (v5 + 17);
        *(_BYTE *)(a4 + 336) = v5 + 1;
        *(_WORD *)result = a2;
        *(_WORD *)(result + 2) = a3;
        *(_DWORD *)(result + 12) = a4;
        *(_DWORD *)(result + 8) = 0;
        *(_DWORD *)(result + 4) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3 + 4);
        v6 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3 + 4);
        if ( v6 )
          *(_DWORD *)(v6 + 8) = result;
        *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3 + 4) = result;
      }
    }
  }
  else
  {
    *(_DWORD *)(a4 + 268) = a4;
    result = a4 + 256;
    *(_WORD *)(a4 + 256) = a2;
    *(_WORD *)(a4 + 258) = a3;
    *(_DWORD *)(a4 + 264) = 0;
    *(_DWORD *)(a4 + 260) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3);
    v7 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3);
    if ( v7 )
      *(_DWORD *)(v7 + 8) = result;
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a2) + 16 * a3) = result;
  }
  return result;
}

//----- (00517870) --------------------------------------------------------
__int16 __cdecl sub_517870(int a1)
{
  int v1; // eax
  int v2; // edi
  unsigned __int16 *v3; // ebx

  v1 = *(_DWORD *)(a1 + 16);
  if ( v1 & 0x200 )
  {
    sub_5178E0(0, (unsigned __int16 *)(a1 + 256));
    if ( !(*(_BYTE *)(a1 + 8) & 1) )
    {
      v2 = 0;
      if ( *(_BYTE *)(a1 + 336) )
      {
        v3 = (unsigned __int16 *)(a1 + 272);
        do
        {
          sub_5178E0(1, v3);
          ++v2;
          v3 += 8;
        }
        while ( v2 < *(unsigned __int8 *)(a1 + 336) );
      }
      *(_BYTE *)(a1 + 336) = 0;
    }
    v1 = *(_DWORD *)(a1 + 16);
    BYTE1(v1) &= 0xFDu;
    *(_DWORD *)(a1 + 16) = v1;
  }
  return v1;
}

//----- (005178E0) --------------------------------------------------------
unsigned __int16 *__cdecl sub_5178E0(int a1, unsigned __int16 *a2)
{
  unsigned __int16 *result; // eax
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  if ( a1 )
  {
    result = (unsigned __int16 *)(a1 - 1);
    if ( a1 == 1 )
    {
      result = a2;
      v3 = *((_DWORD *)a2 + 2);
      if ( v3 )
        *(_DWORD *)(v3 + 4) = *((_DWORD *)a2 + 1);
      else
        *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * *a2) + 16 * a2[1] + 4) = *((_DWORD *)a2 + 1);
      v4 = *((_DWORD *)a2 + 1);
      if ( v4 )
        *(_DWORD *)(v4 + 8) = *((_DWORD *)a2 + 2);
    }
  }
  else
  {
    result = a2;
    v5 = *((_DWORD *)a2 + 2);
    if ( v5 )
      *(_DWORD *)(v5 + 4) = *((_DWORD *)a2 + 1);
    else
      *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * *a2) + 16 * a2[1]) = *((_DWORD *)a2 + 1);
    v6 = *((_DWORD *)a2 + 1);
    if ( v6 )
      *(_DWORD *)(v6 + 8) = *((_DWORD *)a2 + 2);
  }
  return result;
}

//----- (00517970) --------------------------------------------------------
void __cdecl sub_517970(int a1)
{
  sub_517870(a1);
  if ( sub_517590(*(float *)(a1 + 64), *(float *)(a1 + 68)) )
    sub_517640(a1);
  else
    sub_4E5CC0(a1);
}

//----- (005179B0) --------------------------------------------------------
void __cdecl sub_5179B0(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // ecx
  int v4; // edx
  int v5; // eax
  __int16 v6; // dx
  int v7; // eax
  int v8; // [esp+4h] [ebp-4h]

  v1 = a1;
  if ( !(*(_BYTE *)(a1 + 480) & 2) )
  {
    sub_5175E0(*(float *)(a1 + 8), (int)&a1);
    sub_5175E0(*(float *)(v1 + 12), (int)&v8);
    v2 = v8;
    v3 = a1;
    v4 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * a1) + 16 * v8 + 8);
    if ( v4 )
    {
      *(_DWORD *)(v4 + 500) = v1;
      v3 = a1;
      v2 = v8;
    }
    *(_DWORD *)(v1 + 500) = 0;
    v5 = 16 * v2;
    *(_DWORD *)(v1 + 496) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v3) + v5 + 8);
    *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v3) + v5 + 8) = v1;
    v6 = a1;
    *(_WORD *)(v1 + 494) = v8;
    v7 = *(_DWORD *)(v1 + 480);
    *(_WORD *)(v1 + 492) = v6;
    LOBYTE(v7) = v7 | 2;
    *(_DWORD *)(v1 + 480) = v7;
  }
}

//----- (00517A70) --------------------------------------------------------
int __cdecl sub_517A70(int a1)
{
  int result; // eax
  int v2; // ecx
  int v3; // ecx

  result = a1;
  if ( *(_BYTE *)(a1 + 480) & 2 )
  {
    v2 = *(_DWORD *)(a1 + 500);
    if ( v2 )
      *(_DWORD *)(v2 + 496) = *(_DWORD *)(a1 + 496);
    else
      *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * *(__int16 *)(a1 + 492))
                + 16 * *(__int16 *)(a1 + 494)
                + 8) = *(_DWORD *)(a1 + 496);
    v3 = *(_DWORD *)(a1 + 496);
    if ( v3 )
      *(_DWORD *)(v3 + 500) = *(_DWORD *)(a1 + 500);
    *(_DWORD *)(a1 + 480) &= 0xFFFFFFFD;
  }
  return result;
}

//----- (00517AE0) --------------------------------------------------------
int sub_517AE0()
{
  size_t v0; // eax
  int i; // esi

  *(_DWORD *)&byte_5D4594[2386944] = 70;
  *(_DWORD *)&byte_5D4594[2386940] = nox_malloc(0x118u);
  v0 = *(_DWORD *)&byte_5D4594[2386944];
  for ( i = 0; i < *(int *)&byte_5D4594[2386944]; ++i )
  {
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * i) = nox_calloc(v0, 0x10u);
    v0 = *(_DWORD *)&byte_5D4594[2386944];
  }
  return 1;
}

//----- (00517B30) --------------------------------------------------------
void sub_517B30()
{
  int i; // esi

  for ( i = 0; i < *(int *)&byte_5D4594[2386944]; ++i )
    free(*(LPVOID *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * i));
  free(*(LPVOID *)&byte_5D4594[2386940]);
}

//----- (00517B70) --------------------------------------------------------
void __cdecl sub_517B70(float2 *a1, void (__cdecl *a2)(_DWORD, int), int a3)
{
  int v3; // ecx
  int v4; // eax
  int i; // esi
  int v6; // [esp+8h] [ebp-8h]
  int v7; // [esp+Ch] [ebp-4h]

  if ( !a2 )
    return;
  sub_5175E0(a1->field_0, (int)&v6);
  sub_5175E0(a1->field_4, (int)&v7);
  v3 = v6;
  if ( v6 >= 0 )
  {
    if ( v6 < *(int *)&byte_5D4594[2386944] )
      goto LABEL_7;
    v3 = *(_DWORD *)&byte_5D4594[2386944] - 1;
  }
  else
  {
    v3 = 0;
  }
  v6 = v3;
LABEL_7:
  v4 = v7;
  if ( v7 >= 0 )
  {
    if ( v7 < *(int *)&byte_5D4594[2386944] )
      goto LABEL_12;
    v4 = *(_DWORD *)&byte_5D4594[2386944] - 1;
  }
  else
  {
    v4 = 0;
  }
  v7 = v4;
LABEL_12:
  for ( i = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v3) + 16 * v4 + 4); i; i = *(_DWORD *)(i + 4) )
    a2(*(_DWORD *)(i + 12), a3);
}

//----- (00517C10) --------------------------------------------------------
void __cdecl sub_517C10(float4 *a1, void (__cdecl *a2)(float *, int), int a3)
{
  int v3; // eax
  int v4; // et1
  void (__cdecl *v5)(float *, int); // ebp
  int v6; // eax
  int v7; // edi
  float4 *v8; // edi
  int v9; // esi
  int v10; // edx
  int v11; // eax
  int v12; // ecx
  int v13; // ebx
  int v14; // eax
  int v15; // ecx
  int v16; // esi
  int v17; // et1
  _DWORD *v18; // eax
  int v19; // ecx
  float *v20; // ecx
  int v21; // et1
  int v22; // [esp+4h] [ebp-10h]
  int v23; // [esp+8h] [ebp-Ch]
  int v24; // [esp+Ch] [ebp-8h]
  int v25; // [esp+10h] [ebp-4h]
  int v26; // [esp+18h] [ebp+4h]
  int v27; // [esp+1Ch] [ebp+8h]
  int v28; // [esp+20h] [ebp+Ch]

  v4 = *(_DWORD *)&byte_587000[249172];
  v3 = v4;
  if ( v4 < 1 )
  {
    v5 = a2;
    if ( a2 )
    {
      v6 = v3 + 1;
      v7 = *(_DWORD *)&byte_5D4594[4 * v6 + 2386964];
      *(_DWORD *)&byte_587000[249172] = v6;
      *(_DWORD *)&byte_5D4594[4 * v6 + 2386964] = v7 + 1;
      v8 = a1;
      sub_5175E0(a1->field_0, (int)&v24);
      sub_5175E0(a1->field_4, (int)&v25);
      sub_5175E0(a1->field_8, (int)&v22);
      sub_5175E0(a1->field_C, (int)&v23);
      v9 = v24;
      if ( v24 < 0 )
      {
        v24 = 0;
        v9 = 0;
      }
      v10 = v22;
      if ( v22 >= *(int *)&byte_5D4594[2386944] )
      {
        v10 = *(_DWORD *)&byte_5D4594[2386944] - 1;
        v22 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      }
      v11 = v25;
      if ( v25 < 0 )
      {
        v11 = 0;
        v25 = 0;
      }
      if ( v23 >= *(int *)&byte_5D4594[2386944] )
        v23 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      v12 = v11;
      v26 = v11;
      if ( v11 <= v23 )
      {
        v13 = a3;
        do
        {
          v14 = v9;
          v27 = v9;
          if ( v9 <= v10 )
          {
            v15 = 16 * v12;
            v28 = v15;
            do
            {
              v16 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v14) + v15 + 4);
              if ( v16 )
              {
                do
                {
                  v17 = *(_DWORD *)&byte_587000[249172];
                  v18 = (_DWORD *)(*(_DWORD *)(v16 + 12) + 4 * v17 + 248);
                  v19 = *(_DWORD *)&byte_5D4594[4 * v17 + 2386964];
                  if ( *v18 != v19 )
                  {
                    *v18 = v19;
                    v20 = *(float **)(v16 + 12);
                    if ( v20[58] < (double)v8->field_8
                      && v20[60] > (double)v8->field_0
                      && v20[59] < (double)v8->field_C
                      && v20[61] > (double)v8->field_4 )
                    {
                      v5(v20, v13);
                    }
                  }
                  v16 = *(_DWORD *)(v16 + 4);
                }
                while ( v16 );
                v15 = v28;
                v10 = v22;
                v14 = v27;
              }
              v27 = ++v14;
            }
            while ( v14 <= v10 );
            v12 = v26;
            v9 = v24;
          }
          v26 = ++v12;
        }
        while ( v12 <= v23 );
      }
      v21 = *(_DWORD *)&byte_587000[249172];
      *(_DWORD *)&byte_587000[249172] = v21 - 1;
    }
  }
}

//----- (00517DC0) --------------------------------------------------------
void __cdecl sub_517DC0(float4 *a1, void (__cdecl *a2)(int, int), int a3)
{
  void (__cdecl *v3)(int, int); // ebp
  int v4; // ebx
  int v5; // edx
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  int v9; // esi
  int v10; // eax
  int v11; // [esp+Ch] [ebp-10h]
  int v12; // [esp+10h] [ebp-Ch]
  int v13; // [esp+14h] [ebp-8h]
  int v14; // [esp+18h] [ebp-4h]
  float4 *v15; // [esp+20h] [ebp+4h]
  int i; // [esp+24h] [ebp+8h]

  v3 = a2;
  if ( a2 )
  {
    sub_5175E0(a1->field_0, (int)&v13);
    sub_5175E0(a1->field_4, (int)&v14);
    sub_5175E0(a1->field_8, (int)&v11);
    sub_5175E0(a1->field_C, (int)&v12);
    v4 = v13;
    if ( v13 < 0 )
    {
      v13 = 0;
      v4 = 0;
    }
    v5 = v11;
    if ( v11 >= *(int *)&byte_5D4594[2386944] )
    {
      v5 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      v11 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    }
    v6 = v14;
    if ( v14 < 0 )
    {
      v6 = 0;
      v14 = 0;
    }
    if ( v12 >= *(int *)&byte_5D4594[2386944] )
      v12 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    v7 = v6;
    for ( i = v6; v7 <= v12; i = v7 )
    {
      if ( v4 <= v5 )
      {
        v8 = 16 * v7;
        v15 = (float4 *)(16 * v7);
        do
        {
          v9 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v4) + v8);
          if ( v9 )
          {
            do
            {
              v10 = *(_DWORD *)(v9 + 12);
              if ( *(_BYTE *)(v10 + 8) & 1 )
                v3(v10, a3);
              v9 = *(_DWORD *)(v9 + 4);
            }
            while ( v9 );
            v5 = v11;
            v8 = (int)v15;
          }
          ++v4;
        }
        while ( v4 <= v5 );
        v4 = v13;
        v7 = i;
      }
      ++v7;
    }
  }
}

//----- (00517ED0) --------------------------------------------------------
void __cdecl sub_517ED0(float4 *a1, void (__cdecl *a2)(float *, int), int a3)
{
  sub_517C10(a1, a2, a3);
  sub_517DC0(a1, (void (__cdecl *)(int, int))a2, a3);
}

//----- (00517F00) --------------------------------------------------------
int *__cdecl sub_517F00(float *a1, int (__cdecl *a2)(int *, int), int a3)
{
  int *result; // eax
  int *i; // esi
  double v5; // st7
  double v6; // st7

  result = (int *)sub_410780();
  for ( i = result; result; i = result )
  {
    v5 = (double)(23 * i[1]);
    if ( v5 > *a1 && v5 < a1[2] )
    {
      v6 = (double)(23 * i[2]);
      if ( v6 > a1[1] && v6 < a1[3] )
        a2(i, a3);
    }
    result = (int *)sub_410790(i);
  }
  return result;
}

//----- (00517F90) --------------------------------------------------------
void __cdecl sub_517F90(float2 *a1, float a2, int a3, int a4)
{
  double v4; // st7
  int a3a[4]; // [esp+0h] [ebp-20h]
  float4 a1a; // [esp+10h] [ebp-10h]

  a3a[0] = (int)a1;
  a3a[2] = a3;
  *(float *)&a3a[1] = a2 * a2;
  v4 = a1->field_0 - a2;
  a3a[3] = a4;
  a1a.field_0 = v4;
  a1a.field_4 = a1->field_4 - a2;
  a1a.field_8 = a2 + a1->field_0;
  a1a.field_C = a2 + a1->field_4;
  sub_517C10(&a1a, sub_518000, (int)a3a);
}

//----- (00518000) --------------------------------------------------------
void __cdecl sub_518000(float *a1, int a2)
{
  double v2; // st7
  double v3; // st6

  v2 = **(float **)a2 - a1[14];
  v3 = *(float *)(*(_DWORD *)a2 + 4) - a1[15];
  if ( v3 * v3 + v2 * v2 < *(float *)(a2 + 4) )
    (*(void (__cdecl **)(float *, _DWORD))(a2 + 8))(a1, *(_DWORD *)(a2 + 12));
}

//----- (00518040) --------------------------------------------------------
int __cdecl sub_518040(int arg0, float a2, int arg8, int a4)
{
  int result; // eax
  double v5; // st7
  double v6; // st7
  int a3[4]; // [esp+0h] [ebp-20h]
  float4 a1; // [esp+10h] [ebp-10h]

  result = arg0;
  if ( arg0 )
  {
    v5 = *(float *)arg0 - a2;
    a3[2] = arg8;
    a3[0] = arg0;
    *(float *)&a3[1] = a2;
    a1.field_0 = v5;
    v6 = *(float *)(arg0 + 4) - a2;
    a3[3] = a4;
    a1.field_4 = v6;
    a1.field_8 = a2 + *(float *)arg0;
    a1.field_C = a2 + *(float *)(arg0 + 4);
    sub_517C10(&a1, sub_5180B0, (int)a3);
  }
  return result;
}

//----- (005180B0) --------------------------------------------------------
void __cdecl sub_5180B0(int a1, int a2)
{
  float2 *v2; // eax
  double v3; // st7
  long double v4; // st7
  long double v5; // st7
  float2 *v6; // eax
  double v7; // st7
  float2 v8;

  if ( a1 && a2 )
  {
    if ( *(_DWORD *)(a1 + 172) == 2 )
    {
      v6 = *(float2 **)a2;
      *(float *)&v8 = **(float **)a2 - *(float *)(a1 + 56);
      v7 = v6->field_4 - *(float *)(a1 + 60);
      v8.field_4 = v7;
      v4 = sqrt(v7 * v8.field_4 + v8.field_0 * v8.field_0) - *(float *)(a1 + 176);
    }
    else
    {
      if ( *(_DWORD *)(a1 + 172) == 3 )
      {
        v5 = sub_54A990((float2 *)*(_DWORD *)a2, *(float *)(a2 + 4), a1, &v8);
        goto LABEL_9;
      }
      v2 = *(float2 **)a2;
      *(float *)&v8 = **(float **)a2 - *(float *)(a1 + 56);
      v3 = v2->field_4 - *(float *)(a1 + 60);
      v8.field_4 = v3;
      v4 = sqrt(v3 * v8.field_4 + v8.field_0 * v8.field_0);
    }
    v5 = *(float *)(a2 + 4) - v4;
LABEL_9:
    if ( v5 > 0.0 )
      (*(void (__cdecl **)(int, _DWORD))(a2 + 8))(a1, *(_DWORD *)(a2 + 12));
  }
}

//----- (00518170) --------------------------------------------------------
void __cdecl sub_518170(int a1, float a2, int a3, int a4)
{
  void (__cdecl *v4)(int, int); // ebp
  int v5; // ebx
  int v6; // edx
  int v7; // eax
  double v8; // st7
  int v9; // ecx
  int v10; // edi
  int v11; // eax
  int v12; // esi
  int v13; // ecx
  double v14; // st7
  double v15; // st6
  float v16; // [esp+0h] [ebp-24h]
  float v17; // [esp+0h] [ebp-24h]
  float v18; // [esp+0h] [ebp-24h]
  float v19; // [esp+0h] [ebp-24h]
  int v20; // [esp+14h] [ebp-10h]
  int v21; // [esp+18h] [ebp-Ch]
  int v22; // [esp+1Ch] [ebp-8h]
  int v23; // [esp+20h] [ebp-4h]
  int v24; // [esp+2Ch] [ebp+8h]
  int v25; // [esp+30h] [ebp+Ch]
  int v26; // [esp+34h] [ebp+10h]

  v4 = (void (__cdecl *)(int, int))a3;
  if ( a3 )
  {
    v16 = *(float *)a1 - a2;
    sub_5175E0(v16, (int)&v22);
    v17 = *(float *)(a1 + 4) - a2;
    sub_5175E0(v17, (int)&v23);
    v18 = a2 + *(float *)a1;
    sub_5175E0(v18, (int)&v20);
    v19 = a2 + *(float *)(a1 + 4);
    sub_5175E0(v19, (int)&v21);
    v5 = v22;
    if ( v22 < 0 )
    {
      v22 = 0;
      v5 = 0;
    }
    v6 = v20;
    if ( v20 >= *(int *)&byte_5D4594[2386944] )
    {
      v6 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      v20 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    }
    v7 = v23;
    if ( v23 < 0 )
    {
      v7 = 0;
      v23 = 0;
    }
    if ( v21 >= *(int *)&byte_5D4594[2386944] )
      v21 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    v8 = a2 * a2;
    v9 = v7;
    v24 = v7;
    *(float *)&v25 = v8;
    if ( v7 <= v21 )
    {
      v10 = a4;
      do
      {
        if ( v5 <= v6 )
        {
          v11 = 16 * v9;
          v26 = 16 * v9;
          do
          {
            v12 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v5) + v11);
            if ( v12 )
            {
              do
              {
                v13 = *(_DWORD *)(v12 + 12);
                if ( *(_BYTE *)(v13 + 8) & 1 )
                {
                  v14 = *(float *)a1 - *(float *)(v13 + 56);
                  v15 = *(float *)(a1 + 4) - *(float *)(v13 + 60);
                  if ( v15 * v15 + v14 * v14 <= *(float *)&v25 )
                    v4(v13, v10);
                }
                v12 = *(_DWORD *)(v12 + 4);
              }
              while ( v12 );
              v11 = v26;
              v6 = v20;
            }
            ++v5;
          }
          while ( v5 <= v6 );
          v5 = v22;
          v9 = v24;
        }
        v24 = ++v9;
      }
      while ( v9 <= v21 );
    }
  }
}

//----- (005182D0) --------------------------------------------------------
void __cdecl sub_5182D0(float *a1, float a2, void (__cdecl *a3)(int, int), int a4)
{
  void (__cdecl *v4)(int, int); // ebp
  int v5; // ebx
  int v6; // edx
  int v7; // eax
  double v8; // st7
  int v9; // ecx
  int v10; // edi
  int v11; // eax
  int v12; // esi
  double v13; // st7
  double v14; // st6
  float v15; // [esp+0h] [ebp-24h]
  float v16; // [esp+0h] [ebp-24h]
  float v17; // [esp+0h] [ebp-24h]
  float v18; // [esp+0h] [ebp-24h]
  int v19; // [esp+14h] [ebp-10h]
  int v20; // [esp+18h] [ebp-Ch]
  int v21; // [esp+1Ch] [ebp-8h]
  int v22; // [esp+20h] [ebp-4h]
  int v23; // [esp+2Ch] [ebp+8h]
  float v24; // [esp+30h] [ebp+Ch]
  int v25; // [esp+34h] [ebp+10h]

  v4 = a3;
  if ( a3 )
  {
    v15 = *a1 - a2;
    sub_5175E0(v15, (int)&v21);
    v16 = a1[1] - a2;
    sub_5175E0(v16, (int)&v22);
    v17 = a2 + *a1;
    sub_5175E0(v17, (int)&v19);
    v18 = a2 + a1[1];
    sub_5175E0(v18, (int)&v20);
    v5 = v21;
    if ( v21 < 0 )
    {
      v21 = 0;
      v5 = 0;
    }
    v6 = v19;
    if ( v19 >= *(int *)&byte_5D4594[2386944] )
    {
      v6 = *(_DWORD *)&byte_5D4594[2386944] - 1;
      v19 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    }
    v7 = v22;
    if ( v22 < 0 )
    {
      v7 = 0;
      v22 = 0;
    }
    if ( v20 >= *(int *)&byte_5D4594[2386944] )
      v20 = *(_DWORD *)&byte_5D4594[2386944] - 1;
    v8 = a2 * a2;
    v9 = v7;
    v23 = v7;
    v24 = v8;
    if ( v7 <= v20 )
    {
      v10 = a4;
      do
      {
        if ( v5 <= v6 )
        {
          v11 = 16 * v9;
          v25 = 16 * v9;
          do
          {
            v12 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v5) + v11 + 8);
            if ( v12 )
            {
              do
              {
                if ( *(_BYTE *)(v12 + 480) & 1 )
                {
                  v13 = *a1 - *(float *)(v12 + 8);
                  v14 = a1[1] - *(float *)(v12 + 12);
                  if ( v14 * v14 + v13 * v13 <= v24 )
                    v4(v12, v10);
                }
                v12 = *(_DWORD *)(v12 + 496);
              }
              while ( v12 );
              v11 = v25;
              v6 = v19;
            }
            ++v5;
          }
          while ( v5 <= v6 );
          v5 = v21;
          v9 = v23;
        }
        v23 = ++v9;
      }
      while ( v9 <= v20 );
    }
  }
}

//----- (00518440) --------------------------------------------------------
int __cdecl sub_518440(int a1, unsigned __int8 a2)
{
  return sub_518460((float2 *)a1, a2, 0);
}

//----- (00518460) --------------------------------------------------------
int __cdecl sub_518460(float2 *a1, unsigned __int8 a2, int a3)
{
  int v3; // edi
  float v5; // [esp+0h] [ebp-2Ch]
  float v6; // [esp+0h] [ebp-2Ch]
  float v7; // [esp+0h] [ebp-2Ch]
  float v8; // [esp+0h] [ebp-2Ch]
  float v9; // [esp+18h] [ebp-14h]
  int4 v10; // [esp+1Ch] [ebp-10h]

  ++*(_DWORD *)&byte_5D4594[2386960];
  *(_DWORD *)&byte_5D4594[2386928] = 1148846080;
  v9 = 0.0;
  v3 = 0;
  do
  {
    v5 = a1->field_0 - v9;
    sub_5175E0(v5, &v10.field_0);
    v6 = a1->field_4 - v9;
    sub_5175E0(v6, &v10.field_4);
    v7 = v9 + a1->field_0;
    sub_5175E0(v7, &v10.field_8);
    v8 = v9 + a1->field_4;
    sub_5175E0(v8, &v10.field_C);
    *(_DWORD *)&byte_5D4594[2386948] = 0;
    sub_518550(&v10, (int *)a1, a2, a3);
    if ( *(_DWORD *)&byte_5D4594[2386948] )
    {
      v3 = *(_DWORD *)&byte_5D4594[2386948];
      v9 = *(float *)&byte_5D4594[2386928];
    }
    else
    {
      if ( v3 )
        return v3;
      v9 = v9 + 85.0;
    }
  }
  while ( v9 < 1000.0 );
  return v3;
}

//----- (00518550) --------------------------------------------------------
int __cdecl sub_518550(int *a1, int *a2, unsigned __int8 a3, int a4)
{
  int *v4; // ebp
  int v5; // eax
  float v6; // edx
  int result; // eax
  int v8; // ecx
  int v9; // edx
  int v10; // ecx
  int v11; // eax
  int v12; // esi
  int v13; // ebx
  int v14; // edi
  int *v15; // ebp
  double v16; // st7
  double v17; // st6
  long double v18; // st5
  int v19; // [esp+4h] [ebp-20h]
  int v20; // [esp+8h] [ebp-1Ch]
  int v21; // [esp+Ch] [ebp-18h]
  float v22; // [esp+10h] [ebp-14h]
  float4 v23; // [esp+14h] [ebp-10h]

  v4 = a1;
  if ( (int)*a1 < 0 )
    *a1 = 0;
  v5 = *(_DWORD *)&byte_5D4594[2386944];
  if ( a1[2] >= *(int *)&byte_5D4594[2386944] )
  {
    a1[2] = *(_DWORD *)&byte_5D4594[2386944] - 1;
    v5 = *(_DWORD *)&byte_5D4594[2386944];
  }
  if ( a1[1] < 0 )
  {
    a1[1] = 0;
    v5 = *(_DWORD *)&byte_5D4594[2386944];
  }
  if ( a1[3] >= v5 )
    a1[3] = v5 - 1;
  v6 = *((float *)a2 + 1);
  result = a1[1];
  LODWORD(v23.field_0) = *a2;
  v8 = a1[3];
  v23.field_4 = v6;
  v20 = result;
  if ( result <= v8 )
  {
    v9 = 16 * result;
    v21 = 16 * result;
    do
    {
      v10 = *v4;
      v19 = *v4;
      if ( *v4 <= v4[2] )
      {
        do
        {
          v11 = v9 + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v10);
          if ( *(_DWORD *)(v11 + 12) != *(_DWORD *)&byte_5D4594[2386960] )
          {
            v12 = *(_DWORD *)(v11 + 8);
            if ( v12 )
            {
              do
              {
                if ( *(_BYTE *)(v12 + 480) & 1 && sub_579EE0(v12, a3) )
                {
                  if ( !a4 )
                    goto LABEL_35;
                  v13 = 0;
                  v14 = 0;
                  if ( *(_BYTE *)(v12 + 476) )
                  {
                    v15 = (int *)(v12 + 92);
                    do
                    {
                      if ( *(_BYTE *)(*v15 + 480) & 1 && sub_579EE0(*v15, a3) )
                        ++v13;
                      ++v14;
                      v15 += 2;
                    }
                    while ( v14 < *(unsigned __int8 *)(v12 + 476) );
                    v4 = a1;
                    if ( v13 )
                    {
LABEL_35:
                      v16 = *(float *)a2 - *(float *)(v12 + 8);
                      v17 = *((float *)a2 + 1) - *(float *)(v12 + 12);
                      v18 = sqrt(v17 * v17 + v16 * v16);
                      if ( v18 < *(float *)&byte_5D4594[2386928] )
                      {
                        v23.field_8 = *(float *)(v12 + 8);
                        v23.field_C = *(float *)(v12 + 12);
                        if ( sub_535250(&v23, 0, 0, 1) )
                        {
                          *(_DWORD *)&byte_5D4594[2386948] = v12;
                          v22 = v18;
                          *(float *)&byte_5D4594[2386928] = v22;
                        }
                      }
                    }
                  }
                }
                v12 = *(_DWORD *)(v12 + 496);
              }
              while ( v12 );
              v9 = v21;
              v10 = v19;
            }
            *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2386940] + 4 * v10) + v9 + 12) = *(_DWORD *)&byte_5D4594[2386960];
          }
          v19 = ++v10;
        }
        while ( v10 <= v4[2] );
        result = v20;
      }
      ++result;
      v9 += 16;
      v20 = result;
      v21 = v9;
    }
    while ( result <= v4[3] );
  }
  return result;
}

//----- (00518740) --------------------------------------------------------
int __cdecl sub_518740(float2 *a1, unsigned __int8 a2)
{
  return sub_518460(a1, a2, 1);
}

//----- (00518760) --------------------------------------------------------
void sub_518760()
{
  srand(0x22F4u);
}

//----- (00518770) --------------------------------------------------------
int sub_518770()
{
  int result; // eax

  result = sub_4E3AA0((CHAR *)&byte_587000[249176]);
  *(_DWORD *)&byte_5D4594[2386972] = result;
  if ( result )
  {
    result = sub_4E3AA0((CHAR *)&byte_587000[249196]);
    *(_DWORD *)&byte_5D4594[2386976] = result;
    if ( result )
    {
      result = sub_4E3AA0((CHAR *)&byte_587000[249212]);
      *(_DWORD *)&byte_5D4594[2386980] = result;
      if ( result )
      {
        *(_DWORD *)&byte_5D4594[2386984] = sub_4E3AA0((CHAR *)&byte_587000[249220]);
        result = *(_DWORD *)&byte_5D4594[2386984] != 0;
      }
    }
  }
  return result;
}

//----- (005187E0) --------------------------------------------------------
int __cdecl sub_5187E0(int a1, int a2)
{
  __int16 v2; // ax
  float v3; // ecx
  __int16 v4; // ax
  float v5; // edx
  int v6; // eax
  char v7; // al
  int2 a2a; // [esp+4h] [ebp-14h]
  char v10[11]; // [esp+Ch] [ebp-Ch]

  v10[0] = 48;
  *(_WORD *)&v10[3] = *(_WORD *)(a2 + 4);
  v2 = sub_578AC0((_DWORD *)a2);
  v3 = *(float *)(a2 + 56);
  *(_WORD *)&v10[1] = v2;
  v4 = sub_419A70(v3);
  v5 = *(float *)(a2 + 60);
  *(_WORD *)&v10[5] = v4;
  v6 = sub_419A70(v5);
  *(_WORD *)&v10[7] = v6;
  if ( *(_BYTE *)(a2 + 8) & 1 && *(_BYTE *)(a2 + 12) & 0x30 )
  {
    LOWORD(v6) = *(_WORD *)(a2 + 124);
    v10[10] = v6 >> 3;
  }
  else
  {
    v10[10] = -1;
  }
  sub_509E20(*(__int16 *)(a2 + 124), &a2a);
  if ( (unsigned __int8)(LOBYTE(a2a.field_0) + 3 * LOBYTE(a2a.field_4) + 4) <= 3u )
    v7 = LOBYTE(a2a.field_0) + 3 * LOBYTE(a2a.field_4) + 4;
  else
    v7 = LOBYTE(a2a.field_0) + 3 * LOBYTE(a2a.field_4) + 3;
  v10[9] = 16 * v7;
  return sub_40EF40(a1, v10, 11);
}

//----- (005188A0) --------------------------------------------------------
int __cdecl sub_5188A0(int a1, int a2)
{
  __int16 *v2; // eax
  int v3; // ebx
  __int16 v4; // ax
  __int16 v5; // cx
  __int16 v6; // dx
  __int16 v7; // ax
  float v8; // ecx
  char v10[9];

  if ( *(_DWORD *)(a2 + 8) & 0x20000 )
  {
    v2 = *(__int16 **)(a2 + 556);
    if ( v2 )
    {
      v3 = *(_DWORD *)(a2 + 748);
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a2 + 536)) > 2 )
      {
        v4 = *v2;
        v5 = *(_WORD *)(v3 + 2 * a1 + 96);
        if ( v4 != v5 )
        {
          sub_4D8760(a1, *(_DWORD *)(a2 + 36), v4 - v5);
          *(_WORD *)(v3 + 2 * a1 + 96) = **(_WORD **)(a2 + 556);
        }
      }
    }
  }
  v6 = *(_WORD *)(a2 + 4);
  v10[0] = 47;
  *(_WORD *)&v10[3] = v6;
  *(_WORD *)&v10[1] = sub_578AC0((_DWORD *)a2);
  v7 = sub_419A70(*(float *)(a2 + 56));
  v8 = *(float *)(a2 + 60);
  *(_WORD *)&v10[5] = v7;
  *(_WORD *)&v10[7] = sub_419A70(v8);
  return sub_40EF40(a1, v10, 9);
}

//----- (00518960) --------------------------------------------------------
int __cdecl sub_518960(int a1, _DWORD *a2, int a3)
{
  int v3; // ebx
  _DWORD *v4; // esi
  __int16 *v5; // eax
  int v6; // edi
  __int16 v7; // ax
  __int16 v8; // cx
  __int16 v9; // dx
  __int16 v10; // ax
  float v11; // ecx
  __int16 v12; // ax
  int v13; // edi
  char v14; // al
  char v15; // al
    int2 a2a; // [esp+Ch] [ebp-14h]
  char v18[11]; // [esp+14h] [ebp-Ch]

  v3 = a1;
  v4 = a2;
  if ( a3 )
  {
    v5 = (__int16 *)a2[139];
    if ( v5 )
    {
      v6 = a2[187];
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - a2[134]) > 2 )
      {
        v7 = *v5;
        v8 = *(_WORD *)(v6 + 2 * a1 + 412);
        if ( v7 != v8 )
        {
          sub_4D8760(a1, a2[9], v7 - v8);
          *(_WORD *)(v6 + 2 * v3 + 412) = *(_WORD *)v4[139];
        }
      }
    }
  }
  v9 = *((_WORD *)v4 + 2);
  v18[0] = 48;
  *(_WORD *)&v18[3] = v9;
  *(_WORD *)&v18[1] = sub_578AC0(v4);
  v10 = sub_419A70(*((float *)v4 + 14));
  v11 = *((float *)v4 + 15);
  *(_WORD *)&v18[5] = v10;
  v12 = sub_419A70(v11);
  v13 = v4[187];
  *(_WORD *)&v18[7] = v12;
  v18[9] = sub_533790((int)v4);
  v14 = *((_BYTE *)v4 + 12);
  v18[10] = *(_BYTE *)(v13 + 481);
  if ( v14 & 0x10 && *(_BYTE *)(v13 + 2094) && sub_415FA0(0, 10) >= 8 )
  {
    v18[9] = 14;
    sub_4F9F90(50, &a3, &a1);
    v18[10] = sub_415FA0(0, a3);
  }
  sub_509E20(*((__int16 *)v4 + 62), &a2a);
  LOBYTE(a3) = LOBYTE(a2a.field_0) + 3 * LOBYTE(a2a.field_4) + 4;
  if ( (unsigned __int8)a3 <= 3u )
    v15 = a3;
  else
    v15 = a3 - 1;
  v18[9] |= 16 * v15;
  return sub_40EF40(v3, v18, 11);
}

//----- (00518AE0) --------------------------------------------------------
int __cdecl sub_518AE0(int a1, int a2, _DWORD *a3)
{
  _DWORD *v3; // esi
  __int16 v4; // ax
  int v5; // ecx
  int v7; // eax
  char v8; // dl
  int v9; // eax
  char v10; // dl
  unsigned __int8 v11; // cl
  int v12; // esi
  int v13; // esi
  unsigned __int8 v14; // al
  char v15; // dl

  v3 = a3;
  v4 = sub_578AC0(a3);
  v5 = v3[2];
  *(_WORD *)((char *)&a3 + 1) = v4;
  if ( v5 & 0x400000 && v3[3] & 0x18 )
  {
    HIBYTE(a3) = *(_BYTE *)v3[187];
    LOBYTE(a3) = -77;
    return sub_4E5390(a2, (int)&a3, 4, 0, 1);
  }
  v7 = *((unsigned __int16 *)v3 + 2);
  if ( (unsigned __int16)v7 == *(_DWORD *)&byte_5D4594[2386972] )
  {
    v8 = *(_BYTE *)(v3[187] + 20);
    LOBYTE(a3) = 57;
    HIBYTE(a3) = v8;
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  if ( v7 == *(_DWORD *)&byte_5D4594[2386980] )
  {
    v9 = v3[4];
    LOBYTE(a3) = 57;
    HIBYTE(a3) = ~HIBYTE(v9) & 1;
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  if ( v7 == *(_DWORD *)&byte_5D4594[2386976] )
  {
    v10 = *(_BYTE *)v3[187];
    LOBYTE(a3) = -76;
    HIBYTE(a3) = v10 & 1;
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  if ( v5 & 0x4000 )
  {
    v11 = *(_BYTE *)(v3[187] + 16);
    LOBYTE(a3) = 57;
    HIBYTE(a3) = v11 >> 2;
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  if ( (v5 & 0x8000) != 0 )
  {
    v12 = v3[187];
    if ( v12 && (v13 = *(_DWORD *)(v12 + 4)) != 0 )
    {
      v14 = *(_BYTE *)(*(_DWORD *)(v13 + 748) + 16);
      LOBYTE(a3) = 57;
      HIBYTE(a3) = v14 >> 2;
    }
    else
    {
      HIBYTE(a3) = 0;
      LOBYTE(a3) = 57;
    }
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  if ( (v5 & 0x80u) != 0 )
  {
    v15 = *(_BYTE *)(v3[187] + 12);
    LOBYTE(a3) = -78;
    HIBYTE(a3) = v15;
    return sub_40EBC0(a2, 1, &a3, 4);
  }
  sub_527E50(a1, v3);
  return 0;
}

//----- (00518C30) --------------------------------------------------------
int __cdecl sub_518C30(int a1, _DWORD *a2, int a3, signed int a4)
{
  int v4; // ebx
  _DWORD *v5; // esi
  int v6; // edi
  int v7; // ebp
  __int16 *v8; // eax
  __int16 v9; // ax
  __int16 v10; // cx
  __int16 v11; // ax
  __int16 v12; // ax
  float v13; // ecx
  __int16 v14; // ax
  float v15; // edx
  char v16; // al
  char v17; // al
  signed int v18; // eax
  char v19; // al
  int result; // eax
   int2 a2a; // [esp+10h] [ebp-14h]
  char v22[12]; // [esp+18h] [ebp-Ch]
  int v23; // [esp+28h] [ebp+4h]

  v4 = a1;
  v5 = a2;
  v23 = *(_DWORD *)(a1 + 748);
  v6 = a2[187];
  v7 = *(unsigned __int8 *)(*(_DWORD *)(v23 + 276) + 2064);
  if ( a4 )
  {
    v8 = (__int16 *)a2[139];
    if ( v8 )
    {
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - a2[134]) > 2 )
      {
        v9 = *v8;
        v10 = *(_WORD *)(v6 + 2 * v7 + 12);
        if ( v9 != v10 )
        {
          sub_4D8760(v7, a2[9], v9 - v10);
          *(_WORD *)(v6 + 2 * v7 + 12) = *(_WORD *)v5[139];
        }
      }
    }
  }
  if ( (_DWORD *)v4 == v5 )
    sub_4D9900(v4);
  *(_DWORD *)(*(_DWORD *)(v23 + 276) + 4 * *(unsigned __int8 *)(*(_DWORD *)(v6 + 276) + 2064) + 4452) = *(_DWORD *)&byte_5D4594[2598000];
  v11 = *((_WORD *)v5 + 2);
  v22[0] = -61;
  *(_WORD *)&v22[3] = v11;
  v12 = sub_578AC0(v5);
  v13 = *((float *)v5 + 14);
  *(_WORD *)&v22[1] = v12;
  v14 = sub_419A70(v13);
  v15 = *((float *)v5 + 15);
  *(_WORD *)&v22[5] = v14;
  *(_WORD *)&v22[7] = sub_419A70(v15);
  v22[9] = 0;
  v22[11] = sub_4FA2B0((int)v5);
  v16 = *(_BYTE *)(v6 + 88);
  if ( v16 == 1
    || v16 == 10
    || v16 == 2
    || v16 == 15
    || v16 == 16
    || v16 == 17
    || v16 == 14
    || v16 == 20
    || v16 == 18
    || v16 == 19
    || v16 == 21
    || v16 == 22
    || v16 == 24
    || v16 == 25
    || v16 == 27
    || v16 == 28
    || v16 == 29
    || v16 == 26
    || v16 == 30
    || v16 == 32 )
  {
    v22[10] = *(_BYTE *)(v6 + 236);
  }
  else
  {
    v22[10] = -1;
  }
  if ( *(_WORD *)(v6 + 160) && sub_415FA0(0, 10) >= 8 )
  {
    v22[11] = 50;
    v22[10] = -1;
  }
  v17 = *(_BYTE *)(v6 + 88);
  if ( (v17 == 3 || v17 == 4) && v5[131] == 16 )
  {
    v22[11] = 51;
    v22[10] = -1;
  }
  if ( *(_BYTE *)(v6 + 88) != 30 && *(_DWORD *)(v6 + 164) )
  {
    sub_4F9F90(52, &a4, (int *)&a2);
    v18 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v6 + 164)) / ((unsigned int)a2 + 1);
    if ( v18 >= a4 || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v6 + 164)) >= 4 )
    {
      *(_DWORD *)(v6 + 164) = 0;
    }
    else
    {
      v22[11] = 52;
      v22[10] = v18;
    }
  }
  sub_509E20(*((__int16 *)v5 + 62), &a2a);
  LOBYTE(a2) = LOBYTE(a2a.field_0) + 3 * LOBYTE(a2a.field_4) + 4;
  if ( (unsigned __int8)a2 <= 3u )
    v19 = (char)a2;
  else
    v19 = (_BYTE)a2 - 1;
  v22[9] |= 16 * v19;
  if ( a3 )
    result = sub_40EF40(*(unsigned __int8 *)(*(_DWORD *)(v23 + 276) + 2064), v22, 12);
  else
    result = sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(v23 + 276) + 2064), 1, v22, 12);
  return result;
}

//----- (00518EE0) --------------------------------------------------------
int __cdecl sub_518EE0(_DWORD *a3)
{
  _DWORD *v1; // ebx
  int v2; // esi
  int v3; // edi
  int result; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // ebp
  int v14; // ebx
  int v15; // eax
  int v16; // edi
  char v17[3]; // [esp+Ch] [ebp-20h]
  int v18; // [esp+10h] [ebp-1Ch]
  char v19[5]; // [esp+14h] [ebp-18h]
  float4 a1; // [esp+1Ch] [ebp-10h]

  v1 = a3;
  v2 = a3[187];
  v3 = *(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064);
  sub_40F020(v3);
  if ( v3 != 31 && !((*(_DWORD *)&byte_5D4594[2598000] + v3) % (unsigned int)(15 * *(_DWORD *)&byte_5D4594[2649704])) )
    sub_4D9020(v3, (int)a3);
  if ( !*(_DWORD *)&byte_5D4594[2650652]
    || !(*(_DWORD *)&byte_5D4594[2598000] % (unsigned int)sub_40A6C0())
    || sub_40A5C0(8) )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 3680) & 0x40 )
    {
      v19[0] = 40;
      *(_DWORD *)&v19[1] = *(_DWORD *)&byte_5D4594[2598000];
      sub_40EF40(v3, v19, 5);
      sub_417530(*(_DWORD *)(v2 + 276), 64);
    }
    else
    {
      v17[0] = 39;
      *(_WORD *)&v17[1] = *(_WORD *)&byte_5D4594[2598000];
      sub_40EF40(v3, v17, 3);
    }
  }
  if ( !*(_DWORD *)&byte_5D4594[2650652]
    || a3 == *(_DWORD **)&byte_5D4594[3843628]
    || sub_40A5C0(8)
    || !(*(_DWORD *)&byte_5D4594[2598000] % (unsigned int)sub_40A6C0()) )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 276) + 3680) & 3 || *(_DWORD *)&byte_5D4594[2650636] & 0x400000 )
    {
      result = sub_519330((int)a3);
      if ( !result )
        return result;
      if ( *(_DWORD *)&byte_5D4594[2650636] & 0x400000 )
        sub_518C30((int)a3, a3, 1, 1);
    }
    else
    {
      result = sub_518C30((int)a3, a3, 1, 1);
      if ( !result )
        return result;
    }
    v5 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v5 + 10);
    a1.field_0 = *(float *)(v5 + 3632) - (double)v18 - 100.0;
    v6 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v6 + 12);
    a1.field_4 = *(float *)(v6 + 3636) - (double)v18 - 100.0;
    v7 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v7 + 10);
    a1.field_8 = (double)v18 + *(float *)(v7 + 3632) + 100.0;
    v8 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v8 + 12);
    a1.field_C = (double)v18 + *(float *)(v8 + 3636) + 100.0;
    sub_517ED0(&a1, sub_5193B0, (int)a3);
    v9 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v9 + 10);
    a1.field_0 = *(float *)(v9 + 3632) - (double)v18 - 128.0;
    v10 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v10 + 12);
    a1.field_4 = *(float *)(v10 + 3636) - (double)v18 - 128.0;
    v11 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v11 + 10);
    a1.field_8 = (double)v18 + *(float *)(v11 + 3632) + 128.0;
    v12 = *(_DWORD *)(v2 + 276);
    v18 = *(unsigned __int16 *)(v12 + 12);
    a1.field_C = (double)v18 + *(float *)(v12 + 3636) + 128.0;
    sub_517F00(&a1, sub_519660, (int)a3);
    if ( sub_519710(v2) )
      sub_519760((int)a3, &a1.field_0);
    if ( byte_5D4594[2598000] & 8 )
    {
      v13 = 0;
      v14 = 1 << *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2064);
      v15 = sub_4DA790();
LABEL_25:
      v16 = v15;
      while ( 1 )
      {
        if ( v16 )
        {
          if ( !(*(_DWORD *)(v16 + 8) & 0x20400000)
            && !sub_4173D0(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), v16)
            && (*(float *)(v16 + 232) > (double)a1.field_8
             || *(float *)(v16 + 240) < (double)a1.field_0
             || *(float *)(v16 + 236) > (double)a1.field_C
             || *(float *)(v16 + 244) < (double)a1.field_4) )
          {
            if ( v14 & *(_DWORD *)(v16 + 148) )
            {
              sub_528A60(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), (_DWORD *)v16);
              *(_DWORD *)(v16 + 152) |= v14;
              *(_DWORD *)(v16 + 148) &= ~v14;
            }
          }
          if ( v13 )
            v15 = sub_4DA850(v16);
          else
            v15 = sub_4DA7A0(v16);
          goto LABEL_25;
        }
        if ( v13 == 1 )
          break;
        v16 = sub_4DA840();
        v13 = 1;
      }
      v1 = a3;
    }
  }
  if ( !*(_DWORD *)&byte_5D4594[2650652]
    || !(*(_DWORD *)&byte_5D4594[2598000] % (unsigned int)sub_40A6C0())
    || sub_40A5C0(8) )
  {
    sub_4FF7B0(*(_DWORD *)(v2 + 276));
    sub_511100(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064));
  }
  return sub_501CA0((int)v1);
}

//----- (00519330) --------------------------------------------------------
int __cdecl sub_519330(int a1)
{
  int v1; // esi
  char v3[12]; // [esp+8h] [ebp-Ch]

  v1 = *(_DWORD *)(a1 + 748);
  v3[0] = -61;
  *(_WORD *)&v3[3] = 0;
  *(_WORD *)&v3[1] = 0;
  *(_WORD *)&v3[5] = (__int64)*(float *)(*(_DWORD *)(v1 + 276) + 3632);
  *(_WORD *)&v3[7] = (__int64)*(float *)(*(_DWORD *)(v1 + 276) + 3636);
  v3[9] = 0;
  v3[10] = -1;
  v3[11] = 0;
  return sub_40EF40(*(unsigned __int8 *)(*(_DWORD *)(v1 + 276) + 2064), v3, 12);
}

//----- (005193B0) --------------------------------------------------------
char __cdecl sub_5193B0(_DWORD *a1, int a2)
{
  int v2; // ebx
  int v3; // eax

  v2 = *(_DWORD *)(a2 + 748);
  if ( (_DWORD *)a2 != a1 || (sub_527E50(a2, a1), v3 = *(_DWORD *)(v2 + 276), *(_BYTE *)(v3 + 3680) & 1) )
  {
    if ( !sub_40A5C0(0x2000)
      || (LOBYTE(v3) = byte_5D4594[2598000], *(_DWORD *)(v2 + 272) != *(_DWORD *)&byte_5D4594[2598000]) )
    {
      LOBYTE(v3) = sub_519410(a2, (int)a1);
    }
  }
  return v3;
}

//----- (00519410) --------------------------------------------------------
char __cdecl sub_519410(int a1, int a2)
{
  int v2; // ebx
  int v3; // ecx
  int v4; // eax
  int v5; // edi
  int v6; // ebp
  int v7; // eax
  int v8; // eax
  float v9; // ecx
  float v10; // edx
  int v11; // eax
  int v13; // [esp+10h] [ebp-14h]
  float4 v14; // [esp+14h] [ebp-10h]

  v4 = *(_DWORD *)(a1 + 748);
  v13 = v4;
  v2 = 0;
  v3 = *(unsigned __int8 *)(*(_DWORD *)(v4 + 276) + 2064);
  LOBYTE(v4) = *(_BYTE *)(a2 + 16);
  v5 = v3;
  if ( !(v4 & 0x20) && !(*(_DWORD *)(a2 + 8) & 0x40000000) )
  {
    v6 = 1 << v3;
    if ( a2 != a1 && v6 & *(_DWORD *)(a2 + 140) )
    {
      sub_4D97A0(v3, (_DWORD *)a2, (v6 & *(_DWORD *)(a2 + 144)) != 0);
      LOBYTE(v4) = ~(_BYTE)v6;
      *(_DWORD *)(a2 + 140) &= ~v6;
    }
    if ( v6 & *(_DWORD *)(a2 + 152) || *(_BYTE *)(a2 + 8) & 1 )
    {
      v7 = *(_DWORD *)(a2 + 16);
      if ( !(v7 & 0x800) || sub_4EC4F0(a2, a1) || (v4 = sub_40A5C0(512)) != 0 )
      {
        v8 = *(_DWORD *)(v13 + 276);
        v14.field_0 = *(float *)(v8 + 3632);
        v9 = *(float *)(a2 + 60);
        v10 = *(float *)(v8 + 3636);
        v14.field_8 = *(float *)(a2 + 56);
        v4 = *(_DWORD *)(a2 + 8);
        v14.field_4 = v10;
        v14.field_C = v9;
        if ( v4 & 0x20400000 || (v4 = sub_4173D0(v5, a2)) != 0 || (v4 = sub_535250(&v14, 0, 0, 69)) != 0 )
        {
          if ( v6 & *(_DWORD *)(a2 + 148) )
          {
            if ( *(_BYTE *)(a2 + 20) & 0x20 )
              return v4;
          }
          else if ( *(_DWORD *)(a2 + 4 * v5 + 560) & 0xFFF )
          {
            *(_DWORD *)(a2 + 4 * v5 + 560) |= (*(_DWORD *)(a2 + 4 * v5 + 560) & 0xFFF) << 16;
          }
          v11 = *(_DWORD *)(a2 + 8);
          if ( v11 & 0x400000 )
          {
            v2 = sub_518AE0(a1, v5, (_DWORD *)a2);
          }
          else if ( v11 & 0x200000 )
          {
            if ( v11 & 2 )
            {
              v2 = sub_518960(v5, (_DWORD *)a2, 1);
            }
            else if ( v11 & 4 )
            {
              v2 = sub_518C30(a1, (_DWORD *)a2, 1, 1);
            }
            else
            {
              v2 = sub_5187E0(v5, a2);
            }
          }
          else if ( v11 & 0x100000 )
          {
            v2 = sub_5188A0(v5, a2);
          }
          else
          {
            *(_DWORD *)(a2 + 152) = 0;
          }
          LOBYTE(v4) = sub_527E50(a1, (_DWORD *)a2);
          if ( v2 )
          {
            v4 = v6 | *(_DWORD *)(a2 + 148);
            *(_DWORD *)(a2 + 152) &= ~v6;
            *(_DWORD *)(a2 + 148) = v4;
          }
        }
        else if ( v6 & *(_DWORD *)(a2 + 148) )
        {
          if ( *(_BYTE *)(a2 + 8) & 6 )
            sub_528A60(v5, (_DWORD *)a2);
          else
            sub_528A90(v5, (_DWORD *)a2);
          v4 = ~v6 & *(_DWORD *)(a2 + 148);
          *(_DWORD *)(a2 + 152) |= v6;
          *(_DWORD *)(a2 + 148) = v4;
        }
      }
    }
  }
  return v4;
}

//----- (00519660) --------------------------------------------------------
int __cdecl sub_519660(int a1, int a2)
{
  int v2; // esi
  int result; // eax
  int v4; // ebx
  int v5; // [esp-4h] [ebp-10h]

  v2 = 1 << *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 2064);
  result = (v2 & *(_DWORD *)(a1 + 28)) != 0;
  switch ( *(unsigned __int8 *)(a1 + 21) )
  {
    case 1u:
    case 4u:
      v4 = 0;
      break;
    case 2u:
    case 3u:
      v4 = 1;
      break;
    default:
      v4 = a2;
      break;
  }
  if ( result != v4 )
  {
    v5 = sub_410580(*(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8));
    if ( v4 )
    {
      sub_4DF120(v5);
      result = v2 | *(_DWORD *)(a1 + 28);
    }
    else
    {
      sub_4DF180(v5);
      result = ~v2 & *(_DWORD *)(a1 + 28);
    }
    *(_DWORD *)(a1 + 28) = result;
  }
  return result;
}

//----- (00519710) --------------------------------------------------------
int __cdecl sub_519710(int a1)
{
  int result; // eax

  result = sub_417270(*(unsigned __int8 *)(*(_DWORD *)(a1 + 276) + 2064));
  if ( result )
    result = result > 60 || *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 268) > (unsigned int)(60 / result);
  return result;
}

//----- (00519760) --------------------------------------------------------
void __cdecl sub_519760(int a1, float *a2)
{
  int v2; // ebp
  int v3; // edi
  int v4; // eax
  int v5; // esi

  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064);
  v4 = sub_4172C0(v3);
  v5 = v4;
  if ( v4 )
  {
    if ( *(_BYTE *)(v4 + 16) & 0x20 )
    {
      sub_417430(v4);
    }
    else if ( *(float *)(v4 + 56) < (double)*a2
           || *(float *)(v4 + 56) > (double)a2[2]
           || *(float *)(v4 + 60) < (double)a2[1]
           || *(float *)(v4 + 60) > (double)a2[3] )
    {
      *(_DWORD *)(v4 + 152) |= 1 << v3;
      sub_519410(a1, v4);
      sub_4D9020(v3, v5);
      *(_DWORD *)(v2 + 268) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
}

//----- (00519820) --------------------------------------------------------
void sub_519820()
{
  srand(0x22F5u);
}

//----- (00519830) --------------------------------------------------------
int __cdecl sub_519830(int a1, char a2)
{
  int result; // eax

  result = a1;
  if ( a1 )
  {
    *(_DWORD *)(a1 + 40) = 0;
    *(_BYTE *)a1 = a2;
    *(_WORD *)(a1 + 2) = 0;
    *(_WORD *)(a1 + 4) = 0;
    *(_DWORD *)(a1 + 8) = 0;
    *(_DWORD *)(a1 + 12) = 0;
    *(_DWORD *)(a1 + 16) = 1;
    *(_WORD *)(a1 + 20) = 512;
    *(_DWORD *)(a1 + 24) = 0;
    *(_BYTE *)(a1 + 28) = 2;
    *(_DWORD *)(a1 + 32) = 0;
    *(_DWORD *)(a1 + 44) = 0;
  }
  return result;
}

//----- (00519870) --------------------------------------------------------
int sub_519870()
{
  char v0; // di
  unsigned __int8 *v1; // esi
  int result; // eax

  v0 = 0;
  v1 = &byte_5D4594[2387148];
  *(_WORD *)&byte_5D4594[2388636] = 0;
  *(_WORD *)&byte_5D4594[2388638] = 0;
  *(_DWORD *)&byte_5D4594[2388640] = 0;
  *(_DWORD *)&byte_5D4594[2388648] = 0;
  do
  {
    result = sub_519830((int)v1, v0);
    v1 += 48;
    ++v0;
  }
  while ( (int)v1 < (int)&byte_5D4594[2388636] );
  return result;
}

//----- (005198B0) --------------------------------------------------------
void __cdecl sub_5198B0(unsigned __int8 a1)
{
  char v1; // bl
  unsigned __int8 *v2; // esi

  v1 = 0;
  v2 = &byte_5D4594[2387150];
  do
  {
    if ( *(_WORD *)v2 == 1 )
    {
      *(_WORD *)v2 = 0;
      nullsub_27(v2 - 2);
      sub_519C80(v2 - 2, a1);
      ++*(_WORD *)&byte_5D4594[2388638];
      if ( *((_WORD *)v2 + 1) == 1 )
      {
        if ( *(_DWORD *)(v2 + 6) )
          free(*(LPVOID *)(v2 + 6));
      }
      sub_519830((int)(v2 - 2), v1);
    }
    v2 += 48;
    ++v1;
  }
  while ( (int)v2 < (int)&byte_5D4594[2388638] );
}
// 519920: using guessed type void __cdecl nullsub_27(_DWORD);

//----- (00519930) --------------------------------------------------------
int __cdecl sub_519930(int a1)
{
  int v1; // edi
  unsigned __int8 *v2; // esi
  char *i; // eax
  char v4; // al
  int v6; // [esp+8h] [ebp-4h]

  v1 = 0;
  v6 = 0;
  v2 = &byte_5D4594[48 * a1 + 2387148];
  if ( v2 )
  {
    if ( a1 < 32 )
    {
      for ( i = (char *)sub_555250(*v2, &v6); i; i = (char *)sub_555290(*v2, &v6) )
      {
        v4 = *i;
        if ( v4 == -72 || v4 == -71 )
          ++v1;
      }
    }
  }
  return v1;
}

//----- (00519990) --------------------------------------------------------
void sub_519990()
{
  int v0; // edi
  unsigned __int8 *v1; // esi

  if ( *(_DWORD *)&byte_5D4594[2388648] )
  {
    if ( !*(_DWORD *)&byte_5D4594[2388644] )
      sub_519EB0();
    v0 = 0;
    v1 = &byte_5D4594[2387180];
    do
    {
      if ( *((_WORD *)v1 - 15) == 1 )
      {
        if ( sub_519930(v0 + 1) > *(v1 - 4) )
          ++*(_DWORD *)v1;
        else
          sub_5199F0(v1 - 32);
      }
      v1 += 48;
      ++v0;
    }
    while ( (int)v1 < (int)&byte_5D4594[2388668] );
  }
}

//----- (005199F0) --------------------------------------------------------
void __cdecl sub_5199F0(unsigned __int8 *a1)
{
  char *v1; // eax
  wchar_t *v2; // eax
  _WORD *v3; // ebp
  unsigned int v4; // eax
  int v5; // esi
  int v6; // edi
  unsigned int v7; // ecx
  unsigned int v8; // eax
  unsigned int v9; // esi
  int v10; // ebp
  char *v11; // edi
  wchar_t *v12; // eax
  int v13; // eax
  wchar_t *v14; // eax
  int v15; // [esp-4h] [ebp-178h]
  int v16; // [esp-4h] [ebp-178h]
  int v17; // [esp+10h] [ebp-164h]
  int v18; // [esp+14h] [ebp-160h]
  char v19[88]; // [esp+1Ch] [ebp-158h]
  wchar_t v20[128]; // [esp+74h] [ebp-100h]

  if ( a1 )
  {
    if ( !*((_DWORD *)a1 + 6) )
    {
      v1 = sub_417090(*a1);
      if ( v1 )
      {
        v15 = (int)(v1 + 4704);
        v2 = sub_40F1D0((char *)&byte_587000[249408], 0, (const char *)&byte_587000[249368], 231);
        nox_swprintf(v20, v2, &byte_5D4594[2387068], v15);
        sub_450B90(6u, (int)v20);
      }
      *(_DWORD *)&v19[4] = *((_DWORD *)a1 + 3);
      v19[0] = -72;
      strcpy(&v19[8], (const char *)&byte_5D4594[2387068]);
      sub_552640(*a1 + 1, v19, 88, 3);
    }
    v3 = nox_malloc(*((unsigned __int16 *)a1 + 10) + 6);
    if ( v3 )
    {
      v4 = *((unsigned __int16 *)a1 + 10);
      if ( (unsigned __int16)v4 >= (unsigned int)(*((_DWORD *)a1 + 3) - *((_DWORD *)a1 + 6)) )
      {
        v17 = *((_DWORD *)a1 + 3) - *((_DWORD *)a1 + 6);
        v4 = *((_DWORD *)a1 + 3) - *((_DWORD *)a1 + 6);
      }
      else
      {
        v17 = *((unsigned __int16 *)a1 + 10);
      }
      LOBYTE(v18) = -71;
      HIWORD(v18) = *((_WORD *)a1 + 8);
      *(_DWORD *)v3 = v18;
      v3[2] = v4;
      if ( *((_WORD *)a1 + 2) )
      {
        v5 = *((_DWORD *)a1 + 2);
        v6 = *((_DWORD *)a1 + 6);
      }
      else
      {
        v5 = *((_DWORD *)a1 + 6);
        v6 = *(_DWORD *)&byte_5D4594[2388640];
      }
      qmemcpy(v3 + 3, (const void *)(v6 + v5), v4);
      sub_552640(*a1 + 1, v3, v4 + 6, 3);
      free(v3);
      v7 = *((_DWORD *)a1 + 3);
      v8 = v17 + *((_DWORD *)a1 + 6);
      ++*((_DWORD *)a1 + 4);
      *((_DWORD *)a1 + 6) = v8;
      if ( v8 < v7 )
      {
        *((_WORD *)a1 + 1) = 1;
      }
      else
      {
        v9 = (sub_416BB0() - *((_QWORD *)a1 + 5)) / (unsigned __int64)1000;
        if ( v9 )
          v10 = *((_DWORD *)a1 + 3) / v9;
        else
          v10 = *((_DWORD *)a1 + 3);
        v11 = sub_417090(*a1);
        if ( v11 )
        {
          v12 = sub_40F1D0((char *)&byte_587000[249464], 0, (const char *)&byte_587000[249424], 299);
          nox_swprintf(v20, v12, *((_DWORD *)a1 + 6), *((_DWORD *)a1 + 4) - 1, v10, v9, v11 + 4704);
          sub_450B90(6u, (int)v20);
        }
        if ( *((_WORD *)a1 + 2) == 1 && *((_DWORD *)a1 + 2) )
          free(*((LPVOID *)a1 + 2));
        v13 = *(_DWORD *)&byte_5D4594[2388648];
        if ( *(_DWORD *)&byte_5D4594[2388648] )
          v13 = --*(_DWORD *)&byte_5D4594[2388648];
        v16 = v13;
        v14 = sub_40F1D0((char *)&byte_587000[249520], 0, (const char *)&byte_587000[249480], 315);
        nox_swprintf(v20, v14, v16);
        sub_450B90(6u, (int)v20);
        sub_519830((int)a1, *a1);
      }
    }
  }
}
// 519AFD: variable 'v18' is possibly undefined

//----- (00519C80) --------------------------------------------------------
void __cdecl sub_519C80(unsigned __int8 *a1, unsigned __int8 a2)
{
  int v2; // ecx
  wchar_t *v3; // eax
  int v4; // [esp-Ch] [ebp-114h]
  char v5[2]; // [esp+6h] [ebp-102h]
  wchar_t v6[128]; // [esp+8h] [ebp-100h]

  if ( a1 )
  {
    v2 = *a1;
    v5[0] = -70;
    v5[1] = a2;
    sub_552640(v2 + 1, v5, 2, 3);
    if ( *(_DWORD *)&byte_5D4594[2388648] )
      --*(_DWORD *)&byte_5D4594[2388648];
    v4 = *a1;
    v3 = sub_40F1D0((char *)&byte_587000[249572], 0, (const char *)&byte_587000[249532], 350);
    nox_swprintf(v6, v3, v4, a2);
    sub_450B90(6u, (int)v6);
  }
}

//----- (00519D20) --------------------------------------------------------
char *__cdecl sub_519D20(int a1)
{
  unsigned __int8 *v1; // esi
  wchar_t *v2; // eax
  char *result; // eax

  v1 = &byte_5D4594[48 * a1 + 2387148];
  ++*(_DWORD *)&byte_5D4594[2388648];
  if ( *((_WORD *)v1 + 1) )
  {
    if ( *((_WORD *)v1 + 1) == 1 )
      v2 = sub_40F1D0((char *)&byte_587000[249628], 0, (const char *)&byte_587000[249588], 392);
    else
      v2 = sub_40F1D0((char *)&byte_587000[249676], 0, (const char *)&byte_587000[249636], 397);
    result = (char *)sub_450B90(6u, (int)v2);
  }
  else
  {
    ++*(_WORD *)&byte_5D4594[2388636];
    *((_WORD *)v1 + 1) = 1;
    *((_DWORD *)v1 + 6) = 0;
    *((_DWORD *)v1 + 4) = 1;
    *((_WORD *)v1 + 10) = 512;
    *((_DWORD *)v1 + 3) = *(_DWORD *)&byte_5D4594[2388644];
    *((_QWORD *)v1 + 5) = sub_416BB0();
    result = sub_417090(a1);
  }
  return result;
}

//----- (00519DE0) --------------------------------------------------------
int __cdecl sub_519DE0(int a1)
{
  unsigned __int8 *v1; // esi
  char *v2; // ebx
  int result; // eax
  wchar_t *v4; // eax

  v1 = &byte_5D4594[48 * a1 + 2387148];
  v2 = sub_417090(a1);
  *((_WORD *)v1 + 1) = 0;
  nullsub_27(v1);
  ++*(_WORD *)&byte_5D4594[2388638];
  if ( *((_WORD *)v1 + 2) == 1 && *((_DWORD *)v1 + 2) )
    free(*((LPVOID *)v1 + 2));
  sub_519830((int)v1, a1);
  result = *(_DWORD *)&byte_5D4594[2388648];
  if ( *(_DWORD *)&byte_5D4594[2388648] )
    result = --*(_DWORD *)&byte_5D4594[2388648];
  if ( v2 )
  {
    v4 = sub_40F1D0((char *)&byte_587000[249728], 0, (const char *)&byte_587000[249688], 428);
    result = sub_450C00(6u, v4, v2 + 4704);
  }
  return result;
}
// 519920: using guessed type void __cdecl nullsub_27(_DWORD);

//----- (00519E80) --------------------------------------------------------
_DWORD *__cdecl sub_519E80(int a1)
{
  sub_417090(a1);
  return sub_4DE410(byte_5D4594[48 * a1 + 2387148]);
}

//----- (00519EB0) --------------------------------------------------------
int sub_519EB0()
{
  char *v0; // eax
  unsigned __int8 *v1; // ebx
  void *v2; // eax
  const void *v3; // esi
  unsigned int v4; // kr00_4
  wchar_t *v5; // eax
  char *v6; // edi
  unsigned __int8 v7; // cl
  FILE *v8; // ebx
  int result; // eax
  wchar_t *v10; // eax
  const char *v11; // [esp+10h] [ebp-104h]
  char v12[256]; // [esp+14h] [ebp-100h]

  v0 = sub_409B30();
  v11 = v0;
  if ( *(_DWORD *)&byte_5D4594[2388648] )
  {
    v1 = &byte_5D4594[2387156];
    do
    {
      if ( *((_WORD *)v1 - 3) == 1 )
      {
        v2 = nox_malloc(*(size_t *)&byte_5D4594[2388644]);
        *(_DWORD *)v1 = v2;
        if ( v2 )
        {
          v3 = *(const void **)&byte_5D4594[2388640];
          v4 = *(_DWORD *)&byte_5D4594[2388644];
          *((_WORD *)v1 - 2) = 1;
          qmemcpy(v2, v3, v4);
          *((_DWORD *)v1 + 1) = *(_DWORD *)&byte_5D4594[2388644];
          v5 = sub_40F1D0((char *)&byte_587000[249788], 0, (const char *)&byte_587000[249748], 478);
          sub_450B90(6u, (int)v5);
        }
        else
        {
          sub_519C80(v1 - 8, 1u);
        }
      }
      v1 += 48;
    }
    while ( (int)v1 < (int)&byte_5D4594[2388644] );
    v0 = (char *)v11;
  }
  if ( !v0 )
    goto LABEL_16;
  if ( !memcmp(v0, &byte_5D4594[2388652], 1u) )
    goto LABEL_16;
  strcpy(v12, "maps\\");
  strcat(v12, sub_409B40());
  *(_WORD *)&v12[strlen(v12)] = *(_WORD *)&byte_587000[249808];
  strcat(v12, sub_409B40());
  v6 = &v12[strlen(v12) + 1];
  v7 = byte_587000[249816];
  *(_DWORD *)--v6 = *(_DWORD *)&byte_587000[249812];
  v6[4] = v7;
  v8 = fopen(v12, (const char *)&byte_587000[249820]);
  if ( v8 )
  {
    strcpy((char *)&byte_5D4594[2386988], v12);
    strcpy((char *)&byte_5D4594[2387068], v11);
    fseek(v8, 0, 2);
    *(_DWORD *)&byte_5D4594[2388644] = ftell(v8);
    fseek(v8, 0, 0);
    *(_DWORD *)&byte_5D4594[2388640] = nox_malloc(*(size_t *)&byte_5D4594[2388644]);
    sub_40ADD0(*(char **)&byte_5D4594[2388640], 1u, *(size_t *)&byte_5D4594[2388644], v8);
    fclose(v8);
    result = 1;
  }
  else
  {
LABEL_16:
    v10 = sub_40F1D0((char *)&byte_587000[249864], 0, (const char *)&byte_587000[249824], 518);
    sub_450B90(6u, (int)v10);
    result = 0;
  }
  return result;
}

//----- (0051A100) --------------------------------------------------------
LPVOID sub_51A100()
{
  LPVOID result; // eax

  if ( *(_DWORD *)&byte_5D4594[2388648] )
    sub_5198B0(0);
  result = *(LPVOID *)&byte_5D4594[2388640];
  if ( *(_DWORD *)&byte_5D4594[2388640] )
    free(*(LPVOID *)&byte_5D4594[2388640]);
  *(_DWORD *)&byte_5D4594[2388644] = 0;
  return result;
}

//----- (0051A130) --------------------------------------------------------
int sub_51A130()
{
  return *(_DWORD *)&byte_5D4594[2388648];
}

//----- (0051A140) --------------------------------------------------------
BOOL __cdecl sub_51A140(int a1)
{
  unsigned __int8 *v1; // eax

  v1 = &byte_5D4594[48 * a1 + 2387148];
  return v1 && a1 < 32 && *((_WORD *)v1 + 1) == 1;
}

//----- (0051A170) --------------------------------------------------------
int __cdecl sub_51A170(const char *a1)
{
  int v1; // ebp
  const char **v2; // edi

  if ( !a1 )
    return -1;
  v1 = 0;
  v2 = (const char **)&byte_587000[249880];
  while ( strcmp(*v2, a1) )
  {
    ++v2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[249892] )
      return -1;
  }
  return v1;
}

//----- (0051A1D0) --------------------------------------------------------
char *__cdecl sub_51A1D0(int a1)
{
  char *result; // eax

  if ( a1 <= -1 || a1 >= 3 )
    result = 0;
  else
    result = *(char **)&byte_587000[4 * a1 + 249880];
  return result;
}

//----- (0051A1F0) --------------------------------------------------------
void __cdecl sub_51A1F0(int a1)
{
  int v1; // ebx
  int v2; // edi
  int v3; // ebx
  int v4; // eax
  int v5; // ecx
  int v6; // esi
  double v7; // st7
  int v8; // eax
  int v9; // ebx
  int v10; // ebp
  int v11; // esi
  int v12; // edi
  int v13; // eax
  int v14; // ebx
  int v15; // edi
  int i; // esi
  int v17; // esi
  int v18; // edi
  float v19; // [esp+0h] [ebp-20h]
  float v20; // [esp+0h] [ebp-20h]
  unsigned int v21; // [esp+10h] [ebp-10h]
  int v22; // [esp+14h] [ebp-Ch]
  int v23; // [esp+18h] [ebp-8h]
  unsigned int v24; // [esp+1Ch] [ebp-4h]
  int v25; // [esp+24h] [ebp+4h]

  v21 = 0;
  v23 = 0;
  v1 = sub_4E3CC0();
  v22 = v1;
  v19 = sub_419D40(&byte_587000[252424]);
  v24 = sub_419A70(v19);
  if ( !*(_DWORD *)&byte_5D4594[2388668] )
  {
    *(_DWORD *)&byte_5D4594[2388668] = sub_4E3AA0((CHAR *)&byte_587000[252444]);
    *(_DWORD *)&byte_5D4594[2388672] = sub_4E3AA0((CHAR *)&byte_587000[252460]);
  }
  v2 = sub_4DA790();
  if ( v2 )
  {
    v3 = a1;
    do
    {
      v4 = sub_4DA7A0(v2);
      v5 = *(_DWORD *)(v2 + 8);
      v25 = v4;
      if ( v5 & 0x20 && *(_BYTE *)(v2 + 12) & 1 )
      {
        ++v21;
      }
      else if ( *(unsigned __int16 *)(v2 + 4) == *(_DWORD *)&byte_5D4594[2388668] )
      {
        ++v23;
      }
      if ( v5 & 0x20000 )
      {
        v6 = *(_DWORD *)(v2 + 748);
        if ( *(_DWORD *)(16 * v3 + v6) )
        {
          switch ( *(unsigned __int8 *)(v6 + v3 + 83) )
          {
            case 0u:
              v7 = sub_419D40(&byte_587000[252480]);
              goto LABEL_18;
            case 1u:
              v7 = sub_419D40(&byte_587000[252512]);
              goto LABEL_18;
            case 2u:
              v7 = sub_419D40(&byte_587000[252548]);
              goto LABEL_18;
            case 3u:
              v7 = sub_419D40(&byte_587000[252580]);
LABEL_18:
              *(_BYTE *)(v6 + 87) = (__int64)v7;
              break;
            default:
              break;
          }
          if ( sub_4E3CC0() >= v24 && *(_BYTE *)(v6 + v3 + 83) != 3 )
            *(_BYTE *)(v6 + 87) *= 2;
          v8 = sub_51A500(*(_DWORD *)(16 * v3 + v6));
          if ( v8 )
            *(_WORD *)(v2 + 4) = v8;
        }
        else
        {
          sub_4E5CC0(v2);
        }
      }
      v2 = v25;
    }
    while ( v25 );
    if ( v21 > 1 )
    {
      v9 = sub_415FA0(0, v21 - 1);
      v10 = 0;
      v11 = sub_4DA790();
      if ( v11 )
      {
        do
        {
          v12 = sub_4DA7A0(v11);
          if ( *(_BYTE *)(v11 + 8) & 0x20 && *(_BYTE *)(v11 + 12) & 1 )
          {
            if ( v10 != v9 )
              sub_4E5CC0(v11);
            ++v10;
          }
          v11 = v12;
        }
        while ( v12 );
      }
    }
    v1 = v22;
  }
  sub_51A940(0);
  if ( v1 >= 5 )
  {
    v20 = sub_419D40(&byte_587000[252656]);
    v13 = sub_419A70(v20);
    if ( v1 == 5 || v1 >= v13 || v1 & 1 && sub_415FA0(1, 100) >= 50 )
    {
      sub_51A940(1);
      if ( v23 )
      {
        v14 = sub_415FA0(1, v23);
        v15 = 0;
        for ( i = sub_4DA790(); i; i = sub_4DA7A0(i) )
        {
          if ( *(unsigned __int16 *)(i + 4) == *(_DWORD *)&byte_5D4594[2388668] && ++v15 == v14 )
            sub_51A5A0((int *)(i + 56));
          if ( *(unsigned __int16 *)(i + 4) == *(_DWORD *)&byte_5D4594[2388672] && sub_415FA0(1, 100) >= 50 )
            sub_51A7A0((int *)(i + 56));
        }
      }
    }
  }
  v17 = sub_4DA790();
  if ( v17 )
  {
    do
    {
      v18 = sub_4DA7A0(v17);
      if ( *(unsigned __int16 *)(v17 + 4) == *(_DWORD *)&byte_5D4594[2388668] )
        sub_4E5CC0(v17);
      if ( *(unsigned __int16 *)(v17 + 4) == *(_DWORD *)&byte_5D4594[2388672] )
        sub_4E5CC0(v17);
      v17 = v18;
    }
    while ( v18 );
  }
}

//----- (0051A500) --------------------------------------------------------
int __cdecl sub_51A500(int a1)
{
  int v1; // ecx
  int v2; // edx
  unsigned __int8 *i; // eax
  int v4; // esi

  if ( !*(_DWORD *)&byte_5D4594[2388664] )
    sub_51A550();
  if ( !a1 )
    return 0;
  v1 = 0;
  if ( !*(_DWORD *)&byte_587000[249904] )
    return 0;
  HIWORD(v2) = 0;
  for ( i = &byte_587000[249904]; ; i += 16 )
  {
    LOWORD(v2) = *(_WORD *)(a1 + 4);
    if ( *((_DWORD *)i - 1) == v2 )
      break;
    v4 = *((_DWORD *)i + 4);
    ++v1;
    if ( !v4 )
      return 0;
  }
  return *(_DWORD *)&byte_587000[16 * v1 + 249908];
}

//----- (0051A550) --------------------------------------------------------
CHAR *sub_51A550()
{
  CHAR *result; // eax
  unsigned __int8 *v1; // esi

  result = *(CHAR **)&byte_587000[249904];
  if ( *(_DWORD *)&byte_587000[249904] )
  {
    v1 = &byte_587000[249896];
    do
    {
      *((_DWORD *)v1 + 3) = sub_4E3AA0(result);
      *((_DWORD *)v1 + 1) = sub_4E3AA0(*(CHAR **)v1);
      result = (CHAR *)*((_DWORD *)v1 + 6);
      v1 += 16;
    }
    while ( result );
    *(_DWORD *)&byte_5D4594[2388664] = 1;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2388664] = 1;
  }
  return result;
}

//----- (0051A5A0) --------------------------------------------------------
void __cdecl sub_51A5A0(int *a1)
{
  _DWORD *v1; // edi
  _DWORD *v2; // esi
  int v3; // eax
  int v4; // eax
  double v5; // st7
  int v6; // eax
  _DWORD *v7; // esi
  int v8; // eax
  _DWORD *v9; // eax
  int v10; // eax
  _DWORD *v11; // eax
  int v12; // eax
  _DWORD *v13; // eax
  int v14; // eax
  _DWORD *v15; // eax
  float v16; // [esp+8h] [ebp-8h]
  float v17; // [esp+Ch] [ebp-4h]

  v1 = sub_4E3810((CHAR *)&byte_587000[252796]);
  v16 = sub_4E40F0();
  if ( v1 )
  {
    v2 = (_DWORD *)v1[187];
    v3 = v2[121];
    if ( v3 )
      v4 = *(_DWORD *)(v3 + 72);
    else
      v4 = *(unsigned __int16 *)(*(_DWORD *)(sub_4E3B70(*((unsigned __int16 *)v1 + 2)) + 136) + 4);
    if ( v16 < 1.0 )
      v16 = 1.0;
    v5 = (double)v4 * v16;
    v17 = v5;
    sub_4E4560((int)v1, (__int64)v5);
    *(_WORD *)(v1[139] + 4) = sub_419A70(v17);
    if ( !*(_WORD *)v1[139] )
      sub_4E4560((int)v1, 1u);
    v6 = v1[139];
    if ( !*(_WORD *)(v6 + 4) )
      *(_WORD *)(v6 + 4) = 1;
    v2[411] = 0x10000000;
    v2[423] = 0x10000000;
    v2[340] = 4;
    v2[326] = 1062501089;
    v2[510] = 3;
    v2[410] = 0x8000000;
    v2[444] = 0x20000000;
    v2[388] = 0x40000000;
    v2[415] = 0x40000000;
    sub_419D40(&byte_587000[252804]);
    v2[330] = 1062836634;
    sub_4DAA50((int)v1, 0, *(float *)a1, *((float *)a1 + 1));
    v7 = sub_4E3810((CHAR *)&byte_587000[252824]);
    if ( v7 )
    {
      v8 = sub_4E3CC0();
      v9 = sub_4F0720((int)v7, v8 + 2);
      if ( v9 )
        sub_4F3070((int)v1, (int)v9, 0);
      v10 = sub_4E3CC0();
      v11 = sub_4F0720((int)v7, v10 + 2);
      if ( v11 )
        sub_4F3070((int)v1, (int)v11, 0);
      v12 = sub_4E3CC0();
      v13 = sub_4F0720((int)v7, v12 + 2);
      if ( v13 )
        sub_4F3070((int)v1, (int)v13, 0);
      v14 = sub_4E3CC0();
      v15 = sub_4F0720((int)v7, v14 + 2);
      if ( v15 )
        sub_4F3070((int)v1, (int)v15, 0);
      sub_4E38A0((int)v7);
    }
  }
}

//----- (0051A7A0) --------------------------------------------------------
void __cdecl sub_51A7A0(int *a1)
{
  _DWORD *v1; // edi
  _DWORD *v2; // esi
  int v3; // eax
  int v4; // eax
  double v5; // st7
  int v6; // eax
  _DWORD *v7; // esi
  int v8; // eax
  _DWORD *v9; // eax
  float v10; // [esp+8h] [ebp-8h]
  float v11; // [esp+Ch] [ebp-4h]

  v1 = sub_4E3810((CHAR *)&byte_587000[252840]);
  v10 = sub_4E40F0();
  if ( v1 )
  {
    v2 = (_DWORD *)v1[187];
    v3 = v2[121];
    if ( v3 )
      v4 = *(_DWORD *)(v3 + 72);
    else
      v4 = *(unsigned __int16 *)(*(_DWORD *)(sub_4E3B70(*((unsigned __int16 *)v1 + 2)) + 136) + 4);
    if ( v10 < 1.0 )
      v10 = 1.0;
    v5 = (double)v4 * v10;
    v11 = v5;
    sub_4E4560((int)v1, (__int64)v5);
    *(_WORD *)(v1[139] + 4) = sub_419A70(v11);
    if ( !*(_WORD *)v1[139] )
      sub_4E4560((int)v1, 1u);
    v6 = v1[139];
    if ( !*(_WORD *)(v6 + 4) )
      *(_WORD *)(v6 + 4) = 1;
    v2[340] = 4;
    v2[411] = 0x10000000;
    v2[423] = 0x10000000;
    v2[326] = 1062501089;
    v2[510] = 1;
    v2[410] = 0x8000000;
    v2[444] = 0x20000000;
    v2[415] = 0x40000000;
    sub_4DAA50((int)v1, 0, *(float *)a1, *((float *)a1 + 1));
    v7 = sub_4E3810((CHAR *)&byte_587000[252852]);
    if ( v7 )
    {
      v8 = sub_4E3CC0();
      v9 = sub_4F0720((int)v7, v8 + 2);
      if ( v9 )
        sub_4F3070((int)v1, (int)v9, 0);
      sub_4E38A0((int)v7);
    }
  }
}

//----- (0051A920) --------------------------------------------------------
int __cdecl sub_51A920(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[2388660] = a1;
  return result;
}

//----- (0051A930) --------------------------------------------------------
int sub_51A930()
{
  return *(_DWORD *)&byte_5D4594[2388660];
}

//----- (0051A940) --------------------------------------------------------
int __cdecl sub_51A940(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[2388656] = a1;
  return result;
}

//----- (0051A950) --------------------------------------------------------
int sub_51A950()
{
  return *(_DWORD *)&byte_5D4594[2388656];
}

//----- (0051A960) --------------------------------------------------------
int __cdecl sub_51A960(int a1, unsigned __int8 *a2)
{
  char *v2; // eax
  int v3; // esi
  int v5; // eax
  int v6; // edx
  int v7; // [esp+Ch] [ebp-C04h]
  char v8[3072]; // [esp+10h] [ebp-C00h]

  v2 = sub_417090(a1);
  v3 = *a2;
  v7 = *a2;
  if ( v2 && !(v2[3680] & 0x10) )
    return v3 + 1;
  v5 = sub_51AAA0((int)(a2 + 1), v3, (int)v8);
  v6 = *(_DWORD *)&byte_5D4594[4 * a1 + 2388804];
  if ( v6 + v5 < 128 )
  {
    *(_DWORD *)&byte_5D4594[4 * a1 + 2388804] = v6 + v5;
    qmemcpy(&byte_5D4594[24 * (v6 + (a1 << 7)) + 2388932], v8, 24 * v5);
    v3 = v7;
  }
  sub_51AA20(a1);
  return v3 + 1;
}

//----- (0051AA20) --------------------------------------------------------
int __cdecl sub_51AA20(int a1)
{
  int v1; // esi
  int v2; // edi
  int v3; // edx
  int result; // eax
  int v5; // ebx
  unsigned __int8 *v6; // ecx

  v1 = 0;
  v2 = 0;
  v3 = 0;
  result = *(_DWORD *)&byte_5D4594[4 * a1 + 2388804] - 1;
  if ( result >= 0 )
  {
    v5 = *(_DWORD *)&byte_5D4594[4 * a1 + 2388804];
    v6 = &byte_5D4594[24 * (result + (a1 << 7)) + 2388948];
    do
    {
      if ( *(_DWORD *)v6 )
      {
        result = *((_DWORD *)v6 - 2) - 2;
        if ( *((_DWORD *)v6 - 2) == 2 )
        {
          if ( v3 )
            *(_DWORD *)v6 = 0;
          else
            v3 = 1;
        }
        else
        {
          result = *((_DWORD *)v6 - 2) - 4;
          if ( *((_DWORD *)v6 - 2) == 4 )
          {
            if ( v1 )
              *(_DWORD *)v6 = 0;
            else
              v1 = 1;
          }
          else
          {
            result = *((_DWORD *)v6 - 2) - 5;
            if ( *((_DWORD *)v6 - 2) == 5 )
            {
              if ( v2 )
                *(_DWORD *)v6 = 0;
              else
                v2 = 1;
            }
          }
        }
      }
      v6 -= 24;
      --v5;
    }
    while ( v5 );
  }
  return result;
}

//----- (0051AAA0) --------------------------------------------------------
int __cdecl sub_51AAA0(int a1, int a2, int a3)
{
  int v3; // edi
  int v4; // ebp
  _DWORD *v5; // ebx
  int v6; // ecx
  unsigned __int8 v7; // al
  int v9; // [esp+8h] [ebp-4h]

  v3 = 0;
  v4 = 0;
  v9 = 0;
  if ( a2 <= 0 )
    return 0;
  v5 = (_DWORD *)(a3 + 12);
  do
  {
    v6 = *(unsigned __int8 *)(a1 + v4);
    v4 += 4;
    *(v5 - 1) = v6;
    if ( sub_42D440(v6) )
    {
      v7 = sub_42D450(*(v5 - 1));
      *v5 = 0;
      qmemcpy(v5, (const void *)(v4 + a1), v7);
      v4 += v7;
      v3 = v9;
    }
    else
    {
      *v5 = 0;
    }
    v5[1] = 1;
    ++v3;
    v5 += 6;
    v9 = v3;
  }
  while ( v4 < a2 );
  return v3;
}

//----- (0051AB50) --------------------------------------------------------
unsigned __int8 *__cdecl sub_51AB50(int a1)
{
  int v1; // esi
  int v2; // edx

  *(_DWORD *)&byte_5D4594[4 * a1 + 2388676] = 0;
  if ( *(int *)&byte_5D4594[4 * a1 + 2388804] <= 0 )
    return 0;
  v1 = a1 << 7;
  while ( 1 )
  {
    v2 = *(_DWORD *)&byte_5D4594[4 * a1 + 2388676];
    if ( *(_DWORD *)&byte_5D4594[24 * (v1 + v2) + 2388948] )
      break;
    *(_DWORD *)&byte_5D4594[4 * a1 + 2388676] = v2 + 1;
    if ( v2 + 1 >= *(int *)&byte_5D4594[4 * a1 + 2388804] )
      return 0;
  }
  return &byte_5D4594[24 * (v1 + *(_DWORD *)&byte_5D4594[4 * a1 + 2388676]) + 2388932];
}

//----- (0051ABC0) --------------------------------------------------------
unsigned __int8 *__cdecl sub_51ABC0(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // esi

  v1 = *(_DWORD *)&byte_5D4594[4 * a1 + 2388676] + 1;
  *(_DWORD *)&byte_5D4594[4 * a1 + 2388676] = v1;
  v2 = v1;
  if ( v1 >= *(int *)&byte_5D4594[4 * a1 + 2388804] )
    return 0;
  v3 = a1 << 7;
  while ( !*(_DWORD *)&byte_5D4594[24 * (v3 + v2) + 2388948] )
  {
    *(_DWORD *)&byte_5D4594[4 * a1 + 2388676] = ++v2;
    if ( v2 >= *(int *)&byte_5D4594[4 * a1 + 2388804] )
      return 0;
  }
  return &byte_5D4594[24 * (v3 + *(_DWORD *)&byte_5D4594[4 * a1 + 2388676]) + 2388932];
}

//----- (0051AC30) --------------------------------------------------------
int __cdecl sub_51AC30(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)&byte_5D4594[4 * a1 + 2388804] = 0;
  return result;
}

//----- (0051AC40) --------------------------------------------------------
BOOL __cdecl sub_51AC40(int a1)
{
  return *(_DWORD *)&byte_5D4594[4 * a1 + 2388804] == 0;
}

//----- (0051AC60) --------------------------------------------------------
void sub_51AC60()
{
  int v0; // ecx
  int i; // eax

  v0 = *(_DWORD *)&byte_5D4594[2487236];
  if ( *(_DWORD *)&byte_5D4594[2487236] )
  {
    for ( i = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487236] + 24); i; i = *(_DWORD *)(i + 24) )
      v0 = i;
    *(_DWORD *)(v0 + 24) = *(_DWORD *)&byte_5D4594[2487240];
    *(_DWORD *)&byte_5D4594[2487240] = *(_DWORD *)&byte_5D4594[2487236];
    *(_DWORD *)&byte_5D4594[2487236] = 0;
  }
}

//----- (0051ACA0) --------------------------------------------------------
int __cdecl sub_51ACA0(int a1, int a2, int a3)
{
  _DWORD *v3; // esi
  int result; // eax
  int v5; // eax
  int i; // ecx

  v3 = sub_51AD40();
  if ( !v3 )
    return sub_507230(0);
  *v3 = a1 + *(_DWORD *)&byte_5D4594[2598000];
  v3[1] = a2;
  v3[2] = a3;
  v5 = sub_51AD20();
  v3[3] = v5;
  v3[4] = 0;
  v3[5] = 0;
  v3[6] = 0;
  sub_507230(v5);
  result = *(_DWORD *)&byte_5D4594[2487236];
  if ( *(_DWORD *)&byte_5D4594[2487236] )
  {
    for ( i = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487236] + 24); i; i = *(_DWORD *)(i + 24) )
      result = i;
    *(_DWORD *)(result + 24) = v3;
    v3[7] = result;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2487236] = v3;
    v3[7] = 0;
  }
  return result;
}

//----- (0051AD20) --------------------------------------------------------
int sub_51AD20()
{
  int result; // eax

  result = ++*(_DWORD *)&byte_587000[252868];
  if ( *(_DWORD *)&byte_587000[252868] > 0x7D00u )
  {
    result = 1;
    *(_DWORD *)&byte_587000[252868] = 1;
  }
  return result;
}

//----- (0051AD40) --------------------------------------------------------
void *sub_51AD40()
{
  void *result; // eax

  result = *(void **)&byte_5D4594[2487240];
  if ( !*(_DWORD *)&byte_5D4594[2487240] )
    return nox_malloc(0x20u);
  *(_DWORD *)&byte_5D4594[2487240] = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487240] + 24);
  return result;
}

//----- (0051AD60) --------------------------------------------------------
int __cdecl sub_51AD60(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2487236];
  if ( !*(_DWORD *)&byte_5D4594[2487236] )
    return 0;
  while ( *(_DWORD *)(v1 + 12) != a1 )
  {
    v1 = *(_DWORD *)(v1 + 24);
    if ( !v1 )
      return 0;
  }
  sub_51AD90(v1);
  return 1;
}

//----- (0051AD90) --------------------------------------------------------
int __cdecl sub_51AD90(int a1)
{
  int v1; // edx
  _DWORD *v2; // ecx
  int v3; // esi
  int result; // eax

  v1 = *(_DWORD *)(a1 + 24);
  v2 = (_DWORD *)(a1 + 24);
  if ( v1 )
    *(_DWORD *)(v1 + 28) = *(_DWORD *)(a1 + 28);
  v3 = *(_DWORD *)(a1 + 28);
  if ( v3 )
    *(_DWORD *)(v3 + 24) = *v2;
  if ( a1 == *(_DWORD *)&byte_5D4594[2487236] )
    *(_DWORD *)&byte_5D4594[2487236] = *v2;
  result = *v2;
  *v2 = *(_DWORD *)&byte_5D4594[2487240];
  *(_DWORD *)&byte_5D4594[2487240] = a1;
  *(_DWORD *)(a1 + 28) = 0;
  return result;
}

//----- (0051ADF0) --------------------------------------------------------
void sub_51ADF0()
{
  _DWORD *v0; // esi
  int v1; // edi
  int v2; // ebx
  int v3; // ebp

  v0 = *(_DWORD **)&byte_5D4594[2487236];
  if ( *(_DWORD *)&byte_5D4594[2487236] )
  {
    do
    {
      if ( *v0 > *(int *)&byte_5D4594[2598000] )
      {
        v0 = (_DWORD *)v0[6];
      }
      else
      {
        v1 = v0[1];
        v2 = v0[5];
        v3 = v0[4];
        if ( *(_DWORD *)(48 * v1 + *(_DWORD *)&byte_5D4594[1599636] + 8) )
          sub_507230(v0[2]);
        v0 = (_DWORD *)sub_51AD90((int)v0);
        sub_507310(v1, v2, v3);
      }
    }
    while ( v0 );
  }
}

//----- (0051AE60) --------------------------------------------------------
_DWORD *__cdecl sub_51AE60(int a1)
{
  _DWORD *result; // eax

  result = *(_DWORD **)&byte_5D4594[2487236];
  if ( *(_DWORD *)&byte_5D4594[2487236] )
  {
    do
    {
      if ( result[4] == a1 )
      {
        result = (_DWORD *)sub_51AD90((int)result);
      }
      else
      {
        if ( result[5] == a1 )
          result[5] = 0;
        result = (_DWORD *)result[6];
      }
    }
    while ( result );
  }
  return result;
}

//----- (0051AEA0) --------------------------------------------------------
int sub_51AEA0()
{
  int v0; // eax
  int j; // esi
  int v2; // eax
  int v3; // eax
  int v5; // [esp+8h] [ebp-Ch]
  int i; // [esp+Ch] [ebp-8h]
  int v7; // [esp+10h] [ebp-4h]

  v7 = 1;
  sub_426AC0(&v7, 2u);
  sub_426AC0(&byte_5D4594[2598000], 4u);
  v0 = *(_DWORD *)&byte_5D4594[2487236];
  for ( i = 0; v0; v0 = *(_DWORD *)(v0 + 24) )
    ++i;
  sub_426AC0(&i, 4u);
  for ( j = *(_DWORD *)&byte_5D4594[2487236]; j; j = *(_DWORD *)(j + 24) )
  {
    sub_426AC0((_BYTE *)j, 4u);
    sub_426AC0((_BYTE *)(j + 4), 4u);
    sub_426AC0((_BYTE *)(j + 8), 4u);
    v2 = *(_DWORD *)(j + 16);
    if ( v2 )
      v5 = *(_DWORD *)(v2 + 44);
    else
      v5 = 0;
    sub_426AC0(&v5, 4u);
    v3 = *(_DWORD *)(j + 20);
    if ( v3 )
      v5 = *(_DWORD *)(v3 + 44);
    else
      v5 = 0;
    sub_426AC0(&v5, 4u);
  }
  return 1;
}

//----- (0051AF80) --------------------------------------------------------
int sub_51AF80()
{
  int v0; // ebx
  _DWORD *v1; // eax
  _DWORD *v2; // esi
  int v3; // eax
  int i; // ecx
  int v6; // [esp+Ch] [ebp-20h]
  unsigned int v7; // [esp+10h] [ebp-1Ch]
  int v8; // [esp+14h] [ebp-18h]
  int v9; // [esp+18h] [ebp-14h]
  int v10; // [esp+1Ch] [ebp-10h]
  int v11; // [esp+20h] [ebp-Ch]
  int v12; // [esp+24h] [ebp-8h]
  int v13; // [esp+28h] [ebp-4h]

  v6 = 1;
  sub_426AC0(&v6, 2u);
  if ( (__int16)v6 <= 1 && (__int16)v6 > 0 )
  {
    sub_426AC0(&v8, 4u);
    sub_426AC0(&v7, 4u);
    v0 = 0;
    if ( v7 <= 0 )
      return 1;
    while ( 1 )
    {
      sub_426AC0(&v9, 4u);
      sub_426AC0(&v10, 4u);
      sub_426AC0(&v11, 4u);
      sub_426AC0(&v12, 4u);
      sub_426AC0(&v13, 4u);
      v1 = sub_51AD40();
      v2 = v1;
      if ( !v1 )
        break;
      *v1 = v9 + *(_DWORD *)&byte_5D4594[2598000] - v8;
      v1[1] = v10;
      v1[2] = v11;
      v1[3] = sub_51AD20();
      v2[4] = 0;
      v2[5] = 0;
      v2[4] = v12;
      v2[5] = v13;
      v2[6] = 0;
      v3 = *(_DWORD *)&byte_5D4594[2487236];
      if ( *(_DWORD *)&byte_5D4594[2487236] )
      {
        for ( i = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487236] + 24); i; i = *(_DWORD *)(i + 24) )
          v3 = i;
        *(_DWORD *)(v3 + 24) = v2;
        v2[7] = v3;
      }
      else
      {
        *(_DWORD *)&byte_5D4594[2487236] = v2;
        v2[7] = 0;
      }
      if ( ++v0 >= v7 )
        return 1;
    }
  }
  return 0;
}

//----- (0051B0C0) --------------------------------------------------------
void sub_51B0C0()
{
  int *v0; // esi

  v0 = *(int **)&byte_5D4594[2487236];
  if ( *(_DWORD *)&byte_5D4594[2487236] )
  {
    do
    {
      if ( v0[4] )
        v0[4] = sub_511B60(v0[4]);
      if ( v0[5] )
        v0[5] = sub_511B60(v0[5]);
      v0 = (int *)v0[6];
    }
    while ( v0 );
  }
}

//----- (0051B100) --------------------------------------------------------
char sub_51B100()
{
  int i; // esi
  int v1; // edi
  int v2; // esi
  int v3; // ebx
  int v4; // eax
  int v5; // eax
  void (__cdecl *v6)(int); // eax
  int v7; // edi
  _WORD *v8; // eax
  double v9; // st7
  int v10; // eax
  int v11; // ecx
  int v12; // eax
  int j; // esi
  void (__cdecl *v14)(int); // eax
  int v15; // eax
  int v16; // ecx
  int v17; // edx
  int v18; // eax
  int k; // esi
  int v20; // eax
  int v21; // edx
  int v22; // ecx
  __int16 v23; // ax
  __int16 v24; // ax
  char v25; // al
  int v26; // eax
  _WORD *v27; // eax
  BOOL v28; // edi
  int v29; // ecx
  int v30; // edi
  unsigned __int8 v31; // cl
  _BYTE *v32; // esi
  char v33; // bl
  char v34; // al
  int v35; // edx
  char v36; // al
  int v37; // eax
  char v38; // al
  int v39; // eax
  int v40; // eax
  int v41; // ecx
  int v42; // eax
  double v43; // st7
  int v44; // ecx
  char *v45; // eax
  int v46; // eax
  char v47; // al
  int v48; // eax
  int v49; // eax
  int v50; // ecx
  int v51; // eax
  double v52; // st7
  int v53; // ecx
  char *v54; // eax
  int v55; // eax
  double v56; // st7
  float v58; // [esp+0h] [ebp-48h]
  float v59; // [esp+0h] [ebp-48h]
  char v60; // [esp+17h] [ebp-31h]
  float v61; // [esp+18h] [ebp-30h]
  float v62; // [esp+1Ch] [ebp-2Ch]
  float2 v63; // [esp+20h] [ebp-28h]
  float2 v64; // [esp+28h] [ebp-20h]
  float v65; // [esp+34h] [ebp-14h]
  float4 v66;

  for ( i = sub_4DA7C0(); i; i = sub_4DA7F0(i) )
  {
    v1 = *(_DWORD *)(i + 748);
    sub_4FA490(i);
    *(_DWORD *)(v1 + 288) = sub_54AF40(i);
  }
  v2 = sub_4DA8A0();
  if ( v2 )
  {
    do
    {
      v3 = sub_4DA8B0(v2);
      if ( !(*(_BYTE *)(v2 + 16) & 0x20) )
      {
        v4 = *(_DWORD *)(v2 + 520);
        if ( v4 && *(_BYTE *)(v4 + 16) & 0x20 )
        {
          v5 = *(_DWORD *)(v4 + 508);
          if ( !v5 || *(_BYTE *)(v5 + 16) & 0x20 )
            *(_DWORD *)(v2 + 520) = 0;
          else
            *(_DWORD *)(v2 + 520) = v5;
        }
        v6 = *(void (__cdecl **)(int))(v2 + 744);
        if ( v6 )
        {
          if ( *(_BYTE *)(v2 + 8) & 4 )
          {
            v7 = *(_DWORD *)(v2 + 748);
            if ( !(*(_BYTE *)(v2 + 16) & 2) )
              v6(v2);
            sub_51AC30(*(unsigned __int8 *)(*(_DWORD *)(v7 + 276) + 2064));
          }
          else if ( !(*(_BYTE *)(v2 + 16) & 2) )
          {
            v6(v2);
          }
        }
        if ( *(_BYTE *)(v2 + 8) & 2 )
          sub_4E44F0(v2);
        sub_51B870(v2);
        v8 = *(_WORD **)(v2 + 556);
        if ( v8 )
          v8[1] = *v8;
        v9 = *(float *)(v2 + 64) - *(float *)(v2 + 56);
        *(_DWORD *)(v2 + 16) &= 0xFFEFFFFF;
        v58 = v9;
        v61 = sub_419A10(v58);
        v59 = *(float *)(v2 + 68) - *(float *)(v2 + 60);
        v62 = sub_419A10(v59);
        if ( *(float *)(v2 + 88) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 88) >= *(double *)&byte_581450[10256]
          || *(float *)(v2 + 92) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 92) >= *(double *)&byte_581450[10256]
          || *(float *)(v2 + 80) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 80) >= *(double *)&byte_581450[10256]
          || *(float *)(v2 + 84) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 84) >= *(double *)&byte_581450[10256]
          || v61 <= *(double *)&byte_581450[10392]
          || v61 >= *(double *)&byte_581450[10256]
          || v62 <= *(double *)&byte_581450[10392]
          || v62 >= *(double *)&byte_581450[10256]
          || *(float *)(v2 + 104) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 104) >= *(double *)&byte_581450[10256]
          || *(float *)(v2 + 108) <= *(double *)&byte_581450[10392]
          || *(float *)(v2 + 108) >= *(double *)&byte_581450[10256] )
        {
          sub_537610(v2);
          *(_DWORD *)(v2 + 16) &= 0xF7FFFFFF;
        }
        else
        {
          *(_DWORD *)(v2 + 88) = 0;
          *(_DWORD *)(v2 + 92) = 0;
          *(_DWORD *)(v2 + 80) = 0;
          *(_DWORD *)(v2 + 84) = 0;
          sub_4E46F0(v2, 0.0);
          v10 = *(_DWORD *)(v2 + 56);
          *(_DWORD *)(v2 + 68) = *(_DWORD *)(v2 + 60);
          v11 = *(_DWORD *)(v2 + 16);
          *(_DWORD *)(v2 + 64) = v10;
          v12 = *(_DWORD *)(v2 + 744);
          *(_DWORD *)(v2 + 108) = 0;
          *(_DWORD *)(v2 + 16) = v11 | 0x8000000;
          if ( !v12 )
            sub_4DA920((_DWORD *)v2);
        }
      }
      v2 = v3;
    }
    while ( v3 );
  }
  for ( j = sub_4DA840(); j; j = sub_4DA850(j) )
  {
    if ( !(*(_BYTE *)(j + 16) & 0x22) )
    {
      v14 = *(void (__cdecl **)(int))(j + 744);
      if ( v14 )
        v14(j);
      sub_51B870(j);
      sub_51B810(j);
      sub_537770(j);
      v15 = *(_DWORD *)(j + 56);
      v16 = *(_DWORD *)(j + 60);
      *(_WORD *)(j + 124) = *(_WORD *)(j + 126);
      v17 = *(_DWORD *)(j + 64);
      *(_DWORD *)(j + 72) = v15;
      v18 = *(_DWORD *)(j + 68);
      *(_DWORD *)(j + 56) = v17;
      *(_DWORD *)(j + 76) = v16;
      *(_DWORD *)(j + 60) = v18;
      *(_DWORD *)(j + 88) = 0;
      *(_DWORD *)(j + 92) = 0;
      sub_517970(j);
    }
  }
  sub_511850();
  for ( k = sub_4DA8A0(); k; k = sub_4DA8B0(k) )
  {
    v20 = *(_DWORD *)(k + 64);
    v21 = *(_DWORD *)(k + 60);
    *(_DWORD *)(k + 72) = *(_DWORD *)(k + 56);
    v22 = *(_DWORD *)(k + 68);
    *(_DWORD *)(k + 56) = v20;
    LOBYTE(v20) = *(_BYTE *)(k + 541);
    *(_DWORD *)(k + 76) = v21;
    LOWORD(v21) = *(_WORD *)(k + 126);
    *(_DWORD *)(k + 60) = v22;
    *(_DWORD *)(k + 88) = 0;
    *(_DWORD *)(k + 92) = 0;
    *(_WORD *)(k + 124) = v21;
    if ( (unsigned __int8)v20 > 4u )
      *(_BYTE *)(k + 541) = 4;
    *(float *)(k + 544) = (*(float *)(k + 552) + *(float *)(k + 548))
                        * (5.0 - (double)*(unsigned __int8 *)(k + 541))
                        * 0.2;
    if ( sub_4FF350(k, 4) )
      *(float *)(k + 544) = *(float *)(k + 544) * 0.5;
    if ( *(_BYTE *)(k + 541) || *(_BYTE *)(k + 540) )
    {
      v23 = *(_WORD *)(k + 542);
      if ( v23 > 0 )
      {
        v24 = v23 - 1;
        *(_WORD *)(k + 542) = v24;
        if ( !v24 )
        {
          v25 = *(_BYTE *)(k + 541);
          if ( v25 )
            *(_BYTE *)(k + 541) = v25 - 1;
          if ( *(_BYTE *)(k + 540) )
          {
            v26 = *(_DWORD *)(k + 16);
            if ( (v26 & 0x8000) == 0 )
              sub_4EE8F0(k, 1);
          }
          *(_WORD *)(k + 542) = 1000;
        }
      }
    }
    sub_4FF620(k);
    if ( *(_BYTE *)(k + 540) )
    {
      v27 = *(_WORD **)(k + 556);
      if ( v27 )
      {
        if ( v27[2] > 0u && *v27 > 0u )
        {
          v28 = sub_40A5C0(4096);
          v29 = *(_DWORD *)(*(_DWORD *)(k + 556) + 16);
          v30 = v28 + 1;
          if ( !v29 || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v29) > 0x3C )
          {
            v31 = *(_BYTE *)(k + 540);
            if ( v31 > 8u || !(*(_DWORD *)&byte_5D4594[2598000] % (unsigned int)(128 >> (v31 - 1))) )
              (*(void (__cdecl **)(int, _DWORD, _DWORD, int, int))(k + 716))(k, 0, 0, v30, 5);
          }
        }
      }
    }
  }
  v32 = sub_410780();
  if ( v32 )
  {
    v33 = v60;
    while ( v32 )
    {
      switch ( v32[21] )
      {
        case 1:
          v47 = v32[20];
          if ( v47 & 4 )
          {
            if ( (v47 & 8) == 8 )
            {
              v48 = *((_DWORD *)v32 + 6) - 1;
              *((_DWORD *)v32 + 6) = v48;
              if ( !v48 )
              {
                v49 = *((_DWORD *)v32 + 1);
                v32[21] = 4;
                v50 = 23 * v49;
                v51 = *((_DWORD *)v32 + 2);
                v52 = (double)(v50 + 11);
                v53 = *((_DWORD *)v32 + 3);
                v64.field_0 = v52;
                v64.field_4 = (double)(23 * v51 + 11);
                v54 = sub_410EE0(*(unsigned __int8 *)(v53 + 1));
                v55 = sub_40AF50(v54);
                sub_501A30(v55, &v64, 0, 0);
              }
            }
          }
          goto LABEL_90;
        case 2:
          v36 = v32[22] - 1;
          v32[22] = v36;
          if ( !v36 )
          {
            v37 = *((_DWORD *)v32 + 4);
            v32[21] = 1;
            *((_DWORD *)v32 + 6) = *(_DWORD *)&byte_5D4594[2649704] * v37;
          }
          v33 = 1;
          goto LABEL_92;
        case 3:
          v38 = v32[20];
          if ( !(v38 & 4) || v38 & 8 || (v39 = *((_DWORD *)v32 + 6) - 1, (*((_DWORD *)v32 + 6) = v39) != 0) )
          {
LABEL_90:
            v33 = 0;
          }
          else
          {
            v40 = *((_DWORD *)v32 + 1);
            v32[21] = 2;
            v41 = 23 * v40;
            v42 = *((_DWORD *)v32 + 2);
            v43 = (double)(v41 + 11);
            v44 = *((_DWORD *)v32 + 3);
            v63.field_0 = v43;
            v63.field_4 = (double)(23 * v42 + 11);
            v45 = sub_410F20(*(unsigned __int8 *)(v44 + 1));
            v46 = sub_40AF50(v45);
            sub_501A30(v46, &v63, 0, 0);
            v33 = 0;
          }
          break;
        case 4:
          v34 = v32[22] + 1;
          v32[22] = v34;
          if ( v34 == 23 )
          {
            v35 = *((_DWORD *)v32 + 4);
            v32[21] = 3;
            *((_DWORD *)v32 + 6) = *(_DWORD *)&byte_5D4594[2649704] * v35;
          }
          v33 = 1;
          goto LABEL_92;
        default:
          if ( v33 )
          {
LABEL_92:
            v56 = (double)(int)(23 * *((_DWORD *)v32 + 1)) + 11.5;
            v65 = (double)(int)(23 * *((_DWORD *)v32 + 2)) + 11.5;
            v66.field_0 = v56 - 42.5;
            v66.field_4 = v65 - 42.5;
            v66.field_8 = v56 + 42.5;
            v66.field_C = v65 + 42.5;
            sub_517C10(&v66, (void (__cdecl *)(float *, int))sub_51B860, 0);
          }
		  break;
      }
      v32 = (_BYTE *)sub_410790((int *)v32);
    }
  }
  sub_511750();
  return sub_509A60();
}
// 51B5E7: variable 'v60' is possibly undefined

//----- (0051B810) --------------------------------------------------------
int __cdecl sub_51B810(int a1)
{
  float *v1; // eax
  double v2; // st7
  int v3; // edx
  double v4; // st7
  int v6; // [esp-4h] [ebp-4h]
  float v7; // [esp+4h] [ebp+4h]

  v1 = (float *)a1;
  v6 = a1;
  v2 = *(float *)(a1 + 88) + *(float *)(a1 + 80);
  v3 = *(_DWORD *)(a1 + 68);
  *(_DWORD *)(a1 + 56) = *(_DWORD *)(a1 + 64);
  *(_DWORD *)(a1 + 60) = v3;
  v4 = v2 * *(float *)(a1 + 112);
  *(float *)(a1 + 80) = v4;
  v7 = (v1[23] + v1[21]) * v1[28];
  v1[21] = v7;
  v1[16] = v4 + v1[16];
  v1[17] = v7 + v1[17];
  return sub_4E7290(v6);
}

//----- (0051B860) --------------------------------------------------------
char __cdecl sub_51B860(int a1)
{
  return sub_537610(a1);
}

//----- (0051B870) --------------------------------------------------------
void __cdecl sub_51B870(int a1)
{
  int v1; // esi
  int v2; // ecx
  double v3; // st7
  double v4; // st7
  double v5; // st7
  double v6; // st6
  long double v7; // st6
  double v8; // st7
  double v9; // st7
  float v10; // [esp+0h] [ebp-14h]
  float v11; // [esp+0h] [ebp-14h]
  float v12; // [esp+0h] [ebp-14h]
  float v13; // [esp+10h] [ebp-4h]
  int v14; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 16);
  v3 = *(float *)(a1 + 104);
  if ( v2 & 0x40000 )
  {
    v10 = v3 + *(float *)(a1 + 108);
    sub_4E46F0(a1, v10);
    v4 = *(float *)(a1 + 108) - 1.0;
    *(_DWORD *)(a1 + 88) = 0;
    *(_DWORD *)(a1 + 92) = 0;
    *(_DWORD *)(a1 + 80) = 0;
    *(_DWORD *)(a1 + 84) = 0;
    *(float *)(a1 + 108) = v4;
    v5 = *(float *)(a1 + 56) - *(float *)(a1 + 156);
    v6 = *(float *)(a1 + 60) - *(float *)(a1 + 160);
    v13 = v6;
    v7 = sqrt(v6 * v13 + v5 * v5);
    *(float *)&v14 = v7;
    if ( v7 > 0.0 )
    {
      *(float *)(v1 + 88) = v5 * -3.0 / *(float *)&v14;
      *(float *)(v1 + 92) = v13 * -3.0 / *(float *)&v14;
    }
    if ( *(float *)(v1 + 104) < -50.0 )
    {
      sub_4E46F0(v1, 90.0);
      *(_DWORD *)(v1 + 16) &= 0xFFFBFFFF;
      sub_4E7010(v1, (float2 *)(v1 + 164));
    }
  }
  else if ( v3 != 0.0 || *(float *)(a1 + 108) != 0.0 )
  {
    if ( 0x800000 & v2 )
    {
      v11 = *(float *)(a1 + 104) + *(float *)(a1 + 108);
      sub_4E46F0(a1, v11);
      if ( *(float *)(a1 + 104) >= 0.0 )
      {
        *(float *)(a1 + 108) = *(float *)(a1 + 108) - 0.5;
      }
      else
      {
        sub_4E46F0(a1, 0.0);
        v8 = -*(float *)(a1 + 108) * *(float *)(a1 + 116) * 0.1;
        *(float *)(a1 + 108) = v8;
        if ( v8 < 2.0 )
        {
          sub_4E46F0(a1, 0.0);
          *(_DWORD *)(a1 + 108) = 0;
        }
      }
    }
    else if ( !(v2 & 0x100000) )
    {
      if ( *(float *)(a1 + 104) > 0.0 )
      {
        if ( *(float *)(a1 + 108) <= 0.0 )
          *(_DWORD *)(a1 + 16) = v2 | 0x20000;
        v12 = *(float *)(a1 + 104) + *(float *)(a1 + 108);
        sub_4E46F0(a1, v12);
        *(float *)(a1 + 108) = *(float *)(a1 + 108) - 1.0;
      }
      if ( *(float *)(a1 + 104) <= 0.0 )
      {
        v9 = *(float *)(a1 + 108);
        *(_DWORD *)(a1 + 16) &= 0xFFFDFFFF;
        if ( v9 < 0.0 && !(*(_BYTE *)(a1 + 8) & 1) )
        {
          sub_537610(a1);
          if ( *(float *)(a1 + 108) < -10.0 )
          {
            if ( *(_BYTE *)(a1 + 8) & 4 )
              sub_501960(280, a1, 0, 0);
          }
        }
        sub_4E46F0(a1, 0.0);
        *(_DWORD *)(a1 + 108) = 0;
      }
    }
  }
}

//----- (0051BAC0) --------------------------------------------------------
void sub_51BAC0()
{
  srand(0x2308u);
}

//----- (0051BAD0) --------------------------------------------------------
int __cdecl sub_51BAD0(int a1, unsigned __int8 *a2, signed int a3)
{
  unsigned __int8 *v4; // esi
  char *v5; // eax
  char *v6; // eax
  int v7; // edx
  int v8; // ebx
  int v9; // ebp
  int *v10; // edi
  char *v11; // ecx
  unsigned __int16 v12; // ax
  int v13; // ecx
  int v14; // ecx
  int v15; // edi
  int v16; // eax
  int v17; // edi
  int v18; // eax
  int v19; // edi
  int v20; // eax
  unsigned __int16 v21; // dx
  int v22; // edi
  int v23; // ebx
  int v24; // edi
  int i; // eax
  int v26; // edi
  int v27; // eax
  int v28; // edi
  int v29; // eax
  void (__cdecl *v30)(int, int, _DWORD); // ecx
  int v31; // edi
  int v32; // eax
  BOOL v33; // edi
  int v34; // edi
  int v35; // eax
  int *v36; // edi
  int v37; // ebx
  _DWORD *v38; // eax
  int v39; // ecx
  int v40; // ebx
  int v41; // eax
  wchar_t *v42; // eax
  wchar_t *v43; // eax
  int v44; // eax
  int v45; // edi
  _DWORD *v46; // eax
  _DWORD *v47; // ebx
  int v48; // ebx
  char *v49; // ebp
  char *j; // ebp
  int v51; // eax
  char *v52; // eax
  int v53; // edi
  char *v54; // eax
  char *v55; // edi
  int v56; // eax
  int v57; // eax
  int v58; // edi
  int v59; // eax
  int v60; // ebx
  int v61; // edi
  unsigned __int8 v62; // al
  _DWORD *v63; // eax
  int v64; // eax
  int v65; // eax
  int v66; // eax
  int v67; // edi
  int *v68; // edi
  int v69; // eax
  int v70; // edi
  int v71; // eax
  _DWORD *v72; // eax
  int v73; // eax
  int v74; // eax
  int v75; // eax
  int v76; // eax
  int v77; // eax
  int v78; // eax
  unsigned __int8 v79; // al
  int v80; // eax
  int v81; // ecx
  unsigned int v82; // [esp-8h] [ebp-65Ch]
  float v83; // [esp+0h] [ebp-654h]
  float v84; // [esp+4h] [ebp-650h]
  int v85; // [esp+18h] [ebp-63Ch]
  char *v86; // [esp+1Ch] [ebp-638h]
  char v87[2]; // [esp+22h] [ebp-632h]
  char v88[4]; // [esp+24h] [ebp-630h]
  char *v89; // [esp+28h] [ebp-62Ch]
  char v90[6]; // [esp+2Ch] [ebp-628h]
  unsigned __int8 *v91; // [esp+34h] [ebp-620h]
  char v92[5]; // [esp+38h] [ebp-61Ch]
  int v93; // [esp+40h] [ebp-614h]
  float2 v94; // [esp+44h] [ebp-610h]
  float2 v96; // [esp+4Ch] [ebp-608h]
  wchar_t v97[256]; // [esp+54h] [ebp-600h]
  CHAR FileName[1024]; // [esp+254h] [ebp-400h]
  
  // mix patch
  int vU101; // ebp

  if (a3)
  {
//	OutputDebugStringA("S -> ");
//    dhexdump((_BYTE*)a2, a3);
  }

  if ( a3 <= 0 )
  {
    *((_DWORD *)sub_417090(a1) + 899) = *(_DWORD *)&byte_5D4594[2598000];
    return 1;
  }
  v4 = a2;
  if ( *(_DWORD *)&byte_5D4594[2650636] & 0x200000 )
  {
    v5 = sub_417090(a1);
    sub_4D3450((int)v5, a2, a3);
  }
  switch ( *a2 )
  {
    case 0x20u:
      if ( !sub_4DD320(a1, (int)(a2 + 1)) )
        sub_5545B0(a1 + 1);
      return 1;
    case 0x22u:
      sub_4DE7C0(a1);
      return 1;
    case 0x25u:
      *((_DWORD *)sub_417090(a1) + 899) = *(_DWORD *)&byte_5D4594[2598000];
      return 1;
  }
  v91 = &a2[a3];
  v6 = sub_417090(a1);
  v8 = (int)v6;
  v89 = v6;
  if ( !v6 )
    return 1;
  v93 = *((_DWORD *)v6 + 514);
  v9 = v93;
  if ( !v93 )
    return 1;
  v10 = *(int **)(v93 + 748);
  v85 = *(_DWORD *)(v93 + 748);
  if ( a2 < v91 )
  {
    while ( v4 < v91 )
    {
      v11 = 0;
      switch ( *v4 )
      {
        case 0x26u:
          goto LABEL_272;
        case 0x29u:
          sub_4174F0(v8, 64);
          ++v4;
          goto LABEL_273;
        case 0x3Fu:
          v4 += sub_51A960(*(unsigned __int8 *)(v10[69] + 2064), v4 + 1) + 1;
          goto LABEL_273;
        case 0x40u:
          v84 = (double)*(unsigned __int16 *)(v4 + 5);
          v83 = (double)*(unsigned __int16 *)(v4 + 3);
          sub_4F79A0(v9, SLODWORD(v83), SLODWORD(v84));
          v4 += 7;
          goto LABEL_273;
        case 0x72u:
          v19 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          v7 = *(_DWORD *)(v85 + 276);
          if ( !(*(_BYTE *)(v7 + 3680) & 3)
            && !*(_DWORD *)(v85 + 280)
            && !*(_DWORD *)(v85 + 284)
            && !(*(_BYTE *)(v9 + 16) & 2) )
          {
            v20 = sub_4F7920(v9, v19);
            if ( v20 )
            {
              v21 = *(_WORD *)(v4 + 5);
              v94.field_0 = (double)*(unsigned __int16 *)(v4 + 3);
              v94.field_4 = (double)v21;
              sub_4ED810(v9, v20, &v94);
            }
          }
          v10 = (int *)v85;
          v4 += 7;
          goto LABEL_273;
        case 0x73u:
          v22 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          if ( sub_4DB1B0() )
            goto LABEL_55;
          v7 = *(_DWORD *)(v85 + 276);
          if ( *(_BYTE *)(v7 + 3680) & 3 )
            goto LABEL_55;
          if ( *(_DWORD *)(v85 + 280) )
            goto LABEL_55;
          if ( *(_DWORD *)(v85 + 284) )
            goto LABEL_55;
          if ( *(_BYTE *)(v9 + 16) & 2 )
            goto LABEL_55;
          v23 = sub_4ECCB0(v22);
          if ( !v23 )
            goto LABEL_55;
          v24 = 0;
          for ( i = sub_4E7980(v9); i; i = sub_4E7990(i) )
            v24 += *(unsigned __int8 *)(i + 488);
          if ( v24 + *(unsigned __int8 *)(v23 + 488) <= *(unsigned __int16 *)(v9 + 490) )
          {
            sub_4F36F0(v9, v23, 1, 1);
			vU101 = v9;
			OnLibraryNotice(420, &vU101, v9, v23);
LABEL_55:
            v8 = (int)v89;
            v10 = (int *)v85;
            v4 += 3;
          }
          else
          {
            sub_4DA2C0(v9, (const char *)&byte_587000[252872], 0);
            v8 = (int)v89;
            v10 = (int *)v85;
            v4 += 3;
          }
          goto LABEL_273;
        case 0x74u:
          v26 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          if ( sub_4DB1B0() )
            goto LABEL_196;
          v7 = *(_DWORD *)(v85 + 276);
          if ( *(_BYTE *)(v7 + 3680) & 3 )
            goto LABEL_196;
          v27 = sub_4F7920(v9, v26);
          if ( !v27 )
            goto LABEL_196;
          sub_53F8E0(v9, v27);
          v10 = (int *)v85;
          v4 += 3;
          goto LABEL_273;
        case 0x75u:
          v15 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          if ( sub_4DB1B0() )
            goto LABEL_196;
          v7 = v85;
          if ( *(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 3 )
            goto LABEL_196;
          v16 = sub_4F7920(v9, v15);
          if ( !v16 )
            goto LABEL_196;
          sub_4F2F70((_DWORD *)v9, v16);
          v10 = (int *)v85;
          v4 += 3;
          goto LABEL_273;
        case 0x76u:
          v17 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          if ( *(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 3 )
            goto LABEL_196;
          v18 = sub_4F7920(v9, v17);
          if ( !v18 )
            goto LABEL_196;
          v7 = v85;
          if ( *(_BYTE *)(v85 + 88) == 1 && *(_DWORD *)(v18 + 8) & 0x1000000 && *(_BYTE *)(v18 + 12) & 8 )
            goto LABEL_196;
          sub_4F2FB0((_DWORD *)v9, v18);
          v10 = (int *)v85;
          v4 += 3;
          goto LABEL_273;
        case 0x78u:
          v31 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          v7 = v85;
          if ( !(*(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 1) )
          {
            if ( *(_WORD *)(v4 + 1) )
            {
              v32 = sub_4ECCB0(v31);
              if ( v32 )
                sub_533900(v9, v32, v4[3]);
            }
            else
            {
              sub_533900(v9, 0, v4[3]);
            }
          }
          v10 = (int *)v85;
          v4 += 4;
          goto LABEL_273;
        case 0x79u:
          v34 = 1;
          if ( *(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 1 )
          {
            sub_4DA2C0(v9, (const char *)&byte_587000[252900], 0);
            v34 = 0;
          }
          if ( *(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 2 )
          {
            sub_4DA2C0(v9, (const char *)&byte_587000[252936], 0);
            v34 = 0;
          }
          if ( !sub_40A5C0(2048) )
          {
            v35 = *(_DWORD *)(v9 + 16);
            if ( v35 & 0x4000 )
              v34 = 0;
          }
          if ( !sub_40A5C0(128) && v34 )
          {
            v36 = (int *)(v4 + 1);
            v37 = 0;
            v38 = v4 + 1;
            v39 = 5;
            do
            {
              if ( *v38 )
                ++v37;
              ++v38;
              --v39;
            }
            while ( v39 );
            if ( (v37 != 1
               || !sub_424A50(*v36, 32)
               || !*(_DWORD *)(v85 + 288)
               || sub_5330C0(v9, *(_DWORD *)(v85 + 288))
               || sub_40A5C0(4096))
              && !sub_4FE340(v9, (int *)(v4 + 1), v37, 3, v4[21])
              && v37 == 1 )
            {
              v40 = 5;
              do
              {
                if ( *v36 )
                  sub_4D9630(*(unsigned __int8 *)(*(_DWORD *)(v85 + 276) + 2064), *v36, 0);
                ++v36;
                --v40;
              }
              while ( v40 );
            }
          }
          v8 = (int)v89;
          v10 = (int *)v85;
          v4 += 22;
          goto LABEL_273;
        case 0x7Au:
          v33 = (*(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 3) == 0;
          if ( !sub_40A5C0(128) && v33 )
            sub_4FBB70(v9, v4[1]);
          v10 = (int *)v85;
          v4 += 2;
          goto LABEL_273;
        case 0x7Bu:
          v28 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          v7 = v85;
          if ( !(*(_BYTE *)(*(_DWORD *)(v85 + 276) + 3680) & 3) && !*(_DWORD *)(v85 + 280) && !*(_DWORD *)(v85 + 284) )
          {
            v29 = sub_4ECCB0(v28);
            if ( v29 )
            {
              v30 = *(void (__cdecl **)(int, int, _DWORD))(v29 + 696);
              if ( v30 )
                v30(v29, v9, 0);
            }
          }
          v10 = (int *)v85;
          v4 += 3;
          goto LABEL_273;
        case 0xA5u:
          *(_WORD *)(v8 + 8 * v4[1] + 16) = *((_WORD *)v4 + 1);
          *(_WORD *)(v8 + 8 * v4[1] + 18) = *((_WORD *)v4 + 2);
          v14 = v4[1];
          v7 = *(_DWORD *)(v4 + 6);
          v4 += 10;
          *(_DWORD *)(v8 + 8 * v14 + 20) = v7;
          goto LABEL_273;
        case 0xA8u:
          if ( v4[3] & 2 )
          {
            nox_swprintf(v97, (const wchar_t *)&byte_587000[253032], v4 + 11);
            v44 = 1;
          }
          else
          {
            nox_wcscpy(v97, (const wchar_t *)(v4 + 11));
            v44 = 2;
          }
          v45 = v44 * v4[8] + 11;
          if ( sub_57A190(v8) )
            goto LABEL_139;
          if ( !(v4[3] & 1) )
          {
            for ( j = sub_416EA0(); j; j = sub_416EE0((int)j) )
            {
              if ( sub_40A5C0(2) && j[2064] == 31 )
              {
                sub_48EA70(31, (unsigned int)v4, v45);
              }
              else
              {
                sub_552640((unsigned __int8)j[2064] + 1, v4, v45, 0);
                sub_5528B0((unsigned __int8)j[2064] + 1, 1);
              }
            }
LABEL_139:
            v9 = v93;
            v8 = (int)v89;
            v4 += v45;
            v10 = (int *)v85;
            goto LABEL_273;
          }
          v46 = sub_418C80(*(unsigned __int16 *)(v4 + 1));
          v47 = v46;
          if ( !v46 )
            goto LABEL_139;
          if ( !sub_419130((int)v46) )
            goto LABEL_139;
          v86 = sub_418AB0(*((unsigned __int8 *)v47 + 4));
          if ( !v86 )
            goto LABEL_139;
          v48 = sub_4DA7C0();
          if ( !v48 )
            goto LABEL_139;
          do
          {
            v49 = sub_417040(*(_DWORD *)(v48 + 36));
            if ( v49 && sub_419180(v48 + 48, v86[57]) )
            {
              if ( sub_40A5C0(2) && *(_DWORD *)(v48 + 36) == *(_DWORD *)&byte_5D4594[2616328] )
              {
                sub_48EA70((unsigned __int8)v49[2064], (unsigned int)v4, v45);
              }
              else
              {
                sub_552640((unsigned __int8)v49[2064] + 1, v4, v45, 0);
                sub_5528B0((unsigned __int8)v49[2064] + 1, 1);
              }
            }
            v48 = sub_4DA7F0(v48);
          }
          while ( v48 );
          v9 = v93;
          v8 = (int)v89;
          v4 += v45;
          v10 = (int *)v85;
LABEL_273:
          break;
        case 0xAAu:
          v13 = v10[69];
          *(_DWORD *)&v92[1] = *(_DWORD *)(v4 + 1);
          v92[0] = -85;
          sub_40EBC0(*(unsigned __int8 *)(v13 + 2064), 1, v92, 5);
          v4 += 5;
          goto LABEL_273;
        case 0xABu:
          sub_4E55A0(*(_BYTE *)(v10[69] + 2064), *(_DWORD *)(v4 + 1));
          v4 += 5;
          goto LABEL_273;
        case 0xACu:
          v12 = *(_WORD *)(v4 + 1);
          v4 += 5;
          *(_DWORD *)(v8 + 2284) = v12;
          *(_DWORD *)(v8 + 2288) = *((unsigned __int16 *)v4 - 1);
          goto LABEL_273;
        case 0xADu:
          sub_4DDF60(*(unsigned __int8 *)(v8 + 2064));
          ++v4;
          goto LABEL_273;
        case 0xAEu:
          sub_4DE530(*(unsigned __int8 *)(v8 + 2064), 2);
          ++v4;
          goto LABEL_273;
        case 0xB6u:
          sub_4E6860(v8, 1, 1);
          v51 = *(_DWORD *)(v8 + 2056);
          if ( v51 )
            sub_419570(v51 + 48, *(_DWORD *)(v8 + 2060));
          sub_519D20(*(unsigned __int8 *)(v8 + 2064));
          ++v4;
          goto LABEL_273;
        case 0xB7u:
          sub_519DE0(*(unsigned __int8 *)(v8 + 2064));
          ++v4;
          goto LABEL_273;
        case 0xBBu:
          sub_443E90(v8, v4[1], (wchar_t *)(v4 + 5));
          v4 += 2 * v4[4] + 7;
          goto LABEL_273;
        case 0xBCu:
          v87[0] = -67;
          v42 = sub_40A630();
          if ( !*v42 || _nox_wcsicmp((const wchar_t *)(v4 + 1), v42) )
          {
            v87[1] = 0;
          }
          else
          {
            v87[1] = 1;
            if ( !sub_4D12A0(*(unsigned __int8 *)(v8 + 2064)) )
            {
              sub_4D1210(*(unsigned __int8 *)(v8 + 2064));
              v43 = sub_40F1D0((char *)&byte_587000[253012], 0, (const char *)&byte_587000[252972], 735);
              sub_450C00(6u, v43, v8 + 4704);
            }
          }
          sub_4E5420(*(unsigned __int8 *)(v8 + 2064), v87, 2, 0, 1);
          v4 += 21;
          goto LABEL_273;
        case 0xBEu:
          goto LABEL_166;
        case 0xBFu:
          *(_BYTE *)(v8 + 3676) = 3;
          sub_519E80(*(unsigned __int8 *)(v8 + 2064));
          ++v4;
          goto LABEL_273;
        case 0xC0u:
          sub_4DD180(*(unsigned __int8 *)(v8 + 2064));
LABEL_166:
          ++v4;
          goto LABEL_273;
        case 0xC1u:
          if ( sub_40A5C0(4096)
            && *(_BYTE *)(v8 + 2064) != 31
            && *(_DWORD *)(v8 + 2092)
            && *(_DWORD *)(v8 + 2056)
            && v10[138] == 1 )
          {
            sub_4DEAB0(*(unsigned __int8 *)(v8 + 2064), 2);
            v4 += 3;
          }
          else
          {
            v52 = sub_409E10();
            nox_sprintf(FileName, (const char *)&byte_587000[253040], v52);
            if ( sub_41A140(FileName, *(unsigned __int8 *)(v8 + 2064)) )
              sub_41CFA0(FileName, *(unsigned __int8 *)(v8 + 2064));
            DeleteFileA(FileName);
            v4 += 3;
          }
          goto LABEL_273;
        case 0xC2u:
          switch ( v4[1] )
          {
            case 0u:
              sub_40B5D0(*(unsigned __int8 *)(v8 + 2064) + 1, v4[2], (const char *)v4 + 8, *((_DWORD *)v4 + 1), v4[136]);
              v4 += 140;
              break;
            case 1u:
              LOBYTE(v11) = v4[3];
              sub_40BFF0(*(unsigned __int8 *)(v8 + 2064) + 1, v4[2], v11);
              v4 += 4;
              break;
            case 2u:
              v90[0] = -62;
              v90[1] = 3;
              v90[2] = v4[2];
              v82 = *(unsigned __int8 *)(v8 + 2064) + 1;
              *(_WORD *)&v90[4] = *((_WORD *)v4 + 2);
              sub_552640(v82, v90, 6, 3);
              sub_40B250(
                *(unsigned __int8 *)(v8 + 2064) + 1,
                v4[2],
                *((_WORD *)v4 + 2),
                v4 + 8,
                *((unsigned __int16 *)v4 + 3));
              v4 += *((unsigned __int16 *)v4 + 3) + 8;
              break;
            case 3u:
              sub_40BF60(*(unsigned __int8 *)(v8 + 2064) + 1, v4[2], *((unsigned __int16 *)v4 + 2));
              v4 += 6;
              break;
            case 4u:
              sub_40C030(*(unsigned __int8 *)(v8 + 2064) + 1, v4[2]);
              v4 += 3;
              break;
            case 5u:
              LOBYTE(v7) = v4[3];
              sub_40B720(v7, v4[2]);
              v4 += 4;
              break;
            case 6u:
              LOBYTE(v11) = v4[3];
              sub_40C070(*(unsigned __int8 *)(v8 + 2064) + 1, (int)v11, v4[2]);
              v4 += 4;
              break;
            default:
              goto LABEL_273;
          }
          goto LABEL_273;
        case 0xC4u:
          if ( v4[1] == 10 )
          {
            v55 = sub_418AB0(*(_DWORD *)(v4 + 2));
            if ( v55 )
            {
              v56 = sub_4ECCB0(*((unsigned __int16 *)v4 + 3));
              sub_4191D0(v55[57], v56 + 48, 1, *((unsigned __int16 *)v4 + 3), 1);
            }
            v10 = (int *)v85;
            v4 += 10;
          }
          else if ( v4[1] == 11 )
          {
            v53 = sub_4ECCB0(*((unsigned __int16 *)v4 + 3));
            if ( v53 )
            {
              if ( !sub_40A5C0(128) )
              {
                sub_4F7AB0(&v96, v53);
                sub_4E7010(v53, &v96);
              }
              v54 = sub_418AB0(*(_DWORD *)(v4 + 2));
              if ( v54 )
                sub_4196D0(v53 + 48, (int)v54, *((unsigned __int16 *)v4 + 3), 1);
            }
            v10 = (int *)v85;
            v4 += 10;
          }
          goto LABEL_273;
        case 0xC8u:
          sub_446070();
          ++v4;
          goto LABEL_273;
        case 0xC9u:
          goto LABEL_226;
        case 0xD0u:
          if ( v4[1] == 1 )
          {
            if ( sub_4DB1B0()
              || (v7 = v10[69], *(_BYTE *)(v7 + 3680) & 3)
              || (v57 = sub_4ECCB0(*((unsigned __int16 *)v4 + 1))) == 0 )
            {
LABEL_232:
              v4 += 4;
            }
            else
            {
              sub_548CD0(v9, v57);
              v4 += 4;
            }
          }
          else if ( v4[1] == 2 )
          {
            sub_548D30(v9, v4[2]);
            v4 += 3;
          }
          goto LABEL_273;
        case 0xD4u:
          v41 = sub_40A220();
          sub_4D8F50(a1, v41);
          ++v4;
          goto LABEL_273;
        case 0xE0u:
          v58 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          if ( *(_WORD *)(v4 + 1) )
          {
            v59 = sub_4ECCB0(v58);
            sub_53AB90(v9, v59);
            v10 = (int *)v85;
            v4 += 3;
          }
          else
          {
            sub_53AB90(v9, 0);
LABEL_196:
            v10 = (int *)v85;
            v4 += 3;
          }
          goto LABEL_273;
        case 0xE2u:
          v60 = sub_578B40(*(unsigned __int16 *)(v4 + 1));
          if ( (byte_5D4594[2650637] & 0x80u) != 0 )
            sub_578B70(*(unsigned __int16 *)(v4 + 1));
          v61 = sub_4F7920(v9, v60);
          if ( v61 || (v61 = sub_510DE0(v9, v60)) != 0 || (v61 = sub_4ECCB0(v60)) != 0 )
          {
            v88[0] = -30;
            *(_WORD *)&v88[1] = sub_578AC0((_DWORD *)v61);
            v62 = v4[3];
            if ( v62 == 1 )
            {
              v88[3] = **(_BYTE **)(v61 + 736);
            }
            else if ( v62 == 2 )
            {
              v88[3] = sub_427010(*(const char **)(v61 + 736));
            }
            else
            {
              v88[3] = **(_BYTE **)(v61 + 736);
            }
            sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v85 + 276) + 2064), v88, 4, 0, 1);
          }
          v8 = (int)v89;
          v10 = (int *)v85;
          v4 += 4;
          goto LABEL_273;
        case 0xE3u:
          switch ( v4[1] )
          {
            case 1u:
              sub_4FA020((_DWORD *)v9, 26);
              break;
            case 2u:
              sub_4FA020((_DWORD *)v9, 25);
              break;
            case 4u:
              sub_4FA020((_DWORD *)v9, 27);
              break;
            default:
              goto LABEL_273;
          }
          goto LABEL_272;
        case 0xEEu:
          switch ( v4[1] )
          {
            case 0u:
              if ( sub_40A5C0(4096) )
                sub_506870(3, v9, (wchar_t *)v4 + 1);
              else
                sub_506870(0, v9, (wchar_t *)v4 + 1);
              v4 += 52;
              goto LABEL_226;
            case 1u:
              sub_506870(1, v9, (wchar_t *)v4 + 1);
              v4 += 52;
              goto LABEL_226;
            case 2u:
              if ( sub_40A5C0(4096) )
                sub_506C90(3, v9, (wchar_t *)v4 + 1);
              else
                sub_506C90(0, v9, (wchar_t *)v4 + 1);
              v4 += 52;
              goto LABEL_226;
            case 3u:
              sub_506C90(1, v9, (wchar_t *)v4 + 1);
              v4 += 52;
              goto LABEL_226;
            case 4u:
              sub_506870(2, v9, 0);
              break;
            case 5u:
              sub_506C90(2, v9, 0);
              break;
            default:
              return 0;
          }
          v4 += 2;
LABEL_226:
          switch ( v4[1] )
          {
            case 0xEu:
              if ( v10[70] )
                sub_50F3A0((_DWORD *)v10[70]);
              goto LABEL_272;
            case 0xFu:
              v67 = sub_578B40(*((unsigned __int16 *)v4 + 1));
              if ( (byte_5D4594[2650637] & 0x80u) != 0 )
                sub_578B70(*((unsigned __int16 *)v4 + 1));
              v68 = (int *)sub_4F7920(v9, v67);
              if ( v68 )
              {
                v69 = *(_DWORD *)(v85 + 280);
                if ( v69 )
                {
                  if ( sub_50F820(v69, v9, *(float *)&v68) == 1 )
                    sub_4ED0C0(v9, v68);
                }
              }
              goto LABEL_243;
            case 0x10u:
              v70 = sub_578B40(*((unsigned __int16 *)v4 + 1));
              if ( (byte_5D4594[2650637] & 0x80u) != 0 )
                sub_578B70(*((unsigned __int16 *)v4 + 1));
              v71 = *(_DWORD *)(v85 + 280);
              if ( v71 )
              {
                sub_50FE20(v71, v70);
                v10 = (int *)v85;
                v4 += 4;
              }
              else
              {
LABEL_243:
                v10 = (int *)v85;
                v4 += 4;
              }
              goto LABEL_273;
            case 0x11u:
              v66 = v10[70];
              if ( v66 )
                sub_50F5A0(v66, v9);
              goto LABEL_272;
            case 0x12u:
              if ( v10[70] )
                sub_50F4C0((_DWORD *)v10[70]);
              goto LABEL_272;
            case 0x15u:
              if ( !sub_4DB1B0() && !(*(_BYTE *)(v10[69] + 3680) & 3) )
              {
                v64 = sub_578B40(*((unsigned __int16 *)v4 + 1));
                v65 = sub_4ECCB0(v64);
                if ( v65 )
                {
                  if ( *(_BYTE *)(v65 + 12) & 8 )
                    sub_50EF10(v9, v65);
                }
              }
              goto LABEL_232;
            case 0x16u:
              v72 = (_DWORD *)v10[70];
              if ( v72 )
                sub_5100C0(v9, v72, *((unsigned __int16 *)v4 + 1));
              goto LABEL_252;
            case 0x17u:
              v73 = v10[70];
              if ( v73 )
                sub_510640(v9, v73, *((unsigned __int16 *)v4 + 1), (float *)v4[4]);
              goto LABEL_255;
            case 0x18u:
              v74 = v10[70];
              if ( !v74 )
                goto LABEL_252;
              sub_510BE0((int *)v9, v74, (_DWORD *)*((unsigned __int16 *)v4 + 1));
              v4 += 4;
              goto LABEL_273;
            case 0x19u:
              v76 = v10[70];
              if ( v76 )
              {
                sub_510D10((int *)v9, v76, *((unsigned __int16 *)v4 + 1), v4[4]);
                v4 += 5;
              }
              else
              {
LABEL_255:
                v4 += 5;
              }
              goto LABEL_273;
            case 0x1Au:
              v75 = v10[70];
              if ( !v75 )
                goto LABEL_252;
              sub_510AE0((int *)v9, v75, (_DWORD *)*((unsigned __int16 *)v4 + 1));
              v4 += 4;
              break;
            case 0x1Cu:
              v77 = v10[70];
              if ( !v77 )
                goto LABEL_252;
              sub_5109C0((int *)v9, v77, (_DWORD *)*((unsigned __int16 *)v4 + 1));
              v4 += 4;
              break;
            case 0x1Eu:
              v78 = v10[70];
              if ( v78 )
              {
                sub_5108D0(v9, v78, *((unsigned __int16 *)v4 + 1));
                v4 += 4;
              }
              else
              {
LABEL_252:
                v4 += 4;
              }
              break;
            default:
              return 0;
          }
          goto LABEL_273;
        case 0xF0u:
          v79 = v4[1];
          if ( v79 == 3 )
          {
            v80 = v10[69];
            v81 = *(_DWORD *)(v80 + 2056);
            if ( v81 )
            {
              v7 = *(_DWORD *)(v81 + 16);
              if ( (v7 & 0x8000) != 0 )
              {
                v10[137] = 0;
                sub_4F7EF0(*(_DWORD *)(v80 + 2056));
              }
            }
          }
          else
          {
            if ( v79 != 27 )
              goto LABEL_273;
            sub_4DD0B0(v9);
          }
LABEL_272:
          v4 += 2;
          goto LABEL_273;
        case 0xF1u:
          v63 = (_DWORD *)sub_4F7920(v9, *(unsigned __int16 *)(v4 + 1));
          if ( v63 )
          {
            sub_4ED790(v9, v63, (float2 *)(v9 + 56));
            sub_4DA2C0(v9, (const char *)&byte_587000[253060], 0);
          }
          v4 += 3;
          goto LABEL_273;
        default:
          return 0;
      }
    }
  }
  *(_DWORD *)(v8 + 3596) = *(_DWORD *)&byte_5D4594[2598000];
  return 1;
}
// 51C788: variable 'v7' is possibly undefined

//----- (0051D0D0) --------------------------------------------------------
void sub_51D0D0()
{
  srand(0x2309u);
}

//----- (0051D0E0) --------------------------------------------------------
void sub_51D0E0()
{
  *(_DWORD *)&byte_5D4594[2487244] = 0;
}

//----- (0051D0F0) --------------------------------------------------------
int __cdecl sub_51D0F0(char a1)
{
  byte_5D4594[3835400] = a1;
  return 1;
}

//----- (0051D100) --------------------------------------------------------
int __cdecl sub_51D100(int a1)
{
  if ( a1 != 1 && a1 )
    return 0;
  *(_DWORD *)&byte_5D4594[3835404] = a1;
  return 1;
}

//----- (0051D120) --------------------------------------------------------
_DWORD *__cdecl sub_51D120(float *a1)
{
  _DWORD *result; // eax
  _DWORD *v2; // esi
  float2 v3; // [esp+4h] [ebp-8h]

  result = (float *)sub_4D3D90((float2 *)a1, &v3);
  if ( result )
  {
    result = sub_5798F0(v3.field_0, v3.field_4);
    v2 = result;
    if ( result )
    {
      if ( *(_DWORD *)&byte_5D4594[2487244] )
      {
        if ( *(_DWORD *)&byte_5D4594[3835404] == 1 )
        {
          sub_51D300(*(int *)&byte_5D4594[2487244], (int)result, byte_5D4594[3835400]);
          sub_51D300((int)v2, *(int *)&byte_5D4594[2487244], byte_5D4594[3835400]);
        }
      }
      *(_DWORD *)&byte_5D4594[2487244] = v2;
      result = v2;
    }
  }
  return result;
}

//----- (0051D1A0) --------------------------------------------------------
float *__cdecl sub_51D1A0(float2 *a1)
{
  float *result; // eax
  float2 a2; // [esp+0h] [ebp-8h]

  result = (float *)sub_4D3D90(a1, &a2);
  if ( result )
    result = sub_579AD0(a2.field_0, a2.field_4);
  return result;
}

//----- (0051D1E0) --------------------------------------------------------
int __cdecl sub_51D1E0(LPVOID lpMem)
{
  LPVOID v1; // eax
  char *i; // esi
  int v4; // ebx
  char *v5; // edi

  if ( !lpMem )
    return 0;
  v1 = sub_579860();
  if ( !v1 )
    return 0;
  while ( v1 != lpMem )
  {
    v1 = (LPVOID)sub_579870((int)v1);
    if ( !v1 )
      return 0;
  }
  for ( i = (char *)sub_579860(); i; i = (char *)sub_579870((int)i) )
  {
    v4 = 0;
    if ( i[476] )
    {
      v5 = i + 96;
      do
      {
        if ( *((LPVOID *)v5 - 1) == lpMem )
          sub_51D370((int)i, (int)lpMem, *v5);
        ++v4;
        v5 += 8;
      }
      while ( v4 < (unsigned __int8)i[476] );
    }
  }
  sub_579B30(lpMem);
  return 1;
}

//----- (0051D270) --------------------------------------------------------
float *__cdecl sub_51D270(float *a1)
{
  float *result; // eax
  float2 v2; // [esp+0h] [ebp-8h]

  result = (float *)sub_4D3D90((float2 *)a1, &v2);
  if ( result )
  {
    result = sub_579AD0(v2.field_0, v2.field_0);
    if ( result )
      result = (float *)sub_51D1E0(result);
  }
  return result;
}

//----- (0051D2C0) --------------------------------------------------------
int __cdecl sub_51D2C0(int a1, int a2)
{
  return sub_51D300(a1, a2, byte_5D4594[3835400]);
}

//----- (0051D2E0) --------------------------------------------------------
int __cdecl sub_51D2E0(int a1, int a2)
{
  return sub_51D370(a1, a2, byte_5D4594[3835400]);
}

//----- (0051D300) --------------------------------------------------------
int __cdecl sub_51D300(int a1, int a2, char a3)
{
  unsigned __int8 v3; // al
  int v4; // ecx
  int v5; // esi
  _BYTE *v6; // eax

  v3 = *(_BYTE *)(a1 + 476);
  if ( v3 >= 0x1Fu || a1 == a2 )
    return 0;
  v4 = 0;
  v5 = v3;
  if ( (int)v3 > 0 )
  {
    v6 = (_BYTE *)(a1 + 96);
    do
    {
      if ( *((_DWORD *)v6 - 1) == a2 && *v6 == a3 )
        break;
      ++v4;
      v6 += 8;
    }
    while ( v4 < v5 );
  }
  if ( v4 != v5 )
    return 0;
  *(_DWORD *)(a1 + 8 * v5 + 92) = a2;
  *(_BYTE *)(a1 + 8 * (unsigned __int8)(*(_BYTE *)(a1 + 476))++ + 96) = a3;
  return 1;
}

//----- (0051D370) --------------------------------------------------------
int __cdecl sub_51D370(int a1, int a2, char a3)
{
  int v3; // eax
  int v4; // esi
  _BYTE *i; // ecx
  int v7; // ecx
  _DWORD *v8; // eax

  if ( a1 == a2 )
    return 0;
  v3 = 0;
  v4 = *(unsigned __int8 *)(a1 + 476);
  if ( v4 <= 0 )
    return 0;
  for ( i = (_BYTE *)(a1 + 96); *((_DWORD *)i - 1) != a2 || *i != a3; i += 8 )
  {
    if ( ++v3 >= v4 )
      return 0;
  }
  v7 = v3;
  if ( v3 < v4 - 1 )
  {
    v8 = (_DWORD *)(a1 + 8 * v3 + 92);
    do
    {
      ++v7;
      *v8 = v8[2];
      v8[1] = v8[3];
      v8 += 2;
    }
    while ( v7 < *(unsigned __int8 *)(a1 + 476) - 1 );
  }
  --*(_BYTE *)(a1 + 476);
  return 1;
}

//----- (0051D3F0) --------------------------------------------------------
float2 *__cdecl sub_51D3F0(float2 *a1, float2 *a2)
{
  float2 *result; // eax
  float2 *v3; // esi

  result = a1;
  if ( a1 )
  {
    if ( a2 )
    {
      result = (float2 *)sub_51D1A0(a1);
      v3 = result;
      if ( result )
      {
        result = (float2 *)sub_51D1A0(a2);
        if ( result )
          result = (float2 *)sub_51D2C0((int)v3, (int)result);
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (0051D440) --------------------------------------------------------
float *__cdecl sub_51D440(float *a1, float *a2)
{
  float *result; // eax
  float *v3; // esi

  result = a1;
  if ( a1 )
  {
    if ( a2 )
    {
      result = sub_51D1A0((float2 *)a1);
      v3 = result;
      if ( result )
      {
        result = sub_51D1A0((float2 *)a2);
        if ( result )
          result = (float *)sub_51D2E0((int)v3, (int)result);
      }
    }
    else
    {
      result = 0;
    }
  }
  return result;
}

//----- (0051D490) --------------------------------------------------------
int __cdecl sub_51D490(char *a1)
{
  int v1; // edi
  const char *v2; // esi

  if ( !a1 )
    return -1;
  v1 = 0;
  v2 = (const char *)&byte_5D4594[2682188];
  while ( _strcmpi(v2, a1) )
  {
    v2 += 60;
    ++v1;
    if ( (int)v2 >= (int)&byte_5D4594[2692748] )
      return -1;
  }
  return v1;
}

//----- (0051D4D0) --------------------------------------------------------
int __cdecl sub_51D4D0(char *a1)
{
  int v1; // ebx
  int v2; // edi
  const char *v3; // esi

  v1 = 0;
  v2 = 0;
  v3 = (const char *)&byte_5D4594[2682188];
  do
  {
    if ( !_strcmpi(v3, a1) )
    {
      v1 = 1;
      *(_DWORD *)&byte_5D4594[3835340] = v2;
    }
    v3 += 60;
    ++v2;
  }
  while ( (int)v3 < (int)&byte_5D4594[2692748] );
  if ( !_strcmpi(a1, (const char *)&byte_587000[253088]) )
  {
    *(_DWORD *)&byte_5D4594[3835340] = 255;
    return 1;
  }
  if ( v1 )
    return 1;
  *(_DWORD *)&byte_5D4594[3835340] = 0;
  return 0;
}

//----- (0051D540) --------------------------------------------------------
int __cdecl sub_51D540(int a1)
{
  int result; // eax

  if ( a1 < 0 || a1 >= 176 )
  {
    *(_DWORD *)&byte_5D4594[3835340] = 0;
    result = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835340] = a1;
    result = 1;
  }
  return result;
}

//----- (0051D570) --------------------------------------------------------
int __cdecl sub_51D570(int a1)
{
  int result; // eax

  if ( a1 <= byte_5D4594[60 * *(_DWORD *)&byte_5D4594[3835340] + 2682240]
           * byte_5D4594[60 * *(_DWORD *)&byte_5D4594[3835340] + 2682241]
           - 1 )
  {
    *(_DWORD *)&byte_5D4594[3835348] = a1;
    result = 1;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835348] = 0;
    result = 0;
  }
  return result;
}

//----- (0051D5C0) --------------------------------------------------------
int __cdecl sub_51D5C0(int a1)
{
  if ( a1 != 1 && a1 )
    return 0;
  *(_DWORD *)&byte_5D4594[3835344] = a1;
  return 1;
}

//----- (0051D5E0) --------------------------------------------------------
float *__cdecl sub_51D5E0(float *a1)
{
  float *result; // eax
  float2 v2; // [esp+0h] [ebp-8h]

  result = a1;
  if ( a1 )
  {
    if ( *(_DWORD *)&byte_5D4594[3835340] == 255
      || (sub_4D3D90((float2 *)a1, &v2), (result = (float *)sub_51D8F0(&v2)) != 0)
      && (*(_DWORD *)&byte_5D4594[3835364] != 1 || (result = (float *)sub_527380(&v2.field_0)) != 0) )
    {
      result = (float *)1;
    }
  }
  return result;
}

//----- (0051D650) --------------------------------------------------------
float *__cdecl sub_51D650(float *a1)
{
  float *v1; // esi
  char v3[0x48]; // [esp+8h] [ebp-48h]

  qmemcpy(v3, sub_4D3C70(), 0x48u);
  sub_51D4D0((char *)&byte_587000[253096]);
  v1 = sub_51D5E0(a1);
  sub_4D3C50(v3);
  return v1;
}

//----- (0051D6A0) --------------------------------------------------------
int __cdecl sub_51D6A0(int a1)
{
  int result; // eax
  char v2[0x48]; // [esp+8h] [ebp-48h]

  if ( !a1 )
    return 0;
  if ( !*(_DWORD *)a1 )
    return 0;
  qmemcpy(v2, sub_4D3C70(), 0x48u);
  sub_51D4D0((char *)&byte_587000[253104]);
  result = sub_51D8F0((float2 *)(a1 + 4));
  if ( result )
  {
    if ( *(_DWORD *)&byte_5D4594[3835364] != 1 || (result = sub_527380((float *)(a1 + 4))) != 0 )
    {
      sub_4D3C50(v2);
      *(_DWORD *)(a1 + 4) = 0;
      *(_DWORD *)a1 = 0;
      *(_DWORD *)(a1 + 8) = 0;
      result = 1;
    }
  }
  return result;
}

//----- (0051D740) --------------------------------------------------------
int __cdecl sub_51D740(float *a1, int a2)
{
  double v2; // st7
  double v3; // st6
  int v4; // ebx
  int v5; // esi
  int v6; // ebp
  int v7; // edx
  int v8; // edx
  float v9; // ecx
  int result; // eax
  int v11; // eax
  float v12; // edx
  int v13; // eax
  float v14; // edx
  float2 v15; // [esp+10h] [ebp-8h]
  float v17; // [esp+1Ch] [ebp+4h]

  if ( !sub_4D3D90((float2 *)a1, &v15) )
    return 0;
  if ( !a2 )
    return 0;
  v2 = v15.field_0 + 11.5;
  v3 = v15.field_4 + 11.5;
  v4 = (__int64)(v2 * 0.021739131);
  v17 = v3;
  v5 = (__int64)(v3 * 0.021739131);
  v6 = (int)(__int64)v2 % 46;
  v7 = (__int64)v17 % 46;
  if ( v4 - 1 <= 0 || v4 >= 127 || v5 - 1 <= 0 || v5 >= 127 )
    return 0;
  if ( v6 <= v7 )
  {
    if ( 46 - v6 > v7 )
    {
      v8 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v4 - 4) + 44 * v5 + 24;
      goto LABEL_10;
    }
    v13 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v4) + 44 * v5 + 24;
    v14 = v15.field_4;
    *(float *)(a2 + 4) = v15.field_0;
    *(_DWORD *)a2 = v13;
    *(float *)(a2 + 8) = v14;
    result = 1;
  }
  else
  {
    if ( 46 - v6 > v7 )
    {
      v8 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v4) + 44 * v5 - 20;
LABEL_10:
      v9 = v15.field_4;
      *(float *)(a2 + 4) = v15.field_0;
      *(_DWORD *)a2 = v8;
      *(float *)(a2 + 8) = v9;
      return 1;
    }
    v11 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v4) + 44 * v5 + 4;
    v12 = v15.field_4;
    *(float *)(a2 + 4) = v15.field_0;
    *(_DWORD *)a2 = v11;
    *(float *)(a2 + 8) = v12;
    result = 1;
  }
  return result;
}

//----- (0051D8B0) --------------------------------------------------------
int __cdecl sub_51D8B0(int a1)
{
  if ( !a1 )
    return -1;
  if ( *(_DWORD *)a1 )
    return **(_DWORD **)a1;
  return -1;
}

//----- (0051D8D0) --------------------------------------------------------
int __cdecl sub_51D8D0(int a1)
{
  if ( !a1 )
    return -1;
  if ( *(_DWORD *)a1 )
    return *(_DWORD *)(*(_DWORD *)a1 + 4);
  return -1;
}

//----- (0051D8F0) --------------------------------------------------------
int __cdecl sub_51D8F0(float2 *a1)
{
  double v1; // st7
  double v2; // st6
  int v3; // esi
  int v4; // edi
  int v5; // ebp
  int v6; // edx
  int result; // eax
  int v8; // [esp+10h] [ebp-20h]
  int v9; // [esp+14h] [ebp-1Ch]
  int v10; // [esp+18h] [ebp-18h]
  int v11; // [esp+1Ch] [ebp-14h]
  int v12; // [esp+20h] [ebp-10h]
  char v13; // [esp+24h] [ebp-Ch]
  int v14; // [esp+28h] [ebp-8h]
  int v15; // [esp+2Ch] [ebp-4h]
  float v16; // [esp+34h] [ebp+4h]

  v9 = *(_DWORD *)&byte_5D4594[3835348];
  v1 = a1->field_0 + 11.5;
  v8 = *(_DWORD *)&byte_5D4594[3835340];
  v10 = 0;
  v13 = 0;
  v11 = -1;
  v12 = -1;
  v14 = 255;
  v15 = 0;
  v2 = a1->field_4 + 11.5;
  v3 = (__int64)(v1 * 0.021739131);
  v16 = v2;
  v4 = (__int64)(v2 * 0.021739131);
  v5 = (int)(__int64)v1 % 46;
  v6 = (__int64)v16 % 46;
  if ( *(_DWORD *)&byte_5D4594[3835340] == 255 )
    result = sub_51D9C0(v3, v4, v5, v6, 0);
  else
    result = sub_51D9C0(v3, v4, v5, v6, (int)&v8);
  return result;
}

//----- (0051D9C0) --------------------------------------------------------
int __cdecl sub_51D9C0(int a1, int a2, int a3, int a4, int a5)
{
  int result; // eax

  if ( a1 - 1 <= 0 || a1 >= 127 || a2 - 1 <= 0 || a2 >= 127 )
    return 0;
  if ( a3 <= a4 )
  {
    if ( 46 - a3 <= a4 )
      result = sub_51DA70(a1, a2, a5, 2, 0);
    else
      result = sub_51DA70(a1 - 1, a2, a5, 1, 0);
  }
  else if ( 46 - a3 <= a4 )
  {
    result = sub_51DA70(a1, a2, a5, 1, 0);
  }
  else
  {
    result = sub_51DA70(a1, a2 - 1, a5, 2, 0);
  }
  return result;
}

//----- (0051DA70) --------------------------------------------------------
int __cdecl sub_51DA70(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ebx
  int v6; // ebp
  int *v7; // esi
  int v8; // edi
  int v9; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // edx
  int v13; // ecx
  int v14; // edi
  int v15; // ebx
  int v16; // edi
  int v17; // edx
  int v18; // eax
  int v19; // edx
  int v20; // esi
  int v22; // ebp
  int v23; // edx
  int v24; // edx
  int v25; // esi
  int v26; // ebp
  int v27; // edx
  int v28; // [esp+10h] [ebp-8h]
  int v29; // [esp+14h] [ebp-4h]
  int v30; // [esp+24h] [ebp+Ch]

  v5 = a4;
  v6 = a2;
  v7 = (int *)a3;
  v8 = a1;
  if ( !a3 )
  {
    v9 = 255;
    v10 = 0;
    goto LABEL_19;
  }
  if ( !*(_DWORD *)(a3 + 8) )
  {
    v11 = a1;
    v12 = a2;
    v28 = a1;
    v13 = a4 != 1;
    goto LABEL_10;
  }
  if ( !*(_BYTE *)(a3 + 20) )
  {
    v9 = *(_DWORD *)a3;
    v10 = 0;
    *(_DWORD *)(a3 + 12) = a1;
    *(_DWORD *)(a3 + 16) = a2;
    *(_BYTE *)(a3 + 20) = a4;
    goto LABEL_19;
  }
  v11 = a1 - *(_DWORD *)(a3 + 12);
  v12 = a2 - *(_DWORD *)(a3 + 16);
  v28 = a1 - *(_DWORD *)(a3 + 12);
  a2 -= *(_DWORD *)(a3 + 16);
  if ( *(unsigned __int8 *)(a3 + 20) != a4 )
  {
    v13 = *(_BYTE *)(a3 + 20) != 1 ? -1 : 1;
LABEL_10:
    v30 = v13;
    goto LABEL_11;
  }
  v30 = 0;
LABEL_11:
  v9 = *v7;
  v14 = 60 * *v7;
  v15 = byte_5D4594[v14 + 2682240];
  v29 = (v12 + v11) % v15;
  v16 = byte_5D4594[v14 + 2682241];
  v17 = (v30 + a2 - v28) % v16;
  v18 = v29;
  if ( v29 < 0 )
    v18 = v15 + v29;
  if ( v17 < 0 )
    v17 += v16;
  if ( *(_DWORD *)&byte_5D4594[3835344] == 1 )
    v10 = *(_DWORD *)&byte_5D4594[3835348];
  else
    v10 = v18 + v17 * v15;
  v8 = a1;
  v5 = a4;
LABEL_19:
  if ( v5 == 2 )
  {
    if ( *(_DWORD *)&byte_5D4594[3835352] == 1 )
    {
      if ( v7 )
      {
        v19 = v7[6];
        v20 = v7[7];
      }
      else
      {
        v19 = 255;
        v20 = 0;
      }
      return sub_543C50(
               (_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + 44 * v6 + 24),
               v9,
               v10,
               v19,
               v20,
               a5);
    }
    v22 = 44 * v6;
    v23 = v22 + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8);
    if ( *(_DWORD *)(v23 + 24) != v9 || *(_DWORD *)(v23 + 28) != v10 )
    {
      *(_DWORD *)(v23 + 24) = v9;
      *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v22 + 28) = v10;
      if ( v9 == 255 )
        sub_422200(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v22 + 24);
      if ( v7 )
        *(_BYTE *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v22) |= 2u;
      else
        *(_BYTE *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v22) = *(_BYTE *)(v22
                                                                                            + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8)) & 0xFD;
      return 1;
    }
    return 0;
  }
  if ( v5 != 1 )
    return 0;
  if ( *(_DWORD *)&byte_5D4594[3835352] == 1 )
  {
    if ( v7 )
    {
      v24 = v7[6];
      v25 = v7[7];
    }
    else
    {
      v24 = 255;
      v25 = 0;
    }
    return sub_543C50(
             (_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + 44 * v6 + 4),
             v9,
             v10,
             v24,
             v25,
             a5);
  }
  v26 = 44 * v6;
  v27 = v26 + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8);
  if ( *(_DWORD *)(v27 + 4) == v9 && *(_DWORD *)(v27 + 8) == v10 )
    return 0;
  *(_DWORD *)(v27 + 4) = v9;
  *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v26 + 8) = v10;
  if ( v9 == 255 )
    sub_422200(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v26 + 4);
  if ( v7 )
    *(_BYTE *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v26) |= 1u;
  else
    *(_BYTE *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8) + v26) = *(_BYTE *)(v26
                                                                                        + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v8)) & 0xFE;
  return 1;
}

//----- (0051DD50) --------------------------------------------------------
void __cdecl sub_51DD50(int a1, int a2, int a3, int a4)
{
  int v4; // edx
  int v5; // edi
  unsigned __int8 *v6; // eax
  int v7; // eax

  if ( a1 > 0 && a1 < 127 && a2 > 0 && a2 < 127 )
  {
    if ( (v4 = a3, a3 & 2)
      && (v4 = a3, a4 == *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * a1) + 44 * a2 + 24))
      || v4 & 1 && a4 == *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * a1) + 44 * a2 + 4) )
    {
      if ( (!(v4 & 1) || a2 != 1) && (!(a3 & 2) || a1 != 1) )
      {
        v5 = 0;
        if ( *(int *)&byte_5D4594[2487248] <= 0 )
        {
LABEL_19:
          if ( *(_DWORD *)&byte_5D4594[2487248] >= 500 )
          {
            *(_DWORD *)&byte_5D4594[3821628] = 1;
          }
          else
          {
            v7 = 12 * (*(_DWORD *)&byte_5D4594[2487248])++;
            *(_DWORD *)&byte_5D4594[v7 + 3815628] = a1;
            *(_DWORD *)&byte_5D4594[v7 + 3815632] = a2;
            *(_DWORD *)&byte_5D4594[v7 + 3815636] = v4;
          }
        }
        else
        {
          v6 = &byte_5D4594[3815632];
          while ( *((_DWORD *)v6 - 1) != a1 || *(_DWORD *)v6 != a2 || *((_DWORD *)v6 + 1) != v4 )
          {
            ++v5;
            v6 += 12;
            if ( v5 >= *(int *)&byte_5D4594[2487248] )
              goto LABEL_19;
          }
        }
      }
    }
  }
}

//----- (0051DE30) --------------------------------------------------------
int __cdecl sub_51DE30(_DWORD *a1, _DWORD *a2, _DWORD *a3)
{
  int v3; // eax
  int result; // eax

  if ( *(int *)&byte_5D4594[2487248] <= 0 )
    return 0;
  v3 = *(_DWORD *)&byte_5D4594[2487248] - 1;
  *(_DWORD *)&byte_5D4594[2487248] = v3;
  *a1 = *(_DWORD *)&byte_5D4594[12 * v3 + 3815628];
  *a2 = *(_DWORD *)&byte_5D4594[12 * *(_DWORD *)&byte_5D4594[2487248] + 3815632];
  result = 1;
  *a3 = *(_DWORD *)&byte_5D4594[12 * *(_DWORD *)&byte_5D4594[2487248] + 3815636];
  return result;
}

//----- (0051DE90) --------------------------------------------------------
void sub_51DE90()
{
  srand(0x7D4u);
}

//----- (0051DEA0) --------------------------------------------------------
int __cdecl sub_51DEA0(int a1)
{
  int result; // eax

  if ( (int)*(unsigned __int8 *)(a1 + 5) < *(int *)&byte_5D4594[2487252] )
    *(_DWORD *)&byte_5D4594[2487252] = *(unsigned __int8 *)(a1 + 5);
  result = *(unsigned __int8 *)(a1 + 6);
  if ( result < *(int *)&byte_5D4594[2487256] )
    *(_DWORD *)&byte_5D4594[2487256] = *(unsigned __int8 *)(a1 + 6);
  return result;
}

//----- (0051DED0) --------------------------------------------------------
int sub_51DED0()
{
  int *v0; // edi
  CHAR *v1; // eax
  unsigned __int16 *v2; // eax
  float *v3; // esi
  int v4; // ebx
  int v5; // eax

  v0 = (int *)sub_45A060();
  if ( !v0 )
    return 1;
  do
  {
    if ( !sub_4E3AD0(v0[27]) && sub_4E3B80(v0[27]) )
    {
      v1 = (CHAR *)sub_44CEF0(v0[27]);
      v2 = (unsigned __int16 *)sub_4E3B60(v1);
      v3 = (float *)sub_4E3450(*v2);
      v4 = *((_DWORD *)v3 + 9);
      v3[14] = (double)v0[3] + 0.5;
      v3[15] = (double)v0[4] + 0.5;
      v5 = v0[32];
      *((_DWORD *)v3 + 10) = v5;
      *((_DWORD *)v3 + 11) = v5;
      *((_DWORD *)v3 + 9) = v5;
      *((_DWORD *)v3 + 4) = v0[30];
      *((_DWORD *)v3 + 5) = v0[70];
      sub_51DF90((int)v3);
      *((_DWORD *)v3 + 9) = v4;
      sub_4E38A0((int)v3);
    }
    v0 = (int *)sub_45A070((int)v0);
  }
  while ( v0 );
  return 1;
}

//----- (0051DF90) --------------------------------------------------------
int __cdecl sub_51DF90(int a1)
{
  int v1; // esi
  int v2; // eax
  int result; // eax
  void *v5; // ecx
  int i; // esi

  v1 = a1;
  if ( *(_BYTE *)(a1 + 16) & 0x20 )
    return 1;
  LOWORD(v2) = sub_42C2E0(*(unsigned __int16 *)(a1 + 4));
  a1 = v2;
  if ( !(_WORD)v2 )
    return 0;
  sub_426AC0(&a1, 2u);
  sub_426C90();
  result = (*(int (__cdecl **)(int, _DWORD))(v1 + 704))(v1, 0);
  if ( result )
  {
    sub_426D40();
    for ( i = *(_DWORD *)(v1 + 504); i; i = *(_DWORD *)(i + 496) )
      sub_51DF90(i);
    return 1;
  }
  return result;
}
// 51DFAA: variable 'v2' is possibly undefined
// 51DFC3: variable 'v4' is possibly undefined
// 51DFDA: variable 'v5' is possibly undefined

//----- (0051E010) --------------------------------------------------------
int __cdecl sub_51E010(char *a1, int a2)
{
  char *v2; // edi
  unsigned __int8 v3; // cl
  int result; // eax
  int v5; // esi
  int v6; // ecx
  int v7; // [esp+10h] [ebp-804h]
  char v8[1024]; // [esp+14h] [ebp-800h]
  char Mem[1024]; // [esp+414h] [ebp-400h]

  v7 = -86050098;
  strcpy(Mem, a1);
  v8[0] = byte_5D4594[2487260];
  strncat(v8, a1, strlen(a1) - 4);
  v2 = &v8[strlen(v8) + 1];
  v3 = byte_587000[253116];
  *(_DWORD *)--v2 = *(_DWORD *)&byte_587000[253112];
  v2[4] = v3;
  result = sub_426910(Mem, 0, 19);
  if ( result )
  {
    sub_426AC0(&v7, 4u);
    v5 = sub_4268E0();
    if ( sub_51E140() )
    {
      sub_4268F0(v5);
      sub_4269F0();
      if ( !a2 || (result = sub_57BDD0(Mem, (int)v8)) != 0 )
        result = 1;
    }
    else
    {
      sub_4269F0();
      result = 0;
    }
  }
  return result;
}
// 51E0D5: variable 'v6' is possibly undefined

//----- (0051E140) --------------------------------------------------------
int sub_51E140()
{
  int result; // eax
  char v2; // [esp+1h] [ebp-1h]

  *(_DWORD *)&byte_5D4594[2487252] = 256;
  *(_DWORD *)&byte_5D4594[2487256] = 256;
  sub_410640((void (__cdecl *)(int, int))sub_51DEA0, 0);
  sub_426AC0(&byte_5D4594[2487252], 4u);
  sub_426AC0(&byte_5D4594[2487256], 4u);
  sub_426A80((int *)&byte_5D4594[2487252]);
  sub_5004D0();
  if ( sub_426E20(0) )
  {
    sub_5004F0();
    v2 = 0;
    sub_426AC0(&v2, 1u);
    result = 1;
  }
  else
  {
    sub_4269F0();
    result = 0;
  }
  return result;
}

//----- (0051E1C0) --------------------------------------------------------
void sub_51E1C0()
{
  srand(0x7D5u);
}

//----- (0051E1D0) --------------------------------------------------------
int __cdecl sub_51E1D0(const char *a1)
{
  unsigned int i; // esi
  char v3[60]; // [esp+8h] [ebp-78h]
  char v4; // [esp+44h] [ebp-3Ch]

  strcpy(v3, a1);
  for ( i = 0; i < strlen(v3); ++i )
    v3[i] = toupper(v3[i]);
  nox_sprintf(&v4, (const char *)&byte_587000[253508], v3);
  return sub_4243F0(&v4);
}
// 51E1D0: using guessed type char var_78[60];

//----- (0051E260) --------------------------------------------------------
int __cdecl sub_51E260(int *a1, int a2)
{
  FILE *v2; // eax
  FILE *v3; // edi
  int v4; // eax
  int v5; // ebx
  char v7[256]; // [esp+18h] [ebp-100h]

  memset(a1, 0, 0x45Cu);
  nox_sprintf(v7, (const char *)&byte_587000[253520], a2);
  a1[3] = 3;
  a1[5] = 3;
  a1[1] = 5;
  a1[2] = 2;
  a1[4] = 1;
  a1[6] = 40;
  a1[7] = 20;
  a1[8] = 10;
  a1[9] = 5;
  a1[10] = 20;
  a1[16] = 1157234688;
  a1[18] = 100;
  a1[19] = time(0);
  a1[14] = 1;
  a1[22] = 0;
  a1[11] = 0;
  a1[12] = 100;
  a1[13] = 100;
  a1[30] = 0;
  a1[38] = 0;
  a1[46] = 0;
  *(_DWORD *)&byte_5D4594[2487520] = 0;
  v2 = sub_408CC0(v7, 0);
  v3 = v2;
  if ( !v2 || !sub_408D40((int)v2, 1) )
    return 0;
  while ( sub_51E540(v3, &byte_5D4594[2487264]) )
  {
    if ( !_strcmpi((const char *)&byte_587000[253536], (const char *)&byte_5D4594[2487264]) )
    {
      v4 = sub_51EBB0((int)a1, v3);
      goto LABEL_23;
    }
    if ( !_strcmpi((const char *)&byte_587000[253552], (const char *)&byte_5D4594[2487264]) )
    {
      v4 = sub_51F800((int)a1, v3);
      goto LABEL_23;
    }
    if ( !_strcmpi((const char *)&byte_587000[253560], (const char *)&byte_5D4594[2487264]) )
    {
      v4 = sub_520BF0((int)a1, v3);
      goto LABEL_23;
    }
    if ( _strcmpi((const char *)&byte_587000[253568], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[253584], (const char *)&byte_5D4594[2487264]) )
      {
        if ( _strcmpi((const char *)&byte_587000[253596], (const char *)&byte_5D4594[2487264]) )
        {
          if ( _strcmpi((const char *)&byte_587000[253608], (const char *)&byte_5D4594[2487264]) )
          {
            if ( _strcmpi((const char *)&byte_587000[253620], (const char *)&byte_5D4594[2487264]) )
              goto LABEL_25;
            v4 = sub_51F9F0(a1, v3);
          }
          else
          {
            v4 = sub_51F030((int)a1, v3);
          }
        }
        else
        {
          v4 = sub_51F640((int)a1, v3);
        }
      }
      else
      {
        v4 = sub_51EFB0((int)a1, v3);
      }
LABEL_23:
      v5 = v4;
      if ( !v4 )
        goto LABEL_27;
    }
    else
    {
      if ( !sub_51E540(v3, &byte_5D4594[2487264])
        || (a1[134] = atoi((const char *)&byte_5D4594[2487264]), !sub_51E540(v3, &byte_5D4594[2487264]))
        || (a1[135] = atoi((const char *)&byte_5D4594[2487264]), !sub_51E540(v3, &byte_5D4594[2487264])) )
      {
LABEL_25:
        v5 = 0;
        goto LABEL_27;
      }
      a1[136] = atoi((const char *)&byte_5D4594[2487264]);
    }
  }
  v5 = 1;
LABEL_27:
  sub_408D90(v3);
  if ( v5 != 1 || sub_520AD0(a1 + 22) && sub_520AD0(a1 + 30) && (!a1[46] || sub_520AD0(a1 + 46)) )
    return v5;
  return 0;
}

//----- (0051E540) --------------------------------------------------------
int __cdecl sub_51E540(FILE *a1, _BYTE *a2)
{
  int result; // eax

  result = sub_51E570(a1, a2);
  if ( result )
    result = sub_51E670(a1) != 0;
  return result;
}

//----- (0051E570) --------------------------------------------------------
int __cdecl sub_51E570(FILE *a1, _BYTE *a2)
{
  _BYTE *v2; // ebx
  int v3; // ecx
  int v4; // edi
  int v5; // ebp
  int v6; // eax
  WORD CharType[2]; // [esp+10h] [ebp-4h]

  v2 = a2;
  v3 = 0;
  *(_DWORD *)CharType = 0;
  v4 = 1;
  do
  {
    while ( 1 )
    {
      v5 = v3;
      sub_408E40((char *)CharType, 1, 1, a1);
      if ( sub_409370() == -1 )
        return 0;
      v3 = *(_DWORD *)CharType;
      if ( *(_DWORD *)CharType == 10 )
        ++*(_DWORD *)&byte_5D4594[2487520];
      if ( *(_DWORD *)&byte_587000[1668] <= 1 )
      {
        v6 = isspace(CharType[0]);
      }
      else
      {
        v6 = isspace(CharType[0]);
        v3 = *(_DWORD *)CharType;
      }
      if ( v6 )
        break;
      v4 = 0;
      if ( v3 != 47 || v5 != 47 )
      {
        *v2++ = v3;
      }
      else
      {
        sub_51E630(a1);
        v2 = a2;
        v3 = *(_DWORD *)CharType;
        v4 = 1;
      }
    }
  }
  while ( v4 );
  *v2 = 0;
  return 1;
}

//----- (0051E630) --------------------------------------------------------
int __cdecl sub_51E630(FILE *a1)
{
  FILE *v1; // esi
  int result; // eax

  v1 = a1;
  while ( 1 )
  {
    LOBYTE(a1) = 0;
    sub_408E40((char *)&a1, 1, 1, v1);
    result = sub_409370();
    if ( result == -1 )
      break;
    if ( (_BYTE)a1 == 10 )
    {
      ++*(_DWORD *)&byte_5D4594[2487520];
      return result;
    }
  }
  return result;
}

//----- (0051E670) --------------------------------------------------------
int __cdecl sub_51E670(FILE *a1)
{
  int result; // eax
  int v2; // [esp+4h] [ebp-4h]

  if ( _strcmpi((const char *)&byte_587000[253628], (const char *)&byte_5D4594[2487264]) )
  {
    if ( _strcmpi((const char *)&byte_587000[253632], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[253640], (const char *)&byte_5D4594[2487264]) )
        return 1;
    }
    else
    {
      result = sub_51E720(a1);
      if ( !result )
        return result;
    }
    return sub_51E540(a1, &byte_5D4594[2487264]) != 0;
  }
  result = sub_51E800((int)a1, &v2);
  if ( result )
  {
    if ( v2 )
      return sub_51E540(a1, &byte_5D4594[2487264]) != 0;
    result = sub_51E780(a1);
    if ( result )
      return sub_51E540(a1, &byte_5D4594[2487264]) != 0;
  }
  return result;
}

//----- (0051E720) --------------------------------------------------------
int __cdecl sub_51E720(FILE *a1)
{
  do
  {
    while ( 1 )
    {
      if ( !sub_51E570(a1, &byte_5D4594[2487264]) )
        return 0;
      if ( _strcmpi((const char *)&byte_587000[253648], (const char *)&byte_5D4594[2487264]) )
        break;
      if ( !sub_51E720(a1) )
        return 0;
    }
  }
  while ( _strcmpi((const char *)&byte_587000[253652], (const char *)&byte_5D4594[2487264]) );
  return 1;
}

//----- (0051E780) --------------------------------------------------------
int __cdecl sub_51E780(FILE *a1)
{
  do
  {
    while ( 1 )
    {
      if ( !sub_51E570(a1, &byte_5D4594[2487264]) )
        return 0;
      if ( _strcmpi((const char *)&byte_587000[253660], (const char *)&byte_5D4594[2487264]) )
        break;
      if ( !sub_51E720(a1) )
        return 0;
    }
  }
  while ( _strcmpi((const char *)&byte_587000[253664], (const char *)&byte_5D4594[2487264])
       && _strcmpi((const char *)&byte_587000[253672], (const char *)&byte_5D4594[2487264]) );
  return 1;
}

//----- (0051E800) --------------------------------------------------------
int __cdecl sub_51E800(int a1, _DWORD *a2)
{
  FILE *v2; // edi
  _DWORD *v3; // esi
  char *v4; // eax
  int result; // eax
  char *v6; // eax
  char *v7; // eax
  int v8; // eax
  int v9; // esi
  int v10; // eax
  int v11; // esi

  v2 = (FILE *)a1;
  if ( !sub_51E540((FILE *)a1, &byte_5D4594[2487264]) )
    return 0;
  if ( !_strcmpi((const char *)&byte_587000[253680], (const char *)&byte_5D4594[2487264]) )
  {
    v3 = a2;
    *a2 = 0;
    v4 = sub_416EA0();
    if ( v4 )
    {
      while ( v4[2251] != 1 )
      {
        v4 = sub_416EE0((int)v4);
        if ( !v4 )
          return 1;
      }
LABEL_17:
      *v3 = 1;
      return 1;
    }
    return 1;
  }
  if ( !_strcmpi((const char *)&byte_587000[253688], (const char *)&byte_5D4594[2487264]) )
  {
    v3 = a2;
    *a2 = 0;
    v6 = sub_416EA0();
    if ( v6 )
    {
      while ( v6[2251] != 2 )
      {
        v6 = sub_416EE0((int)v6);
        if ( !v6 )
          return 1;
      }
      goto LABEL_17;
    }
    return 1;
  }
  if ( !_strcmpi((const char *)&byte_587000[253700], (const char *)&byte_5D4594[2487264]) )
  {
    v3 = a2;
    *a2 = 0;
    v7 = sub_416EA0();
    if ( v7 )
    {
      while ( v7[2251] )
      {
        v7 = sub_416EE0((int)v7);
        if ( !v7 )
          return 1;
      }
      goto LABEL_17;
    }
    return 1;
  }
  if ( !_strcmpi((const char *)&byte_587000[253708], (const char *)&byte_5D4594[2487264]) )
  {
    if ( sub_51EAF0((int)v2, &a1) && sub_51E540(v2, &byte_5D4594[2487264]) )
    {
      v8 = atoi((const char *)&byte_5D4594[2487264]);
      switch ( a1 )
      {
        case 0:
          *a2 = v8 > 3;
          result = 1;
          break;
        case 1:
          *a2 = v8 < 3;
          result = 1;
          break;
        case 2:
          *a2 = v8 == 3;
          result = 1;
          break;
        case 3:
          *a2 = v8 != 3;
          result = 1;
          break;
        default:
          return 1;
      }
      return result;
    }
    return 0;
  }
  if ( _strcmpi((const char *)&byte_587000[253728], (const char *)&byte_5D4594[2487264]) )
  {
    if ( strchr((const char *)&byte_5D4594[2487264], 37) )
    {
      v11 = atoi((const char *)&byte_5D4594[2487264]);
      *a2 = sub_526AC0(1, 100) <= v11;
      return 1;
    }
    return 0;
  }
  v9 = sub_416F40();
  if ( !sub_51EAF0((int)v2, &a1) || !sub_51E540(v2, &byte_5D4594[2487264]) )
    return 0;
  v10 = atoi((const char *)&byte_5D4594[2487264]);
  switch ( a1 )
  {
    case 0:
      *a2 = v9 < v10;
      result = 1;
      break;
    case 1:
      *a2 = v9 > v10;
      result = 1;
      break;
    case 2:
      *a2 = v9 == v10;
      result = 1;
      break;
    case 3:
      *a2 = v9 != v10;
      result = 1;
      break;
    default:
      return 1;
  }
  return result;
}

//----- (0051EAF0) --------------------------------------------------------
int __cdecl sub_51EAF0(int a1, _DWORD *a2)
{
  int result; // eax

  if ( !sub_51E540((FILE *)a1, &byte_5D4594[2487264]) )
    return 0;
  if ( !_strcmpi((const char *)&byte_587000[253740], (const char *)&byte_5D4594[2487264]) )
  {
    *a2 = 0;
    return 1;
  }
  if ( !_strcmpi((const char *)&byte_587000[253744], (const char *)&byte_5D4594[2487264]) )
  {
    result = 1;
    *a2 = 1;
    return result;
  }
  if ( !_strcmpi((const char *)&byte_587000[253748], (const char *)&byte_5D4594[2487264]) )
  {
    *a2 = 2;
    return 1;
  }
  if ( _strcmpi((const char *)&byte_587000[253752], (const char *)&byte_5D4594[2487264]) )
    return 0;
  result = 1;
  *a2 = 3;
  return result;
}

//----- (0051EBB0) --------------------------------------------------------
int __cdecl sub_51EBB0(int a1, FILE *a2)
{
  int v2; // edi
  const char **v3; // eax
  unsigned __int8 *v4; // esi
  int v5; // ecx
  char v7; // [esp+10h] [ebp-3Ch]

  while ( sub_51E540(a2, &byte_5D4594[2487264]) )
  {
    if ( !_strcmpi((const char *)&byte_587000[253756], (const char *)&byte_5D4594[2487264]) )
      return 1;
    if ( !sub_51E540(a2, &v7) )
      break;
    if ( _strcmpi((const char *)&byte_587000[253760], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[253776], (const char *)&byte_5D4594[2487264]) )
      {
        if ( _strcmpi((const char *)&byte_587000[253796], (const char *)&byte_5D4594[2487264]) )
        {
          if ( _strcmpi((const char *)&byte_587000[253812], (const char *)&byte_5D4594[2487264]) )
          {
            if ( _strcmpi((const char *)&byte_587000[253832], (const char *)&byte_5D4594[2487264]) )
            {
              if ( _strcmpi((const char *)&byte_587000[253844], (const char *)&byte_5D4594[2487264]) )
              {
                if ( _strcmpi((const char *)&byte_587000[253860], (const char *)&byte_5D4594[2487264]) )
                {
                  if ( _strcmpi((const char *)&byte_587000[253876], (const char *)&byte_5D4594[2487264]) )
                  {
                    if ( _strcmpi((const char *)&byte_587000[253888], (const char *)&byte_5D4594[2487264]) )
                    {
                      if ( _strcmpi((const char *)&byte_587000[253904], (const char *)&byte_5D4594[2487264]) )
                      {
                        if ( _strcmpi((const char *)&byte_587000[253924], (const char *)&byte_5D4594[2487264]) )
                        {
                          if ( _strcmpi((const char *)&byte_587000[253932], (const char *)&byte_5D4594[2487264]) )
                          {
                            if ( _strcmpi((const char *)&byte_587000[253948], (const char *)&byte_5D4594[2487264]) )
                            {
                              if ( _strcmpi((const char *)&byte_587000[253956], (const char *)&byte_5D4594[2487264]) )
                              {
                                if ( _strcmpi((const char *)&byte_587000[253972], (const char *)&byte_5D4594[2487264]) )
                                {
                                  if ( _strcmpi((const char *)&byte_587000[253984], (const char *)&byte_5D4594[2487264]) )
                                  {
                                    if ( _strcmpi(
                                           (const char *)&byte_587000[254004],
                                           (const char *)&byte_5D4594[2487264]) )
                                    {
                                      if ( _strcmpi(
                                             (const char *)&byte_587000[254020],
                                             (const char *)&byte_5D4594[2487264]) )
                                      {
                                        if ( !_strcmpi(
                                                (const char *)&byte_587000[254040],
                                                (const char *)&byte_5D4594[2487264]) )
                                        {
                                          v2 = 0;
                                          if ( *(_DWORD *)&byte_587000[253244] )
                                          {
                                            v3 = (const char **)&byte_587000[253244];
                                            v4 = &byte_587000[253244];
                                            do
                                            {
                                              if ( !_strcmpi(*v3, &v7) )
                                                break;
                                              v5 = *((_DWORD *)v4 + 1);
                                              v4 += 4;
                                              ++v2;
                                              v3 = (const char **)v4;
                                            }
                                            while ( v5 );
                                          }
                                          *(_DWORD *)a1 = *(_DWORD *)&byte_587000[4 * v2 + 253244] != 0 ? v2 : 0;
                                        }
                                      }
                                      else
                                      {
                                        *(_DWORD *)(a1 + 52) = atoi(&v7);
                                      }
                                    }
                                    else if ( _strcmpi(&v7, (const char *)&byte_587000[254012]) )
                                    {
                                      *(_DWORD *)(a1 + 60) = 0;
                                    }
                                    else
                                    {
                                      *(_DWORD *)(a1 + 60) = 1;
                                    }
                                  }
                                  else if ( _strcmpi(&v7, (const char *)&byte_587000[253996]) )
                                  {
                                    *(_DWORD *)(a1 + 56) = 0;
                                  }
                                  else
                                  {
                                    *(_DWORD *)(a1 + 56) = 1;
                                  }
                                }
                                else
                                {
                                  *(_DWORD *)(a1 + 48) = atoi(&v7);
                                }
                              }
                              else
                              {
                                *(_DWORD *)(a1 + 44) = atoi(&v7);
                              }
                            }
                            else
                            {
                              *(_DWORD *)(a1 + 76) = atoi(&v7);
                            }
                          }
                          else
                          {
                            *(_DWORD *)(a1 + 72) = atoi(&v7);
                          }
                        }
                        else
                        {
                          *(float *)(a1 + 64) = atof(&v7);
                        }
                      }
                      else
                      {
                        *(_DWORD *)(a1 + 40) = atoi(&v7);
                      }
                    }
                    else
                    {
                      *(_DWORD *)(a1 + 36) = atoi(&v7);
                    }
                  }
                  else
                  {
                    *(_DWORD *)(a1 + 32) = atoi(&v7);
                  }
                }
                else
                {
                  *(_DWORD *)(a1 + 28) = atoi(&v7);
                }
              }
              else
              {
                *(_DWORD *)(a1 + 24) = atoi(&v7);
              }
            }
            else
            {
              *(_DWORD *)(a1 + 20) = atoi(&v7);
            }
          }
          else
          {
            *(_DWORD *)(a1 + 16) = atoi(&v7);
          }
        }
        else
        {
          *(_DWORD *)(a1 + 12) = atoi(&v7);
        }
      }
      else
      {
        *(_DWORD *)(a1 + 8) = atoi(&v7);
      }
    }
    else
    {
      *(_DWORD *)(a1 + 4) = atoi(&v7);
    }
  }
  return 0;
}

//----- (0051EFB0) --------------------------------------------------------
int __cdecl sub_51EFB0(int a1, FILE *a2)
{
  int v2; // eax

  while ( 1 )
  {
    if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
      return 0;
    if ( !_strcmpi((const char *)&byte_587000[254052], (const char *)&byte_5D4594[2487264])
      || *(_DWORD *)(a1 + 1096) >= 137 )
    {
      break;
    }
    v2 = sub_51E1D0((const char *)&byte_5D4594[2487264]);
    if ( v2 )
      *(_DWORD *)(a1 + 4 * (*(_DWORD *)(a1 + 1096))++ + 548) = v2;
  }
  return 1;
}

//----- (0051F030) --------------------------------------------------------
int __cdecl sub_51F030(int a1, FILE *a2)
{
  char *v2; // ebx
  int v3; // ecx
  int v4; // eax
  int i; // eax

  *(_DWORD *)&byte_5D4594[2487524] = 0;
  while ( 1 )
  {
    if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
      return 0;
    if ( !_strcmpi((const char *)&byte_587000[254056], (const char *)&byte_5D4594[2487264]) )
      break;
    if ( !_strcmpi((const char *)&byte_587000[254060], (const char *)&byte_5D4594[2487264]) )
    {
      v2 = (char *)nox_calloc(1u, 0x9Cu);
      if ( !v2 || !sub_51E540(a2, &byte_5D4594[2487264]) )
        return 0;
      strcpy(v2 + 60, (const char *)&byte_5D4594[2487264]);
      if ( _strcmpi((const char *)&byte_587000[254068], v2 + 60) )
      {
        if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
          return 0;
        strcpy(v2, (const char *)&byte_5D4594[2487264]);
      }
      if ( !sub_51F230((int)v2, a2) )
        return 0;
      if ( _strcmpi((const char *)&byte_587000[254080], v2 + 60) )
      {
        *((_DWORD *)v2 + 38) = 0;
        v3 = *(_DWORD *)(a1 + 1100);
        if ( v3 )
        {
          for ( i = *(_DWORD *)(v3 + 152); i; i = *(_DWORD *)(i + 152) )
            v3 = i;
          *(_DWORD *)(v3 + 152) = v2;
          ++*(_DWORD *)(a1 + 1104);
        }
        else
        {
          v4 = *(_DWORD *)(a1 + 1104);
          *(_DWORD *)(a1 + 1100) = v2;
          *(_DWORD *)(a1 + 1104) = v4 + 1;
        }
      }
      else
      {
        *(_DWORD *)&byte_5D4594[2487524] = v2;
      }
    }
  }
  if ( *(_DWORD *)&byte_5D4594[2487524] )
    sub_51F1F0(*(LPVOID *)&byte_5D4594[2487524]);
  *(_DWORD *)&byte_5D4594[2487524] = 0;
  return 1;
}

//----- (0051F1F0) --------------------------------------------------------
void __cdecl sub_51F1F0(LPVOID lpMem)
{
  char *v1; // esi
  int v2; // edi

  v1 = (char *)lpMem + 120;
  v2 = 4;
  do
  {
    if ( *((_DWORD *)v1 + 4) )
      free(*(LPVOID *)v1);
    v1 += 4;
    --v2;
  }
  while ( v2 );
  free(lpMem);
}

//----- (0051F230) --------------------------------------------------------
int __cdecl sub_51F230(int a1, FILE *a2)
{
  int v2; // ebx
  int v3; // edx
  _DWORD *v4; // ecx
  int v5; // edi
  signed int *v6; // edx
  int v7; // esi
  int v8; // edi
  signed int v9; // ebx
  int v10; // ebp
  _DWORD *v11; // esi
  int v12; // edx
  const char *v13; // edi
  _DWORD *v14; // ecx
  char *v15; // ebp
  signed int v16; // esi
  char *v17; // edi
  int v18; // esi
  int v19; // ebp
  const char *v20; // edx
  char *v21; // eax
  signed int v22; // esi
  char *v23; // edi
  bool v24; // zf
  char *v25; // edx
  char *v26; // ebp
  const char *v27; // edi
  unsigned int v28; // ecx
  char v29; // al
  const char *v30; // esi
  char *v31; // edi
  char *v32; // edi
  const char *v33; // esi
  int v34; // ecx
  _DWORD *v35; // eax
  void *v36; // eax
  int v37; // edx
  signed int v38; // ebp
  const char *v39; // edi
  char *v40; // esi
  _DWORD *v41; // ecx
  char *v42; // eax
  int v43; // edx
  char *v44; // edi
  _DWORD *v46; // [esp+10h] [ebp-12C38h]
  char *v47; // [esp+14h] [ebp-12C34h]
  char *v48; // [esp+18h] [ebp-12C30h]
  _DWORD *v49; // [esp+1Ch] [ebp-12C2Ch]
  char *v50; // [esp+20h] [ebp-12C28h]
  char *v51; // [esp+24h] [ebp-12C24h]
  int *v52; // [esp+28h] [ebp-12C20h]
  char *v53; // [esp+2Ch] [ebp-12C1Ch]
  int v54; // [esp+30h] [ebp-12C18h]
  int v55; // [esp+34h] [ebp-12C14h]
  int v56; // [esp+38h] [ebp-12C10h]
  int v57; // [esp+3Ch] [ebp-12C0Ch]
  int v58; // [esp+40h] [ebp-12C08h]
  int i; // [esp+44h] [ebp-12C04h]
  char v60[15360]; // [esp+48h] [ebp-12C00h]
  char v61[61440]; // [esp+3C48h] [ebp-F000h]

  v55 = 0;
  v56 = 0;
  v57 = 0;
  v58 = 0;
LABEL_2:
  if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
    return 0;
  if ( !_strcmpi((const char *)&byte_587000[254092], (const char *)&byte_5D4594[2487264]) )
  {
    v50 = v61;
    v4 = (_DWORD *)(a1 + 120);
    v5 = 16 - a1;
    v6 = &v55;
    v7 = 120 - (_DWORD)&v55;
    v47 = 0;
    v52 = &v55;
    v49 = (_DWORD *)(a1 + 120);
    v54 = 16 - a1;
    for ( i = 120 - (_DWORD)&v55; ; v7 = i )
    {
      if ( *(_DWORD *)&byte_5D4594[2487524] )
      {
        v8 = (int)v4 + v5;
        v9 = *(_DWORD *)(v8 + *(_DWORD *)&byte_5D4594[2487524]);
        if ( v9 > 0 )
        {
          v10 = *(_DWORD *)(v8 + *(_DWORD *)&byte_5D4594[2487524]);
          v11 = (signed int *)((char *)v6 + v7 + *(_DWORD *)&byte_5D4594[2487524]);
          v12 = 0;
          v46 = v11;
          do
          {
            v13 = (const char *)(v12 + *v46);
            v48 = &v60[v12];
            v12 += 60;
            strcpy(v48, v13);
            --v10;
          }
          while ( v10 );
        }
        v14 = (_DWORD *)*v52;
        if ( *v52 > 0 )
        {
          v15 = v50;
          v48 = v50;
          v46 = v14;
          v51 = &v60[60 * v9];
          do
          {
            if ( *v15 == 45 )
            {
              v16 = 0;
              if ( v9 <= 0 )
                goto LABEL_43;
              v17 = v60;
              while ( _strcmpi(v17, v15 + 1) )
              {
                ++v16;
                v17 += 60;
                if ( v16 >= v9 )
                  goto LABEL_43;
              }
              if ( v16 >= v9 )
                goto LABEL_43;
              v18 = v16 + 1;
              if ( v18 < v9 )
              {
                v19 = v9 - v18;
                v20 = &v60[60 * v18];
                do
                {
                  v53 = (char *)(v20 - 60);
                  v20 += 60;
                  strcpy(v53, v20);
                  --v19;
                }
                while ( v19 );
                v15 = v48;
              }
              --v9;
              v21 = v51 - 60;
            }
            else
            {
              v22 = 0;
              if ( v9 > 0 )
              {
                v23 = v60;
                do
                {
                  if ( !_strcmpi(v23, v15) )
                    break;
                  ++v22;
                  v23 += 60;
                }
                while ( v22 < v9 );
              }
              if ( v22 != v9 )
                goto LABEL_43;
              ++v9;
              v21 = strcpy(v51, v15) + 60;
            }
            v51 = v21;
LABEL_43:
            v15 += 60;
            v24 = v46 == (_DWORD *)1;
            v48 = v15;
            v46 = (_DWORD *)((char *)v46 - 1);
          }
          while ( !v24 );
        }
      }
      else
      {
        v9 = *v6;
        v24 = *v6 == 0;
        if ( *v6 <= 0 )
          goto LABEL_49;
        v25 = v50;
        v26 = v60;
        v46 = (_DWORD *)v9;
        do
        {
          v27 = v25;
          v25 += 60;
          v28 = strlen(v27) + 1;
          v29 = v28;
          v30 = v27;
          v31 = v26;
          v26 += 60;
          v28 >>= 2;
          qmemcpy(v31, v30, 4 * v28);
          v33 = &v30[4 * v28];
          v32 = &v31[4 * v28];
          v34 = v29 & 3;
          v35 = (_DWORD *)((char *)v46 - 1);
          v24 = v46 == (_DWORD *)1;
          qmemcpy(v32, v33, v34);
          v46 = v35;
        }
        while ( !v24 );
      }
      v24 = v9 == 0;
LABEL_49:
      if ( !v24 )
      {
        v36 = nox_calloc(v9, 0x3Cu);
        *v49 = v36;
        if ( !v36 )
          return 0;
        if ( v9 > 0 )
        {
          v37 = 0;
          v38 = v9;
          do
          {
            v39 = &v60[v37];
            v40 = (char *)(v37 + *v49);
            v37 += 60;
            v53 = strcpy(v40, v39);
            --v38;
          }
          while ( v38 );
        }
      }
      v41 = v49;
      v42 = v47;
      v43 = (int)v52;
      v44 = v50;
      v49[4] = v9;
      v6 = (signed int *)(v43 + 4);
      v4 = v41 + 1;
      v47 = v42 + 1;
      v52 = v6;
      v49 = v4;
      v50 = v44 + 15360;
      if ( (int)(v42 + 1) >= 4 )
        return 1;
      v5 = v54;
    }
  }
  if ( _strcmpi((const char *)&byte_587000[254096], (const char *)&byte_5D4594[2487264])
    && _strcmpi((const char *)&byte_587000[254112], (const char *)&byte_5D4594[2487264]) )
  {
    if ( !_strcmpi((const char *)&byte_587000[254120], (const char *)&byte_5D4594[2487264]) )
    {
      v2 = 1;
      goto LABEL_13;
    }
    if ( !_strcmpi((const char *)&byte_587000[254132], (const char *)&byte_5D4594[2487264]) )
    {
      v2 = 2;
      goto LABEL_13;
    }
    if ( !_strcmpi((const char *)&byte_587000[254152], (const char *)&byte_5D4594[2487264]) )
    {
      v2 = 3;
      goto LABEL_13;
    }
  }
  else
  {
    v2 = 0;
LABEL_13:
    while ( sub_51E540(a2, &byte_5D4594[2487264]) )
    {
      if ( !_strcmpi((const char *)&byte_587000[254176], (const char *)&byte_5D4594[2487264]) )
        goto LABEL_2;
      v3 = *(&v55 + v2);
      v47 = &v61[60 * (v3 + (v2 << 8))];
      strcpy(v47, (const char *)&byte_5D4594[2487264]);
      *(&v55 + v2) = v3 + 1;
    }
  }
  return 0;
}
// 51F230: using guessed type char var_F000[61440];
// 51F230: using guessed type char var_12C00[15360];

//----- (0051F640) --------------------------------------------------------
int __cdecl sub_51F640(int a1, FILE *a2)
{
  char *v2; // ebx
  int v3; // ecx
  int v4; // eax
  int i; // eax

  *(_DWORD *)&byte_5D4594[2487524] = 0;
  while ( 1 )
  {
    if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
      return 0;
    if ( !_strcmpi((const char *)&byte_587000[254180], (const char *)&byte_5D4594[2487264]) )
      break;
    if ( !_strcmpi((const char *)&byte_587000[254184], (const char *)&byte_5D4594[2487264]) )
    {
      v2 = (char *)nox_calloc(1u, 0x9Cu);
      if ( !v2 || !sub_51E540(a2, &byte_5D4594[2487264]) )
        return 0;
      strcpy(v2 + 60, (const char *)&byte_5D4594[2487264]);
      if ( _strcmpi((const char *)&byte_587000[254192], v2 + 60) )
      {
        if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
          return 0;
        strcpy(v2, (const char *)&byte_5D4594[2487264]);
      }
      if ( !sub_51F230((int)v2, a2) )
        return 0;
      if ( _strcmpi((const char *)&byte_587000[254204], v2 + 60) )
      {
        *((_DWORD *)v2 + 38) = 0;
        v3 = *(_DWORD *)(a1 + 1108);
        if ( v3 )
        {
          for ( i = *(_DWORD *)(v3 + 152); i; i = *(_DWORD *)(i + 152) )
            v3 = i;
          *(_DWORD *)(v3 + 152) = v2;
          ++*(_DWORD *)(a1 + 1112);
        }
        else
        {
          v4 = *(_DWORD *)(a1 + 1112);
          *(_DWORD *)(a1 + 1108) = v2;
          *(_DWORD *)(a1 + 1112) = v4 + 1;
        }
      }
      else
      {
        *(_DWORD *)&byte_5D4594[2487524] = v2;
      }
    }
  }
  if ( *(_DWORD *)&byte_5D4594[2487524] )
    sub_51F1F0(*(LPVOID *)&byte_5D4594[2487524]);
  *(_DWORD *)&byte_5D4594[2487524] = 0;
  return 1;
}

//----- (0051F800) --------------------------------------------------------
int __cdecl sub_51F800(int a1, FILE *a2)
{
  while ( 1 )
  {
    if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
      return 0;
    if ( !_strcmpi((const char *)&byte_587000[254216], (const char *)&byte_5D4594[2487264]) )
      break;
    if ( _strcmpi((const char *)&byte_587000[254220], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[254260], (const char *)&byte_5D4594[2487264])
        || !sub_51E540(a2, &byte_5D4594[2487264]) )
      {
        return 0;
      }
      strcpy((char *)(a1 + 476), (const char *)&byte_5D4594[2487264]);
    }
    else
    {
      if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
        return 0;
      strcpy((char *)(a1 + 216 + (*(_DWORD *)(a1 + 472) << 6)), (const char *)&byte_5D4594[2487264]);
      if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
        return 0;
      if ( _strcmpi((const char *)&byte_587000[254228], (const char *)&byte_5D4594[2487264]) )
      {
        if ( _strcmpi((const char *)&byte_587000[254236], (const char *)&byte_5D4594[2487264]) )
        {
          if ( _strcmpi((const char *)&byte_587000[254244], (const char *)&byte_5D4594[2487264]) )
          {
            if ( !_strcmpi((const char *)&byte_587000[254252], (const char *)&byte_5D4594[2487264]) )
              *(_DWORD *)((*(_DWORD *)(a1 + 472) << 6) + a1 + 216 + 60) = 3;
            ++*(_DWORD *)(a1 + 472);
          }
          else
          {
            *(_DWORD *)(((*(_DWORD *)(a1 + 472))++ << 6) + a1 + 216 + 60) = 2;
          }
        }
        else
        {
          *(_DWORD *)(((*(_DWORD *)(a1 + 472))++ << 6) + a1 + 216 + 60) = 1;
        }
      }
      else
      {
        *(_DWORD *)(((*(_DWORD *)(a1 + 472))++ << 6) + a1 + 216 + 60) = 0;
      }
    }
  }
  return 1;
}

//----- (0051F9F0) --------------------------------------------------------
int __cdecl sub_51F9F0(_DWORD *a1, FILE *a2)
{
  _BYTE *v2; // eax
  int v3; // edi
  FILE *v4; // esi
  int v5; // ebx
  int v6; // ebp
  const char **v7; // eax
  unsigned __int8 *v8; // esi
  int v9; // ecx
  int v10; // ecx
  int result; // eax
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  char *v15; // [esp+10h] [ebp-4h]

  v15 = 0;
  v2 = nox_calloc(1u, 0xE0u);
  v3 = (int)v2;
  if ( v2 )
  {
    v4 = a2;
    v2[64] = 0;
    *((_DWORD *)v2 + 18) = 1000;
    *((_DWORD *)v2 + 19) = 0;
    *((_DWORD *)v2 + 20) = 999999;
    if ( sub_51E540(a2, &byte_5D4594[2487264]) )
    {
      if ( sub_51E540(a2, (_BYTE *)v3) )
      {
        if ( !_strcmpi((const char *)&byte_587000[254272], (const char *)&byte_5D4594[2487264]) )
        {
          *(_DWORD *)(v3 + 60) = 0;
          goto LABEL_12;
        }
        if ( !_strcmpi((const char *)&byte_587000[254280], (const char *)&byte_5D4594[2487264]) )
        {
          *(_DWORD *)(v3 + 60) = 1;
          goto LABEL_12;
        }
        if ( !_strcmpi((const char *)&byte_587000[254288], (const char *)&byte_5D4594[2487264]) )
        {
          *(_DWORD *)(v3 + 60) = 2;
          goto LABEL_12;
        }
        if ( !_strcmpi((const char *)&byte_587000[254300], (const char *)&byte_5D4594[2487264]) )
        {
          *(_DWORD *)(v3 + 60) = 3;
LABEL_12:
          while ( sub_51E540(v4, &byte_5D4594[2487264]) )
          {
            if ( !_strcmpi((const char *)&byte_587000[254312], (const char *)&byte_5D4594[2487264]) )
            {
              switch ( *(_DWORD *)(v3 + 60) )
              {
                case 0:
                  *(_DWORD *)(v3 + 220) = a1[22];
                  v10 = a1[23];
                  a1[22] = v3;
                  a1[23] = v10 + 1;
                  result = 1;
                  break;
                case 1:
                  *(_DWORD *)(v3 + 220) = a1[30];
                  v12 = a1[31];
                  a1[30] = v3;
                  a1[31] = v12 + 1;
                  result = 1;
                  break;
                case 2:
                  *(_DWORD *)(v3 + 220) = a1[38];
                  v13 = a1[39];
                  a1[38] = v3;
                  a1[39] = v13 + 1;
                  result = 1;
                  break;
                case 3:
                  *(_DWORD *)(v3 + 220) = a1[46];
                  v14 = a1[47] + 1;
                  a1[46] = v3;
                  a1[47] = v14;
                  goto LABEL_57;
                default:
LABEL_57:
                  result = 1;
                  break;
              }
              return result;
            }
            if ( _strcmpi((const char *)&byte_587000[254316], (const char *)&byte_5D4594[2487264]) )
            {
              if ( _strcmpi((const char *)&byte_587000[254328], (const char *)&byte_5D4594[2487264]) )
              {
                if ( _strcmpi((const char *)&byte_587000[254348], (const char *)&byte_5D4594[2487264]) )
                {
                  if ( _strcmpi((const char *)&byte_587000[254360], (const char *)&byte_5D4594[2487264]) )
                  {
                    if ( _strcmpi((const char *)&byte_587000[254372], (const char *)&byte_5D4594[2487264]) )
                    {
                      if ( _strcmpi((const char *)&byte_587000[254384], (const char *)&byte_5D4594[2487264]) )
                      {
                        if ( _strcmpi((const char *)&byte_587000[254392], (const char *)&byte_5D4594[2487264]) )
                        {
                          if ( _strcmpi((const char *)&byte_587000[254404], (const char *)&byte_5D4594[2487264]) )
                          {
                            if ( _strcmpi((const char *)&byte_587000[254428], (const char *)&byte_5D4594[2487264]) )
                            {
                              if ( _strcmpi((const char *)&byte_587000[254436], (const char *)&byte_5D4594[2487264]) )
                              {
                                v5 = 0;
                                v6 = 0;
                                if ( !*(_DWORD *)&byte_587000[253200] )
                                  return 0;
                                v7 = (const char **)&byte_587000[253200];
                                v8 = &byte_587000[253200];
                                do
                                {
                                  if ( !_strcmpi(*v7, (const char *)&byte_5D4594[2487264]) )
                                  {
                                    if ( !v15 || !sub_51FEC0((int)v15, v6, a2) )
                                      return 0;
                                    v5 = 1;
                                  }
                                  v9 = *((_DWORD *)v8 + 1);
                                  v8 += 4;
                                  ++v6;
                                  v7 = (const char **)v8;
                                }
                                while ( v9 );
                                if ( !v5 )
                                  return 0;
                                v4 = a2;
                              }
                              else if ( !sub_51FFA0(v3, v4) )
                              {
                                return 0;
                              }
                            }
                            else if ( !sub_520660(a1, (const char *)v3, v4) )
                            {
                              return 0;
                            }
                          }
                          else if ( !sub_5209F0(v3, v4) )
                          {
                            return 0;
                          }
                        }
                        else if ( !sub_520AB0(v3, v4) )
                        {
                          return 0;
                        }
                      }
                      else if ( !sub_520A90(v3, v4) )
                      {
                        return 0;
                      }
                    }
                    else if ( !sub_520910(v3, v4) )
                    {
                      return 0;
                    }
                  }
                  else
                  {
                    *(_BYTE *)(v3 + 67) = 1;
                  }
                }
                else if ( !sub_5208D0(v3, v4) )
                {
                  return 0;
                }
              }
              else if ( !sub_520810(v3, v4) )
              {
                return 0;
              }
            }
            else
            {
              v15 = sub_51FE00(v3, v4);
              if ( !v15 )
                return 0;
            }
          }
        }
      }
    }
  }
  return 0;
}

//----- (0051FE00) --------------------------------------------------------
char *__cdecl sub_51FE00(int a1, FILE *a2)
{
  char *result; // eax
  char *v3; // ebx
  int v4; // ecx

  result = (char *)nox_calloc(1u, 0x80u);
  v3 = result;
  if ( result )
  {
    result = (char *)sub_51E540(a2, &byte_5D4594[2487264]);
    if ( result )
    {
      strcpy(v3, (const char *)&byte_5D4594[2487264]);
      result = (char *)sub_51E540(a2, &byte_5D4594[2487264]);
      if ( result )
      {
        strcpy(v3 + 60, (const char *)&byte_5D4594[2487264]);
        *((_DWORD *)v3 + 31) = *(_DWORD *)(a1 + 84);
        v4 = *(_DWORD *)(a1 + 88) + 1;
        *(_DWORD *)(a1 + 84) = v3;
        *(_DWORD *)(a1 + 88) = v4;
        result = v3;
      }
    }
  }
  return result;
}

//----- (0051FEC0) --------------------------------------------------------
int __cdecl sub_51FEC0(int a1, int a2, FILE *a3)
{
  int result; // eax
  int v4; // ebx
  int v5; // ecx
  int i; // eax

  result = (int)nox_calloc(1u, 0x80u);
  v4 = result;
  if ( result )
  {
    *(_DWORD *)result = a2;
    result = sub_51E540(a3, &byte_5D4594[2487264]);
    if ( result )
    {
      strcpy((char *)(v4 + 4), (const char *)&byte_5D4594[2487264]);
      result = sub_51E540(a3, &byte_5D4594[2487264]);
      if ( result )
      {
        strcpy((char *)(v4 + 64), (const char *)&byte_5D4594[2487264]);
        v5 = *(_DWORD *)(a1 + 120);
        if ( v5 )
        {
          for ( i = *(_DWORD *)(v5 + 124); i; i = *(_DWORD *)(i + 124) )
            v5 = i;
          *(_DWORD *)(v5 + 124) = v4;
          result = 1;
        }
        else
        {
          *(_DWORD *)(a1 + 120) = v4;
          result = 1;
        }
      }
    }
  }
  return result;
}

//----- (0051FFA0) --------------------------------------------------------
int __cdecl sub_51FFA0(int a1, FILE *a2)
{
  int v2; // ebp
  int result; // eax
  int *v4; // esi
  _DWORD *v5; // eax
  _DWORD *v6; // eax
  _DWORD *v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // ecx
  int i; // eax
  int v12; // [esp+10h] [ebp-4h]

  v2 = 0;
  result = (int)nox_calloc(1u, 0x18u);
  v4 = (int *)result;
  v12 = result;
  if ( result )
  {
    result = sub_51E540(a2, &byte_5D4594[2487264]);
    if ( result )
    {
      *v4 = atoi((const char *)&byte_5D4594[2487264]);
      result = sub_51E540(a2, &byte_5D4594[2487264]);
      if ( result )
      {
        v4[1] = atoi((const char *)&byte_5D4594[2487264]);
        while ( 1 )
        {
          while ( 1 )
          {
LABEL_5:
            if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
              goto LABEL_41;
            if ( !_strcmpi((const char *)&byte_587000[254448], (const char *)&byte_5D4594[2487264]) )
            {
              v10 = *(_DWORD *)(a1 + 92);
              if ( v10 )
              {
                for ( i = *(_DWORD *)(v10 + 20); i; i = *(_DWORD *)(i + 20) )
                  v10 = i;
                *(_DWORD *)(v10 + 20) = v4;
              }
              else
              {
                *(_DWORD *)(a1 + 92) = v4;
              }
              v4[5] = 0;
              ++*(_DWORD *)(a1 + 96);
              return 1;
            }
            if ( _strcmpi((const char *)&byte_587000[254452], (const char *)&byte_5D4594[2487264]) )
              break;
            if ( !v2 )
              goto LABEL_41;
            if ( *(_DWORD *)v2 != 1 )
              goto LABEL_41;
            v5 = sub_5205B0(a2);
            if ( !v5 )
              goto LABEL_41;
            v5[2] = *(_DWORD *)(v2 + 84);
            *(_DWORD *)(v2 + 84) = v5;
          }
          if ( _strcmpi((const char *)&byte_587000[254460], (const char *)&byte_5D4594[2487264]) )
            break;
          if ( v2 )
          {
            if ( !*(_DWORD *)v2 )
            {
              v6 = sub_520380(a2);
              *(_DWORD *)(v2 + 80) = v6;
              if ( v6 )
                continue;
            }
          }
          goto LABEL_41;
        }
        v7 = nox_calloc(1u, 0x64u);
        v2 = (int)v7;
        if ( v7 )
        {
          *v7 = 0;
          if ( *(_DWORD *)&byte_587000[253216] )
          {
            do
            {
              if ( !_strcmpi(
                      *(const char **)&byte_587000[4 * *(_DWORD *)v2 + 253216],
                      (const char *)&byte_5D4594[2487264]) )
                break;
              v8 = *(_DWORD *)v2 + 1;
              *(_DWORD *)v2 = v8;
            }
            while ( *(_DWORD *)&byte_587000[4 * v8 + 253216] );
          }
          if ( *(_DWORD *)&byte_587000[4 * *(_DWORD *)v2 + 253216] )
          {
            switch ( *(_DWORD *)v2 )
            {
              case 0:
              case 1:
                if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
                  break;
                strcpy((char *)(v2 + 4), (const char *)&byte_5D4594[2487264]);
                if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
                  break;
                if ( _strcmpi((const char *)&byte_587000[254472], (const char *)&byte_5D4594[2487264]) )
                {
                  *(_DWORD *)(v2 + 64) = 0;
                  *(_DWORD *)(v2 + 68) = atoi((const char *)&byte_5D4594[2487264]);
                  if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
                    break;
                  goto LABEL_35;
                }
                *(_DWORD *)(v2 + 64) = 1;
                if ( sub_51E540(a2, &byte_5D4594[2487264]) )
                {
                  *(float *)(v2 + 76) = atof((const char *)&byte_5D4594[2487264]);
                  if ( sub_51E540(a2, &byte_5D4594[2487264]) )
                  {
                    *(_DWORD *)(v2 + 68) = !strcmp(
                                              (const char *)&byte_587000[254480],
                                              (const char *)&byte_5D4594[2487264]) ? 0 : atoi((const char *)&byte_5D4594[2487264]);
                    if ( sub_51E540(a2, &byte_5D4594[2487264]) )
                    {
                      if ( !strcmp((const char *)&byte_587000[254484], (const char *)&byte_5D4594[2487264]) )
                      {
                        *(_DWORD *)(v2 + 72) = 999999;
                        goto LABEL_38;
                      }
LABEL_35:
                      *(_DWORD *)(v2 + 72) = atoi((const char *)&byte_5D4594[2487264]);
                      goto LABEL_38;
                    }
                  }
                }
                break;
              case 3:
              case 4:
              case 5:
                if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
                  break;
                strcpy((char *)(v2 + 4), (const char *)&byte_5D4594[2487264]);
LABEL_38:
                v4 = (int *)v12;
                goto LABEL_39;
              default:
LABEL_39:
                *(_DWORD *)(v2 + 88) = v4[2];
                v9 = v4[3] + 1;
                v4[2] = v2;
                v4[3] = v9;
                goto LABEL_5;
            }
          }
          free((LPVOID)v2);
        }
LABEL_41:
        result = 0;
      }
    }
  }
  return result;
}

//----- (00520380) --------------------------------------------------------
_DWORD *__cdecl sub_520380(FILE *a1)
{
  _DWORD *v1; // ebx
  _DWORD *v2; // ebp
  int v3; // eax
  int v4; // edi
  const char **v5; // eax
  unsigned __int8 *v6; // esi
  int v7; // ecx
  int v8; // eax
  _DWORD *v9; // eax
  _DWORD *i; // ecx
  _DWORD *v11; // ecx
  _DWORD *v13; // eax
  _DWORD *v14; // esi
  int v15; // [esp+10h] [ebp-Ch]
  int v16; // [esp+14h] [ebp-8h]
  int v17; // [esp+18h] [ebp-4h]

  v1 = 0;
  v17 = 0;
  v15 = 0;
  v16 = 100;
LABEL_2:
  v2 = nox_calloc(1u, 0x80Cu);
  if ( v2 && sub_51E540(a1, &byte_5D4594[2487264]) )
  {
    if ( !strcmp((const char *)&byte_587000[254488], (const char *)&byte_5D4594[2487264]) )
    {
      *v2 = -1;
      ++v15;
    }
    else
    {
      v3 = atoi((const char *)&byte_5D4594[2487264]);
      *v2 = v3;
      v16 -= v3;
    }
    while ( sub_51E540(a1, &byte_5D4594[2487264]) )
    {
      if ( !_strcmpi((const char *)&byte_587000[254492], (const char *)&byte_5D4594[2487264]) )
      {
        v17 = 1;
LABEL_19:
        if ( v1 )
        {
          v9 = (_DWORD *)v1[514];
          for ( i = v1; v9; v9 = (_DWORD *)v9[514] )
            i = v9;
          i[514] = v2;
        }
        else
        {
          v1 = v2;
        }
        if ( v17 )
        {
          if ( v15 )
          {
            v11 = v1;
            do
            {
              if ( (int)*v11 < 0 )
                *v11 = v16 / v15 + 1;
              v11 = (_DWORD *)v11[514];
            }
            while ( v11 );
          }
          return v1;
        }
        goto LABEL_2;
      }
      if ( !_strcmpi((const char *)&byte_587000[254496], (const char *)&byte_5D4594[2487264]) )
        goto LABEL_19;
      v4 = 0;
      if ( *(_DWORD *)&byte_587000[253216] )
      {
        v5 = (const char **)&byte_587000[253216];
        v6 = &byte_587000[253216];
        do
        {
          if ( !_strcmpi(*v5, (const char *)&byte_5D4594[2487264]) )
            break;
          v7 = *((_DWORD *)v6 + 1);
          v6 += 4;
          ++v4;
          v5 = (const char **)v6;
        }
        while ( v7 );
      }
      if ( !*(_DWORD *)&byte_587000[4 * v4 + 253216] )
      {
        free(v2);
        break;
      }
      v2[16 * v2[513] + 1] = v4;
      if ( !sub_51E540(a1, &v2[16 * v2[513] + 2]) )
        break;
      v8 = v2[513] + 1;
      v2[513] = v8;
      if ( v8 >= 32 )
        v2[513] = 31;
    }
  }
  v13 = v1;
  if ( v1 )
  {
    do
    {
      v14 = (_DWORD *)v13[514];
      free(v13);
      v13 = v14;
    }
    while ( v14 );
  }
  return 0;
}

//----- (005205B0) --------------------------------------------------------
_DWORD *__cdecl sub_5205B0(FILE *a1)
{
  _DWORD *result; // eax
  _DWORD *v2; // esi
  _DWORD *v3; // eax

  result = (_DWORD *)sub_51E540(a1, &byte_5D4594[2487264]);
  if ( result )
  {
    result = nox_calloc(1u, 0xCu);
    v2 = result;
    if ( result )
    {
      *result = sub_4E3AA0((CHAR *)&byte_5D4594[2487264]);
      if ( sub_51E540(a1, &byte_5D4594[2487264]) )
      {
        if ( _strcmpi((const char *)&byte_587000[254500], (const char *)&byte_5D4594[2487264]) )
        {
          free(v2);
          result = 0;
        }
        else
        {
          v3 = sub_520380(a1);
          v2[1] = v3;
          if ( v3 )
          {
            result = v2;
          }
          else
          {
            free(v2);
            result = 0;
          }
        }
      }
      else
      {
        free(v2);
        result = 0;
      }
    }
  }
  return result;
}

//----- (00520660) --------------------------------------------------------
int __cdecl sub_520660(_DWORD *a1, const char *a2, FILE *a3)
{
  int result; // eax
  int v4; // eax
  int v5; // eax
  const char *v6; // eax
  const char *v7; // ebx
  _DWORD *i; // ebp
  _DWORD *v9; // eax
  int v10; // edx
  _DWORD *v11; // ebp
  _DWORD *j; // eax
  _DWORD *k; // ebx
  _DWORD *v14; // eax
  int v15; // edx

  result = sub_51E540(a3, &byte_5D4594[2487264]);
  if ( result )
  {
    v4 = *((_DWORD *)a2 + 15);
    if ( v4 )
    {
      v5 = v4 - 1;
      if ( v5 )
      {
        if ( v5 == 1 )
          v6 = (const char *)a1[38];
        else
          v6 = a2;
      }
      else
      {
        v6 = (const char *)a1[30];
      }
    }
    else
    {
      v6 = (const char *)a1[22];
    }
    v7 = v6;
    if ( !v6 )
      goto LABEL_14;
    while ( strcmp(v7, (const char *)&byte_5D4594[2487264]) )
    {
      v7 = (const char *)*((_DWORD *)v7 + 55);
      if ( !v7 )
        goto LABEL_14;
    }
    if ( !v7 )
    {
LABEL_14:
      v7 = (const char *)a1[38];
      if ( !v7 )
        return 0;
      while ( strcmp(v7, (const char *)&byte_5D4594[2487264]) )
      {
        v7 = (const char *)*((_DWORD *)v7 + 55);
        if ( !v7 )
          return 0;
      }
    }
    for ( i = (_DWORD *)*((_DWORD *)v7 + 21); i; i = (_DWORD *)i[31] )
    {
      v9 = nox_calloc(1u, 0x80u);
      if ( !v9 )
        return 0;
      qmemcpy(v9, i, 0x80u);
      v9[31] = *((_DWORD *)a2 + 21);
      v10 = *((_DWORD *)a2 + 22) + 1;
      *((_DWORD *)a2 + 21) = v9;
      *((_DWORD *)a2 + 22) = v10;
    }
    v11 = (_DWORD *)*((_DWORD *)a2 + 23);
    if ( v11 )
    {
      for ( j = (_DWORD *)v11[5]; j; j = (_DWORD *)j[5] )
        v11 = j;
    }
    for ( k = (_DWORD *)*((_DWORD *)v7 + 23); k; v11 = v14 )
    {
      v14 = nox_calloc(1u, 0x18u);
      if ( !v14 )
        return 0;
      v15 = 1;
      qmemcpy(v14, k, 0x18u);
      v14[4] = 1;
      v14[5] = 0;
      if ( v11 )
      {
        v11[5] = v14;
        v15 = *((_DWORD *)a2 + 24) + 1;
      }
      else
      {
        *((_DWORD *)a2 + 23) = v14;
      }
      *((_DWORD *)a2 + 24) = v15;
      k = (_DWORD *)k[5];
    }
    result = 1;
  }
  return result;
}

//----- (00520810) --------------------------------------------------------
int __cdecl sub_520810(int a1, FILE *a2)
{
  char *v3; // ebx
  int v4; // edi
  const char **v5; // eax
  unsigned __int8 *v6; // esi
  int v7; // ecx

  *(_BYTE *)(a1 + 64) = 0;
  if ( !sub_51E540(a2, &byte_5D4594[2487264]) )
    return 0;
  if ( _strcmpi((const char *)&byte_587000[254512], (const char *)&byte_5D4594[2487264]) )
  {
    v3 = strtok((char *)&byte_5D4594[2487264], (const char *)&byte_587000[254520]);
    if ( v3 )
    {
      while ( 1 )
      {
        v4 = 0;
        if ( *(_DWORD *)&byte_587000[253144] )
        {
          v5 = (const char **)&byte_587000[253144];
          v6 = &byte_587000[253144];
          do
          {
            if ( !_strcmpi(*v5, v3) )
              break;
            v7 = *((_DWORD *)v6 + 1);
            v6 += 4;
            ++v4;
            v5 = (const char **)v6;
          }
          while ( v7 );
        }
        if ( !*(_DWORD *)&byte_587000[4 * v4 + 253144] )
          break;
        *(_BYTE *)(a1 + 64) |= 1 << v4;
        v3 = strtok(0, (const char *)&byte_587000[254524]);
        if ( !v3 )
          return 1;
      }
      return 0;
    }
  }
  return 1;
}

//----- (005208D0) --------------------------------------------------------
int __cdecl sub_5208D0(int a1, FILE *a2)
{
  int result; // eax

  result = sub_51E540(a2, &byte_5D4594[2487264]);
  if ( result )
  {
    *(_BYTE *)(a1 + 65) = atoi((const char *)&byte_5D4594[2487264]);
    result = 1;
  }
  return result;
}

//----- (00520910) --------------------------------------------------------
int __cdecl sub_520910(int a1, FILE *a2)
{
  int result; // eax

  result = sub_51E540(a2, &byte_5D4594[2487264]);
  if ( result )
  {
    if ( _strcmpi((const char *)&byte_587000[254528], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[254536], (const char *)&byte_5D4594[2487264]) )
      {
        if ( _strcmpi((const char *)&byte_587000[254548], (const char *)&byte_5D4594[2487264]) )
        {
          if ( _strcmpi((const char *)&byte_587000[254556], (const char *)&byte_5D4594[2487264]) )
          {
            if ( !_strcmpi((const char *)&byte_587000[254568], (const char *)&byte_5D4594[2487264]) )
              *(_DWORD *)(a1 + 72) = 1;
            result = 1;
          }
          else
          {
            result = 1;
            *(_DWORD *)(a1 + 72) = 10;
          }
        }
        else
        {
          *(_DWORD *)(a1 + 72) = 100;
          result = 1;
        }
      }
      else
      {
        result = 1;
        *(_DWORD *)(a1 + 72) = 500;
      }
    }
    else
    {
      result = 1;
      *(_DWORD *)(a1 + 72) = 1000;
    }
  }
  return result;
}

//----- (005209F0) --------------------------------------------------------
int __cdecl sub_5209F0(int a1, FILE *a2)
{
  int result; // eax

  result = sub_51E540(a2, &byte_5D4594[2487264]);
  if ( result )
  {
    *(_DWORD *)(a1 + 76) = _strcmpi((const char *)&byte_587000[254580], (const char *)&byte_5D4594[2487264]) ? atoi((const char *)&byte_5D4594[2487264]) : 0;
    result = sub_51E540(a2, &byte_5D4594[2487264]);
    if ( result )
    {
      if ( _strcmpi((const char *)&byte_587000[254584], (const char *)&byte_5D4594[2487264]) )
        *(_DWORD *)(a1 + 80) = atoi((const char *)&byte_5D4594[2487264]);
      else
        *(_DWORD *)(a1 + 80) = 999999;
      result = 1;
    }
  }
  return result;
}

//----- (00520A90) --------------------------------------------------------
BOOL __cdecl sub_520A90(int a1, FILE *a2)
{
  return sub_51E540(a2, (_BYTE *)(a1 + 100)) != 0;
}

//----- (00520AB0) --------------------------------------------------------
BOOL __cdecl sub_520AB0(int a1, FILE *a2)
{
  return sub_51E540(a2, (_BYTE *)(a1 + 160)) != 0;
}

//----- (00520AD0) --------------------------------------------------------
BOOL __cdecl sub_520AD0(int *a1)
{
  int v1; // ecx

  v1 = *a1;
  a1[2] = 0;
  a1[3] = 0;
  a1[4] = 0;
  a1[5] = 0;
  a1[6] = 0;
  for ( a1[7] = 0; v1; v1 = *(_DWORD *)(v1 + 220) )
  {
    if ( !*(_BYTE *)(v1 + 64) )
    {
      a1[2] += *(_DWORD *)(v1 + 72);
      a1[3] += *(_DWORD *)(v1 + 72);
      a1[4] += *(_DWORD *)(v1 + 72);
      a1[5] += *(_DWORD *)(v1 + 72);
      a1[6] += *(_DWORD *)(v1 + 72);
      a1[7] += *(_DWORD *)(v1 + 72);
    }
    if ( *(_BYTE *)(v1 + 64) & 1 )
      a1[2] += *(_DWORD *)(v1 + 72);
    if ( *(_BYTE *)(v1 + 64) & 2 )
      a1[3] += *(_DWORD *)(v1 + 72);
    if ( *(_BYTE *)(v1 + 64) & 4 )
      a1[4] += *(_DWORD *)(v1 + 72);
    if ( *(_BYTE *)(v1 + 64) & 8 )
      a1[5] += *(_DWORD *)(v1 + 72);
    if ( *(_BYTE *)(v1 + 64) & 0x10 )
      a1[6] += *(_DWORD *)(v1 + 72);
    if ( *(_BYTE *)(v1 + 64) & 0x20 )
      a1[7] += *(_DWORD *)(v1 + 72);
  }
  if ( !a1[2] )
    return 0;
  if ( !a1[3] )
    return 0;
  if ( !a1[4] )
    return 0;
  if ( !a1[5] )
    return 0;
  if ( a1[6] )
    return a1[7] != 0;
  return 0;
}

//----- (00520BF0) --------------------------------------------------------
int __cdecl sub_520BF0(int a1, FILE *a2)
{
  char *v2; // esi
  int v3; // ebx
  char *v4; // eax
  _DWORD *v5; // eax

  v2 = 0;
  v3 = 0;
  while ( sub_51E540(a2, &byte_5D4594[2487264]) )
  {
    if ( !_strcmpi((const char *)&byte_587000[254588], (const char *)&byte_5D4594[2487264]) )
      return 1;
    if ( _strcmpi((const char *)&byte_587000[254592], (const char *)&byte_5D4594[2487264]) )
    {
      if ( _strcmpi((const char *)&byte_587000[254600], (const char *)&byte_5D4594[2487264]) )
      {
        if ( !_strcmpi((const char *)&byte_587000[254612], (const char *)&byte_5D4594[2487264]) )
        {
          if ( !v2 )
            return 0;
          v5 = sub_5205B0(a2);
          if ( !v5 )
            return 0;
          v5[2] = *((_DWORD *)v2 + 38);
          *((_DWORD *)v2 + 38) = v5;
        }
      }
      else
      {
        v3 = 1;
      }
    }
    else
    {
      v4 = sub_520CE0(a1, a2);
      v2 = v4;
      if ( !v4 )
        return 0;
      if ( v3 )
      {
        *((_DWORD *)v4 + 18) = 1;
        v3 = 0;
      }
    }
  }
  return 0;
}

//----- (00520CE0) --------------------------------------------------------
char *__cdecl sub_520CE0(int a1, FILE *a2)
{
  char *result; // eax
  int v3; // ecx

  result = (char *)sub_51E540(a2, &byte_5D4594[2487264]);
  if ( result )
  {
    result = (char *)nox_calloc(1u, 0xA0u);
    if ( result )
    {
      strcpy(result, (const char *)&byte_5D4594[2487264]);
      *((_DWORD *)result + 39) = *(_DWORD *)(a1 + 80);
      v3 = *(_DWORD *)(a1 + 84) + 1;
      *(_DWORD *)(a1 + 80) = result;
      *(_DWORD *)(a1 + 84) = v3;
    }
  }
  return result;
}

//----- (00520D50) --------------------------------------------------------
_DWORD *__cdecl sub_520D50(_DWORD *a1)
{
  _DWORD *v1; // eax
  _DWORD *v2; // esi
  _DWORD *v3; // eax
  _DWORD *v4; // esi
  _DWORD *v5; // eax
  _DWORD *v6; // esi
  _DWORD *v7; // eax
  _DWORD *v8; // esi
  _DWORD *result; // eax
  _DWORD *v10; // esi

  v1 = (_DWORD *)a1[22];
  if ( v1 )
  {
    do
    {
      v2 = (_DWORD *)v1[55];
      free(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  v3 = (_DWORD *)a1[30];
  if ( v3 )
  {
    do
    {
      v4 = (_DWORD *)v3[55];
      free(v3);
      v3 = v4;
    }
    while ( v4 );
  }
  v5 = (_DWORD *)a1[275];
  if ( v5 )
  {
    do
    {
      v6 = (_DWORD *)v5[38];
      sub_51F1F0(v5);
      v5 = v6;
    }
    while ( v6 );
  }
  v7 = (_DWORD *)a1[277];
  if ( v7 )
  {
    do
    {
      v8 = (_DWORD *)v7[38];
      sub_51F1F0(v7);
      v7 = v8;
    }
    while ( v8 );
  }
  result = (_DWORD *)a1[20];
  if ( result )
  {
    do
    {
      v10 = (_DWORD *)result[39];
      free(result);
      result = v10;
    }
    while ( v10 );
  }
  return result;
}

//----- (00520DF0) --------------------------------------------------------
__int64 __cdecl sub_520DF0(float2 *a1, _DWORD *a2)
{
  double v2; // st7
  double v3; // st7
  __int64 result; // rax

  if ( a1->field_0 >= 0.0 )
    v2 = 0.5;
  else
    v2 = -0.5;
  *a2 = (__int64)(a1->field_0 * 0.030743772 + v2);
  if ( a1->field_4 >= 0.0 )
    v3 = 0.5;
  else
    v3 = -0.5;
  result = (__int64)(a1->field_4 * 0.030743772 + v3);
  a2[1] = result;
  return result;
}

//----- (00520E60) --------------------------------------------------------
int __cdecl sub_520E60(int2 *a1)
{
  int v1; // eax
  int v2; // ecx
  int result; // eax

  v1 = *(_DWORD *)&byte_5D4594[2487536] + a1->field_0;
  v2 = *(_DWORD *)&byte_5D4594[2487536] + a1->field_4;
  if ( v1 < 0 || v1 >= *(int *)&byte_5D4594[2487540] || v2 < 0 || v2 >= *(int *)&byte_5D4594[2487540] )
    result = 0;
  else
    result = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v1) + 20 * v2;
  return result;
}

//----- (00520EA0) --------------------------------------------------------
int __cdecl sub_520EA0(int a1)
{
  int v2; // edx
  int v3; // esi
  int v4; // esi
  int v5; // ecx
  int v6; // eax
  int v7; // ebx

  *(_DWORD *)&byte_5D4594[2487540] = 2 * *(_DWORD *)(a1 + 68) + 1;
  *(_DWORD *)&byte_5D4594[2487536] = *(_DWORD *)(a1 + 68);
  *(_DWORD *)&byte_5D4594[2487532] = nox_malloc(4 * *(_DWORD *)&byte_5D4594[2487540]);
  if ( !*(_DWORD *)&byte_5D4594[2487532] )
    return 0;
  v2 = *(_DWORD *)&byte_5D4594[2487540];
  v3 = 0;
  if ( *(_DWORD *)&byte_5D4594[2487540] > 0 )
  {
    do
    {
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v3) = nox_malloc(20 * v2);
      if ( !*(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v3) )
        return 0;
      v2 = *(_DWORD *)&byte_5D4594[2487540];
    }
    while ( ++v3 < *(int *)&byte_5D4594[2487540] );
  }
  v4 = 0;
  if ( v2 > 0 )
  {
    v5 = 0;
    do
    {
      v6 = 0;
      if ( v2 > 0 )
      {
        do
        {
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v6) + v5 + 4) = v6
                                                                                       - *(_DWORD *)&byte_5D4594[2487536];
          v7 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v6++);
          *(_DWORD *)(v7 + v5 + 8) = v4 - *(_DWORD *)&byte_5D4594[2487536];
          *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * v6 - 4) + v5 + 16) = 0;
          v2 = *(_DWORD *)&byte_5D4594[2487540];
        }
        while ( v6 < *(int *)&byte_5D4594[2487540] );
      }
      ++v4;
      v5 += 20;
    }
    while ( v4 < v2 );
  }
  return 1;
}

//----- (00520F80) --------------------------------------------------------
void sub_520F80()
{
  int i; // esi

  for ( i = 0; i < *(int *)&byte_5D4594[2487540]; ++i )
    free(*(LPVOID *)(*(_DWORD *)&byte_5D4594[2487532] + 4 * i));
  free(*(LPVOID *)&byte_5D4594[2487532]);
}

//----- (00520FC0) --------------------------------------------------------
void sub_520FC0()
{
  ++byte_5D4594[2487548];
}

//----- (00520FD0) --------------------------------------------------------
int __cdecl sub_520FD0(_DWORD *a1)
{
  unsigned __int16 *v1; // eax
  int result; // eax

  v1 = (unsigned __int16 *)sub_520E60((int2 *)a1);
  if ( v1 )
    result = *v1;
  else
    result = -1;
  return result;
}

//----- (00520FF0) --------------------------------------------------------
BOOL __cdecl sub_520FF0(_DWORD *a1)
{
  int v1; // eax
  BOOL result; // eax

  v1 = sub_520E60((int2 *)a1);
  if ( v1 )
    result = *(_DWORD *)(v1 + 16) == 0;
  else
    result = 0;
  return result;
}

//----- (00521020) --------------------------------------------------------
BOOL __cdecl sub_521020(_DWORD *a1)
{
  int v1; // eax
  BOOL result; // eax

  v1 = sub_520E60((int2 *)a1);
  if ( v1 )
    result = *(_BYTE *)(v1 + 2) == byte_5D4594[2487548];
  else
    result = 1;
  return result;
}

//----- (00521050) --------------------------------------------------------
int __cdecl sub_521050(_DWORD *a1, __int16 a2)
{
  int result; // eax

  result = sub_520E60((int2 *)a1);
  if ( result )
  {
    *(_BYTE *)(result + 2) = byte_5D4594[2487548];
    *(_WORD *)result = a2;
  }
  return result;
}

//----- (00521080) --------------------------------------------------------
int __cdecl sub_521080(_DWORD *a1, int a2)
{
  int v2; // ebp
  int v3; // esi
  int2 v5; // [esp+10h] [ebp-8h]

  v2 = 0;
  v5.field_4 = a1[1] - a2 / 2;
  if ( a2 > 0 )
  {
    while ( 2 )
    {
      v3 = 0;
      v5.field_0 = *a1 - a2 / 2;
      do
      {
        if ( !sub_520FF0(&v5) )
          return 0;
        ++v3;
        ++v5.field_0;
      }
      while ( v3 < a2 );
      ++v2;
      ++v5.field_4;
      if ( v2 < a2 )
        continue;
      break;
    }
  }
  return 1;
}

//----- (00521100) --------------------------------------------------------
int __cdecl sub_521100(int a1)
{
  int result; // eax
  int v2; // ebx
  int v3; // edi
  int v4; // eax
  int v5; // eax
  int2 a1a; // [esp+8h] [ebp-10h]
  int2 a2; // [esp+10h] [ebp-8h]

  sub_520DF0((float2 *)(a1 + 20), &a2);
  result = *(_DWORD *)(a1 + 16);
  v2 = 0;
  for ( a1a.field_4 = a2.field_4; v2 < result; ++a1a.field_4 )
  {
    v3 = 0;
    a1a.field_0 = a2.field_0;
    if ( *(_DWORD *)(a1 + 12) > 0 )
    {
      do
      {
        v4 = sub_520E60(&a1a);
        if ( v4 )
          *(_DWORD *)(v4 + 16) = a1;
        v5 = *(_DWORD *)(a1 + 12);
        ++v3;
        ++a1a.field_0;
      }
      while ( v3 < v5 );
    }
    result = *(_DWORD *)(a1 + 16);
    ++v2;
  }
  return result;
}

//----- (00521180) --------------------------------------------------------
int __cdecl sub_521180(int a1)
{
  int result; // eax
  int v2; // ebx
  int v3; // esi
  int v4; // eax
  int v5; // eax
  int2 a1a; // [esp+Ch] [ebp-10h]
  int2 a2; // [esp+14h] [ebp-8h]

  sub_520DF0((float2 *)(a1 + 20), &a2);
  result = *(_DWORD *)(a1 + 16);
  v2 = 0;
  for ( a1a.field_4 = a2.field_4; v2 < result; ++a1a.field_4 )
  {
    v3 = 0;
    a1a.field_0 = a2.field_0;
    if ( *(_DWORD *)(a1 + 12) > 0 )
    {
      do
      {
        v4 = sub_520E60(&a1a);
        if ( v4 )
          *(_DWORD *)(v4 + 16) = 0;
        v5 = *(_DWORD *)(a1 + 12);
        ++v3;
        ++a1a.field_0;
      }
      while ( v3 < v5 );
    }
    result = *(_DWORD *)(a1 + 16);
    ++v2;
  }
  return result;
}

//----- (00521200) --------------------------------------------------------
int __cdecl sub_521200(int a1)
{
  int v1; // eax
  int v2; // ebx
  int v3; // esi
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int2 a1a; // [esp+Ch] [ebp-10h]
  int2 a2; // [esp+14h] [ebp-8h]

  sub_520DF0((float2 *)(a1 + 20), &a2);
  v1 = *(_DWORD *)(a1 + 16);
  v2 = 0;
  a1a.field_4 = a2.field_4;
  if ( v1 <= 0 )
    return 0;
  while ( 1 )
  {
    v3 = 0;
    a1a.field_0 = a2.field_0;
    if ( *(_DWORD *)(a1 + 12) > 0 )
      break;
LABEL_6:
    v6 = *(_DWORD *)(a1 + 16);
    ++v2;
    ++a1a.field_4;
    if ( v2 >= v6 )
      return 0;
  }
  while ( 1 )
  {
    v4 = sub_520E60(&a1a);
    if ( v4 )
    {
      if ( *(_DWORD *)(v4 + 16) )
        return *(_DWORD *)(v4 + 16);
    }
    v5 = *(_DWORD *)(a1 + 12);
    ++v3;
    ++a1a.field_0;
    if ( v3 >= v5 )
      goto LABEL_6;
  }
}

//----- (00521290) --------------------------------------------------------
int __cdecl sub_521290(int2 *a1)
{
  int v1; // eax
  int result; // eax

  v1 = sub_520E60(a1);
  if ( v1 )
    result = *(_DWORD *)(v1 + 16);
  else
    result = 0;
  return result;
}

//----- (005212B0) --------------------------------------------------------
int __cdecl sub_5212B0(int a1, _DWORD *a2)
{
  _DWORD *v2; // eax
  int v3; // ebp
  int v4; // ecx
  int v5; // edx
  int v6; // edi
  int v7; // ecx
  int v8; // edi
  int v9; // edx
  int v10; // eax
  int v11; // ecx
  int v12; // ebx
  int v13; // ecx
  int v14; // ecx
  int v15; // eax
  int *v16; // edx
  float2 a2a; // [esp+10h] [ebp-18h]
  int v19[4]; // [esp+18h] [ebp-10h]

  v2 = a2;
  v3 = 0;
  while ( 1 )
  {
    v4 = *(_DWORD *)(a1 + 4);
    v5 = v2[1];
    v6 = v2[3] - v4;
    v7 = *(_DWORD *)(a1 + 12) + v4 - v5;
    v8 = v5 + v6;
    v9 = v2[2];
    v10 = v2[4];
    v19[3] = v7;
    v11 = *(_DWORD *)(a1 + 8);
    v12 = -1;
    v19[0] = v9 + v10 - v11;
    v13 = *(_DWORD *)(a1 + 16) + v11 - v9;
    v19[2] = v8;
    v19[1] = v13;
    v14 = 99999;
    v15 = 0;
    v16 = v19;
    do
    {
      if ( *v16 < v14 )
      {
        v14 = *v16;
        v12 = v15;
      }
      ++v15;
      ++v16;
    }
    while ( v15 < 4 );
    switch ( v12 )
    {
      case 0:
        a2a.field_0 = *(float *)(a1 + 20);
        a2a.field_4 = (double)v19[0] * 32.526913 + *(float *)(a1 + 24);
        break;
      case 1:
        a2a.field_0 = *(float *)(a1 + 20);
        a2a.field_4 = *(float *)(a1 + 24) - (double)v19[1] * 32.526913;
        break;
      case 2:
        a2a.field_4 = *(float *)(a1 + 24);
        a2a.field_0 = (double)v19[2] * 32.526913 + *(float *)(a1 + 20);
        break;
      case 3:
        a2a.field_4 = *(float *)(a1 + 24);
        a2a.field_0 = *(float *)(a1 + 20) - (double)v19[3] * 32.526913;
        break;
      default:
        break;
    }
    sub_521880((_DWORD *)a1, &a2a);
    v2 = (_DWORD *)sub_521200(a1);
    if ( !v2 )
      return 1;
    if ( ++v3 >= 25 )
      return 0;
  }
}

//----- (005213E0) --------------------------------------------------------
BOOL sub_5213E0()
{
  *(_DWORD *)&byte_5D4594[2487556] = nox_malloc(0x2000u);
  return *(_DWORD *)&byte_5D4594[2487556] != 0;
}

//----- (00521400) --------------------------------------------------------
void sub_521400()
{
  free(*(LPVOID *)&byte_5D4594[2487556]);
}

//----- (00521410) --------------------------------------------------------
LPVOID __cdecl sub_521410(int *a1, _DWORD *a2, int a3, int *a4)
{
  LPVOID result; // eax
  int v5; // eax
  int v6; // edx
  int v7; // edi
  int v8; // ebp
  int v9; // ecx
  _DWORD *v10; // ebx
  int v11; // edx
  int v12; // esi
  _DWORD *v13; // ecx
  int v14; // edx
  int v15; // [esp+14h] [ebp+Ch]

  sub_520FC0();
  result = (LPVOID)sub_521500(a2, a1, a3);
  if ( result )
  {
    sub_521600(a2, a1);
    if ( *(_DWORD *)&byte_5D4594[2487552] <= 1 )
    {
      *a4 = a3;
      result = *(LPVOID *)&byte_5D4594[2487556];
    }
    else
    {
      v5 = *(_DWORD *)&byte_5D4594[2487556];
      v6 = 1;
      v7 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 8) - **(_DWORD **)&byte_5D4594[2487556];
      v8 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 12) - *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 4);
      v15 = 1;
      v9 = 1;
      if ( *(_DWORD *)&byte_5D4594[2487552] - 1 > 1 )
      {
        do
        {
          v10 = (_DWORD *)(v5 + 8 * v9 - 8);
          v11 = *(_DWORD *)(v5 + 8 * v9) - *v10;
          v12 = *(_DWORD *)(v5 + 8 * v9 + 4) - *(_DWORD *)(v5 + 8 * v9 - 4);
          if ( v11 != v7 || v12 != v8 )
          {
            *(_DWORD *)(v5 + 8 * v15++) = *v10;
            *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 8 * v15 - 4) = v10[1];
            v5 = *(_DWORD *)&byte_5D4594[2487556];
          }
          v7 = v11;
          ++v9;
          v8 = v12;
        }
        while ( v9 < *(int *)&byte_5D4594[2487552] - 1 );
        v6 = v15;
      }
      v13 = (_DWORD *)(v5 + 8 * v9);
      v14 = v6 + 1;
      *(_DWORD *)(v5 + 8 * v14 - 8) = *v13;
      *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 8 * v14 - 4) = v13[1];
      *a4 = v14;
      result = *(LPVOID *)&byte_5D4594[2487556];
    }
  }
  return result;
}

//----- (00521500) --------------------------------------------------------
int __cdecl sub_521500(_DWORD *a1, _DWORD *a2, int a3)
{
  __int16 v3; // bp
  int v4; // eax
  _DWORD *v5; // edi
  _DWORD *v6; // ebx
  unsigned __int8 *v7; // esi
  int v8; // eax
  int v9; // eax
  int v11; // [esp+10h] [ebp-Ch]
  int v12; // [esp+14h] [ebp-8h]
  int v13; // [esp+18h] [ebp-4h]

  v3 = 0;
  v11 = 0;
  v4 = sub_521050(a1, 0);
  *(_DWORD *)(v4 + 12) = 0;
  v5 = (_DWORD *)v4;
  while ( 1 )
  {
    ++v3;
    v6 = 0;
    if ( !v5 )
      return 0;
    do
    {
      if ( v11 )
        break;
      v7 = &byte_587000[254628];
      while ( 1 )
      {
        v8 = *(_DWORD *)v7;
        v12 = v5[1] + *((_DWORD *)v7 - 1);
        v13 = v8 + v5[2];
        if ( sub_521080(&v12, a3) == 1 && !sub_521020(&v12) )
        {
          v9 = sub_521050(&v12, v3);
          *(_DWORD *)(v9 + 12) = v6;
          v6 = (_DWORD *)v9;
          if ( v12 == *a2 && v13 == a2[1] )
            break;
        }
        v7 += 8;
        if ( (int)v7 >= (int)&byte_587000[254660] )
          goto LABEL_12;
      }
      v11 = 1;
LABEL_12:
      v5 = (_DWORD *)v5[3];
    }
    while ( v5 );
    if ( !v6 )
      return 0;
    v5 = v6;
    if ( v11 )
      return 1;
  }
}

//----- (00521600) --------------------------------------------------------
_DWORD *__cdecl sub_521600(_DWORD *a1, int *a2)
{
  int v2; // edx
  _DWORD *v3; // ebp
  int v4; // eax
  _DWORD *result; // eax
  int v6; // ebx
  int v7; // edi
  unsigned __int8 *v8; // esi
  int v9; // ecx
  int v10; // esi
  int v11; // ecx
  int v12; // [esp+10h] [ebp-14h]
  int v13; // [esp+14h] [ebp-10h]
  int v14; // [esp+18h] [ebp-Ch]
  int v15; // [esp+1Ch] [ebp-8h]
  int v16; // [esp+20h] [ebp-4h]

  *(_DWORD *)&byte_5D4594[2487552] = 0;
  v2 = a2[1];
  v12 = -1;
  v13 = *a2;
  v14 = v2;
  v3 = (_DWORD *)(sub_520FD0(&v13) - 1);
  v4 = v13;
  while ( 1 )
  {
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 8 * *(_DWORD *)&byte_5D4594[2487552]) = v4;
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487556] + 8 * *(_DWORD *)&byte_5D4594[2487552] + 4) = v14;
    result = (_DWORD *)(*(_DWORD *)&byte_5D4594[2487552] + 1);
    if ( ++*(_DWORD *)&byte_5D4594[2487552] == 1024 )
      break;
    result = a1;
    if ( v13 == *a1 && v14 == a1[1] )
      break;
    v6 = -1;
    v7 = 0;
    v8 = &byte_587000[254660];
    do
    {
      v9 = *(_DWORD *)v8;
      v15 = v13 + *((_DWORD *)v8 - 1);
      v16 = v14 + v9;
      result = (_DWORD *)sub_520FD0(&v15);
      if ( result == v3 )
      {
        result = (_DWORD *)v12;
        v6 = v7;
        if ( v7 == v12 )
          break;
      }
      v8 += 8;
      ++v7;
    }
    while ( (int)v8 < (int)&byte_587000[254692] );
    if ( v6 < 0 )
      break;
    v10 = *(_DWORD *)&byte_587000[8 * v6 + 254656];
    v11 = *(_DWORD *)&byte_587000[8 * v6 + 254660];
    v4 = v10 + v13;
    v13 += v10;
    v14 += v11;
    v3 = (_DWORD *)((char *)v3 - 1);
    v12 = v6;
  }
  return result;
}

//----- (00521710) --------------------------------------------------------
LPVOID sub_521710()
{
  return *(LPVOID *)&byte_5D4594[2487560];
}

//----- (00521720) --------------------------------------------------------
int __cdecl sub_521720(int a1)
{
  int result; // eax

  if ( a1 )
    result = *(_DWORD *)(a1 + 56);
  else
    result = 0;
  return result;
}

//----- (00521730) --------------------------------------------------------
int __cdecl sub_521730(_DWORD *a1)
{
  a1[15] = 0;
  a1[14] = *(_DWORD *)&byte_5D4594[2487560];
  if ( *(_DWORD *)&byte_5D4594[2487560] )
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487560] + 60) = a1;
  *(_DWORD *)&byte_5D4594[2487560] = a1;
  return sub_521100((int)a1);
}

//----- (00521760) --------------------------------------------------------
int __cdecl sub_521760(int a1)
{
  int v1; // ecx
  int v2; // ecx

  v1 = *(_DWORD *)(a1 + 60);
  if ( v1 )
    *(_DWORD *)(v1 + 56) = *(_DWORD *)(a1 + 56);
  else
    *(_DWORD *)&byte_5D4594[2487560] = *(_DWORD *)(a1 + 56);
  v2 = *(_DWORD *)(a1 + 56);
  if ( v2 )
    *(_DWORD *)(v2 + 60) = *(_DWORD *)(a1 + 60);
  return sub_521180(a1);
}

//----- (005217A0) --------------------------------------------------------
int __cdecl sub_5217A0(int a1, int a2)
{
  int v2; // edi
  int v3; // ebx
  long double v4; // st7
  int v5; // edx
  long double v6; // st6
  int v7; // ecx

  v2 = 0;
  v3 = *(_DWORD *)(a2 + 16);
  v4 = *(float *)(a2 + 24);
  if ( v3 <= 0 )
    return 1;
  v5 = *(_DWORD *)(a2 + 12);
  while ( 1 )
  {
    v6 = *(float *)(a2 + 20);
    v7 = 0;
    if ( v5 > 0 )
      break;
LABEL_7:
    ++v2;
    v4 = v4 + 32.526913;
    if ( v2 >= v3 )
      return 1;
  }
  while ( *(float *)(a1 + 64) >= fabs(v6) && *(float *)(a1 + 64) >= fabs(v4) )
  {
    v6 = v6 + 32.526913;
    if ( ++v7 >= v5 )
      goto LABEL_7;
  }
  return 0;
}

//----- (00521820) --------------------------------------------------------
int __cdecl sub_521820(int a1, int a2)
{
  int result; // eax

  result = sub_5217A0(a1, a2);
  if ( result )
    result = sub_521200(a2) == 0;
  return result;
}

//----- (00521850) --------------------------------------------------------
int __cdecl sub_521850(int a1)
{
  int result; // eax
  double v2; // st7
  int v3; // edx

  result = a1;
  v2 = *(float *)(a1 + 28) + *(float *)(a1 + 20);
  v3 = *(_DWORD *)(a1 + 24);
  *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 20);
  *(_DWORD *)(a1 + 40) = v3;
  *(float *)(a1 + 44) = v2;
  *(float *)(a1 + 48) = *(float *)(a1 + 32) + *(float *)(a1 + 24);
  return result;
}

//----- (00521880) --------------------------------------------------------
int __cdecl sub_521880(_DWORD *a1, float2 *a2)
{
  *(float2 *)(a1 + 5) = *a2;
  sub_520DF0(a2, a1 + 1);
  return sub_521850((int)a1);
}

//----- (005218B0) --------------------------------------------------------
int __cdecl sub_5218B0(int a1, int a2)
{
  int v2; // edx
  int v3; // esi
  _DWORD *i; // ecx

  v2 = 0;
  v3 = *(unsigned __int8 *)(a1 + a2 + 216);
  if ( v3 <= 0 )
    return 0;
  for ( i = (_DWORD *)(32 * a2 + a1 + 88); !*i || *(_DWORD *)*i != 1; ++i )
  {
    if ( ++v2 >= v3 )
      return 0;
  }
  return 1;
}

//----- (00521900) --------------------------------------------------------
int __cdecl sub_521900(int a1, int a2, int a3)
{
  if ( *(_BYTE *)(a1 + a3 + 216) >= 8u )
    return 0;
  *(_DWORD *)(a1 + 4 * ((unsigned __int8)(*(_BYTE *)(a1 + a3 + 216))++ + 8 * a3) + 88) = a2;
  return 1;
}

//----- (00521940) --------------------------------------------------------
float *__cdecl sub_521940(int a1, int a2)
{
  float *result; // eax

  result = (float *)nox_calloc(1u, 0x178u);
  if ( result )
  {
    *(_DWORD *)result = 1;
    *((_DWORD *)result + 3) = a1;
    *((_DWORD *)result + 4) = a2;
    result[7] = (double)a1 * 32.526913;
    result[8] = (double)a2 * 32.526913;
  }
  return result;
}

//----- (00521990) --------------------------------------------------------
float *__cdecl sub_521990(int a1)
{
  int v1; // ebp
  int v2; // eax
  int v3; // esi
  int v4; // edi
  int v5; // ebx
  signed int v7; // [esp-4h] [ebp-14h]
  int v8; // [esp+14h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 32);
  v7 = *(_DWORD *)(a1 + 36);
  v3 = v2 - v7;
  v4 = sub_526B00(v2, v7);
  v8 = v4;
  if ( v4 < 5 )
  {
    v4 = 5;
    v8 = 5;
  }
  v5 = sub_526B00(v4, (__int64)((double)v8 * 0.30000001));
  if ( v5 < 5 )
    v5 = 5;
  if ( v5 < v3 )
    v5 = v3;
  if ( *(_DWORD *)(v1 + 56) )
    sub_526AC0(0, 2);
  return sub_521940(v4, v5);
}

//----- (00521A10) --------------------------------------------------------
void __cdecl sub_521A10(LPVOID lpMem)
{
  _DWORD *v1; // eax
  _DWORD *v2; // esi

  v1 = (_DWORD *)*((_DWORD *)lpMem + 92);
  if ( v1 )
  {
    do
    {
      v2 = (_DWORD *)v1[6];
      free(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  free(lpMem);
}

//----- (00521A40) --------------------------------------------------------
_DWORD *sub_521A40()
{
  _DWORD *result; // eax
  _DWORD *v1; // esi

  result = *(_DWORD **)&byte_5D4594[2487560];
  if ( *(_DWORD *)&byte_5D4594[2487560] )
  {
    do
    {
      v1 = (_DWORD *)result[14];
      sub_521A10(result);
      result = v1;
    }
    while ( v1 );
    *(_DWORD *)&byte_5D4594[2487560] = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2487560] = 0;
  }
  return result;
}

//----- (00521A70) --------------------------------------------------------
int __cdecl sub_521A70(int a1, int a2, int a3)
{
  int v3; // eax

  sub_521900(a1, a2, a3);
  v3 = sub_523960(a3);
  return sub_521900(a2, a1, v3);
}

//----- (00521AA0) --------------------------------------------------------
int __cdecl sub_521AA0(_DWORD *a1, int a2)
{
  int v2; // eax
  int result; // eax

  if ( *a1 == 1 )
    goto LABEL_13;
  switch ( *a1 )
  {
    case 2:
      v2 = 1;
      break;
    case 3:
      v2 = 0;
      break;
    case 4:
      v2 = 3;
      break;
    case 5:
      v2 = 2;
      break;
    default:
      v2 = (int)a1;
      break;
  }
  if ( a2 != v2 )
LABEL_13:
    result = 0;
  else
    result = 1;
  return result;
}

//----- (00521B00) --------------------------------------------------------
double __cdecl sub_521B00(int a1, int a2)
{
  return (double)sub_526AC0(0, *(_DWORD *)(a1 + 12) - *(_DWORD *)(a2 + 12)) * 32.526913 + *(float *)(a1 + 20);
}

//----- (00521B30) --------------------------------------------------------
double __cdecl sub_521B30(int a1, int a2)
{
  return (double)sub_526AC0(0, *(_DWORD *)(a1 + 16) - *(_DWORD *)(a2 + 16)) * 32.526913 + *(float *)(a1 + 24);
}

//----- (00521B60) --------------------------------------------------------
double __cdecl sub_521B60(int a1, int a2)
{
  return *(float *)(a2 + 20) - (double)sub_526AC0(0, *(_DWORD *)(a1 + 12) - *(_DWORD *)(a2 + 12)) * 32.526913;
}

//----- (00521B90) --------------------------------------------------------
double __cdecl sub_521B90(int a1, int a2)
{
  return *(float *)(a2 + 24) - (double)sub_526AC0(0, *(_DWORD *)(a1 + 16) - *(_DWORD *)(a2 + 16)) * 32.526913;
}

//----- (00521BC0) --------------------------------------------------------
float *__cdecl sub_521BC0(int a1, float2 *a2, float a3, float a4)
{
  float *result; // eax

  result = (float *)nox_calloc(1u, 0x1Cu);
  if ( result )
  {
    *result = 0.0;
    *(float2 *)(result + 1) = *a2;
    result[3] = a3 + a2->field_0;
    result[4] = a4 + a2->field_4;
    result[6] = *(float *)(a1 + 368);
    *(_DWORD *)(a1 + 368) = result;
  }
  return result;
}

//----- (00521C10) --------------------------------------------------------
_DWORD *__cdecl sub_521C10(int a1)
{
  _DWORD *v1; // edi
  _DWORD *result; // eax
  _DWORD *v3; // esi

  v1 = 0;
  result = *(_DWORD **)(a1 + 368);
  if ( result )
  {
    do
    {
      v3 = (_DWORD *)result[6];
      if ( *result == 1 )
      {
        if ( v1 )
          v1[6] = v3;
        else
          *(_DWORD *)(a1 + 368) = v3;
        free(result);
      }
      else
      {
        v1 = result;
      }
      result = v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (00521C60) --------------------------------------------------------
int __cdecl sub_521C60(int a1, int a2)
{
  int result; // eax
  int i; // esi
  int v4; // eax

  result = sub_504980();
  for ( i = result; result; i = result )
  {
    v4 = a2;
    if ( a2 )
    {
      while ( *(unsigned __int16 *)(i + 4) != *(_DWORD *)v4 )
      {
        v4 = *(_DWORD *)(v4 + 8);
        if ( !v4 )
          goto LABEL_7;
      }
      sub_521FE0(a1, i, *(_DWORD **)(v4 + 4));
    }
LABEL_7:
    result = sub_5049C0(i);
  }
  return result;
}

//----- (00521CB0) --------------------------------------------------------
int __cdecl sub_521CB0(int a1, int a2, int a3, int a4)
{
  float *v4; // ebx
  int v5; // ebp
  int v6; // esi
  signed int v7; // edi
  signed int v8; // ebp
  int v9; // eax
  int v10; // eax
  double v11; // st7
  BOOL v12; // eax
  float *v14; // [esp-4h] [ebp-30h]
  float v15; // [esp+10h] [ebp-1Ch]
  float v16; // [esp+14h] [ebp-18h]
  char *v17; // [esp+18h] [ebp-14h]
  int v18; // [esp+1Ch] [ebp-10h]
  int v19; // [esp+20h] [ebp-Ch]
  float2 v20; // [esp+24h] [ebp-8h]
  int v22; // [esp+34h] [ebp+8h]

  v4 = (float *)nox_calloc(1u, 0x1Cu);
  if ( !v4 )
    return 0;
  v15 = sub_502E70(a4);
  v16 = sub_502EA0(a4);
  v5 = (__int64)(v15 * 0.030743772);
  v18 = v5;
  v6 = a2;
  v19 = (__int64)(v16 * 0.030743772);
  v7 = *(_DWORD *)(a2 + 12) - v5;
  v8 = *(_DWORD *)(a2 + 16) - v19;
  if ( v7 >= 0 && v8 >= 0 )
  {
    v17 = sub_526AA0(a4);
    v20.field_0 = (double)sub_526AC0(0, v7) * 32.526913 + *(float *)(a2 + 36);
    v20.field_4 = (double)sub_526AC0(0, v8) * 32.526913 + *(float *)(a2 + 40);
    v9 = *((_DWORD *)v17 + 15);
    if ( v9 & 1 )
    {
      v20.field_4 = *(float *)(a2 + 40);
    }
    else if ( v9 & 2 )
    {
      v20.field_4 = *(float *)(a2 + 48) - v16;
    }
    v10 = *((_DWORD *)v17 + 15);
    if ( v10 & 4 )
    {
      v20.field_0 = *(float *)(a2 + 44) - v15;
    }
    else if ( v10 & 8 )
    {
      v20.field_0 = *(float *)(a2 + 36);
    }
    if ( v17[60] & 0x10 )
    {
      v22 = (*(_DWORD *)(a2 + 16) - v19) / 2;
      v20.field_0 = (double)(int)((*(_DWORD *)(v6 + 12) - v18) / 2) * 32.526913 + *(float *)(v6 + 36);
      v20.field_4 = (double)v22 * 32.526913 + *(float *)(v6 + 40);
    }
    *(_DWORD *)v4 = 1;
    v4[1] = v20.field_0;
    v4[2] = v20.field_4;
    v4[3] = v20.field_0 + v15;
    v11 = v20.field_4 + v16;
    *((_DWORD *)v4 + 5) = a4;
    v4[4] = v11;
    v12 = sub_521EB0((float *)v6, v4);
    v14 = v4;
    if ( !v12 )
      goto LABEL_18;
    if ( !sub_521F10(v6, v4) )
    {
      sub_502D70(a4);
      sub_521C60(a1, *(_DWORD *)(a3 + 84));
      sub_503B30(&v20);
      v4[6] = *(float *)(v6 + 368);
      *(_DWORD *)(v6 + 368) = v4;
      return 1;
    }
  }
  v14 = v4;
LABEL_18:
  free(v14);
  return 0;
}

//----- (00521EB0) --------------------------------------------------------
BOOL __cdecl sub_521EB0(float *a1, float *a2)
{
  return a2[1] + 0.5 >= a1[9] && a2[3] - 0.5 <= a1[11] && a2[2] + 0.5 >= a1[10] && a2[4] - 0.5 <= a1[12];
}

//----- (00521F10) --------------------------------------------------------
int __cdecl sub_521F10(int a1, float *a2)
{
  int v2; // ecx
  float v4; // [esp+0h] [ebp-20h]
  float v5; // [esp+4h] [ebp-1Ch]
  float v6; // [esp+8h] [ebp-18h]
  float v7; // [esp+Ch] [ebp-14h]
  float v8; // [esp+14h] [ebp-Ch]
  float v9; // [esp+1Ch] [ebp-4h]

  v2 = *(_DWORD *)(a1 + 368);
  if ( !v2 )
    return 0;
  while ( 1 )
  {
    if ( (float *)v2 != a2 )
    {
      v4 = a2[1] + 0.5;
      if ( v4 < *(float *)(v2 + 12) - 0.5 )
      {
        v6 = a2[3] - 0.5;
        if ( v6 > *(float *)(v2 + 4) + 0.5 )
        {
          v9 = *(float *)(v2 + 16) - 0.5;
          v5 = a2[2] + 0.5;
          if ( v5 < (double)v9 )
          {
            v8 = *(float *)(v2 + 8) + 0.5;
            v7 = a2[4] - 0.5;
            if ( v7 > (double)v8 )
              break;
          }
        }
      }
    }
    v2 = *(_DWORD *)(v2 + 24);
    if ( !v2 )
      return 0;
  }
  return v2;
}

//----- (00521FE0) --------------------------------------------------------
void __cdecl sub_521FE0(int a1, int a2, _DWORD *a3)
{
  _DWORD *v3; // ebp
  signed int v4; // eax
  _DWORD *v5; // edi
  CHAR *v6; // esi
  _DWORD *v7; // eax
  int v8; // [esp+10h] [ebp+Ch]

  v3 = a3;
  if ( a3 )
  {
    v4 = sub_526AC0(1, 100);
    while ( 1 )
    {
      v4 -= *v3;
      if ( v4 <= 0 )
        break;
      v3 = (_DWORD *)v3[514];
      if ( !v3 )
        return;
    }
    if ( v3 )
    {
      v8 = 0;
      if ( v3[513] > 0 )
      {
        v5 = 0;
        v6 = (CHAR *)(v3 + 2);
        do
        {
          switch ( *((_DWORD *)v6 - 1) )
          {
            case 0:
              v7 = sub_4E3810(v6);
              goto LABEL_14;
            case 3:
              v7 = sub_5221A0(v6, *(char **)(a1 + 1100), *(_DWORD *)(a1 + 1104));
              goto LABEL_14;
            case 4:
              v7 = sub_5221A0(v6, *(char **)(a1 + 1108), *(_DWORD *)(a1 + 1112));
              goto LABEL_14;
            case 5:
              v7 = sub_5220E0(a1, v6);
LABEL_14:
              v5 = v7;
              break;
            default:
              break;
          }
          if ( v5 )
            sub_522300(a2, v5);
          v6 += 64;
          ++v8;
        }
        while ( v8 < v3[513] );
      }
    }
  }
}

//----- (005220E0) --------------------------------------------------------
_DWORD *__cdecl sub_5220E0(int a1, const char *a2)
{
  _DWORD *v3; // ebx
  char v4; // [esp+10h] [ebp+4h]

  if ( !*(_DWORD *)(a1 + 1096) )
    return 0;
  v3 = sub_4E3810((CHAR *)&byte_587000[254704]);
  if ( !v3 )
    return v3;
  if ( !strcmp((const char *)&byte_587000[254716], a2) )
  {
    v4 = *(_BYTE *)(a1 + 4 * sub_526AC0(0, *(_DWORD *)(a1 + 1096) - 1) + 548);
LABEL_6:
    sub_527DB0((int)v3, v4);
    return v3;
  }
  v4 = sub_51E1D0(a2);
  if ( v4 )
    goto LABEL_6;
  free(v3);
  return 0;
}

//----- (005221A0) --------------------------------------------------------
_DWORD *__cdecl sub_5221A0(char *a1, char *a2, int a3)
{
  signed int v3; // eax
  char *v4; // esi
  int i; // ecx
  char *v6; // eax
  _DWORD *v7; // ebp
  _DWORD *v8; // esi
  int v9; // ebx
  const char *v10; // edi
  int v11; // eax
  char v13[20]; // [esp+10h] [ebp-14h]

  if ( !strcmp((const char *)&byte_587000[254720], a1) )
  {
    v3 = sub_526AC0(0, a3 - 1);
    v4 = a2;
    for ( i = 0; v4; ++i )
    {
      if ( i == v3 )
        break;
      v4 = (char *)*((_DWORD *)v4 + 38);
    }
    v6 = v4 + 60;
  }
  else
  {
    v4 = a2;
    if ( !a2 )
      goto LABEL_11;
    while ( _strcmpi(v4, a1) )
    {
      v4 = (char *)*((_DWORD *)v4 + 38);
      if ( !v4 )
        goto LABEL_11;
    }
    v6 = v4 + 60;
    if ( !v4 )
LABEL_11:
      v6 = a1;
  }
  v7 = sub_4E3810(v6);
  if ( v7 && v4 )
  {
    v8 = v4 + 136;
    *(_DWORD *)v13 = 0;
    v9 = 0;
    *(_DWORD *)&v13[4] = 0;
    *(_DWORD *)&v13[8] = 0;
    *(_DWORD *)&v13[12] = 0;
    do
    {
      if ( *v8 )
      {
        if ( sub_526AC0(1, 100) <= *(_DWORD *)&byte_587000[v9 + 254688] )
        {
          v10 = (const char *)(*(v8 - 4) + 60 * sub_526AC0(0, *v8 - 1));
          if ( _strcmpi((const char *)&byte_587000[254724], v10) )
          {
            v11 = sub_413290(v10);
            *(_DWORD *)&v13[v9] = sub_413330(v11);
          }
        }
      }
      v9 += 4;
      ++v8;
    }
    while ( v9 < 16 );
    if ( !*(_DWORD *)&v13[8] )
      *(_DWORD *)&v13[12] = 0;
    sub_4E4990((int)v7, (int *)v13);
  }
  return v7;
}

//----- (00522300) --------------------------------------------------------
_DWORD *__cdecl sub_522300(int a1, _DWORD *a2)
{
  _DWORD *result; // eax
  int v3; // edx

  result = a2;
  a2[125] = 0;
  a2[124] = *(_DWORD *)(a1 + 504);
  v3 = *(_DWORD *)(a1 + 504);
  if ( v3 )
    *(_DWORD *)(v3 + 500) = a2;
  *(_DWORD *)(a1 + 504) = a2;
  a2[123] = a1;
  return result;
}

//----- (00522340) --------------------------------------------------------
void __cdecl sub_522340(int a1, int a2)
{
  int *i; // esi

  for ( i = *(int **)(*(_DWORD *)(a2 + 372) + 92); i; i = (int *)i[5] )
    sub_522370(a1, a2, i);
}

//----- (00522370) --------------------------------------------------------
void __cdecl sub_522370(int a1, int a2, int *a3)
{
  int *v3; // ebp
  signed int v4; // ecx
  int v5; // eax
  int v6; // edi
  _DWORD *v7; // ebx
  _DWORD *v8; // esi
  int v9; // eax
  int v10; // eax
  signed int v11; // esi
  int v12; // [esp+10h] [ebp-4h]
  signed int v13; // [esp+20h] [ebp+Ch]

  v3 = a3;
  if ( a3[2] )
  {
    v4 = sub_526AC0(*a3, a3[1]);
    v5 = a3[3];
    v13 = v4;
    if ( v4 > v5 )
    {
      v13 = v5;
      v4 = v5;
    }
    v6 = v3[2];
    v7 = (_DWORD *)v6;
    v12 = 1;
    *(_DWORD *)(v6 + 92) = 0;
    *(_DWORD *)(v6 + 96) = 0;
    v8 = *(_DWORD **)(v3[2] + 88);
    if ( v3[3] > 1 )
    {
      do
      {
        if ( sub_526AC0(1, 100) >= 50 )
        {
          if ( sub_526AC0(1, 100) >= 50 )
          {
            v7[23] = v8;
            v8[24] = v7;
            v8[23] = 0;
            v7 = v8;
          }
          else
          {
            v8[23] = v7;
            v8[24] = v7[24];
            v10 = v7[24];
            if ( v10 )
              *(_DWORD *)(v10 + 92) = v8;
            else
              v6 = (int)v8;
            v7[24] = v8;
          }
        }
        else if ( sub_526AC0(1, 100) >= 50 )
        {
          v9 = *(_DWORD *)(v6 + 92);
          if ( v9 )
          {
            *(_DWORD *)(v9 + 96) = v8;
            v8[24] = v6;
            v8[23] = *(_DWORD *)(v6 + 92);
          }
          else
          {
            v8[24] = v6;
            v8[23] = *(_DWORD *)(v6 + 92);
            v7 = v8;
          }
          *(_DWORD *)(v6 + 92) = v8;
        }
        else
        {
          v8[23] = v6;
          v8[24] = 0;
          *(_DWORD *)(v6 + 96) = v8;
          v6 = (int)v8;
        }
        v8 = (_DWORD *)v8[22];
        ++v12;
      }
      while ( v12 < v3[3] );
      v4 = v13;
    }
    if ( v4 )
    {
      v11 = v4;
      do
      {
        sub_5224B0(a1, a2, v6);
        v6 = *(_DWORD *)(v6 + 92);
        --v11;
      }
      while ( v11 );
    }
  }
}

//----- (005224B0) --------------------------------------------------------
float *__cdecl sub_5224B0(int a1, int a2, int a3)
{
  int v3; // esi
  float *v4; // ebp
  signed int v5; // edi
  signed int v6; // eax
  float *result; // eax
  int v8; // eax
  float *v9; // ebp
  int v10; // ebx
  int v11; // [esp+10h] [ebp-8h]
  int v12; // [esp+20h] [ebp+8h]
  signed int v13; // [esp+24h] [ebp+Ch]

  v3 = a3;
  if ( *(_DWORD *)(a3 + 64) )
  {
    v4 = (float *)a2;
    v5 = (__int64)((double)(int)(*(_DWORD *)(a2 + 12) * *(_DWORD *)(a2 + 16)) * *(float *)(a3 + 76));
    v6 = *(_DWORD *)(a3 + 68);
    if ( v5 < v6 || (v6 = *(_DWORD *)(a3 + 72), v5 > v6) )
      v5 = v6;
  }
  else
  {
    v4 = (float *)a2;
    v5 = sub_526AC0(*(_DWORD *)(a3 + 68), *(_DWORD *)(a3 + 72));
  }
  result = *(float **)a3;
  switch ( *(_DWORD *)a3 )
  {
    case 0:
      if ( v5 > 0 )
      {
        v12 = v5;
        do
        {
          v8 = sub_522810(v4, (char *)(a3 + 4));
          if ( v8 )
            sub_521FE0(a1, v8, *(_DWORD **)(a3 + 80));
          result = (float *)--v12;
        }
        while ( v12 );
      }
      break;
    case 1:
      result = (float *)sub_5268F0((const char *)(a3 + 4));
      v9 = result;
      if ( (int)result >= 0 && v5 > 0 )
      {
        v13 = v5;
        do
        {
          v10 = 0;
          do
          {
            if ( sub_521CB0(a1, a2, v3, (int)v9) )
              break;
            ++v10;
          }
          while ( v10 < 3 );
          result = (float *)--v13;
        }
        while ( v13 );
      }
      break;
    case 2:
      result = (float *)sub_521C10((int)v4);
      break;
    case 3:
      result = (float *)sub_5226D0((int)v4, 0.89999998, (int)&v11);
      if ( result )
      {
        result = (float *)sub_5221A0((char *)(a3 + 4), *(char **)(a1 + 1100), *(_DWORD *)(a1 + 1104));
        if ( result )
          result = sub_527A10(result, (float *)&v11);
      }
      break;
    case 4:
      result = (float *)sub_5226D0((int)v4, 0.89999998, (int)&v11);
      if ( result )
      {
        result = (float *)sub_5221A0((char *)(a3 + 4), *(char **)(a1 + 1108), *(_DWORD *)(a1 + 1112));
        if ( result )
          result = sub_527A10(result, (float *)&v11);
      }
      break;
    case 5:
      result = (float *)sub_5226D0((int)v4, 0.89999998, (int)&v11);
      if ( result )
      {
        result = (float *)sub_5220E0(a1, (const char *)(a3 + 4));
        if ( result )
          result = sub_527A10(result, (float *)&v11);
      }
      break;
    default:
      return result;
  }
  return result;
}

//----- (005226D0) --------------------------------------------------------
int __cdecl sub_5226D0(int a1, float a2, int a3)
{
  float *v3; // esi
  double v4; // st7
  float v6; // [esp+10h] [ebp-18h]
  float v7; // [esp+14h] [ebp-14h]
  float v8; // [esp+18h] [ebp-10h]
  float v9; // [esp+1Ch] [ebp-Ch]
  float v10; // [esp+20h] [ebp-8h]
  float v11; // [esp+24h] [ebp-4h]
  int v12; // [esp+2Ch] [ebp+4h]

  v3 = (float *)a1;
  v4 = *(float *)(a1 + 36) + *(float *)(a1 + 44);
  v12 = 0;
  v10 = v4 * 0.5;
  v11 = (v3[10] + v3[12]) * 0.5;
  v8 = (v3[11] - v3[9]) * 0.5;
  v9 = (v3[12] - v3[10]) * 0.5;
  while ( 1 )
  {
    v6 = -v8;
    *(float *)a3 = sub_526BC0(v6, v8) * a2 + v10;
    v7 = -v9;
    *(float *)(a3 + 4) = sub_526BC0(v7, v9) * a2 + v11;
    if ( !sub_5227B0((int)v3, (float *)a3) )
      break;
    if ( ++v12 >= 10 )
      return 0;
  }
  return 1;
}

//----- (005227B0) --------------------------------------------------------
int __cdecl sub_5227B0(int a1, float *a2)
{
  int v2; // ecx

  v2 = *(_DWORD *)(a1 + 368);
  if ( !v2 )
    return 0;
  while ( *a2 < (double)*(float *)(v2 + 4)
       || *a2 > (double)*(float *)(v2 + 12)
       || a2[1] < (double)*(float *)(v2 + 8)
       || a2[1] > (double)*(float *)(v2 + 16) )
  {
    v2 = *(_DWORD *)(v2 + 24);
    if ( !v2 )
      return 0;
  }
  return 1;
}

//----- (00522810) --------------------------------------------------------
int __cdecl sub_522810(float *a1, char *a2)
{
  int result; // eax
  float *v3; // eax
  int v4; // esi
  int v5; // eax
  int v6; // eax
  float v7; // [esp+0h] [ebp-18h]
  float v8; // [esp+4h] [ebp-14h]
  float2 v9; // [esp+8h] [ebp-10h]
  float2 v11; // [esp+10h] [ebp-8h]

  v7 = (a1[11] + a1[9]) * 0.5;
  v8 = (a1[12] + a1[10]) * 0.5;
  result = sub_5226D0((int)a1, 0.94999999, &v9);
  if ( result )
  {
    sub_527940(a2);
    v3 = sub_5279B0(&v9);
    v4 = (int)v3;
    if ( v3 )
    {
      if ( (_BYTE)v3[2] & 2 )
      {
        v11.field_0 = v7 - v9.field_0;
        v11.field_4 = v8 - v9.field_4;
        v5 = sub_509ED0(&v11);
        v6 = sub_509EA0(v5);
        sub_527C60(v4, v6);
      }
    }
    result = v4;
  }
  return result;
}

//----- (005228B0) --------------------------------------------------------
void __cdecl sub_5228B0(int a1)
{
  wchar_t *v1; // eax
  wchar_t *v2; // eax
  wchar_t *v3; // eax
  int i; // ebp
  int j; // esi
  float *v6; // eax
  float v8; // [esp+8h] [ebp-8h]
  float v9; // [esp+Ch] [ebp-4h]

  sub_5235F0(157);
  if ( !sub_522A40(a1) )
  {
    v1 = sub_40F1D0((char *)&byte_587000[254784], 0, (const char *)&byte_587000[254732], 848);
    sub_4D9FD0(0, v1);
    v2 = sub_40F1D0((char *)&byte_587000[254844], 0, (const char *)&byte_587000[254792], 849);
    sub_4D9FD0(0, v2);
    v3 = sub_40F1D0((char *)&byte_587000[254904], 0, (const char *)&byte_587000[254852], 850);
    sub_4D9FD0(0, v3);
  }
  sub_5259D0();
  for ( i = sub_4D42C0(); i; i = *(_DWORD *)(i + 64) )
  {
    sub_5235F0(157);
    if ( *(_DWORD *)(i + 372) && !(*(_BYTE *)(i + 52) & 2) )
      sub_522340(a1, i);
    if ( *(_DWORD *)(a1 + 60) )
    {
      for ( j = *(_DWORD *)(i + 368); j; j = *(_DWORD *)(j + 24) )
      {
        if ( *(_DWORD *)j )
          sub_51D4D0((char *)&byte_587000[254924]);
        else
          sub_51D4D0((char *)&byte_587000[254912]);
        sub_5245A0(
          a1,
          (float *)(j + 4),
          (__int64)((*(float *)(j + 12) - *(float *)(j + 4) + 0.5) * 0.030743772),
          (__int64)((*(float *)(j + 16) - *(float *)(j + 8) + 0.5) * 0.030743772));
      }
    }
  }
  v6 = (float *)sub_4D42C0();
  v8 = (v6[11] + v6[9]) * 0.5;
  v9 = (v6[12] + v6[10]) * 0.5;
  sub_527940((char *)&byte_587000[254936]);
  sub_5279B0(&v8);
  sub_469B90((int *)(a1 + 536));
  sub_526A90();
}

//----- (00522A40) --------------------------------------------------------
int __cdecl sub_522A40(int a1)
{
  int v2; // ebx
  int v3; // edi
  int v4; // esi
  float *v5; // eax

  if ( !*(_DWORD *)(a1 + 472) )
    return 1;
  v2 = sub_5259E0();
  if ( !v2 )
    return 0;
  while ( 1 )
  {
    if ( *(_DWORD *)v2 == 1 )
    {
      v3 = 0;
      if ( *(_DWORD *)(a1 + 472) > 0 )
        break;
    }
LABEL_9:
    v2 = *(_DWORD *)(v2 + 68);
    if ( !v2 )
      return 0;
  }
  v4 = a1 + 216;
  while ( 1 )
  {
    v5 = sub_522AD0((float *)v2, v4);
    if ( v5 )
      break;
    ++v3;
    v4 += 64;
    if ( v3 >= *(int *)(a1 + 472) )
      goto LABEL_9;
  }
  sub_527D50((int)v5, (char *)(a1 + 476));
  return 1;
}

//----- (00522AD0) --------------------------------------------------------
float *__cdecl sub_522AD0(float *a1, int a2)
{
  int v2; // eax
  double v4; // st7
  double v5; // st7
  float *v6; // ebx
  double v7; // st7
  float a3; // [esp+0h] [ebp-34h]
  float a4; // [esp+4h] [ebp-30h]
  int2 a2a; // [esp+14h] [ebp-20h]
  float2 a1a; // [esp+1Ch] [ebp-18h]
  float v13; // [esp+24h] [ebp-10h]
  float v14; // [esp+28h] [ebp-Ch]
  float2 v15; // [esp+2Ch] [ebp-8h]

  v2 = *(_DWORD *)(a2 + 60);
  if ( *((_BYTE *)a1 + v2 + 216) )
    return 0;
  switch ( v2 )
  {
    case 0:
      a1a.field_0 = a1[7] * 0.5 + a1[9] + 1.0;
      v4 = a1[10] + 10.0;
      goto LABEL_9;
    case 1:
      a1a.field_0 = a1[7] * 0.5 + a1[9] + 1.0;
      v4 = a1[12] - 10.0;
      goto LABEL_9;
    case 2:
      v5 = a1[11] - 10.0;
      goto LABEL_8;
    case 3:
      v5 = a1[9] + 10.0;
LABEL_8:
      a1a.field_0 = v5;
      v4 = a1[8] * 0.5 + a1[10] + 1.0;
LABEL_9:
      a1a.field_4 = v4;
      break;
    default:
      break;
  }
  sub_527940((char *)a2);
  v6 = sub_5279B0(&a1a);
  if ( v6 )
  {
    sub_520DF0(&a1a, &a2a);
    switch ( *(_DWORD *)(a2 + 60) )
    {
      case 0:
        v13 = 3.0;
        v7 = 2.0;
        --a2a.field_0;
        break;
      case 1:
        v7 = 2.0;
        --a2a.field_0;
        a2a.field_4 -= 2;
        v13 = 3.0;
        break;
      case 2:
        a2a.field_0 -= 2;
        goto LABEL_15;
      case 3:
LABEL_15:
        v13 = 2.0;
        v7 = 3.0;
        --a2a.field_4;
        break;
      default:
        v7 = v14;
        break;
    }
    v15.field_0 = (double)a2a.field_0 * 32.526913;
    v15.field_4 = (double)a2a.field_4 * 32.526913;
    a4 = v7 * 32.526913;
    a3 = v13 * 32.526913;
    sub_521BC0((int)a1, &v15, a3, a4);
  }
  return v6;
}

//----- (00522C80) --------------------------------------------------------
float *__cdecl sub_522C80(float *a1)
{
  float *result; // eax

  result = sub_51D1A0((float2 *)a1);
  if ( !result )
    result = (float *)sub_51D120(a1);
  return result;
}

//----- (00522CA0) --------------------------------------------------------
char __cdecl sub_522CA0(int a1, float *a2)
{
  int v2; // eax
  int v3; // ebx
  float *v4; // esi
  int v5; // edx

  LOBYTE(v2) = *(_BYTE *)(a1 + 352);
  if ( (unsigned __int8)v2 < 0x10u )
  {
    v3 = 0;
    if ( (_BYTE)v2 )
    {
      v4 = (float *)(a1 + 228);
      while ( 1 )
      {
        if ( sub_524660(*(v4 - 1), *a2) )
        {
          v2 = sub_524660(*v4, a2[1]);
          if ( v2 )
            break;
        }
        ++v3;
        v4 += 2;
        if ( v3 >= *(unsigned __int8 *)(a1 + 352) )
          goto LABEL_7;
      }
    }
    else
    {
LABEL_7:
      v5 = *(unsigned __int8 *)(a1 + 352);
      *(float *)(a1 + 8 * v5 + 224) = *a2;
      *(float *)(a1 + 8 * v5 + 228) = a2[1];
      LOBYTE(v2) = *(_BYTE *)(a1 + 352) + 1;
      *(_BYTE *)(a1 + 352) = v2;
    }
  }
  return v2;
}

//----- (00522D30) --------------------------------------------------------
float *__cdecl sub_522D30(int a1)
{
  float *result; // eax
  float *i; // esi
  int *v3; // edi
  int v4; // ebx
  int v5; // ebp
  float **v6; // ebx
  int v7; // edi
  int v8; // ebp
  int v9; // [esp+4h] [ebp-14h]
  int v10; // [esp+4h] [ebp-14h]
  float2 v11; // [esp+8h] [ebp-10h]
  float2 v12; // [esp+10h] [ebp-8h]

  sub_51D0F0(128);
  result = (float *)sub_521710();
  for ( i = result; result; i = result )
  {
    sub_5235F0(156);
    if ( *(_DWORD *)i == 1 )
    {
      v3 = (int *)(i + 22);
      v4 = 0;
      v9 = (int)(i + 22);
      do
      {
        v5 = 0;
        if ( *((_BYTE *)i + v4 + 216) )
        {
          do
          {
            if ( sub_5238F0((int *)*v3) && sub_523920(*(_DWORD *)*v3) == v4 )
            {
              sub_523CB0(*v3, (int)&v12);
              sub_522CA0((int)i, &v12.field_0);
              sub_523D30((float *)*v3, &v11.field_0);
              sub_522C80(&v12.field_0);
              sub_522C80(&v11.field_0);
              sub_51D3F0(&v12, &v11);
              if ( !*(_DWORD *)(a1 + 60) )
                sub_51D3F0(&v11, &v12);
            }
            ++v5;
            ++v3;
          }
          while ( v5 < *((unsigned __int8 *)i + v4 + 216) );
        }
        ++v4;
        v3 = (int *)(v9 + 32);
        v9 += 32;
      }
      while ( v4 < 4 );
    }
    else
    {
      sub_523D30(i, &v12.field_0);
      v6 = (float **)(i + 22);
      v7 = 0;
      v10 = (int)(i + 22);
      do
      {
        if ( !sub_521AA0(i, v7) )
        {
          v8 = 0;
          if ( *((_BYTE *)i + v7 + 216) )
          {
            do
            {
              if ( sub_5238F0((int *)*v6) )
              {
                sub_523D30(*v6, &v11.field_0);
              }
              else
              {
                sub_523C30((int)i, (int)&v11);
                sub_522CA0((int)*v6, &v11.field_0);
              }
              sub_522C80(&v12.field_0);
              sub_522C80(&v11.field_0);
              sub_51D3F0(&v12, &v11);
              if ( !*(_DWORD *)(a1 + 60) )
                sub_51D3F0(&v11, &v12);
              ++v8;
              ++v6;
            }
            while ( v8 < *((unsigned __int8 *)i + v7 + 216) );
          }
        }
        ++v7;
        v6 = (float **)(v10 + 32);
        v10 += 32;
      }
      while ( v7 < 4 );
    }
    result = (float *)sub_521720((int)i);
  }
  return result;
}

//----- (00522F40) --------------------------------------------------------
unsigned __int8 *__cdecl sub_522F40(_DWORD *a1)
{
  unsigned __int8 *result; // eax
  unsigned __int8 *i; // edi
  int v3; // eax
  int v4; // ebp
  int v5; // esi
  float2 *v6; // ebx
  float2 *v7; // [esp+8h] [ebp+4h]

  result = (unsigned __int8 *)a1;
  if ( !a1[15] )
  {
    result = (unsigned __int8 *)sub_521710();
    for ( i = result; result; i = result )
    {
      if ( *(_DWORD *)i == 1 )
      {
        sub_5235F0(156);
        v3 = i[352];
        v4 = 0;
        if ( v3 > 0 )
        {
          v7 = (float2 *)(i + 224);
          do
          {
            v5 = 0;
            if ( v3 > 0 )
            {
              v6 = (float2 *)(i + 224);
              do
              {
                if ( v4 != v5 )
                  sub_51D3F0(v7, v6);
                ++v5;
                ++v6;
              }
              while ( v5 < i[352] );
            }
            v3 = i[352];
            ++v4;
            ++v7;
          }
          while ( v4 < v3 );
        }
      }
      result = (unsigned __int8 *)sub_521720((int)i);
    }
  }
  return result;
}

//----- (00522FF0) --------------------------------------------------------
int __cdecl sub_522FF0(char a1, float2 *a2)
{
  __int16 v2; // ax
  float v3; // edx
  char a2a[5]; // [esp+4h] [ebp-8h]

  a2a[0] = a1;
  v2 = sub_419A70(a2->field_0);
  v3 = a2->field_4;
  *(_WORD *)&a2a[1] = v2;
  *(_WORD *)&a2a[3] = sub_419A70(v3);
  return sub_523030(a2, a2a, 5);
}

//----- (00523030) --------------------------------------------------------
int __cdecl sub_523030(float2 *a1, const void *a2, int a3)
{
  int result; // eax
  int i; // esi
  int v5; // ecx
  int v6; // eax
  float v7; // edx
  float v8; // eax
  double v9; // st7
  double v10; // st7
  double v11; // st6
  float v12; // [esp+4h] [ebp-18h]
  float v13; // [esp+Ch] [ebp-10h]
  float v14; // [esp+10h] [ebp-Ch]
  float v15; // [esp+18h] [ebp-4h]

  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    v5 = *(_DWORD *)(*(_DWORD *)(i + 748) + 276);
    if ( *(_BYTE *)(v5 + 3680) & 3 && (v6 = *(_DWORD *)(v5 + 3628)) != 0 )
    {
      v7 = *(float *)(v6 + 56);
      v8 = *(float *)(v6 + 60);
      v12 = v7;
    }
    else
    {
      v8 = *(float *)(i + 60);
      v12 = *(float *)(i + 56);
    }
    v9 = (double)*(unsigned __int16 *)(v5 + 10);
    v13 = v12 - v9 - 50.0;
    v10 = v9 + v12 + 50.0;
    v11 = (double)*(unsigned __int16 *)(v5 + 12);
    if ( a1->field_0 > (double)v13 && v10 > a1->field_0 )
    {
      v14 = v8 - v11 - 50.0;
      if ( a1->field_4 > (double)v14 )
      {
        v15 = v11 + v8 + 50.0;
        if ( a1->field_4 < (double)v15 )
          sub_40EBC0(*(unsigned __int8 *)(v5 + 2064), 1, a2, a3);
      }
    }
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (00523150) --------------------------------------------------------
int __cdecl sub_523150(char a1, char a2, float *a3)
{
  char v4[6]; // [esp+4h] [ebp-8h]

  v4[0] = a1;
  v4[1] = a2;
  *(_WORD *)&v4[2] = sub_419A70(*a3);
  *(_WORD *)&v4[4] = sub_419A70(a3[1]);
  return sub_523030((float2 *)a3, v4, 6);
}

//----- (005231B0) --------------------------------------------------------
int __cdecl sub_5231B0(float *a1, char a2)
{
  __int16 v2; // ax
  float v3; // ecx
  char v5[6]; // [esp+4h] [ebp-8h]

  v5[0] = -109;
  v2 = sub_419A70(*a1);
  v3 = a1[1];
  *(_WORD *)&v5[1] = v2;
  *(_WORD *)&v5[3] = sub_419A70(v3);
  v5[5] = a2;
  return sub_523030((float2 *)a1, v5, 6);
}

//----- (00523200) --------------------------------------------------------
int __cdecl sub_523200(float *a1, char a2)
{
  __int16 v2; // ax
  float v3; // ecx
  char v5[7]; // [esp+4h] [ebp-8h]

  v5[0] = -16;
  v5[1] = 25;
  v2 = sub_419A70(*a1);
  v3 = a1[1];
  *(_WORD *)&v5[2] = v2;
  *(_WORD *)&v5[4] = sub_419A70(v3);
  v5[6] = a2;
  return sub_523030((float2 *)a1, v5, 7);
}

//----- (00523250) --------------------------------------------------------
int __cdecl sub_523250(int a1)
{
  return sub_5232F0(148, a1);
}

//----- (00523270) --------------------------------------------------------
int __cdecl sub_523270(char a1, __int16 *a2, __int16 a3)
{
  __int16 v3; // dx
  unsigned __int16 v4; // cx
  unsigned __int16 v5; // ax
  float2 a1a; // [esp+0h] [ebp-14h]
  char a2a[11]; // [esp+8h] [ebp-Ch]

  a2a[0] = a1;
  v3 = a2[2];
  *(_WORD *)&a2a[1] = *a2;
  v4 = a2[4];
  v5 = a2[6];
  *(_WORD *)&a2a[3] = v3;
  *(_WORD *)&a2a[5] = v4;
  *(_WORD *)&a2a[7] = v5;
  a1a.field_0 = (double)v4;
  *(_WORD *)&a2a[9] = a3;
  a1a.field_4 = (double)v5;
  return sub_523030(&a1a, a2a, 11);
}

//----- (005232F0) --------------------------------------------------------
int __cdecl sub_5232F0(char a1, int a2)
{
  __int16 v2; // dx
  char v4[9]; // [esp+0h] [ebp-Ch]

  v4[0] = a1;
  v2 = *(_WORD *)(a2 + 4);
  *(_WORD *)&v4[1] = *(_WORD *)a2;
  *(_WORD *)&v4[5] = *(_WORD *)(a2 + 8);
  *(_WORD *)&v4[3] = v2;
  *(_WORD *)&v4[7] = *(_WORD *)(a2 + 12);
  return sub_523340((int *)a2, v4, 9);
}

//----- (00523340) --------------------------------------------------------
int __cdecl sub_523340(int *a1, const void *a2, int a3)
{
  int result; // eax
  int i; // esi
  int v5; // edx
  int v6; // eax
  float v7; // ecx
  float v8; // eax
  double v9; // st7
  char v10; // bl
  double v11; // st7
  double v12; // st6
  double v13; // st6
  double v14; // st6
  double v15; // st6
  char v16; // cl
  double v17; // st6
  float v18; // [esp+8h] [ebp-28h]
  int v19; // [esp+10h] [ebp-20h]
  int v20; // [esp+14h] [ebp-1Ch]
  int v21; // [esp+18h] [ebp-18h]
  int v22; // [esp+1Ch] [ebp-14h]
  float v23; // [esp+20h] [ebp-10h]
  float v24; // [esp+24h] [ebp-Ch]
  float v25; // [esp+2Ch] [ebp-4h]

  if ( *a1 >= a1[2] )
  {
    v19 = a1[2];
    v21 = *a1;
  }
  else
  {
    v19 = *a1;
    v21 = a1[2];
  }
  if ( a1[1] >= a1[3] )
  {
    v20 = a1[3];
    v22 = a1[1];
  }
  else
  {
    v20 = a1[1];
    v22 = a1[3];
  }
  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    v5 = *(_DWORD *)(*(_DWORD *)(i + 748) + 276);
    if ( *(_BYTE *)(v5 + 3680) & 3 && (v6 = *(_DWORD *)(v5 + 3628)) != 0 )
    {
      v7 = *(float *)(v6 + 56);
      v8 = *(float *)(v6 + 60);
      v18 = v7;
    }
    else
    {
      v8 = *(float *)(i + 60);
      v18 = *(float *)(i + 56);
    }
    v9 = (double)*(unsigned __int16 *)(v5 + 10);
    v10 = 0;
    v23 = v18 - v9 - 50.0;
    v11 = v9 + v18 + 50.0;
    v12 = (double)*(unsigned __int16 *)(v5 + 12);
    v24 = v8 - v12 - 50.0;
    v25 = v12 + v8 + 50.0;
    v13 = (double)*a1;
    if ( v13 >= v23 )
    {
      if ( v13 > v11 )
        v10 = 8;
    }
    else
    {
      v10 = 4;
    }
    v14 = (double)a1[1];
    if ( v14 >= v24 )
    {
      if ( v14 > v25 )
        v10 |= 2u;
    }
    else
    {
      v10 |= 1u;
    }
    v15 = (double)a1[2];
    v16 = 0;
    if ( v15 >= v23 )
    {
      if ( v15 > v11 )
        v16 = 8;
    }
    else
    {
      v16 = 4;
    }
    v17 = (double)a1[3];
    if ( v17 >= v24 )
    {
      if ( v17 > v25 )
        v16 |= 2u;
    }
    else
    {
      v16 |= 1u;
    }
    if ( !((unsigned __int8)v16 & (unsigned __int8)v10)
      && (double)v19 <= v11
      && (double)v21 >= v23
      && (double)v20 <= v25
      && (double)v22 >= v24 )
    {
      sub_40EBC0(*(unsigned __int8 *)(v5 + 2064), 1, a2, a3);
    }
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (00523530) --------------------------------------------------------
int __cdecl sub_523530(int a1)
{
  __int16 v1; // ax
  double v2; // st7
  __int64 v3; // rax
  double v4; // st7
  __int64 v5; // rax
  double v6; // st7
  __int16 v7; // cx
  __int64 v8; // rax
  double v9; // st7
  __int64 v10; // rax
  double v11; // st7
  int result; // eax
  int i; // esi
  char v14[14]; // [esp+4h] [ebp-10h]

  v14[0] = -75;
  v1 = sub_578AC0((_DWORD *)a1);
  v2 = *(float *)(a1 + 56);
  *(_WORD *)&v14[1] = v1;
  *(_WORD *)&v14[3] = *(_WORD *)(a1 + 4);
  v3 = (__int64)v2;
  v4 = *(float *)(a1 + 60);
  *(_WORD *)&v14[5] = v3;
  v5 = (__int64)v4;
  v6 = *(float *)(a1 + 112) * 16.0;
  v7 = *(_WORD *)(a1 + 124);
  *(_WORD *)&v14[7] = v5;
  *(_WORD *)&v14[9] = v7;
  v8 = (__int64)v6;
  v9 = *(float *)(a1 + 80) * 16.0;
  v14[11] = v8;
  v10 = (__int64)v9;
  v11 = *(float *)(a1 + 84) * 16.0;
  v14[12] = v10;
  v14[13] = (__int64)v11;
  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064), 1, v14, 14);
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (005235F0) --------------------------------------------------------
int __cdecl sub_5235F0(char a1)
{
  int result; // eax
  int v3; // [esp+0h] [ebp-4h]

  result = sub_40A5C0(0x200000);
  if ( !result )
  {
    *(_DWORD *)&byte_5D4594[2487564] = clock();
    if ( *(_DWORD *)&byte_5D4594[2487568] > *(int *)&byte_5D4594[2487564] )
      *(_DWORD *)&byte_5D4594[2487568] = 0;
    sub_4453A0();
    result = *(_DWORD *)&byte_5D4594[2487564] - *(_DWORD *)&byte_5D4594[2487568];
    if ( *(_DWORD *)&byte_5D4594[2487564] - *(_DWORD *)&byte_5D4594[2487568] > *(int *)&byte_587000[254948] )
    {
      *(_WORD *)((char *)&v3 + 1) = *(_WORD *)&byte_5D4594[2487572];
      LOBYTE(v3) = a1;
      ++*(_DWORD *)&byte_5D4594[2487572];
      sub_4A9D00((unsigned __int8 *)&v3);
      result = *(_DWORD *)&byte_5D4594[2487564];
      *(_DWORD *)&byte_5D4594[2487568] = *(_DWORD *)&byte_5D4594[2487564];
    }
  }
  return result;
}

//----- (00523670) --------------------------------------------------------
int __cdecl sub_523670(int a1, float *a2)
{
  char v2; // al
  int v3; // eax
  char v5[4]; // [esp+4h] [ebp-Ch]
  float2 v6; // [esp+8h] [ebp-8h]

  v5[0] = -128;
  *(_WORD *)&v5[1] = sub_578AC0((_DWORD *)a1);
  if ( a2 )
  {
    v6.field_0 = *(float *)(a1 + 56) - *a2;
    v6.field_4 = *(float *)(a1 + 60) - a2[1];
    v3 = sub_509ED0(&v6);
    v2 = sub_509EA0(v3);
  }
  else
  {
    v2 = sub_509EA0(*(__int16 *)(a1 + 124));
  }
  v5[3] = v2;
  return sub_523030((float2 *)(a1 + 56), v5, 4);
}

//----- (005236F0) --------------------------------------------------------
int __cdecl sub_5236F0(__int16 a1, float *a2, char a3, __int16 a4, __int16 a5)
{
  double v5; // st7
  __int64 v6; // rax
  double v7; // st7
  char v9[12]; // [esp+4h] [ebp-Ch]

  v9[0] = 126;
  *(_WORD *)&v9[5] = a1;
  *(_WORD *)&v9[7] = a4;
  v5 = *a2;
  v9[9] = a3;
  v6 = (__int64)v5;
  v7 = a2[1];
  *(_WORD *)&v9[1] = v6;
  *(_WORD *)&v9[3] = (__int64)v7;
  *(_WORD *)&v9[10] = a5;
  return sub_4E5420(255, v9, 12, 0, 1);
}

//----- (00523760) --------------------------------------------------------
int __cdecl sub_523760(__int16 a1)
{
  int v1; // ecx
  char v3[3]; // [esp+0h] [ebp-4h]
  char v4; // [esp+3h] [ebp-1h]

  v4 = HIBYTE(v1);
  v3[0] = 127;
  *(_WORD *)&v3[1] = a1;
  return sub_4E5420(255, v3, 3, 0, 1);
}

//----- (00523790) --------------------------------------------------------
int __cdecl sub_523790(int4 *a1, __int16 a2)
{
  int4 *v2; // eax
  int v3; // ecx
  double v4; // st7
  __int16 v5; // dx
  int v7; // [esp+0h] [ebp-18h]
  float2 a1a; // [esp+4h] [ebp-14h]
  char a2a[11]; // [esp+Ch] [ebp-Ch]
  int4 *v10; // [esp+1Ch] [ebp+4h]

  v2 = a1;
  a2a[0] = -104;
  v7 = a1->field_0;
  v3 = a1->field_4;
  v4 = (double)(a1->field_8 - a1->field_0);
  v10 = (int4 *)(a1->field_C - v3);
  *(_WORD *)&a2a[3] = v2->field_4;
  v5 = v2->field_C;
  *(_WORD *)&a2a[1] = v2->field_0;
  *(_WORD *)&a2a[5] = v2->field_8;
  *(_WORD *)&a2a[7] = v5;
  *(_WORD *)&a2a[9] = a2;
  a1a.field_0 = v4 * 0.5 + (double)v7;
  a1a.field_4 = (double)(int)v10 * 0.5 + (double)v3;
  return sub_523030(&a1a, a2a, 11);
}

//----- (00523830) --------------------------------------------------------
int __cdecl sub_523830(int4 *a1, __int16 a2)
{
  double v2; // st7
  __int16 v3; // cx
  __int16 v4; // dx
  double v5; // st7
  __int16 v6; // cx
  float2 a1a; // [esp+0h] [ebp-14h]
  char a2a[12]; // [esp+8h] [ebp-Ch]

  a2a[0] = -16;
  a2a[1] = 16;
  v2 = (double)a1->field_8;
  v3 = a1->field_0;
  *(_WORD *)&a2a[4] = a1->field_4;
  v4 = a1->field_C;
  a1a.field_0 = v2;
  v5 = (double)a1->field_C;
  *(_WORD *)&a2a[2] = v3;
  v6 = a1->field_8;
  *(_WORD *)&a2a[8] = v4;
  *(_WORD *)&a2a[6] = v6;
  a1a.field_4 = v5;
  *(_WORD *)&a2a[10] = a2;
  return sub_523030(&a1a, a2a, 12);
}

//----- (005238A0) --------------------------------------------------------
int __cdecl sub_5238A0(float *a1, char a2)
{
  __int16 v2; // ax
  float v3; // ecx
  char v5[6]; // [esp+4h] [ebp-8h]

  v5[0] = -95;
  v2 = sub_419A90(*a1);
  v3 = a1[1];
  *(_WORD *)&v5[1] = v2;
  *(_WORD *)&v5[3] = sub_419A90(v3);
  v5[5] = a2;
  return sub_523030((float2 *)a1, v5, 6);
}

//----- (005238F0) --------------------------------------------------------
BOOL __cdecl sub_5238F0(int *a1)
{
  int v1; // eax

  v1 = *a1;
  return *a1 == 2 || v1 == 3 || v1 == 4 || v1 == 5;
}

//----- (00523920) --------------------------------------------------------
int __cdecl sub_523920(int a1)
{
  switch ( a1 )
  {
    case 2:
      return 0;
    case 3:
      return 1;
    case 4:
      return 2;
  }
  return a1 != 5 ? 0 : 3;
}

//----- (00523960) --------------------------------------------------------
int __cdecl sub_523960(int a1)
{
  return *(_DWORD *)&byte_587000[4 * a1 + 254952];
}

//----- (00523970) --------------------------------------------------------
int __cdecl sub_523970(int a1)
{
  int result; // eax

  switch ( a1 )
  {
    case 2:
      result = 3;
      break;
    case 3:
      result = 2;
      break;
    case 5:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (005239B0) --------------------------------------------------------
int __cdecl sub_5239B0(int a1)
{
  int v1; // eax

  v1 = sub_523970(a1);
  return sub_523960(v1);
}

//----- (005239D0) --------------------------------------------------------
int __cdecl sub_5239D0(int a1)
{
  int result; // eax

  switch ( a1 )
  {
    case 2:
      result = 3;
      break;
    case 3:
      result = 2;
      break;
    case 4:
      result = 5;
      break;
    case 5:
      result = 4;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (005239EF) --------------------------------------------------------
int sub_5239EF()
{
  return 5;
}

//----- (005239F5) --------------------------------------------------------
int sub_5239F5()
{
  return 4;
}

//----- (00523A10) --------------------------------------------------------
BOOL __cdecl sub_523A10(int a1, float *a2)
{
  double v2; // st7
  int v3; // eax
  double v4; // st6
  int v5; // eax
  float v7; // ecx
  int v8; // eax
  double v9; // st7
  int v10; // eax
  float v11; // ecx
  int v12; // eax
  double v13; // st7
  int v14; // eax
  double v15; // st7
  int v16; // eax
  double v17; // st6
  int v18; // eax
  float2 v19;

  switch ( *(_DWORD *)a1 )
  {
    case 2:
      if ( *(float *)(a1 + 36) < (double)a2[9] || *(float *)(a1 + 44) > (double)a2[11] )
        return 0;
      v2 = *(float *)(a1 + 24);
      v19.field_0 = *(float *)(a1 + 20);
      v3 = *(_DWORD *)(a1 + 16);
      v19.field_4 = v2;
      if ( v3 > 1 )
      {
        do
        {
          v2 = v2 + 32.526913;
          v4 = *(float *)(a1 + 32) - 32.526913;
          v5 = *(_DWORD *)(a1 + 16) - 1;
          *(_DWORD *)(a1 + 16) = v5;
          *(float *)(a1 + 32) = v4;
        }
        while ( v2 + 0.1 <= a2[12] && v5 > 1 );
        v19.field_4 = v2;
      }
      goto LABEL_27;
    case 3:
      if ( *(float *)(a1 + 36) < (double)a2[9] || *(float *)(a1 + 44) > (double)a2[11] )
        return 0;
      v7 = *(float *)(a1 + 24);
      v19.field_0 = *(float *)(a1 + 20);
      v8 = *(_DWORD *)(a1 + 16);
      v19.field_4 = v7;
      if ( v8 <= 1 )
        goto LABEL_20;
      break;
    case 4:
      if ( *(float *)(a1 + 40) < (double)a2[10] || *(float *)(a1 + 48) > (double)a2[12] )
        return 0;
      v11 = *(float *)(a1 + 24);
      v19.field_0 = *(float *)(a1 + 20);
      v12 = *(_DWORD *)(a1 + 12);
      v19.field_4 = v11;
      if ( v12 > 1 )
      {
        do
        {
          v13 = *(float *)(a1 + 28) - 32.526913;
          v14 = *(_DWORD *)(a1 + 12) - 1;
          *(_DWORD *)(a1 + 12) = v14;
          *(float *)(a1 + 28) = v13;
        }
        while ( v13 + v19.field_0 - 0.1 >= a2[9] && v14 > 1 );
      }
      goto LABEL_20;
    case 5:
      if ( *(float *)(a1 + 40) < (double)a2[10] || *(float *)(a1 + 48) > (double)a2[12] )
        return 0;
      v15 = *(float *)(a1 + 20);
      v19.field_4 = *(float *)(a1 + 24);
      v16 = *(_DWORD *)(a1 + 12);
      v19.field_0 = v15;
      if ( v16 > 1 )
      {
        do
        {
          v15 = v15 + 32.526913;
          v17 = *(float *)(a1 + 28) - 32.526913;
          v18 = *(_DWORD *)(a1 + 12) - 1;
          *(_DWORD *)(a1 + 12) = v18;
          *(float *)(a1 + 28) = v17;
        }
        while ( v15 + 0.1 <= a2[11] && v18 > 1 );
        v19.field_0 = v15;
      }
LABEL_27:
      sub_521880((_DWORD *)a1, &v19);
      return sub_521200(a1) == 0;
    default:
      return sub_521200(a1) == 0;
  }
  while ( 1 )
  {
    v9 = *(float *)(a1 + 32) - 32.526913;
    v10 = *(_DWORD *)(a1 + 16) - 1;
    *(_DWORD *)(a1 + 16) = v10;
    *(float *)(a1 + 32) = v9;
    if ( v9 + v19.field_4 - 0.1 < a2[10] )
      break;
    if ( v10 <= 1 )
    {
      sub_521880((_DWORD *)a1, &v19);
      return sub_521200(a1) == 0;
    }
  }
LABEL_20:
  sub_521880((_DWORD *)a1, &v19);
  return sub_521200(a1) == 0;
}

//----- (00523C30) --------------------------------------------------------
int __cdecl sub_523C30(int a1, int a2)
{
  int result; // eax
  int v3; // edx

  result = a1;
  switch ( *(_DWORD *)a1 )
  {
    case 2:
      *(float *)a2 = (*(float *)(a1 + 44) + *(float *)(a1 + 36)) * 0.5;
      result = *(_DWORD *)(a1 + 40);
      *(_DWORD *)(a2 + 4) = result;
      break;
    case 3:
      *(float *)a2 = (*(float *)(a1 + 44) + *(float *)(a1 + 36)) * 0.5;
      *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 48);
      break;
    case 4:
      v3 = *(_DWORD *)(a1 + 44);
      goto LABEL_6;
    case 5:
      v3 = *(_DWORD *)(a1 + 36);
LABEL_6:
      *(_DWORD *)a2 = v3;
      *(float *)(a2 + 4) = (*(float *)(a1 + 48) + *(float *)(a1 + 40)) * 0.5;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00523CB0) --------------------------------------------------------
int __cdecl sub_523CB0(int a1, int a2)
{
  int result; // eax
  int v3; // edx

  result = a1;
  switch ( *(_DWORD *)a1 )
  {
    case 2:
      *(float *)a2 = (*(float *)(a1 + 44) + *(float *)(a1 + 36)) * 0.5;
      result = *(_DWORD *)(a1 + 48);
      *(_DWORD *)(a2 + 4) = result;
      break;
    case 3:
      *(float *)a2 = (*(float *)(a1 + 44) + *(float *)(a1 + 36)) * 0.5;
      *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 40);
      break;
    case 4:
      v3 = *(_DWORD *)(a1 + 36);
      goto LABEL_6;
    case 5:
      v3 = *(_DWORD *)(a1 + 44);
LABEL_6:
      *(_DWORD *)a2 = v3;
      *(float *)(a2 + 4) = (*(float *)(a1 + 48) + *(float *)(a1 + 40)) * 0.5;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00523D30) --------------------------------------------------------
float *__cdecl sub_523D30(float *a1, float *a2)
{
  float *result; // eax
  int v3; // esi
  _DWORD *v4; // edx
  _DWORD *v5; // ecx
  double v6; // st7
  _DWORD *v7; // edx
  _DWORD *v8; // ecx

  result = a1;
  v3 = *(_DWORD *)a1;
  if ( *(_DWORD *)a1 == 2 || v3 == 3 )
  {
    v7 = (_DWORD *)*((_DWORD *)a1 + 22);
    if ( v7 )
    {
      v8 = (_DWORD *)*((_DWORD *)a1 + 30);
      if ( v8 )
      {
        if ( *v7 == 1 && *v8 == 1 )
        {
          v6 = (a1[11] + a1[9]) * 0.5;
          goto LABEL_18;
        }
      }
    }
  }
  else
  {
    v4 = (_DWORD *)*((_DWORD *)a1 + 38);
    if ( v4 )
    {
      v5 = (_DWORD *)*((_DWORD *)a1 + 46);
      if ( v5 )
      {
        if ( *v4 == 1 && *v5 == 1 )
        {
          v6 = (a1[11] + a1[9]) * 0.5;
LABEL_18:
          *a2 = v6;
          a2[1] = (a1[12] + a1[10]) * 0.5;
          return result;
        }
      }
    }
  }
  switch ( v3 )
  {
    case 2:
      *a2 = (a1[11] + a1[9]) * 0.5;
      a2[1] = a1[7] * 0.5 + a1[10];
      break;
    case 3:
      *a2 = (a1[11] + a1[9]) * 0.5;
      a2[1] = a1[12] - a1[7] * 0.5;
      break;
    case 4:
      v6 = a1[11] - a1[8] * 0.5;
      goto LABEL_18;
    case 5:
      v6 = a1[8] * 0.5 + a1[9];
      goto LABEL_18;
    default:
      return result;
  }
  return result;
}

//----- (00523E30) --------------------------------------------------------
float *__cdecl sub_523E30(int a1, int a2, int a3)
{
  float *result; // eax

  result = (float *)nox_calloc(1u, 0x178u);
  if ( result )
  {
    *(_DWORD *)result = a1;
    switch ( a1 )
    {
      case 2:
      case 3:
        *((_DWORD *)result + 3) = a2;
        if ( a2 < 1 )
          *((_DWORD *)result + 3) = 1;
        *((_DWORD *)result + 4) = a3;
        break;
      case 4:
      case 5:
        *((_DWORD *)result + 3) = a3;
        *((_DWORD *)result + 4) = a2;
        if ( a2 < 1 )
          *((_DWORD *)result + 4) = 1;
        break;
      default:
        break;
    }
    result[7] = (double)*((int *)result + 3) * 32.526913;
    result[8] = (double)*((int *)result + 4) * 32.526913;
  }
  return result;
}

//----- (00523EC0) --------------------------------------------------------
float *__cdecl sub_523EC0(int a1, int a2, int a3)
{
  int v3; // eax

  v3 = sub_526B00(*(_DWORD *)(a1 + 4), *(_DWORD *)(a1 + 8));
  return sub_523E30(a2, a3, v3);
}

//----- (00523EF0) --------------------------------------------------------
int __cdecl sub_523EF0(float *a1, int a2, int *a3, _DWORD *a4, int a5)
{
  int v5; // ebp
  float *v6; // edi
  int result; // eax
  int v8; // ebx
  int v9; // esi

  v5 = a5;
  v6 = a1;
  result = sub_521410(a3, a4, a5, (int *)&a1);
  if ( result )
  {
    if ( a1 == (float *)1 )
      return 0;
    v8 = 0;
    if ( (int)a1 - 1 > 0 )
    {
      v9 = result;
      do
      {
        v6 = sub_523F70(v5, (int *)v9, (float *)(v9 + 8), (int)v6);
        if ( !v6 )
          return 0;
        ++v8;
        v9 += 8;
      }
      while ( v8 < (int)a1 - 1 );
    }
    result = 1;
  }
  return result;
}

//----- (00523F70) --------------------------------------------------------
float *__cdecl sub_523F70(int a1, int *a2, float *a3, int a4)
{
  float v4; // eax
  int v5; // esi
  int v6; // ecx
  int v7; // edx
  int v8; // eax
  int v9; // ecx
  int v10; // edi
  double v11; // st7
  double v12; // st7
  float *v13; // esi
  int v14; // eax
  float2 a2a; // [esp+8h] [ebp-Ch]
  int v17; // [esp+10h] [ebp-4h]

  v4 = *a3;
  v5 = *a2;
  v6 = *((_DWORD *)a3 + 1);
  v7 = a2[1];
  a2a.field_0 = v4;
  v8 = LODWORD(v4) - v5;
  v17 = v6;
  v9 = v6 - v7;
  if ( v8 )
  {
    if ( v8 <= 0 )
    {
      v10 = 5;
      a2a.field_0 = (double)SLODWORD(a2a.field_0) * 32.526913;
      v11 = (double)v17;
    }
    else
    {
      v10 = 4;
      a2a.field_0 = (double)v5 * 32.526913;
      v11 = (double)v7;
    }
    a2a.field_4 = v11 * 32.526913;
    if ( v8 < 0 )
      v8 = -v8;
  }
  else
  {
    if ( v9 <= 0 )
    {
      v10 = 2;
      a2a.field_0 = (double)SLODWORD(a2a.field_0) * 32.526913;
      v12 = (double)v17;
    }
    else
    {
      v10 = 3;
      a2a.field_0 = (double)v5 * 32.526913;
      v12 = (double)v7;
    }
    a2a.field_4 = v12 * 32.526913;
    if ( v9 < 0 )
      v9 = -v9;
    v8 = v9;
  }
  v13 = sub_523E30(v10, a1, v8);
  if ( v13 )
  {
    v14 = sub_523920(v10);
    sub_521A70(a4, (int)v13, v14);
    sub_521880(v13, &a2a);
    sub_521730(v13);
  }
  return v13;
}

//----- (00524070) --------------------------------------------------------
int __cdecl sub_524070(int a1, int a2)
{
  int result; // eax

  result = sub_524090(a2, (int *)(a1 + 184));
  *(_DWORD *)(a2 + 372) = result;
  return result;
}

//----- (00524090) --------------------------------------------------------
int __cdecl sub_524090(int a1, int *a2)
{
  int v2; // ebx
  signed int v3; // eax
  int v4; // esi
  signed int v5; // edi
  int i; // [esp+10h] [ebp-4h]

  v2 = a1;
  for ( i = 0; ; ++i )
  {
LABEL_2:
    switch ( *(_DWORD *)(a1 + 364) )
    {
      case 1:
        v2 = a2[2];
        break;
      case 2:
        v2 = a2[3];
        break;
      case 4:
        v2 = a2[4];
        break;
      case 8:
        v2 = a2[5];
        break;
      case 0x10:
        v2 = a2[6];
        break;
      case 0x20:
        v2 = a2[7];
        break;
      default:
        break;
    }
    if ( v2 <= 0 )
    {
      nullsub_28(a1);
      return 0;
    }
    v3 = sub_526AC0(0, v2);
    v4 = *a2;
    v5 = v3;
    if ( *a2 )
    {
      while ( 1 )
      {
        if ( sub_5241C0(v4, a1) )
        {
          v5 -= *(_DWORD *)(v4 + 72);
          if ( v5 <= 0 )
            break;
        }
        v4 = *(_DWORD *)(v4 + 220);
        if ( !v4 )
        {
          ++i;
          goto LABEL_2;
        }
      }
      if ( sub_5241F0(v4, a1) && !*(_BYTE *)(v4 + 66) )
      {
        sub_524220(a2, v4);
        return v4;
      }
      if ( i >= 100 )
        break;
    }
  }
  nullsub_28(a1);
  return 0;
}
// 524300: using guessed type void __cdecl nullsub_28(_DWORD);

//----- (005241C0) --------------------------------------------------------
BOOL __cdecl sub_5241C0(int a1, int a2)
{
  unsigned __int8 v2; // al

  v2 = *(_BYTE *)(a1 + 64);
  return *(_BYTE *)(a2 + 364) & v2 || !v2;
}

//----- (005241F0) --------------------------------------------------------
BOOL __cdecl sub_5241F0(int a1, int a2)
{
  int v2; // eax

  v2 = *(_DWORD *)(a2 + 12);
  if ( v2 <= *(int *)(a2 + 16) )
    v2 = *(_DWORD *)(a2 + 16);
  return v2 >= *(int *)(a1 + 76) && v2 <= *(int *)(a1 + 80);
}

//----- (00524220) --------------------------------------------------------
char __cdecl sub_524220(int *a1, int a2)
{
  int i; // eax
  int v3; // edx
  int v4; // edx

  LOBYTE(i) = *(_BYTE *)(a2 + 65);
  if ( (_BYTE)i )
  {
    LOBYTE(i) = i - 1;
    *(_BYTE *)(a2 + 65) = i;
    if ( !(_BYTE)i )
    {
      if ( *(_BYTE *)(a2 + 64) & 2 )
        a1[3] -= *(_DWORD *)(a2 + 72);
      if ( *(_BYTE *)(a2 + 64) & 4 )
        a1[4] -= *(_DWORD *)(a2 + 72);
      if ( *(_BYTE *)(a2 + 64) & 8 )
        a1[5] -= *(_DWORD *)(a2 + 72);
      if ( *(_BYTE *)(a2 + 64) & 0x10 )
        a1[6] -= *(_DWORD *)(a2 + 72);
      i = *a1;
      v3 = 0;
      if ( !*a1 )
        goto LABEL_25;
      do
      {
        if ( i == a2 )
          break;
        v3 = i;
        i = *(_DWORD *)(i + 220);
      }
      while ( i );
      if ( v3 )
      {
        i = *(_DWORD *)(a2 + 220);
        *(_DWORD *)(v3 + 220) = i;
      }
      else
      {
LABEL_25:
        *a1 = *(_DWORD *)(a2 + 220);
      }
      v4 = *a1;
      if ( *a1 )
      {
        for ( i = *(_DWORD *)(v4 + 220); i; i = *(_DWORD *)(i + 220) )
          v4 = i;
        *(_DWORD *)(v4 + 220) = a2;
        *(_DWORD *)(a2 + 220) = 0;
        *(_BYTE *)(a2 + 66) = 1;
      }
      else
      {
        *a1 = a2;
        *(_DWORD *)(a2 + 220) = 0;
        *(_BYTE *)(a2 + 66) = 1;
      }
    }
  }
  return i;
}

//----- (00524310) --------------------------------------------------------
int __cdecl sub_524310(int a1)
{
  int v1; // ebx
  int v2; // edi
  int v3; // ebp
  int *v4; // esi
  int v5; // edi
  int *v6; // ebx
  int v7; // ebp
  int *v8; // esi
  int *v9; // esi
  int v10; // eax
  int *v12; // [esp+14h] [ebp+4h]

  v1 = a1;
  v12 = (int *)(a1 + 88);
  v2 = *v12;
  if ( *v12 )
  {
    while ( 1 )
    {
      v3 = *(_DWORD *)(v2 + 220);
      if ( *(_BYTE *)(v2 + 67) && !*(_BYTE *)(v2 + 68) )
      {
        v4 = (int *)sub_521710();
        if ( !v4 )
          break;
        while ( v4[93] || sub_5238F0(v4) || !sub_5241C0(v2, (int)v4) || !sub_5241F0(v2, (int)v4) || *(_BYTE *)(v2 + 66) )
        {
          v4 = (int *)sub_521720((int)v4);
          if ( !v4 )
            return 0;
        }
        sub_524220(v12, v2);
        v4[93] = v2;
        *(_BYTE *)(v2 + 68) = 1;
        if ( !v4 )
          break;
      }
      v2 = v3;
      if ( !v3 )
        goto LABEL_14;
    }
  }
  else
  {
LABEL_14:
    v5 = *(_DWORD *)(v1 + 120);
    v6 = (int *)(v1 + 120);
    if ( v5 )
    {
      while ( 1 )
      {
        v7 = *(_DWORD *)(v5 + 220);
        if ( *(_BYTE *)(v5 + 67) && !*(_BYTE *)(v5 + 68) )
        {
          v8 = (int *)sub_521710();
          if ( !v8 )
            break;
          while ( v8[93]
               || !sub_5238F0(v8)
               || !sub_5241C0(v5, (int)v8)
               || !sub_5241F0(v5, (int)v8)
               || *(_BYTE *)(v5 + 66) )
          {
            v8 = (int *)sub_521720((int)v8);
            if ( !v8 )
              return 0;
          }
          sub_524220(v6, v5);
          v8[93] = v5;
          *(_BYTE *)(v5 + 68) = 1;
          if ( !v8 )
            break;
        }
        v5 = v7;
        if ( !v7 )
          goto LABEL_27;
      }
    }
    else
    {
LABEL_27:
      v9 = (int *)sub_521710();
      if ( !v9 )
        return 1;
      while ( 1 )
      {
        if ( !v9[93] )
        {
          v10 = sub_5238F0(v9) ? sub_524090((int)v9, v6) : sub_524090((int)v9, v12);
          v9[93] = v10;
          if ( !v10 )
            break;
        }
        v9 = (int *)sub_521720((int)v9);
        if ( !v9 )
          return 1;
      }
    }
  }
  return 0;
}

//----- (005244D0) --------------------------------------------------------
int __cdecl sub_5244D0(int a1)
{
  signed int v1; // ecx
  int result; // eax

  v1 = sub_526AC0(0, *(_DWORD *)(a1 + 88) - 1);
  for ( result = *(_DWORD *)(a1 + 84); v1; --v1 )
    result = *(_DWORD *)(result + 124);
  return result;
}

//----- (00524500) --------------------------------------------------------
int __cdecl sub_524500(float2 *a1, int a2)
{
  float v2; // edx
  int result; // eax
  int v4; // esi
  float2 v5; // [esp+0h] [ebp-8h]

  v2 = a1->field_4;
  v5.field_0 = a1->field_0;
  v5.field_4 = v2;
  sub_526D50(0);
  result = a2;
  if ( a2 > 0 )
  {
    v4 = a2;
    do
    {
      result = sub_526E60(&v5);
      --v4;
      v5.field_0 = v5.field_0 + 32.526913;
    }
    while ( v4 );
  }
  return result;
}

//----- (00524550) --------------------------------------------------------
int __cdecl sub_524550(int *a1, int a2)
{
  int v2; // edx
  int result; // eax
  int v4; // esi
  int v5; // [esp+4h] [ebp-8h]
  float v6; // [esp+8h] [ebp-4h]

  v2 = a1[1];
  v5 = *a1;
  v6 = *(float *)&v2;
  result = sub_526D50(1);
  v4 = a2;
  if ( a2 > 0 )
  {
    do
    {
      result = sub_526E60((float *)&v5);
      --v4;
      v6 = v6 + 32.526913;
    }
    while ( v4 );
  }
  return result;
}

//----- (005245A0) --------------------------------------------------------
float *__cdecl sub_5245A0(int a1, float *a2, int a3, int a4)
{
  float *result; // eax
  int v5; // ebp
  int v6; // esi
  float v7; // [esp+4h] [ebp-8h]
  float v8; // [esp+8h] [ebp-4h]

  result = (float *)a4;
  v8 = a2[1] + 16.263456;
  if ( a4 > 0 )
  {
    v5 = a4;
    do
    {
      v7 = *a2 + 16.263456;
      if ( a3 > 0 )
      {
        v6 = a3;
        do
        {
          result = sub_51D5E0(&v7);
          --v6;
          v7 = v7 + 32.526913;
        }
        while ( v6 );
      }
      --v5;
      v8 = v8 + 32.526913;
    }
    while ( v5 );
  }
  return result;
}

//----- (00524610) --------------------------------------------------------
float *__cdecl sub_524610(int a1, float *a2, int a3)
{
  float *result; // eax
  int v4; // esi
  float v5; // [esp+4h] [ebp-8h]
  float v6; // [esp+8h] [ebp-4h]

  result = a2;
  v4 = a3;
  v5 = *a2 + 16.263456;
  v6 = a2[1] + 16.263456;
  if ( a3 > 0 )
  {
    do
    {
      result = sub_51D5E0(&v5);
      --v4;
      v6 = v6 + 32.526913;
    }
    while ( v4 );
  }
  return result;
}

//----- (00524660) --------------------------------------------------------
BOOL __cdecl sub_524660(float a1, float a2)
{
  return fabs(a1 - a2) < *(double *)&byte_581450[10432];
}

//----- (00524680) --------------------------------------------------------
int __cdecl sub_524680(int a1, int a2, int a3)
{
  float *v3; // edi
  double v4; // st7
  int result; // eax
  int v6; // ecx
  _DWORD *v7; // ecx
  _DWORD *v8; // esi
  _DWORD *v9; // ecx
  float v10; // edx
  _DWORD *v11; // esi
  double v12; // st7
  int v13; // ecx
  double v14; // st7
  _DWORD *v15; // eax
  _DWORD *v16; // esi
  double v17; // st7
  _DWORD *v18; // eax
  _DWORD *v19; // esi
  _DWORD *i; // esi
  int v21; // [esp+10h] [ebp-10h]
  int v22; // [esp+14h] [ebp-Ch]
  float v23; // [esp+18h] [ebp-8h]
  float v24; // [esp+1Ch] [ebp-4h]

  sub_51D4D0((char *)(a3 + 60));
  v3 = (float *)(a2 + 20);
  sub_5245A0(a1, (float *)(a2 + 20), *(_DWORD *)(a2 + 12), *(_DWORD *)(a2 + 16));
  switch ( *(_DWORD *)a2 )
  {
    case 1:
      v4 = *v3 + 32.526913;
      result = *(_DWORD *)(a2 + 12) - 2;
      v6 = *(_DWORD *)(a2 + 16) - 2;
      v21 = *(_DWORD *)(a2 + 12) - 2;
      v22 = v6;
      v23 = v4;
      v24 = *(float *)(a2 + 24) + 32.526913;
      break;
    case 2:
      v7 = *(_DWORD **)(a2 + 88);
      result = *(_DWORD *)(a2 + 12) - 2;
      v23 = *v3 + 32.526913;
      v21 = result;
      if ( v7 && *v7 != 1 )
      {
        v24 = *(float *)(a2 + 24);
        v6 = *(_DWORD *)(a2 + 16);
      }
      else
      {
        v6 = *(_DWORD *)(a2 + 16) - 1;
        v24 = *(float *)(a2 + 24) + 32.526913;
      }
      v8 = *(_DWORD **)(a2 + 120);
      v22 = v6;
      if ( v8 )
      {
        if ( *v8 != 1 )
          goto LABEL_18;
        v22 = --v6;
      }
      break;
    case 3:
      v9 = *(_DWORD **)(a2 + 120);
      v10 = *(float *)(a2 + 24);
      result = *(_DWORD *)(a2 + 12) - 2;
      v23 = *v3 + 32.526913;
      v24 = v10;
      v21 = result;
      if ( v9 && *v9 != 1 )
        v6 = *(_DWORD *)(a2 + 16);
      else
        v6 = *(_DWORD *)(a2 + 16) - 1;
      v11 = *(_DWORD **)(a2 + 88);
      v22 = v6;
      if ( v11 )
      {
        v12 = v24;
        if ( *v11 == 1 )
        {
          v22 = --v6;
          v24 = v12 + 32.526913;
        }
        else
        {
          v24 = v12 - 32.526913;
LABEL_18:
          v22 = ++v6;
        }
      }
      break;
    case 4:
      v13 = *(_DWORD *)(a2 + 16);
      v14 = *(float *)(a2 + 24) + 32.526913;
      v23 = *v3;
      v15 = *(_DWORD **)(a2 + 152);
      v6 = v13 - 2;
      v24 = v14;
      v22 = v6;
      if ( v15 && *v15 != 1 )
        result = *(_DWORD *)(a2 + 12);
      else
        result = *(_DWORD *)(a2 + 12) - 1;
      v16 = *(_DWORD **)(a2 + 184);
      v21 = result;
      if ( v16 )
      {
        v17 = v23;
        if ( *v16 != 1 )
        {
          v23 = v17 - 32.526913;
          goto LABEL_27;
        }
        v21 = --result;
        v23 = v17 + 32.526913;
      }
      break;
    case 5:
      v18 = *(_DWORD **)(a2 + 184);
      v6 = *(_DWORD *)(a2 + 16) - 2;
      v24 = *(float *)(a2 + 24) + 32.526913;
      v22 = v6;
      if ( v18 && *v18 != 1 )
      {
        result = *(_DWORD *)(a2 + 12);
        v23 = *v3;
      }
      else
      {
        result = *(_DWORD *)(a2 + 12) - 1;
        v23 = *v3 + 32.526913;
      }
      v19 = *(_DWORD **)(a2 + 152);
      v21 = result;
      if ( v19 )
      {
        if ( *v19 == 1 )
          v21 = --result;
        else
LABEL_27:
          v21 = ++result;
      }
      break;
    default:
      v6 = v22;
      result = v21;
      break;
  }
  for ( i = *(_DWORD **)(a3 + 120); i; i = (_DWORD *)i[31] )
  {
    if ( result <= 0 || v6 <= 0 )
      break;
    if ( *i == 1 )
    {
      sub_5249C0(a1, (int)i, &v23, &v21);
    }
    else if ( *i == 2 )
    {
      sub_524B50(a1, (int)i, &v23, &v21);
    }
    else
    {
      sub_524950(a1, (int)i, &v23, &v21);
    }
    result = v21 - 2;
    v6 = v22 - 2;
    v21 -= 2;
    v22 -= 2;
    v23 = v23 + 32.526913;
    v24 = v24 + 32.526913;
  }
  return result;
}

//----- (00524950) --------------------------------------------------------
int __cdecl sub_524950(int a1, int a2, float *a3, int *a4)
{
  float v5; // [esp+Ch] [ebp-8h]
  float v6; // [esp+10h] [ebp-4h]

  sub_51D4D0((char *)(a2 + 64));
  sub_5245A0(a1, a3, *a4, a4[1]);
  sub_544020((char *)(a2 + 4));
  v5 = (double)*a4 * 16.263456 + *a3;
  v6 = (double)a4[1] * 16.263456 + a3[1];
  return sub_543680(&v5);
}

//----- (005249C0) --------------------------------------------------------
int __cdecl sub_5249C0(int a1, int a2, float *a3, int *a4)
{
  int *v4; // esi
  int v5; // ecx
  int v6; // edx
  int v7; // eax
  int v8; // ebp
  double v9; // st7
  int v10; // edi
  double v11; // st7
  int v12; // eax
  bool v13; // cc
  int v14; // eax
  int v15; // edi
  int v16; // ebp
  int v17; // eax
  float v19; // [esp+10h] [ebp-14h]
  float v20; // [esp+14h] [ebp-10h]
  float v21; // [esp+18h] [ebp-Ch]
  float v22; // [esp+1Ch] [ebp-8h]
  float v23; // [esp+20h] [ebp-4h]
  int v24; // [esp+34h] [ebp+10h]

  sub_51D4D0((char *)(a2 + 64));
  v4 = a4;
  v5 = *a4;
  v6 = *a4 / 3;
  v7 = a4[1];
  v8 = 2 * v6;
  v24 = 0;
  v9 = (double)v6 * 32.526913;
  v10 = v5 - 2 * v6;
  v19 = v9;
  v11 = v9 + *a3;
  v21 = a3[1];
  v20 = v11;
  if ( v7 / 2 >= 0 )
  {
    do
    {
      sub_5245A0(a1, &v20, v10, 1);
      v12 = *v4;
      v10 += 2;
      v13 = v10 < *v4;
      v20 = v20 - 32.526913;
      v21 = v21 + 32.526913;
      if ( !v13 )
      {
        v10 = v12;
        v20 = *a3;
      }
      ++v24;
    }
    while ( v24 <= v4[1] / 2 );
  }
  v14 = v4[1];
  v15 = *v4 - v8;
  v16 = 0;
  v20 = v19 + *a3;
  v21 = (double)(v14 - 1) * 32.526913 + a3[1];
  if ( v14 / 2 > 0 )
  {
    do
    {
      sub_5245A0(a1, &v20, v15, 1);
      v17 = *v4;
      v15 += 2;
      v13 = v15 < *v4;
      v20 = v20 - 32.526913;
      v21 = v21 - 32.526913;
      if ( !v13 )
      {
        v15 = v17;
        v20 = *a3;
      }
      ++v16;
    }
    while ( v16 < v4[1] / 2 );
  }
  sub_544020((char *)(a2 + 4));
  v22 = (double)*v4 * 16.263456 + *a3;
  v23 = (double)v4[1] * 16.263456 + a3[1];
  return sub_543680(&v22);
}

//----- (00524B50) --------------------------------------------------------
void __cdecl sub_524B50(int a1, int a2, float *a3, int *a4)
{
  int *v4; // esi
  int v5; // eax
  int v7; // ecx
  int v8; // eax
  signed int v9; // eax
  int v10; // ebp
  signed int v11; // eax
  signed int v12; // eax
  int v13; // ebp
  signed int v14; // eax
  float v15; // eax
  int v16; // eax
  signed int v17; // eax
  int v18; // ebp
  signed int v19; // eax
  int v20; // ebp
  float v21; // ecx
  float v22; // [esp+4h] [ebp-10h]
  float v23; // [esp+8h] [ebp-Ch]
  float v24; // [esp+Ch] [ebp-8h]
  float v25; // [esp+10h] [ebp-4h]
  int v26; // [esp+24h] [ebp+10h]
  signed int v27; // [esp+24h] [ebp+10h]

  v4 = a4;
  if ( *a4 >= 3 && a4[1] >= 3 )
  {
    sub_51D4D0((char *)(a2 + 64));
    v5 = *a4 - 2;
    v22 = *a3 + 32.526913;
    v23 = a3[1] + 32.526913;
	if (v5 < 1)
      v5 = 1;
    v7 = a4[1] - 2;
    if ( v7 < 1 )
      v7 = 1;
    sub_5245A0(a1, &v22, v5, v7);
    v8 = *a4;
    if ( (int)*a4 < 4 )
    {
      if ( v8 == 3 )
      {
        v15 = a3[1];
        v22 = *a3 + 32.526913;
        v23 = v15;
        sub_5245A0(a1, &v22, 1, 1);
        v23 = v23 + 65.053825;
        sub_5245A0(a1, &v22, 1, 1);
      }
    }
    else
    {
      v9 = sub_526AC0(1, v8 - 3);
      v10 = v9;
      v11 = sub_526AC0(1, *a4 - v9 - 2);
      v23 = a3[1];
      v22 = (double)v11 * 32.526913 + *a3;
      sub_5245A0(a1, &v22, v10, 1);
      v12 = sub_526AC0(1, *a4 - 3);
      v13 = v12;
      v14 = sub_526AC0(1, *a4 - v12 - 2);
      v26 = a4[1] - 1;
      v22 = (double)v14 * 32.526913 + *a3;
      v23 = (double)v26 * 32.526913 + a3[1];
      sub_5245A0(a1, &v22, v13, 1);
    }
    v16 = v4[1];
    if ( v16 < 4 )
    {
      if ( v16 == 3 )
      {
        v21 = *a3;
        v23 = a3[1] + 32.526913;
        v22 = v21;
        sub_5245A0(a1, &v22, 1, 1);
        v22 = v22 + 65.053825;
        sub_5245A0(a1, &v22, 1, 1);
      }
    }
    else
    {
      v17 = sub_526AC0(1, v16 - 3);
      v18 = v17;
      v19 = sub_526AC0(1, v4[1] - v17 - 2);
      v22 = *a3;
      v23 = (double)v19 * 32.526913 + a3[1];
      sub_524610(a1, &v22, v18);
      v20 = sub_526AC0(1, v4[1] - 3);
      v27 = sub_526AC0(1, v4[1] - v20 - 2);
      v22 = (double)(*v4 - 1) * 32.526913 + *a3;
      v23 = (double)v27 * 32.526913 + a3[1];
      sub_524610(a1, &v22, v20);
    }
    sub_544020((char *)(a2 + 4));
    v24 = (double)*v4 * 16.263456 + *a3;
    v25 = (double)v4[1] * 16.263456 + a3[1];
    sub_543680(&v24);
  }
}

//----- (00524E00) --------------------------------------------------------
void __cdecl sub_524E00(int a1, int a2)
{
  int v2; // esi
  char *v3; // edi
  float v4; // eax
  float v5; // edx
  float v6; // edx
  float v7; // ecx
  double v8; // st7
  double v9; // st7
  int v10; // ecx
  int *v11; // ebp
  int v12; // edi
  int v13; // ebx
  int v14; // [esp-44h] [ebp-50h]
  int v15; // [esp-2Ch] [ebp-38h]
  int v16; // [esp-14h] [ebp-20h]
  float2 v17; // [esp+4h] [ebp-8h]
  int v18; // [esp+14h] [ebp+8h]

  v2 = a2;
  if ( !(*(_BYTE *)(a2 + 52) & 2) )
  {
    v3 = (char *)sub_5244D0(*(_DWORD *)(a2 + 372));
    sub_524680(a1, a2, (int)v3);
    sub_526CA0(v3);
    v4 = *(float *)(a2 + 40);
    v17.field_0 = *(float *)(a2 + 36);
    v17.field_4 = v4;
    sub_526D50(8);
    sub_526E60(&v17);
    v15 = *(_DWORD *)(a2 + 12) - 1;
    v17.field_0 = v17.field_0 + 32.526913;
    sub_524500(&v17, v15);
    v5 = *(float *)(a2 + 40);
    v17.field_0 = *(float *)(a2 + 44);
    v17.field_4 = v5;
    sub_526D50(9);
    sub_526E60(&v17);
    v6 = *(float *)(a2 + 48);
    v17.field_0 = *(float *)(a2 + 36);
    v17.field_4 = v6;
    sub_526D50(7);
    sub_526E60(&v17);
    v14 = *(_DWORD *)(a2 + 12) - 1;
    v17.field_0 = v17.field_0 + 32.526913;
    sub_524500(&v17, v14);
    v7 = *(float *)(a2 + 48);
    v17.field_0 = *(float *)(a2 + 44);
    v17.field_4 = v7;
    sub_526D50(10);
    sub_526E60(&v17);
    v8 = *(float *)(a2 + 40) + 32.526913;
    v16 = *(_DWORD *)(a2 + 16) - 1;
    v17.field_0 = *(float *)(a2 + 36);
    v17.field_4 = v8;
    sub_524550(&v17, v16);
    v9 = *(float *)(a2 + 40) + 32.526913;
    v10 = *(_DWORD *)(a2 + 16) - 1;
    v17.field_0 = *(float *)(a2 + 44);
    v17.field_4 = v9;
    sub_524550(&v17, v10);
    sub_526C80(0);
    v11 = (int *)(a2 + 88);
    v12 = 0;
    v18 = a2 + 88;
    do
    {
      v13 = 0;
      if ( *(_BYTE *)(v2 + v12 + 216) )
      {
        do
        {
          sub_524FB0(v2, *v11, v12);
          ++v13;
          ++v11;
        }
        while ( v13 < *(unsigned __int8 *)(v2 + v12 + 216) );
      }
      ++v12;
      v11 = (int *)(v18 + 32);
      v18 += 32;
    }
    while ( v12 < 4 );
    sub_526C80(1);
    sub_525510(a1, v2);
  }
}

//----- (00524FB0) --------------------------------------------------------
int __cdecl sub_524FB0(int a1, int a2, int a3)
{
  int result; // eax
  double v4; // st7
  int v5; // ecx
  int v6; // eax
  int v7; // ebx
  float v8; // edx
  double v9; // st7
  float v10; // ecx
  int v11; // eax
  int v12; // ecx
  int v13; // ebx
  double v14; // st7
  float v15; // eax
  double v16; // st7
  double v17; // st6
  double v18; // st7
  int v19; // ecx
  int v20; // eax
  int v21; // ebx
  double v22; // st7
  double v23; // st6
  double v24; // st7
  double v25; // st6
  double v26; // st7
  int v27; // ecx
  int v28; // eax
  int v29; // ebx
  double v30; // st7
  double v31; // st6
  double v32; // st7
  float2 a2a; // [esp+Ch] [ebp-10h]
  float2 v34; // [esp+14h] [ebp-8h]

  result = a3;
  switch ( a3 )
  {
    case 0:
      if ( *(float *)(a2 + 36) >= (double)*(float *)(a1 + 36) )
        v4 = *(float *)(a2 + 36);
      else
        v4 = *(float *)(a1 + 36);
      v5 = *(_DWORD *)(a1 + 12);
      a2a.field_4 = *(float *)(a1 + 40);
      v6 = *(_DWORD *)(a2 + 12);
      a2a.field_0 = v4;
      if ( v5 >= v6 )
      {
        v7 = v6;
        sub_521BC0(a1, &a2a, *(float *)(a2 + 28), 32.526913);
      }
      else
      {
        v7 = v5;
        sub_521BC0(a1, &a2a, *(float *)(a1 + 28), 32.526913);
      }
      v34.field_0 = a2a.field_0 + 32.526913;
      v34.field_4 = a2a.field_4;
      sub_525330((int *)&v34, v7 - 1);
      sub_5253B0(&a2a.field_0);
      v8 = *(float *)(a1 + 40);
      if ( *(float *)(a2 + 44) <= (double)*(float *)(a1 + 44) )
        a2a.field_0 = *(float *)(a2 + 44);
      else
        a2a.field_0 = *(float *)(a1 + 44);
      a2a.field_4 = v8;
      goto LABEL_42;
    case 1:
      if ( *(float *)(a2 + 36) >= (double)*(float *)(a1 + 36) )
        v9 = *(float *)(a2 + 36);
      else
        v9 = *(float *)(a1 + 36);
      a2a.field_0 = v9;
      v10 = *(float *)(a1 + 48);
      v11 = *(_DWORD *)(a2 + 12);
      v34.field_0 = v9;
      a2a.field_4 = v10;
      v12 = *(_DWORD *)(a1 + 12);
      v34.field_4 = a2a.field_4 - 32.526913;
      if ( v12 >= v11 )
      {
        v13 = v11;
        sub_521BC0(a1, &v34, *(float *)(a2 + 28), 32.526913);
      }
      else
      {
        v13 = v12;
        sub_521BC0(a1, &v34, *(float *)(a1 + 28), 32.526913);
      }
      v34.field_0 = a2a.field_0 + 32.526913;
      v34.field_4 = a2a.field_4;
      sub_525330((int *)&v34, v13 - 1);
      sub_5253B0(&a2a.field_0);
      if ( *(float *)(a2 + 44) <= (double)*(float *)(a1 + 44) )
        v14 = *(float *)(a2 + 44);
      else
        v14 = *(float *)(a1 + 44);
      v15 = *(float *)(a1 + 48);
      a2a.field_0 = v14;
      a2a.field_4 = v15;
      result = sub_5253B0(&a2a.field_0);
      break;
    case 2:
      v16 = *(float *)(a1 + 40);
      v17 = *(float *)(a2 + 40);
      a2a.field_0 = *(float *)(a1 + 44);
      if ( v17 >= v16 )
        v18 = *(float *)(a2 + 40);
      else
        v18 = *(float *)(a1 + 40);
      a2a.field_4 = v18;
      v19 = *(_DWORD *)(a1 + 16);
      v20 = *(_DWORD *)(a2 + 16);
      v34.field_0 = a2a.field_0 - 32.526913;
      v34.field_4 = v18;
      if ( v19 >= v20 )
      {
        v21 = v20;
        sub_521BC0(a1, &v34, 32.526913, *(float *)(a2 + 32));
      }
      else
      {
        v21 = v19;
        sub_521BC0(a1, &v34, 32.526913, *(float *)(a1 + 32));
      }
      v34.field_4 = a2a.field_4 + 32.526913;
      v34.field_0 = a2a.field_0;
      sub_525370((int *)&v34, v21 - 1);
      sub_5253B0(&a2a.field_0);
      v22 = *(float *)(a1 + 48);
      v23 = *(float *)(a2 + 48);
      a2a.field_0 = *(float *)(a1 + 44);
      if ( v23 <= v22 )
        a2a.field_4 = *(float *)(a2 + 48);
      else
        a2a.field_4 = *(float *)(a1 + 48);
      result = sub_5253B0(&a2a.field_0);
      break;
    case 3:
      v24 = *(float *)(a1 + 40);
      v25 = *(float *)(a2 + 40);
      a2a.field_0 = *(float *)(a1 + 36);
      if ( v25 >= v24 )
        v26 = *(float *)(a2 + 40);
      else
        v26 = *(float *)(a1 + 40);
      v27 = *(_DWORD *)(a1 + 16);
      v28 = *(_DWORD *)(a2 + 16);
      a2a.field_4 = v26;
      if ( v27 >= v28 )
      {
        v29 = v28;
        sub_521BC0(a1, &a2a, 32.526913, *(float *)(a2 + 32));
      }
      else
      {
        v29 = v27;
        sub_521BC0(a1, &a2a, 32.526913, *(float *)(a1 + 32));
      }
      v34.field_4 = a2a.field_4 + 32.526913;
      v34.field_0 = a2a.field_0;
      sub_525370((int *)&v34, v29 - 1);
      sub_5253B0(&a2a.field_0);
      v30 = *(float *)(a1 + 48);
      v31 = *(float *)(a2 + 48);
      a2a.field_0 = *(float *)(a1 + 36);
      if ( v31 <= v30 )
        v32 = *(float *)(a2 + 48);
      else
        v32 = *(float *)(a1 + 48);
      a2a.field_4 = v32;
LABEL_42:
      result = sub_5253B0(&a2a.field_0);
      break;
    default:
      return result;
  }
  return result;
}

//----- (00525330) --------------------------------------------------------
float2 *__cdecl sub_525330(float2 *a1, int a2)
{
  float2 *result; // eax
  int v3; // esi
  float v4; // edx
  float2 a1a; // [esp+4h] [ebp-8h]

  result = a1;
  v3 = a2;
  v4 = a1->field_4;
  a1a.field_0 = a1->field_0;
  a1a.field_4 = v4;
  if ( a2 > 0 )
  {
    do
    {
      result = (float2 *)sub_527030(&a1a);
      --v3;
      a1a.field_0 = a1a.field_0 + 32.526913;
    }
    while ( v3 );
  }
  return result;
}

//----- (00525370) --------------------------------------------------------
float2 *__cdecl sub_525370(float2 *a1, int a2)
{
  float2 *result; // eax
  int v3; // esi
  float v4; // edx
  float2 a1a; // [esp+4h] [ebp-8h]

  result = a1;
  v3 = a2;
  v4 = a1->field_4;
  a1a.field_0 = a1->field_0;
  a1a.field_4 = v4;
  if ( a2 > 0 )
  {
    do
    {
      result = (float2 *)sub_527030(&a1a);
      --v3;
      a1a.field_4 = a1a.field_4 + 32.526913;
    }
    while ( v3 );
  }
  return result;
}

//----- (005253B0) --------------------------------------------------------
int __cdecl sub_5253B0(float *a1)
{
  double v1; // st7
  double v2; // st7
  double v3; // st7
  double v4; // st7
  int result; // eax
  unsigned __int8 v6; // [esp+4h] [ebp-18h]
  float v7; // [esp+8h] [ebp-14h]
  float v8; // [esp+Ch] [ebp-10h]
  int v9; // [esp+10h] [ebp-Ch]

  v1 = a1[1] - 32.526913;
  v6 = 0;
  v7 = *a1;
  v8 = v1;
  if ( sub_526DD0(&v7, &v9) )
    v6 = 1;
  v2 = a1[1] + 32.526913;
  v7 = *a1;
  v8 = v2;
  if ( sub_526DD0(&v7, &v9) )
    v6 |= 2u;
  v3 = *a1 - 32.526913;
  v8 = a1[1];
  v7 = v3;
  if ( sub_526DD0(&v7, &v9) )
    v6 |= 4u;
  v4 = *a1 + 32.526913;
  v8 = a1[1];
  v7 = v4;
  if ( sub_526DD0(&v7, &v9) )
    v6 |= 8u;
  result = v6 - 3;
  switch ( v6 )
  {
    case 3u:
      sub_526D50(1);
      goto LABEL_21;
    case 5u:
      sub_526D50(10);
      goto LABEL_21;
    case 6u:
      sub_526D50(9);
      goto LABEL_21;
    case 7u:
      sub_526D50(6);
      goto LABEL_21;
    case 9u:
      sub_526D50(7);
      goto LABEL_21;
    case 0xAu:
      sub_526D50(8);
      goto LABEL_21;
    case 0xBu:
      sub_526D50(4);
      goto LABEL_21;
    case 0xCu:
      sub_526D50(0);
      goto LABEL_21;
    case 0xDu:
      sub_526D50(3);
      goto LABEL_21;
    case 0xEu:
      sub_526D50(5);
      goto LABEL_21;
    case 0xFu:
      sub_526D50(2);
LABEL_21:
      result = sub_526E60(a1);
      break;
    default:
      return result;
  }
  return result;
}

//----- (00525510) --------------------------------------------------------
void __cdecl sub_525510(int a1, int a2)
{
  int v2; // ebx
  int *v3; // ebp
  int v4; // esi
  int v5; // edi
  int v6; // [esp+18h] [ebp+8h]

  v2 = a2;
  v3 = (int *)(a2 + 88);
  v4 = 0;
  v6 = a2 + 88;
  do
  {
    v5 = 0;
    if ( *(_BYTE *)(v2 + v4 + 216) )
    {
      do
      {
        sub_525570(a1, v2, *v3, v4);
        ++v5;
        ++v3;
      }
      while ( v5 < *(unsigned __int8 *)(v2 + v4 + 216) );
    }
    ++v4;
    v3 = (int *)(v6 + 32);
    v6 += 32;
  }
  while ( v4 < 4 );
}

//----- (00525570) --------------------------------------------------------
void __cdecl sub_525570(int a1, int a2, int a3, int a4)
{
  double v4; // st7
  int v5; // esi
  double v6; // st7
  int v7; // eax
  int v8; // esi
  float2 v9; // [esp+8h] [ebp-8h]

  switch ( a4 )
  {
    case 0:
    case 1:
      if ( *(float *)(a3 + 36) >= (double)*(float *)(a2 + 36) )
        v4 = *(float *)(a3 + 36);
      else
        v4 = *(float *)(a2 + 36);
      v9.field_0 = v4;
      if ( a4 )
        v9.field_4 = *(float *)(a2 + 48);
      else
        v9.field_4 = *(float *)(a2 + 40);
      v5 = *(_DWORD *)(a3 + 12);
      if ( *(_DWORD *)(a2 + 12) < v5 )
        v5 = *(_DWORD *)(a2 + 12);
      if ( v5 >= 2 && (v5 == 2 || !sub_525740(a2, (int *)&v9, v5)) )
        sub_525690(a2, &v9, v5);
      break;
    case 2:
    case 3:
      if ( a4 == 3 )
        v9.field_0 = *(float *)(a2 + 36);
      else
        v9.field_0 = *(float *)(a2 + 44);
      if ( *(float *)(a3 + 40) >= (double)*(float *)(a2 + 40) )
        v6 = *(float *)(a3 + 40);
      else
        v6 = *(float *)(a2 + 40);
      v7 = *(_DWORD *)(a2 + 16);
      v8 = *(_DWORD *)(a3 + 16);
      v9.field_4 = v6;
      if ( v7 < v8 )
        v8 = v7;
      if ( v8 >= 2 && (v8 == 2 || !sub_5258E0(a2, (int)&v9, v8)) )
        sub_525830(a2, (int)&v9, v8);
      break;
    default:
      return;
  }
}

//----- (00525690) --------------------------------------------------------
int __cdecl sub_525690(int a1, float2 *a2, int a3)
{
  float *v4; // eax
  char *v5; // [esp-18h] [ebp-24h]
  float2 a1a; // [esp+4h] [ebp-8h]

  if ( !*(_BYTE *)(*(_DWORD *)(a1 + 372) + 100) )
    return 0;
  sub_524500(a2, a3 + 1);
  a1a.field_4 = a2->field_4;
  a1a.field_0 = (double)(a3 / 2) * 32.526913 + a2->field_0;
  sub_527030(&a1a);
  v5 = (char *)(*(_DWORD *)(a1 + 372) + 100);
  a1a.field_0 = a1a.field_0 - 16.263456;
  sub_527940(v5);
  v4 = sub_5279B0(&a1a);
  if ( v4 )
    sub_527C60((int)v4, 5);
  return 1;
}

//----- (00525740) --------------------------------------------------------
int __cdecl sub_525740(int a1, float2 *a2, int a3)
{
  float *v4; // eax
  float *v5; // eax
  char *v6; // [esp-1Ch] [ebp-28h]
  float2 v7; // [esp+4h] [ebp-8h]

  if ( !*(_BYTE *)(*(_DWORD *)(a1 + 372) + 160) )
    return 0;
  sub_524500(a2, a3 + 1);
  v7.field_4 = a2->field_4;
  v7.field_0 = (double)(a3 / 2) * 32.526913 + a2->field_0;
  sub_527030(&v7);
  v7.field_0 = v7.field_0 + 32.526913;
  sub_527030(&v7);
  v6 = (char *)(*(_DWORD *)(a1 + 372) + 160);
  v7.field_0 = v7.field_0 - 48.790367;
  sub_527940(v6);
  v4 = sub_5279B0(&v7);
  if ( v4 )
    sub_527C60((int)v4, 5);
  v7.field_0 = v7.field_0 + 65.053825;
  v5 = sub_5279B0(&v7);
  if ( v5 )
    sub_527C60((int)v5, 3);
  return 1;
}

//----- (00525830) --------------------------------------------------------
int __cdecl sub_525830(int a1, float2 *a2, int a3)
{
  float *v4; // eax
  char *v5; // [esp-18h] [ebp-24h]
  float2 a1a; // [esp+4h] [ebp-8h]

  if ( !*(_BYTE *)(*(_DWORD *)(a1 + 372) + 100) )
    return 0;
  sub_524550((int *)a2, a3 + 1);
  a1a.field_0 = a2->field_0;
  a1a.field_4 = (double)(a3 / 2) * 32.526913 + a2->field_4;
  sub_527030(&a1a);
  v5 = (char *)(*(_DWORD *)(a1 + 372) + 100);
  a1a.field_4 = a1a.field_4 - 16.263456;
  sub_527940(v5);
  v4 = sub_5279B0(&a1a);
  if ( v4 )
    sub_527C60((int)v4, 7);
  return 1;
}

//----- (005258E0) --------------------------------------------------------
int __cdecl sub_5258E0(int a1, float2 *a2, int a3)
{
  float *v4; // eax
  float *v5; // eax
  char *v6; // [esp-1Ch] [ebp-28h]
  float2 a1a; // [esp+4h] [ebp-8h]

  if ( !*(_BYTE *)(*(_DWORD *)(a1 + 372) + 160) )
    return 0;
  sub_524550((int *)a2, a3 + 1);
  a1a.field_0 = a2->field_0;
  a1a.field_4 = (double)(a3 / 2) * 32.526913 + a2->field_4;
  sub_527030(&a1a);
  a1a.field_4 = a1a.field_4 + 32.526913;
  sub_527030(&a1a);
  v6 = (char *)(*(_DWORD *)(a1 + 372) + 160);
  a1a.field_4 = a1a.field_4 - 48.790367;
  sub_527940(v6);
  v4 = sub_5279B0(&a1a);
  if ( v4 )
    sub_527C60((int)v4, 7);
  a1a.field_4 = a1a.field_4 + 65.053825;
  v5 = sub_5279B0(&a1a);
  if ( v5 )
    sub_527C60((int)v5, 1);
  return 1;
}

//----- (005259D0) --------------------------------------------------------
double sub_5259D0()
{
  return *(float *)&byte_5D4594[2487580];
}

//----- (005259E0) --------------------------------------------------------
int sub_5259E0()
{
  return *(_DWORD *)&byte_5D4594[2487576];
}

//----- (005259F0) --------------------------------------------------------
void __cdecl sub_5259F0(int a1, int a2, float a3)
{
  long double v3; // st7
  int v4; // ebp
  int *v5; // edi
  int v6; // eax
  _BYTE *v7; // esi
  int v8; // ebx
  int v9; // [esp+4h] [ebp+4h]
  int v10; // [esp+8h] [ebp+8h]
  float v11; // [esp+Ch] [ebp+Ch]

  sub_5235F0(156);
  if ( a2 )
  {
    switch ( *(_DWORD *)a2 )
    {
      case 1:
        v3 = sqrt(*(float *)(a2 + 28) * *(float *)(a2 + 28) + *(float *)(a2 + 32) * *(float *)(a2 + 32));
        break;
      case 2:
      case 3:
        v3 = *(float *)(a2 + 32);
        break;
      case 4:
      case 5:
        v3 = *(float *)(a2 + 28);
        break;
      default:
        v3 = a3;
        break;
    }
  }
  else
  {
    v3 = 0.0;
  }
  v4 = a1;
  v11 = v3 + a3;
  if ( *(_BYTE *)(a1 + 220) != 1 || v11 < (double)*(float *)(a1 + 356) )
  {
    *(float *)(a1 + 356) = v11;
    v5 = (int *)(a1 + 88);
    v6 = -216 - a1;
    *(_BYTE *)(a1 + 220) = 1;
    v7 = (_BYTE *)(a1 + 216);
    v10 = a1 + 88;
    v9 = -216 - a1;
    do
    {
      v8 = 0;
      if ( *v7 )
      {
        do
        {
          if ( *v5 )
            sub_5259F0(*v5, v4, v11);
          ++v8;
          ++v5;
        }
        while ( v8 < (unsigned __int8)*v7 );
        v6 = v9;
      }
      ++v7;
      v5 = (int *)(v10 + 32);
      v10 += 32;
    }
    while ( (int)&v7[v6] < 4 );
  }
}

//----- (00525AF0) --------------------------------------------------------
float *__cdecl sub_525AF0(int a1)
{
  int v1; // esi
  int v2; // edi
  float *i; // eax
  float *result; // eax
  int v5; // ecx
  int v6; // eax

  v1 = 0;
  v2 = 0;
  *(_DWORD *)&byte_5D4594[2487580] = 0;
  *(_DWORD *)&byte_5D4594[2487576] = a1;
  sub_525BF0(a1);
  *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487576] + 52) |= 1u;
  for ( i = (float *)sub_521710(); i; i = (float *)sub_521720((int)i) )
  {
    ++v1;
    i[90] = i[89] / *(float *)&byte_5D4594[2487580];
  }
  *(_DWORD *)&byte_5D4594[2487584] = 0;
  result = sub_525C90();
  v5 = a1;
  if ( a1 )
  {
    do
    {
      if ( v1 > 1 )
        v6 = v2 / (v1 - 1);
      else
        v6 = 100;
      if ( v5 == a1 )
      {
        *(_DWORD *)(v5 + 364) = 1;
      }
      else if ( v6 >= 30 )
      {
        if ( v6 >= 60 )
        {
          if ( v6 >= 90 )
            *(_DWORD *)(v5 + 364) = 16;
          else
            *(_DWORD *)(v5 + 364) = 8;
        }
        else
        {
          *(_DWORD *)(v5 + 364) = 4;
        }
      }
      else
      {
        *(_DWORD *)(v5 + 364) = 2;
      }
      v5 = *(_DWORD *)(v5 + 64);
      v2 += 100;
    }
    while ( v5 );
    result = *(float **)&byte_5D4594[2487576];
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487576] + 364) = 32;
  }
  else
  {
    *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487576] + 364) = 32;
  }
  return result;
}

//----- (00525BF0) --------------------------------------------------------
void __cdecl sub_525BF0(int a1)
{
  int v1; // eax
  int v2; // eax
  _BYTE *v3; // esi
  int v4; // ebp
  int v5; // ebx
  int *v6; // edi
  int v7; // [esp+4h] [ebp+4h]

  if ( *(_BYTE *)(a1 + 220) != 2 )
  {
    if ( *(float *)&byte_5D4594[2487580] < (double)*(float *)(a1 + 356) && *(_DWORD *)a1 == 1 )
    {
      v1 = *(_DWORD *)(a1 + 356);
      *(_DWORD *)&byte_5D4594[2487576] = a1;
      *(_DWORD *)&byte_5D4594[2487580] = v1;
    }
    v2 = -216 - a1;
    *(_BYTE *)(a1 + 220) = 2;
    v3 = (_BYTE *)(a1 + 216);
    v4 = a1 + 88;
    v7 = -216 - a1;
    do
    {
      v5 = 0;
      if ( *v3 )
      {
        v6 = (int *)v4;
        do
        {
          if ( *v6 )
            sub_525BF0(*v6);
          ++v5;
          ++v6;
        }
        while ( v5 < (unsigned __int8)*v3 );
        v2 = v7;
      }
      ++v3;
      v4 += 32;
    }
    while ( (int)&v3[v2] < 4 );
  }
}

//----- (00525C90) --------------------------------------------------------
float *sub_525C90()
{
  float *result; // eax
  float *i; // edx
  int v2; // ecx
  int v3; // esi
  int v4; // eax
  int v5; // eax

  *(_DWORD *)&byte_5D4594[2487584] = 0;
  result = (float *)sub_521710();
  for ( i = result; result; i = result )
  {
    v2 = *(_DWORD *)&byte_5D4594[2487584];
    if ( *(_DWORD *)&byte_5D4594[2487584] )
    {
      v3 = 0;
      while ( i[89] >= (double)*(float *)(v2 + 356) )
      {
        v3 = v2;
        v2 = *(_DWORD *)(v2 + 64);
        if ( !v2 )
          goto LABEL_12;
      }
      v4 = *(_DWORD *)(v2 + 68);
      if ( v4 )
        *(_DWORD *)(v4 + 64) = i;
      else
        *(_DWORD *)&byte_5D4594[2487584] = i;
      v5 = *(_DWORD *)(v2 + 68);
      *((_DWORD *)i + 16) = v2;
      *((_DWORD *)i + 17) = v5;
      *(_DWORD *)(v2 + 68) = i;
      if ( !v2 )
      {
LABEL_12:
        *((_DWORD *)i + 17) = v3;
        i[16] = 0.0;
        *(_DWORD *)(v3 + 64) = i;
        goto LABEL_13;
      }
    }
    else
    {
      *(_DWORD *)&byte_5D4594[2487584] = i;
      i[16] = 0.0;
      i[17] = 0.0;
    }
LABEL_13:
    result = (float *)sub_521720((int)i);
  }
  return result;
}

//----- (00525D20) --------------------------------------------------------
int __cdecl sub_525D20(int a1)
{
  int v1; // edi
  _DWORD *i; // esi
  _DWORD *j; // esi

  v1 = 0;
  if ( !*(_DWORD *)&byte_5D4594[2487656] )
  {
    *(_DWORD *)&byte_5D4594[2487656] = sub_4E3AA0((CHAR *)&byte_587000[254968]);
    *(_DWORD *)&byte_5D4594[2487660] = sub_4E3AA0((CHAR *)&byte_587000[254984]);
    *(_DWORD *)&byte_5D4594[2487664] = sub_4E3AA0((CHAR *)&byte_587000[255000]);
    *(_DWORD *)&byte_5D4594[2487668] = sub_4E3AA0((CHAR *)&byte_587000[255016]);
  }
  sub_525DF0(*(float *)&a1);
  for ( i = *(_DWORD **)(a1 + 80); i; i = (_DWORD *)i[39] )
  {
    if ( i[18] )
    {
      if ( v1 == 5 || !sub_526100(a1, (int)i) )
        return 0;
      i[19] = 1;
      ++v1;
    }
  }
  for ( j = *(_DWORD **)(a1 + 80); j; j = (_DWORD *)j[39] )
  {
    if ( !j[18] )
    {
      if ( v1 == 5 )
        return 1;
      if ( !sub_526100(a1, (int)j) )
        return 0;
      j[19] = 1;
      ++v1;
    }
  }
  return 1;
}

//----- (00525DF0) --------------------------------------------------------
void __cdecl sub_525DF0(float a1)
{
  double v1; // st7
  int v2; // eax
  int v3; // ecx
  unsigned __int8 *v4; // edx
  int v5; // esi
  signed int v6; // eax
  int v7; // ecx
  double v8; // st7
  signed int v9; // eax
  double v10; // st7
  double v11; // st7
  double v12; // st7
  double v13; // st7
  float v14; // [esp+8h] [ebp-4h]
  float v15; // [esp+8h] [ebp-4h]
  float v16; // [esp+10h] [ebp+4h]

  v1 = *(float *)(LODWORD(a1) + 64) * 0.5;
  *(_DWORD *)&byte_5D4594[2487608] = 0;
  v2 = *(_DWORD *)(LODWORD(a1) + 84);
  v16 = v1;
  if ( v2 >= 5 )
  {
    v2 = 5;
    *(_DWORD *)&byte_5D4594[2487652] = 5;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2487652] = v2;
    if ( v2 == 1 )
    {
      *(_DWORD *)&byte_5D4594[2487588] = 0;
      goto LABEL_10;
    }
    if ( v2 == 2 )
    {
      if ( sub_526AC0(0, 100) >= 50 )
      {
        v2 = *(_DWORD *)&byte_5D4594[2487652];
        *(_DWORD *)&byte_5D4594[2487588] = 1;
        *(_DWORD *)&byte_5D4594[2487592] = 0;
      }
      else
      {
        v2 = *(_DWORD *)&byte_5D4594[2487652];
        *(_DWORD *)&byte_5D4594[2487588] = 0;
        *(_DWORD *)&byte_5D4594[2487592] = 1;
      }
      goto LABEL_10;
    }
  }
  v3 = 0;
  if ( v2 > 0 )
  {
    v4 = &byte_5D4594[2487588];
    do
    {
      *(_DWORD *)v4 = v3++;
      v4 += 4;
    }
    while ( v3 < v2 );
  }
  v5 = 0;
  if ( v2 > 0 )
  {
    do
    {
      v6 = sub_526AC0(0, v2 - 2);
      v7 = *(_DWORD *)&byte_5D4594[4 * v6 + 2487588];
      *(_DWORD *)&byte_5D4594[4 * v6 + 2487588] = *(_DWORD *)&byte_5D4594[4 * v6 + 2487592];
      *(_DWORD *)&byte_5D4594[4 * v6 + 2487592] = v7;
      v2 = *(_DWORD *)&byte_5D4594[2487652];
      ++v5;
    }
    while ( v5 < *(int *)&byte_5D4594[2487652] );
  }
LABEL_10:
  switch ( v2 )
  {
    case 1:
      v14 = -v16;
      *(float *)&byte_5D4594[2487612] = sub_526BC0(v14, v16);
      *(float *)&byte_5D4594[2487616] = sub_526BC0(v14, v16);
      break;
    case 2:
      v8 = -v16;
      v15 = v8;
      if ( sub_526AC0(0, 100) >= 50 )
      {
        *(float *)&byte_5D4594[2487612] = v8;
        *(float *)&byte_5D4594[2487616] = sub_526BC0(v15, v16);
        *(float *)&byte_5D4594[2487620] = v16;
        *(float *)&byte_5D4594[2487624] = sub_526BC0(v15, v16);
      }
      else
      {
        *(float *)&byte_5D4594[2487612] = sub_526BC0(v15, v16);
        *(float *)&byte_5D4594[2487616] = v15;
        *(float *)&byte_5D4594[2487620] = sub_526BC0(v15, v16);
        *(float *)&byte_5D4594[2487624] = v16;
      }
      break;
    case 3:
      v9 = sub_526AC0(0, 100);
      if ( v9 >= 25 )
      {
        if ( v9 >= 50 )
        {
          v12 = -v16;
          if ( v9 >= 75 )
          {
            *(float *)&byte_5D4594[2487612] = v12;
            *(float *)&byte_5D4594[2487616] = v12;
            *(float *)&byte_5D4594[2487620] = v12;
            *(float *)&byte_5D4594[2487624] = v16;
            *(float *)&byte_5D4594[2487628] = v16;
          }
          else
          {
            *(float *)&byte_5D4594[2487616] = v12;
            *(float *)&byte_5D4594[2487628] = v12;
            *(float *)&byte_5D4594[2487612] = v16;
            *(float *)&byte_5D4594[2487620] = v16;
            *(float *)&byte_5D4594[2487624] = v16;
          }
          *(_DWORD *)&byte_5D4594[2487632] = 0;
        }
        else
        {
          v11 = -v16;
          *(float *)&byte_5D4594[2487612] = v11;
          *(float *)&byte_5D4594[2487632] = v11;
          *(float *)&byte_5D4594[2487616] = v16;
          *(float *)&byte_5D4594[2487620] = v16;
          *(float *)&byte_5D4594[2487624] = v16;
          *(_DWORD *)&byte_5D4594[2487628] = 0;
        }
      }
      else
      {
        v10 = -v16;
        *(float *)&byte_5D4594[2487612] = v10;
        *(float *)&byte_5D4594[2487616] = v10;
        *(float *)&byte_5D4594[2487624] = v10;
        *(float *)&byte_5D4594[2487620] = v16;
        *(_DWORD *)&byte_5D4594[2487628] = 0;
        *(float *)&byte_5D4594[2487632] = v16;
      }
      break;
    case 4:
    case 5:
      *(_DWORD *)&byte_5D4594[2487644] = 0;
      v13 = -v16;
      *(float *)&byte_5D4594[2487612] = v13;
      *(float *)&byte_5D4594[2487616] = v13;
      *(float *)&byte_5D4594[2487624] = v13;
      *(float *)&byte_5D4594[2487628] = v13;
      *(float *)&byte_5D4594[2487620] = v16;
      *(float *)&byte_5D4594[2487632] = v16;
      *(float *)&byte_5D4594[2487636] = v16;
      *(float *)&byte_5D4594[2487640] = v16;
      *(_DWORD *)&byte_5D4594[2487648] = 0;
      break;
    default:
      return;
  }
}

//----- (00526100) --------------------------------------------------------
int __cdecl sub_526100(int a1, int a2)
{
  int result; // eax
  float *v3; // eax
  int v4; // edi
  _DWORD *v5; // eax
  int v6; // edx
  int v7; // ecx
  _DWORD *v8; // eax
  float2 v9; // [esp+Ch] [ebp-8h]

  result = sub_5262F0(a1, a2);
  if ( result )
  {
    v3 = sub_521940(
           4 * *(_DWORD *)(a2 + 144) + (unsigned __int64)(__int64)(*(float *)(a2 + 60) * 0.030743772 + 0.5),
           4 * *(_DWORD *)(a2 + 144) + (unsigned __int64)(__int64)(*(float *)(a2 + 64) * 0.030743772 + 0.5));
    *(_DWORD *)(a2 + 148) = v3;
    sub_526260((int)v3, &v9.field_0);
    sub_521880(*(_DWORD **)(a2 + 148), &v9);
    v4 = 1;
    v5 = (_DWORD *)sub_521200(*(_DWORD *)(a2 + 148));
    if ( v5 && !sub_5212B0(*(_DWORD *)(a2 + 148), v5) )
      v4 = 0;
    if ( sub_5217A0(a1, *(_DWORD *)(a2 + 148)) && v4 )
    {
      sub_521730(*(_DWORD **)(a2 + 148));
      v6 = 4;
      *(_DWORD *)(*(_DWORD *)(a2 + 148) + 52) |= 2u;
      v7 = 2 * *(_DWORD *)(a2 + 144);
      v8 = (_DWORD *)(a2 + 80);
      do
      {
        if ( v8[3] )
        {
          *v8 += v7 + *(_DWORD *)(*(_DWORD *)(a2 + 148) + 4);
          v8[1] += v7 + *(_DWORD *)(*(_DWORD *)(a2 + 148) + 8);
        }
        v8 += 4;
        --v6;
      }
      while ( v6 );
      result = 1;
    }
    else
    {
      sub_521A10(*(LPVOID *)(a2 + 148));
      *(_DWORD *)(a2 + 148) = 0;
      result = 0;
    }
  }
  return result;
}

//----- (00526260) --------------------------------------------------------
__int64 __cdecl sub_526260(int a1, float *a2)
{
  int v2; // ecx
  __int64 result; // rax

  v2 = *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487608] + 2487588];
  *a2 = *(float *)&byte_5D4594[8 * v2 + 2487612];
  a2[1] = *(float *)&byte_5D4594[8 * v2 + 2487616];
  ++*(_DWORD *)&byte_5D4594[2487608];
  *a2 = *a2 - *(float *)(a1 + 28) * 0.5;
  a2[1] = a2[1] - *(float *)(a1 + 32) * 0.5;
  *a2 = (double)(int)(__int64)(*a2 * 0.030743772) * 32.526913;
  result = (__int64)(a2[1] * 0.030743772);
  a2[1] = (double)(int)result * 32.526913;
  return result;
}

//----- (005262F0) --------------------------------------------------------
int __cdecl sub_5262F0(int a1, int a2)
{
  int v2; // eax
  double v3; // st7
  int v4; // ecx
  int i; // edi
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // ecx
  int v13; // eax
  int v14; // eax
  int v15; // ecx
  int v16; // eax
  int v17; // eax
  int v18; // ecx
  int v19; // edi
  int v20; // edx
  int v21; // ebx
  _DWORD *v22; // eax
  int result; // eax
  int2 v24; // [esp+Ch] [ebp-18h]
  float2 v26; // [esp+14h] [ebp-10h]
  float2 v28; // [esp+1Ch] [ebp-8h]

  v2 = sub_5029A0((char *)a2);
  *(_DWORD *)(a2 + 68) = v2;
  if ( v2 == -1 )
    goto LABEL_44;
  sub_502D70(v2);
  v3 = sub_502E70(*(_DWORD *)(a2 + 68));
  v4 = *(_DWORD *)(a2 + 68);
  *(float *)(a2 + 60) = v3;
  *(float *)(a2 + 64) = sub_502EA0(v4);
  for ( i = sub_504980(); i; i = sub_5049C0(i) )
  {
    sub_503EC0(i, &v26);
    v28.field_0 = v26.field_0 - 1.0;
    v28.field_4 = v26.field_4 - 1.0;
    sub_520DF0(&v28, &v24);
    v6 = *(unsigned __int16 *)(i + 4);
    if ( (unsigned __int16)v6 == *(_DWORD *)&byte_5D4594[2487656] )
    {
      if ( *(_DWORD *)(a2 + 92) )
      {
        if ( v24.field_0 < *(int *)(a2 + 80) )
          *(_DWORD *)(a2 + 80) = v24.field_0;
        v7 = *(_DWORD *)(a2 + 88) + 1;
        *(_DWORD *)(a2 + 84) = v24.field_4;
        *(_DWORD *)(a2 + 88) = v7;
      }
      else
      {
        v8 = v24.field_0;
        v9 = v24.field_4;
        *(_DWORD *)(a2 + 92) = 1;
        *(_DWORD *)(a2 + 80) = v8;
        *(_DWORD *)(a2 + 84) = v9;
        *(_DWORD *)(a2 + 88) = 1;
      }
    }
    else if ( v6 == *(_DWORD *)&byte_5D4594[2487660] )
    {
      if ( *(_DWORD *)(a2 + 108) )
      {
        if ( v24.field_0 < *(int *)(a2 + 96) )
          *(_DWORD *)(a2 + 96) = v24.field_0;
        v10 = *(_DWORD *)(a2 + 104) + 1;
        *(_DWORD *)(a2 + 100) = v24.field_4;
        *(_DWORD *)(a2 + 104) = v10;
      }
      else
      {
        v11 = v24.field_0;
        v12 = v24.field_4;
        *(_DWORD *)(a2 + 108) = 1;
        *(_DWORD *)(a2 + 96) = v11;
        *(_DWORD *)(a2 + 100) = v12;
        *(_DWORD *)(a2 + 104) = 1;
      }
    }
    else if ( v6 == *(_DWORD *)&byte_5D4594[2487668] )
    {
      if ( *(_DWORD *)(a2 + 140) )
      {
        if ( v24.field_4 < *(int *)(a2 + 132) )
          *(_DWORD *)(a2 + 132) = v24.field_4;
        v13 = *(_DWORD *)(a2 + 136) + 1;
        *(_DWORD *)(a2 + 128) = v24.field_0;
        *(_DWORD *)(a2 + 136) = v13;
      }
      else
      {
        v14 = v24.field_0;
        v15 = v24.field_4;
        *(_DWORD *)(a2 + 140) = 1;
        *(_DWORD *)(a2 + 128) = v14;
        *(_DWORD *)(a2 + 132) = v15;
        *(_DWORD *)(a2 + 136) = 1;
      }
    }
    else if ( v6 == *(_DWORD *)&byte_5D4594[2487664] )
    {
      if ( *(_DWORD *)(a2 + 124) )
      {
        if ( v24.field_4 < *(int *)(a2 + 116) )
          *(_DWORD *)(a2 + 116) = v24.field_4;
        v16 = *(_DWORD *)(a2 + 120) + 1;
        *(_DWORD *)(a2 + 112) = v24.field_0;
        *(_DWORD *)(a2 + 120) = v16;
      }
      else
      {
        v17 = v24.field_0;
        v18 = v24.field_4;
        *(_DWORD *)(a2 + 124) = 1;
        *(_DWORD *)(a2 + 112) = v17;
        *(_DWORD *)(a2 + 116) = v18;
        *(_DWORD *)(a2 + 120) = 1;
      }
    }
  }
  v19 = 4;
  v20 = *(_DWORD *)(a1 + 12) + *(_DWORD *)(a1 + 16);
  v21 = 0;
  v22 = (_DWORD *)(a2 + 88);
  do
  {
    if ( v22[1] )
    {
      if ( *v22 > *(int *)(a2 + 144) )
        *(_DWORD *)(a2 + 144) = *v22;
      ++v21;
    }
    v22 += 4;
    --v19;
  }
  while ( v19 );
  if ( *(_DWORD *)(a2 + 144) > v20
    || v21 > 2
    || (*(_DWORD *)(a2 + 92) || *(_DWORD *)(a2 + 108)) && (*(_DWORD *)(a2 + 124) || *(_DWORD *)(a2 + 140)) )
  {
LABEL_44:
    result = 0;
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (00526550) --------------------------------------------------------
int __cdecl sub_526550(int a1, int a2)
{
  int v2; // ecx
  int v3; // ebp
  int v4; // edi
  int v5; // ebx
  int v6; // eax
  int *v7; // esi
  int v8; // ecx
  int v9; // eax
  int v10; // eax
  int v11; // edx
  int v12; // eax
  int *v13; // edi
  int v14; // eax
  int v15; // ebp
  int v16; // esi
  int v17; // edi
  int v18; // ebx
  __int64 v19; // rax
  int *v20; // esi
  int v21; // ecx
  int v23; // [esp+10h] [ebp-38h]
  int v24; // [esp+14h] [ebp-34h]
  int v25; // [esp+18h] [ebp-30h]
  int v26[5]; // [esp+1Ch] [ebp-2Ch]
  int v27; // [esp+30h] [ebp-18h]
  int v28[5]; // [esp+34h] [ebp-14h]
  int v29; // [esp+4Ch] [ebp+4h]

  v2 = 16 * (a2 + 5);
  v3 = 0;
  v4 = 0;
  v5 = 0;
  v23 = *(_DWORD *)(v2 + a1);
  v6 = *(_DWORD *)(v2 + a1 + 4);
  v27 = 0;
  v24 = v6;
  v29 = 0;
  v7 = (int *)sub_521710();
  if ( v7 )
  {
    do
    {
      if ( !sub_5238F0(v7) )
      {
        v8 = v7[1] + v7[3] / 2 - v23;
        v9 = v7[2] + v7[4] / 2 - v24;
        switch ( a2 )
        {
          case 0:
            if ( v9 < 0 )
              goto LABEL_11;
            break;
          case 1:
            if ( v9 > 0 )
              goto LABEL_11;
            break;
          case 2:
            if ( v8 > 0 )
              goto LABEL_11;
            break;
          case 3:
            if ( v8 < 0 )
              goto LABEL_11;
            break;
          default:
LABEL_11:
            v10 = v8 * v8 + v9 * v9;
            if ( v3 >= 24 )
            {
              if ( *(&v25 + v5) > v10 )
              {
                *(&v27 + v5) = (int)v7;
                *(&v25 + v5) = v10;
              }
            }
            else
            {
              ++v4;
              *(int *)((char *)&v27 + v3) = (int)v7;
              *(int *)((char *)&v25 + v3) = v10;
              v29 = v4;
              v3 += 4;
            }
            v11 = v25;
            v5 = 0;
            v12 = 1;
            if ( v3 > 4 )
            {
              v13 = v26;
              do
              {
                if ( *v13 > v11 )
                {
                  v5 = v12;
                  v11 = *v13;
                }
                ++v12;
                ++v13;
              }
              while ( v12 < v29 );
              v4 = v29;
            }
            break;
        }
      }
      v14 = sub_521720((int)v7);
      v7 = (int *)v14;
    }
    while ( v14 );
    if ( v4 > 1 )
    {
      v15 = v4 - 1;
      if ( v4 - 1 > 0 )
      {
        do
        {
          v16 = *(&v25 + v14);
          v17 = v26[v14];
          if ( v16 > v17 )
          {
            v18 = *(&v27 + v14);
            *(&v25 + v14) = v17;
            *(&v27 + v14) = v28[v14];
            v26[v14] = v16;
            v28[v14] = v18;
            v14 = -1;
          }
          ++v14;
        }
        while ( v14 < v15 );
        v4 = v29;
      }
    }
  }
  v19 = 0;
  if ( v4 > 0 )
  {
    v20 = &v27;
    do
    {
      v21 = *v20;
      *(_DWORD *)(*v20 + 72) = 0;
      if ( HIDWORD(v19) )
        *(_DWORD *)(HIDWORD(v19) + 72) = v21;
      else
        LODWORD(v19) = v21;
      ++v20;
      --v4;
      HIDWORD(v19) = v21;
    }
    while ( v4 );
  }
  return v19;
}
// 526550: using guessed type int var_2C[5];
// 526550: using guessed type int var_14[5];

//----- (005266F0) --------------------------------------------------------
int __cdecl sub_5266F0(int a1)
{
  int v1; // esi
  int v2; // ecx
  float *v3; // eax
  _DWORD *v4; // ebp
  int v5; // ebx
  _DWORD *v6; // edi
  float2 v8; // [esp+10h] [ebp-8h]

  v1 = *(_DWORD *)(a1 + 80);
  if ( !v1 )
    return 1;
  while ( !*(_DWORD *)(v1 + 76) )
  {
LABEL_11:
    v1 = *(_DWORD *)(v1 + 156);
    if ( !v1 )
      return 1;
  }
  v2 = *(_DWORD *)(v1 + 148);
  v8.field_0 = *(float *)(v2 + 20);
  v8.field_4 = *(float *)(v2 + 24);
  v8.field_0 = (double)*(int *)(v1 + 144) * 65.053825 + v8.field_0;
  v8.field_4 = (double)*(int *)(v1 + 144) * 65.053825 + v8.field_4;
  sub_521760(*(_DWORD *)(v1 + 148));
  sub_521A10(*(LPVOID *)(v1 + 148));
  v3 = sub_521940(
         (__int64)(*(float *)(v1 + 60) * 0.030743772 + 0.5),
         (__int64)(*(float *)(v1 + 64) * 0.030743772 + 0.5));
  *(_DWORD *)(v1 + 148) = v3;
  sub_521880(v3, &v8);
  sub_521730(*(_DWORD **)(v1 + 148));
  v4 = (_DWORD *)(v1 + 92);
  v5 = 0;
  *(_DWORD *)(*(_DWORD *)(v1 + 148) + 52) |= 2u;
  while ( 1 )
  {
    if ( *v4 )
    {
      v6 = (_DWORD *)sub_526550(v1, v5);
      if ( !v6 )
        return 0;
      while ( !sub_54B2D0((int *)v1, v5, v6) )
      {
        v6 = (_DWORD *)v6[18];
        if ( !v6 )
          return 0;
      }
      if ( !v6 )
        return 0;
    }
    ++v5;
    v4 += 4;
    if ( v5 >= 4 )
      goto LABEL_11;
  }
}

//----- (00526830) --------------------------------------------------------
int __cdecl sub_526830(int a1)
{
  int *v1; // ebx
  int v2; // esi
  int v3; // edi
  int v4; // eax

  v1 = *(int **)(a1 + 80);
  if ( !v1 )
    return 1;
  do
  {
    if ( v1[19] )
    {
      sub_502D70(v1[17]);
      v2 = sub_504980();
      if ( v2 )
      {
        do
        {
          v3 = sub_5049C0(v2);
          v4 = *(unsigned __int16 *)(v2 + 4);
          if ( (unsigned __int16)v4 == *(_DWORD *)&byte_5D4594[2487656]
            || v4 == *(_DWORD *)&byte_5D4594[2487660]
            || v4 == *(_DWORD *)&byte_5D4594[2487664]
            || v4 == *(_DWORD *)&byte_5D4594[2487668] )
          {
            sub_504A10(v2);
          }
          v2 = v3;
        }
        while ( v3 );
      }
      sub_521C60(a1, v1[38]);
      sub_503B30((float2 *)(v1[37] + 20));
    }
    v1 = (int *)v1[39];
  }
  while ( v1 );
  return 1;
}

//----- (005268F0) --------------------------------------------------------
int __cdecl sub_5268F0(const char *a1)
{
  int v1; // ebp
  const char *i; // edi

  v1 = 0;
  if ( *(int *)&byte_5D4594[2487676] <= 0 )
    return -1;
  for ( i = *(const char **)&byte_5D4594[2487672]; strcmp(i, a1); i += 64 )
  {
    if ( ++v1 >= *(int *)&byte_5D4594[2487676] )
      return -1;
  }
  return v1;
}

//----- (00526950) --------------------------------------------------------
char *sub_526950()
{
  int v0; // eax
  char *result; // eax
  int v2; // ebp
  char *v3; // ebx
  char *v4; // esi
  int v5; // edi
  unsigned __int8 v6; // al
  int v7; // [esp+4h] [ebp-104h]
  char v8[256]; // [esp+8h] [ebp-100h]

  v0 = sub_502A20();
  *(_DWORD *)&byte_5D4594[2487676] = v0;
  result = (char *)nox_calloc(v0, 0x40u);
  v2 = 0;
  *(_DWORD *)&byte_5D4594[2487672] = result;
  if ( result )
  {
    v7 = 0;
    if ( *(_DWORD *)&byte_5D4594[2487676] > 0 )
    {
      while ( 1 )
      {
        v3 = &result[v2];
        strcpy(v8, (const char *)sub_5029F0(v7));
        strcpy((char *)(*(_DWORD *)&byte_5D4594[2487672] + v2), v8);
        strtok(v8, (const char *)&byte_587000[255040]);
        strtok(0, (const char *)&byte_587000[255044]);
        v4 = strtok(0, (const char *)&byte_587000[255048]);
        if ( v4 )
        {
          v5 = 0;
          if ( byte_587000[255032] )
          {
            do
            {
              if ( strchr(v4, (char)byte_587000[v5 + 255032]) )
                *((_DWORD *)v3 + 15) |= 1 << v5;
              v6 = byte_587000[v5++ + 255033];
            }
            while ( v6 );
          }
        }
        result = (char *)(v7 + 1);
        v2 += 64;
        if ( ++v7 >= *(int *)&byte_5D4594[2487676] )
          break;
        result = *(char **)&byte_5D4594[2487672];
      }
    }
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2487676] = 0;
  }
  return result;
}

//----- (00526A90) --------------------------------------------------------
void sub_526A90()
{
  free(*(LPVOID *)&byte_5D4594[2487672]);
}

//----- (00526AA0) --------------------------------------------------------
char *__cdecl sub_526AA0(int a1)
{
  return (char *)(*(_DWORD *)&byte_5D4594[2487672] + (a1 << 6));
}

//----- (00526AB0) --------------------------------------------------------
void __cdecl sub_526AB0(unsigned int a1)
{
  srand(a1);
}

//----- (00526AC0) --------------------------------------------------------
signed int __cdecl sub_526AC0(int a1, signed int a2)
{
  signed int result; // eax

  result = a1 + (a2 - a1 + 1) * rand() / 0x7FFFu;
  if ( result > a2 )
    result = a2;
  return result;
}

//----- (00526B00) --------------------------------------------------------
int __cdecl sub_526B00(int a1, signed int a2)
{
  int v3; // edi
  signed int v4; // ebx
  int v5; // ecx

  if ( !a2 )
    return a1;
  v3 = 10000 / a2;
  do
  {
    do
    {
      v4 = sub_526AC0(-a2, a2);
      v5 = sub_526AC0(0, 10000 / a2);
    }
    while ( v5 >= v3 * (a2 - v4) / a2 );
  }
  while ( v5 >= v3 * (v4 + a2) / a2 );
  return v4 + a1;
}

//----- (00526B60) --------------------------------------------------------
int __cdecl sub_526B60(int a1, signed int a2)
{
  int v3; // edi
  signed int v4; // ebx
  int v5; // ecx

  if ( !a2 )
    return a1;
  v3 = 10000 / a2;
  do
  {
    v4 = sub_526AC0(-a2, a2);
    v5 = sub_526AC0(0, 10000 / a2);
  }
  while ( v5 <= v3 * (a2 - v4) / a2 && v5 <= v3 * (v4 + a2) / a2 );
  return v4 + a1;
}

//----- (00526BC0) --------------------------------------------------------
double __cdecl sub_526BC0(float a1, float a2)
{
  return (double)(unsigned int)rand() * (a2 - a1) * 0.000030518509 + a1;
}

//----- (00526BF0) --------------------------------------------------------
int __cdecl sub_526BF0(char *a1)
{
  int v1; // esi
  char *v2; // eax

  if ( !a1 )
    return -1;
  v1 = 0;
  if ( *(int *)&byte_5D4594[251540] <= 0 )
    return -1;
  while ( 1 )
  {
    v2 = sub_410D40(v1);
    if ( !_strcmpi(v2, a1) )
      break;
    if ( ++v1 >= *(int *)&byte_5D4594[251540] )
      return -1;
  }
  return v1;
}

//----- (00526C40) --------------------------------------------------------
int __cdecl sub_526C40(int a1)
{
  if ( a1 != 1 && a1 )
    return 0;
  *(_DWORD *)&byte_5D4594[3835364] = a1;
  return 1;
}

//----- (00526C60) --------------------------------------------------------
int __cdecl sub_526C60(int a1)
{
  if ( a1 != 1 && a1 )
    return 0;
  *(_DWORD *)&byte_5D4594[3835372] = a1;
  return 1;
}

//----- (00526C80) --------------------------------------------------------
int __cdecl sub_526C80(int a1)
{
  if ( a1 != 1 && a1 )
    return 0;
  *(_DWORD *)&byte_5D4594[3835368] = a1;
  return 1;
}

//----- (00526CA0) --------------------------------------------------------
int __cdecl sub_526CA0(char *a1)
{
  int v1; // edi
  int i; // esi
  char *v3; // eax

  v1 = 0;
  for ( i = 0; i < *(int *)&byte_5D4594[251540]; ++i )
  {
    v3 = sub_410D40(i);
    if ( !_strcmpi(v3, a1) )
    {
      *(_DWORD *)&byte_5D4594[3835376] = i;
      v1 = 1;
    }
  }
  if ( !_strcmpi(a1, (const char *)&byte_587000[255116]) )
  {
    *(_DWORD *)&byte_5D4594[3835376] = 255;
    return 1;
  }
  if ( v1 )
    return 1;
  *(_DWORD *)&byte_5D4594[3835376] = 0;
  return 0;
}

//----- (00526D20) --------------------------------------------------------
int __cdecl sub_526D20(int a1)
{
  int result; // eax

  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[251540] )
  {
    *(_DWORD *)&byte_5D4594[3835376] = 0;
    result = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835376] = a1;
    result = 1;
  }
  return result;
}

//----- (00526D50) --------------------------------------------------------
int __cdecl sub_526D50(int a1)
{
  int result; // eax

  if ( a1 < 0 || a1 >= 15 )
  {
    *(_DWORD *)&byte_5D4594[3835380] = 0;
    result = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835380] = a1;
    result = 1;
  }
  return result;
}

//----- (00526D80) --------------------------------------------------------
int __cdecl sub_526D80(int a1)
{
  int v1; // ecx
  int result; // eax

  v1 = sub_410DD0(*(int *)&byte_5D4594[3835376], *(int *)&byte_5D4594[3835380], 0);
  if ( a1 < 0 || a1 >= v1 )
  {
    *(_DWORD *)&byte_5D4594[3835384] = 0;
    result = 0;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835384] = a1;
    result = 1;
  }
  return result;
}

//----- (00526DD0) --------------------------------------------------------
int __cdecl sub_526DD0(float2 *a1, int *a2)
{
  int v2; // esi
  __int64 v3; // rax
  int v4; // eax
  float2 a2a; // [esp+8h] [ebp-8h]

  if ( !sub_4D3D90(a1, &a2a) )
    return 0;
  if ( !a2 )
    return 0;
  v2 = (__int64)(a2a.field_0 * 0.043478262);
  v3 = (__int64)(a2a.field_4 * 0.043478262);
  if ( ((_BYTE)v3 + (_BYTE)v2) & 1 )
    return 0;
  if ( v2 < 0 )
    return 0;
  if ( v2 >= 256 )
    return 0;
  if ( (int)v3 < 0 )
    return 0;
  if ( (int)v3 >= 256 )
    return 0;
  v4 = sub_410580(v2, v3);
  if ( !v4 )
    return 0;
  *a2 = v4;
  return 1;
}

//----- (00526E60) --------------------------------------------------------
int __cdecl sub_526E60(float *a1)
{
  int v2; // edi
  __int64 v3; // rax
  int v4; // ebp
  unsigned __int8 *v5; // eax
  unsigned __int8 *v6; // esi
  unsigned __int8 *v7; // eax
  unsigned __int8 *v8; // esi
  int v9; // edx
  unsigned __int8 v10; // al
  __int16 v11; // dx
  int v12; // [esp-Ch] [ebp-20h]
  int v13; // [esp-Ch] [ebp-20h]
  int v14; // [esp-8h] [ebp-1Ch]
  int v15; // [esp-8h] [ebp-1Ch]
  float2 v16; // [esp+Ch] [ebp-8h]

  if ( *(_DWORD *)&byte_5D4594[3835376] == 255 )
    return 1;
  if ( sub_4D3D90((float2 *)a1, &v16) )
  {
    v2 = (__int64)(v16.field_0 * 0.043478262);
    v3 = (__int64)(v16.field_4 * 0.043478262);
    v4 = v3;
    if ( !(((_BYTE)v2 + (_BYTE)v3) & 1) && v2 >= 0 && v2 < 256 && (int)v3 >= 0 && (int)v3 < 256 )
    {
      v5 = (unsigned __int8 *)sub_410580(v2, v3);
      v6 = v5;
      if ( v5 )
      {
        v5[1] = byte_5D4594[3835376];
        if ( *(_DWORD *)&byte_5D4594[3835368] == 1 )
          v10 = sub_42A6C0(byte_5D4594[3835380], *v5);
        else
          v10 = byte_5D4594[3835380];
        *v6 = v10;
        if ( *(_DWORD *)&byte_5D4594[3835372] )
          v11 = v6[5] % (__int16)sub_410E00(v6[1]);
        else
          LOBYTE(v11) = byte_5D4594[3835384];
        v15 = *v6;
        v13 = v6[1];
        v6[2] = v11;
        if ( v6[2] >= sub_410DD0(v13, v15, 0) )
          v6[2] = 0;
        v6[4] = -128;
        return 1;
      }
      v7 = (unsigned __int8 *)sub_410250(v2, v4);
      v8 = v7;
      if ( v7 )
      {
        v7[1] = byte_5D4594[3835376];
        *v7 = byte_5D4594[3835380];
        if ( *(_DWORD *)&byte_5D4594[3835372] )
          v9 = v2 % sub_410E00(v7[1]);
        else
          LOBYTE(v9) = byte_5D4594[3835384];
        v14 = *v8;
        v12 = v8[1];
        v8[2] = v9;
        v8[4] = -128;
        if ( v8[2] >= sub_410DD0(v12, v14, 0) )
        {
          v8[2] = 0;
          return 1;
        }
        return 1;
      }
    }
  }
  return 0;
}

//----- (00527030) --------------------------------------------------------
int __cdecl sub_527030(float2 *a1)
{
  int v1; // edi
  __int64 v2; // rax
  int v3; // ebx
  int v4; // eax
  int v5; // esi
  float2 a2; // [esp+Ch] [ebp-8h]

  if ( !sub_4D3D90(a1, &a2) )
    return 0;
  v1 = (__int64)(a2.field_0 * 0.043478262);
  v2 = (__int64)(a2.field_4 * 0.043478262);
  v3 = v2;
  if ( ((_BYTE)v2 + (_BYTE)v1) & 1 )
    return 0;
  if ( v1 < 0 )
    return 0;
  if ( v1 >= 256 )
    return 0;
  if ( (int)v2 < 0 )
    return 0;
  if ( (int)v2 >= 256 )
    return 0;
  v4 = sub_410580(v1, v2);
  v5 = v4;
  if ( !v4 )
    return 0;
  if ( *(_DWORD *)(v4 + 28) )
  {
    sub_4107A0(*(LPVOID *)(v4 + 28));
    *(_DWORD *)(v5 + 28) = 0;
  }
  sub_410430(v1, v3);
  return 1;
}

//----- (005270E0) --------------------------------------------------------
int __cdecl sub_5270E0(int *a1)
{
  int result; // eax
  int v2; // esi

  if ( !a1 )
    return 0;
  result = *a1;
  if ( *a1 )
  {
    result = sub_410580(*(unsigned __int8 *)(result + 5), *(unsigned __int8 *)(result + 6));
    v2 = result;
    if ( result )
    {
      if ( *(_DWORD *)(result + 28) )
      {
        sub_4107A0(*(LPVOID *)(result + 28));
        *(_DWORD *)(v2 + 28) = 0;
      }
      sub_410430(*(unsigned __int8 *)(v2 + 5), *(unsigned __int8 *)(v2 + 6));
      *a1 = 0;
      result = 1;
    }
  }
  return result;
}

//----- (00527150) --------------------------------------------------------
int __cdecl sub_527150(int *a1, char a2)
{
  int result; // eax
  int v3; // edi
  int v4; // esi

  result = (int)a1;
  if ( a1 )
  {
    result = *a1;
    if ( *a1 )
    {
      result = sub_410580(*(unsigned __int8 *)(result + 5), *(unsigned __int8 *)(result + 6));
      v3 = result;
      if ( result )
      {
        v4 = *(_DWORD *)(result + 28);
        if ( !v4 )
        {
          result = (int)nox_calloc(1u, 0x20u);
          v4 = result;
          if ( !result )
            return result;
          sub_410760((_DWORD *)result);
          *(_DWORD *)(v3 + 28) = v4;
        }
        *(_DWORD *)(v4 + 16) = 3;
        *(_BYTE *)(v4 + 20) = a2;
        *(_BYTE *)(v3 + 4) |= 4u;
        result = 1;
      }
    }
  }
  return result;
}

//----- (005271D0) --------------------------------------------------------
int *__cdecl sub_5271D0(int *a1)
{
  int *result; // eax

  result = a1;
  if ( a1 )
  {
    result = (int *)*a1;
    if ( *a1 )
    {
      result = (int *)sub_410580(*((unsigned __int8 *)result + 5), *((unsigned __int8 *)result + 6));
      if ( result )
      {
        *((_BYTE *)result + 4) |= 8u;
        result = (int *)1;
      }
    }
  }
  return result;
}

//----- (00527210) --------------------------------------------------------
int *__cdecl sub_527210(int *a1)
{
  int *result; // eax
  int *v2; // esi
  char v3; // al
  int v4; // edi
  unsigned __int8 v5; // al

  result = a1;
  if ( a1 )
  {
    result = (int *)*a1;
    if ( *a1 )
    {
      result = (int *)sub_410580(*((unsigned __int8 *)result + 5), *((unsigned __int8 *)result + 6));
      v2 = result;
      if ( result )
      {
        v3 = *(_BYTE *)result;
        if ( *(_BYTE *)v2 && v3 != 1 )
        {
          result = 0;
        }
        else
        {
          *((_BYTE *)v2 + 4) |= 0x40u;
          v4 = sub_410DD0(*(int *)&byte_5D4594[3835376], *(int *)&byte_5D4594[3835380], 0);
          if ( *(_DWORD *)&byte_5D4594[3835380] )
            v5 = sub_410DD0(*(int *)&byte_5D4594[3835376], 12, 0);
          else
            v5 = sub_410DD0(*(int *)&byte_5D4594[3835376], 11, 0);
          if ( v5 < v4 )
            *((_BYTE *)v2 + 2) = 0;
          result = (int *)1;
        }
      }
    }
  }
  return result;
}

//----- (005272B0) --------------------------------------------------------
int __cdecl sub_5272B0(int a1)
{
  int result; // eax

  if ( !a1 )
    return -1;
  if ( !*(_DWORD *)a1 )
    return -1;
  result = sub_410580(*(unsigned __int8 *)(*(_DWORD *)a1 + 5), *(unsigned __int8 *)(*(_DWORD *)a1 + 6));
  if ( result )
    result = *(unsigned __int8 *)(result + 1);
  return result;
}

//----- (005272F0) --------------------------------------------------------
int __cdecl sub_5272F0(int a1)
{
  int result; // eax

  if ( !a1 )
    return -1;
  if ( !*(_DWORD *)a1 )
    return -1;
  result = sub_410580(*(unsigned __int8 *)(*(_DWORD *)a1 + 5), *(unsigned __int8 *)(*(_DWORD *)a1 + 6));
  if ( result )
    result = *(unsigned __int8 *)result;
  return result;
}

//----- (00527330) --------------------------------------------------------
int __cdecl sub_527330(int a1)
{
  if ( !a1 )
    return -1;
  if ( *(_DWORD *)a1 )
    return *(unsigned __int8 *)(*(_DWORD *)a1 + 2);
  return -1;
}

//----- (00527350) --------------------------------------------------------
int __cdecl sub_527350(float *a1)
{
  int result; // eax
  float2 v2; // [esp+0h] [ebp-8h]

  result = sub_4D3D90((float2 *)a1, &v2);
  if ( result )
    result = sub_527380(&v2.field_0);
  return result;
}

//----- (00527380) --------------------------------------------------------
int __cdecl sub_527380(float *a1)
{
  double v1; // st7
  int v2; // esi
  __int64 v3; // rax
  int v4; // esi
  int v5; // esi
  int v6; // eax
  int v8; // [esp+8h] [ebp-8h]
  int v9; // [esp+Ch] [ebp-4h]

  v1 = a1[1] * 0.043478262;
  v2 = (__int64)(*a1 * 0.043478262);
  v8 = (__int64)(*a1 * 0.043478262);
  v3 = (__int64)v1;
  v9 = (__int64)v1;
  if ( v2 > 0 && v2 < 255 && (int)v3 > 0 && (int)v3 < 255 )
  {
    sub_527450(&v8);
    LODWORD(v3) = v9;
    v2 = v8;
  }
  v4 = v2 - 1;
  v8 = v4;
  if ( v4 > 0 && v4 < 255 && (int)v3 > 0 && (int)v3 < 255 )
  {
    sub_527450(&v8);
    LODWORD(v3) = v9;
    v4 = v8;
  }
  v5 = v4 + 1;
  v6 = v3 - 1;
  v8 = v5;
  v9 = v6;
  if ( v5 > 0 && v5 < 255 && v6 > 0 && v6 < 255 )
    sub_527450(&v8);
  return 1;
}

//----- (00527450) --------------------------------------------------------
int __cdecl sub_527450(_DWORD *a1)
{
  int v1; // ebp
  int v2; // ebp
  int v3; // eax
  int result; // eax
  int v5; // esi
  int v6; // ebx
  int v7; // edi
  int v8; // eax
  int v9; // esi
  int v10; // edi
  int v11; // ecx
  __int64 v12; // rax
  int v13; // kr00_4
  int v14; // ebx
  int v15; // ebp
  int v16; // edi
  int v17; // ecx
  unsigned __int8 *v18; // eax
  unsigned __int8 *v19; // esi
  int v20; // ecx
  unsigned __int8 v21; // dl
  unsigned __int8 v22; // al
  unsigned __int8 *v23; // eax
  unsigned __int8 v24; // cl
  int v25; // eax
  int v26; // ecx
  int v27; // eax
  unsigned __int8 *v28; // eax
  _BYTE *v29; // esi
  int v30; // ecx
  unsigned __int8 v31; // dl
  unsigned __int8 v32; // al
  unsigned __int8 v33; // al
  int v34; // [esp+10h] [ebp-10h]
  int v35; // [esp+14h] [ebp-Ch]
  int v36; // [esp+18h] [ebp-8h]
  int v37; // [esp+1Ch] [ebp-4h]
  int v38; // [esp+24h] [ebp+4h]
  int v39; // [esp+24h] [ebp+4h]

  v1 = *a1 - 1;
  if ( v1 > 0 )
  {
    v2 = v1 & 0xFFFE;
    v36 = v2;
  }
  else
  {
    v36 = 0;
    v2 = 0;
  }
  v3 = a1[1] - 1;
  if ( v3 > 0 )
  {
    result = v3 & 0xFFFE;
    v38 = result;
  }
  else
  {
    v38 = 0;
    result = 0;
  }
  v5 = result + 4;
  v6 = result;
  v37 = result + 4;
    while ( v6 <= v5 )
    {
      v7 = v2;
        while ( v7 <= v2 + 4 )
        {
          v8 = sub_410580(v7, v6);
          v9 = v8;
          if ( v8 && !(*(_BYTE *)(v8 + 4) & 0x8C) )
          {
            if ( *(_DWORD *)(v8 + 28) )
            {
              sub_4107A0(*(LPVOID *)(v8 + 28));
              *(_DWORD *)(v9 + 28) = 0;
            }
            sub_410430(*(unsigned __int8 *)(v9 + 5), *(unsigned __int8 *)(v9 + 6));
          }
          ++v7;
        }
        v5 = v37;
        result = v38;
      ++v6;
    }
  v10 = result;
  v35 = result;
  if ( result > v5 )
    return result;
  v11 = v2 + 4;
  do
  {
    v34 = v2;
    v12 = v10;
    v13 = v12;
    result = v12 - HIDWORD(v12);
    v14 = v13 / 2;
    if ( v2 > v11 )
      goto LABEL_72;
    do
    {
      v15 = 0;
      v16 = v34 / 2;
      if ( v34 / 2 >= 128 )
        goto LABEL_70;
      if ( v14 < 128 )
      {
        v17 = 44 * v14 + *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v16);
        if ( *(_DWORD *)(v17 + 24) != 255 )
          v15 = 8;
        if ( *(_DWORD *)(v17 + 4) != 255 )
          v15 |= 2u;
        if ( v14 > 0 && *(_DWORD *)(v17 - 20) != 255 )
          v15 |= 4u;
        if ( v16 > 0 && *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v16 - 4) + 44 * v14 + 4) != 255 )
          v15 |= 1u;
        if ( *(_DWORD *)&byte_587000[4 * v15 + 255052] != 255 )
        {
          v18 = (unsigned __int8 *)sub_410580(v34, v35);
          v19 = v18;
          if ( v18 )
          {
            if ( v18[4] & 0x8C )
              goto LABEL_45;
            if ( *v18 == *(_DWORD *)&byte_587000[4 * v15 + 255052] )
              goto LABEL_45;
            v20 = v18[1];
            if ( v20 == *(_DWORD *)&byte_5D4594[3835376] )
              goto LABEL_45;
            v21 = byte_587000[4 * v15 + 255052];
            v18[2] = 0;
            *v18 = v21;
            if ( v21 )
            {
              if ( v21 != 1 )
                goto LABEL_45;
            }
            v22 = sub_410E00(v20);
          }
          else
          {
            v23 = (unsigned __int8 *)sub_410250(v34, v35);
            v19 = v23;
            if ( !v23 )
              goto LABEL_45;
            v24 = byte_587000[4 * v15 + 255052];
            v23[2] = 0;
            *v23 = v24;
            v23[1] = byte_5D4594[3835376];
            if ( v24 )
            {
              if ( v24 != 1 )
                goto LABEL_45;
            }
            v22 = sub_410E00(v23[1]);
          }
          v19[2] = v19[5] % (__int16)v22;
        }
      }
LABEL_45:
      if ( v14 < 128 )
      {
        v39 = 0;
        if ( v14 > 0 && *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v16) + 44 * v14 - 20) != 255 )
          v39 = 2;
        if ( v16 > 0 )
        {
          v25 = 44 * v14;
          v26 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v16 - 4);
          if ( *(_DWORD *)(v26 + 44 * v14 + 4) != 255 )
            v39 |= 8u;
          if ( v14 > 0 )
          {
            if ( *(_DWORD *)(v26 + v25 - 40) != 255 )
              v39 |= 4u;
            if ( *(_DWORD *)(v26 + v25 - 20) != 255 )
            {
              v27 = v39;
              LOBYTE(v27) = v39 | 1;
              v39 = v27;
            }
          }
        }
        if ( *(_DWORD *)&byte_587000[4 * v39 + 255052] != 255 )
        {
          v28 = (unsigned __int8 *)sub_410580(v34 - 1, v35 - 1);
          v29 = v28;
          if ( v28 )
          {
            if ( !(v28[4] & 0x8C) && *v28 != *(_DWORD *)&byte_587000[4 * v39 + 255052] )
            {
              v30 = v28[1];
              if ( v30 != *(_DWORD *)&byte_5D4594[3835376] )
              {
                v31 = byte_587000[4 * v39 + 255052];
                v28[2] = 0;
                *v28 = v31;
                if ( !v31 || v31 == 1 )
                {
                  v32 = sub_410E00(v30);
LABEL_69:
                  v29[2] = (unsigned __int8)v29[5] % (__int16)v32;
                  goto LABEL_70;
                }
              }
            }
          }
          else
          {
            v29 = sub_410250(v34 - 1, v35 - 1);
            if ( v29 )
            {
              v33 = byte_587000[4 * v39 + 255052];
              v29[2] = 0;
              *v29 = v33;
              v29[1] = byte_5D4594[3835376];
              if ( !v33 || v33 == 1 )
              {
                v32 = sub_410E00((unsigned __int8)v29[1]);
                goto LABEL_69;
              }
            }
          }
        }
      }
LABEL_70:
      result = v34 + 2;
      v11 = v36 + 4;
      v34 = result;
    }
    while ( result <= v36 + 4 );
    v5 = v37;
    v10 = v35;
    v2 = v36;
LABEL_72:
    v10 += 2;
    v35 = v10;
  }
  while ( v10 <= v5 );
  return result;
}

//----- (005277D0) --------------------------------------------------------
int *__cdecl sub_5277D0(int *a1, int a2)
{
  int *result; // eax
  int *v3; // esi

  result = a1;
  if ( a1 )
  {
    result = (int *)*a1;
    if ( *a1 )
    {
      result = (int *)sub_410580(*((unsigned __int8 *)result + 5), *((unsigned __int8 *)result + 6));
      v3 = result;
      if ( result )
      {
        if ( a2 < *(int *)&byte_5D4594[251540] )
        {
          *((_BYTE *)result + 1) = a2;
          if ( *((_BYTE *)result + 2) >= sub_410DD0((unsigned __int8)a2, *(unsigned __int8 *)result, 0) )
            *((_BYTE *)v3 + 2) = 0;
          result = (int *)1;
        }
        else
        {
          result = 0;
        }
      }
    }
  }
  return result;
}

//----- (00527840) --------------------------------------------------------
int *__cdecl sub_527840(int *a1, int a2)
{
  int *result; // eax
  int *v3; // esi

  result = a1;
  if ( a1 )
  {
    result = (int *)*a1;
    if ( *a1 )
    {
      result = (int *)sub_410580(*((unsigned __int8 *)result + 5), *((unsigned __int8 *)result + 6));
      v3 = result;
      if ( result )
      {
        if ( a2 < 15 )
        {
          *(_BYTE *)result = a2;
          if ( *((_BYTE *)result + 2) >= sub_410DD0(*((unsigned __int8 *)result + 1), (unsigned __int8)a2, 0) )
            *((_BYTE *)v3 + 2) = 0;
          result = (int *)1;
        }
        else
        {
          result = 0;
        }
      }
    }
  }
  return result;
}

//----- (005278B0) --------------------------------------------------------
int *__cdecl sub_5278B0(int *a1, int a2)
{
  int *result; // eax
  int *v3; // esi

  result = a1;
  if ( a1 )
  {
    result = (int *)*a1;
    if ( *a1 )
    {
      result = (int *)sub_410580(*((unsigned __int8 *)result + 5), *((unsigned __int8 *)result + 6));
      v3 = result;
      if ( result )
      {
        if ( a2 < sub_410DD0(*((unsigned __int8 *)result + 1), *(unsigned __int8 *)result, 0) )
        {
          *((_BYTE *)v3 + 2) = a2;
          result = (int *)1;
        }
        else
        {
          result = 0;
        }
      }
    }
  }
  return result;
}

//----- (00527920) --------------------------------------------------------
int __cdecl sub_527920(CHAR *a1)
{
  int result; // eax

  result = sub_4E3AA0(a1);
  if ( !result )
    result = -1;
  return result;
}

//----- (00527940) --------------------------------------------------------
int __cdecl sub_527940(char *a1)
{
  int result; // eax

  if ( _strcmpi(a1, (const char *)&byte_587000[255128]) )
  {
    if ( a1 )
    {
      *(_DWORD *)&byte_5D4594[3835388] = sub_4E3AA0(a1);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835388] = 0;
    result = 1;
  }
  return result;
}

//----- (00527980) --------------------------------------------------------
int __cdecl sub_527980(int a1)
{
  if ( a1 < 0 || a1 > sub_4E3AC0() )
    return 0;
  *(_DWORD *)&byte_5D4594[3835388] = a1;
  return 1;
}

//----- (005279B0) --------------------------------------------------------
float *__cdecl sub_5279B0(float2 *a1)
{
  float *result; // eax
  float2 a2; // [esp+4h] [ebp-8h]

  if ( !*(_DWORD *)&byte_5D4594[3835388] )
    return 0;
  result = (float *)sub_4D3D90(a1, &a2);
  if ( result )
  {
    result = (float *)sub_4E3450(*(int *)&byte_5D4594[3835388]);
    if ( result )
      result = sub_527A10(result, &a1->field_0);
  }
  return result;
}

//----- (00527A10) --------------------------------------------------------
float *__cdecl sub_527A10(float *a1, float2 *a2)
{
  float v3; // ecx
  float v4; // eax
  int v5; // ecx
  CHAR *v6; // eax
  float2 v7; // [esp+4h] [ebp-8h]

  if ( !sub_4D3D90(a2, &v7) )
    return a1;
  if ( !a1 )
    return 0;
  v3 = v7.field_4;
  a1[10] = *(float *)&byte_5D4594[3835392];
  v4 = v7.field_0;
  ++*(_DWORD *)&byte_5D4594[3835392];
  a1[15] = v3;
  v5 = *((_DWORD *)a1 + 4) | 0x1000000;
  a1[14] = v4;
  *((_DWORD *)a1 + 4) = v5;
  v6 = (CHAR *)sub_4E39D0((int)a1);
  if ( *(int (__cdecl **)(int))(sub_4E3B60(v6) + 212) == sub_4F4CB0 )
  {
    a1[14] = (double)(int)(23 * (unsigned __int64)(__int64)(v7.field_0 * 0.043478262 + 0.5));
    a1[15] = (double)(int)(23 * (unsigned __int64)(__int64)(v7.field_4 * 0.043478262 + 0.5));
  }
  sub_4DAA50((int)a1, 0, a1[14], a1[15]);
  sub_4DB030();
  return a1;
}

//----- (00527B00) --------------------------------------------------------
int __cdecl sub_527B00(float2 *a1)
{
  int result; // eax
  int v2; // esi
  float2 v3; // [esp+4h] [ebp-8h]

  result = sub_4D3D90(a1, &v3);
  if ( result )
  {
    result = sub_527B70((__int64)v3.field_0, (__int64)v3.field_4, *(int *)&byte_587000[255124]);
    v2 = result;
    if ( result )
    {
      sub_4DAFD0((_DWORD *)result);
      sub_4E38A0(v2);
      result = 1;
    }
  }
  return result;
}

//----- (00527B70) --------------------------------------------------------
int __cdecl sub_527B70(int a1, int a2, int a3)
{
  int v3; // edi
  int v4; // ebx
  int v5; // esi
  int v7; // [esp+8h] [ebp-4h]

  v7 = 0;
  v3 = sub_4DA790();
  if ( !v3 )
    return 0;
  v4 = a3;
  do
  {
    v5 = (unsigned __int64)(__int64)*(float *)(v3 + 56) - a1;
    if ( (int)(v5 * v5
             + ((unsigned __int64)(__int64)*(float *)(v3 + 60) - a2)
             * ((unsigned __int64)(__int64)*(float *)(v3 + 60) - a2)) < v4 )
    {
      v4 = v5 * v5
         + ((unsigned __int64)(__int64)*(float *)(v3 + 60) - a2) * ((unsigned __int64)(__int64)*(float *)(v3 + 60) - a2);
      v7 = v3;
    }
    v3 = sub_4DA7A0(v3);
  }
  while ( v3 );
  return v7;
}

//----- (00527BE0) --------------------------------------------------------
int __cdecl sub_527BE0(_DWORD *a1)
{
  if ( !a1 )
    return 0;
  sub_4DAFD0(a1);
  sub_4E38A0((int)a1);
  return 1;
}

//----- (00527C10) --------------------------------------------------------
int __cdecl sub_527C10(float2 *a1)
{
  int result; // eax
  float2 v2; // [esp+0h] [ebp-8h]

  result = sub_4D3D90(a1, &v2);
  if ( result )
    result = sub_527B70((__int64)v2.field_0, (__int64)v2.field_0, *(int *)&byte_587000[255124]);
  return result;
}

//----- (00527C60) --------------------------------------------------------
int __cdecl sub_527C60(int a1, int a2)
{
  int v2; // edi
  int v3; // eax
  int v4; // eax
  int result; // eax
  _DWORD *v6; // eax
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx

  if ( !a1 )
    return 0;
  if ( (*(_BYTE *)(a1 + 8) & 2) == 2 )
  {
    v2 = *(_DWORD *)(a1 + 748);
    v3 = sub_4D3FF0(a2);
    v4 = sub_509E90(v3);
    *(_DWORD *)(v2 + 376) = v4;
    *(_WORD *)(a1 + 124) = v4;
    return 1;
  }
  if ( !(*(_DWORD *)(a1 + 8) & 0x80) )
    return 0;
  v6 = *(_DWORD **)(a1 + 748);
  switch ( a2 )
  {
    case 1:
      v6[3] = 0;
      v7 = v6[3];
      v6[1] = v7;
      v6[2] = v7;
      result = 1;
      break;
    case 3:
      v6[3] = 24;
      v10 = v6[3];
      v6[1] = v10;
      v6[2] = v10;
      result = 1;
      break;
    case 5:
      v6[3] = 8;
      v8 = v6[3];
      v6[1] = v8;
      v6[2] = v8;
      result = 1;
      break;
    case 7:
      v6[3] = 16;
      v9 = v6[3];
      v6[1] = v9;
      v6[2] = v9;
      result = 1;
      break;
    default:
      return 0;
  }
  return result;
}

//----- (00527D50) --------------------------------------------------------
int __cdecl sub_527D50(int a1, char *a2)
{
  CHAR *v3; // eax

  if ( !a1 )
    return 0;
  if ( !a2 )
    return 0;
  v3 = (CHAR *)sub_4E39D0(a1);
  if ( *(int (__cdecl **)(int))(sub_4E3B60(v3) + 212) != sub_4F4B90 )
    return 0;
  strncpy(*(char **)(a1 + 700), a2, 0x50u);
  return 1;
}

//----- (00527DB0) --------------------------------------------------------
int __cdecl sub_527DB0(int a1, char a2)
{
  CHAR *v3; // eax

  if ( !a1 )
    return 0;
  v3 = (CHAR *)sub_4E39D0(a1);
  if ( *(int (__cdecl **)(int *))(sub_4E3B60(v3) + 212) != sub_4F5F30 )
    return 0;
  **(_BYTE **)(a1 + 736) = a2;
  return 1;
}

//----- (00527E00) --------------------------------------------------------
int *__cdecl sub_527E00(int a1)
{
  int v1; // ecx
  int *result; // eax
  int v3; // edx

  v1 = 32;
  result = (int *)(a1 + 560);
  do
  {
    v3 = *result;
    ++result;
    --v1;
    *(result - 1) = v3 & 0xFFF;
  }
  while ( v1 );
  return result;
}

//----- (00527E20) --------------------------------------------------------
BOOL __cdecl sub_527E20(int a1, unsigned int a2, int a3)
{
  BOOL result; // eax

  if ( a3 && a2 < 0x20 )
    result = (a1 & *(_DWORD *)(a3 + 4 * a2 + 560)) != 0;
  else
    result = 0;
  return result;
}

//----- (00527E50) --------------------------------------------------------
int __cdecl sub_527E50(int a1, _DWORD *a2)
{
  unsigned int v2; // edi
  int v3; // eax

  v2 = *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064);
  if ( a2 && v2 < 0x20 )
  {
    v3 = a2[v2 + 140];
    if ( !(v3 & 0xFFF0000) )
      return 0;
    if ( (v3 & 0x10000) == 0x10000 )
    {
      sub_4D81F0(v2, a2);
      a2[v2 + 140] &= 0xFFFEFFFF;
    }
    if ( (a2[v2 + 140] & 0x20000) == 0x20000 )
    {
      if ( !sub_5330C0(a1, (int)a2) )
        sub_4D8620(v2, a2);
      a2[v2 + 140] &= 0xFFFDFFFF;
    }
    if ( (a2[v2 + 140] & 0x40000) == 0x40000 )
    {
      sub_4D8FD0(v2, a2);
      a2[v2 + 140] &= 0xFFFBFFFF;
    }
    if ( (a2[v2 + 140] & 0x80000) == 0x80000 )
    {
      sub_4D8230(v2, a2);
      a2[v2 + 140] &= 0xFFF7FFFF;
    }
    if ( (a2[v2 + 140] & 0x400000) == 0x400000 )
    {
      sub_4D9020(v2, (int)a2);
      a2[v2 + 140] &= 0xFFBFFFFF;
    }
    if ( (0x800000 & a2[v2 + 140]) == 0x800000 )
    {
      sub_4D8F90(v2, a2);
      a2[v2 + 140] &= 0xFF7FFFFF;
    }
    if ( (a2[v2 + 140] & 0x2000000) == 0x2000000 )
    {
      sub_4D92D0(v2, (int)a2);
      a2[v2 + 140] &= 0xFDFFFFFF;
    }
    if ( (a2[v2 + 140] & 0x4000000) == 0x4000000 )
    {
      sub_4D93A0(v2, (int)a2);
      a2[v2 + 140] &= 0xFBFFFFFF;
    }
  }
  return 1;
}

//----- (00528030) --------------------------------------------------------
__int16 __cdecl sub_528030(int a1)
{
  int v1; // ebp
  int v2; // esi
  unsigned __int16 *v3; // edi
  int v4; // ebx
  int v5; // edi
  int v6; // edx
  unsigned int v7; // ebx
  int v8; // eax
  __int16 result; // ax
  int v10; // edx
  int v11; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(unsigned __int16 **)(a1 + 556);
  v4 = *(_DWORD *)(v2 + 276);
  v11 = *(unsigned __int8 *)(v4 + 2064);
  if ( *(_WORD *)(v2 + 10) == *v3 )
    goto LABEL_5;
  if ( abs32(*v3 - *(unsigned __int16 *)(v2 + 10)) >= v3[2] / 10
    || (v5 = *(_DWORD *)&byte_5D4594[2598000],
        v6 = *(_DWORD *)(v4 + 2176),
        v7 = *(_DWORD *)&byte_5D4594[2649704],
        (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v6) > *(int *)&byte_5D4594[2649704] >> 2) )
  {
    sub_4D86E0(v11);
    v8 = *(_DWORD *)(v2 + 276);
    *(_WORD *)(v2 + 10) = **(_WORD **)(v1 + 556);
    *(_DWORD *)(v8 + 2176) = *(_DWORD *)&byte_5D4594[2598000];
LABEL_5:
    v5 = *(_DWORD *)&byte_5D4594[2598000];
    v7 = *(_DWORD *)&byte_5D4594[2649704];
  }
  result = *(_WORD *)(v2 + 4);
  if ( *(_WORD *)(v2 + 6) != result )
  {
    result = 0;
    if ( abs32(*(unsigned __int16 *)(v2 + 4) - *(unsigned __int16 *)(v2 + 6)) >= *(unsigned __int16 *)(v2 + 8) / 10
      || v5 - *(_DWORD *)(*(_DWORD *)(v2 + 276) + 2180) > v7 >> 2 )
    {
      sub_4D8930(v11, v1);
      v10 = *(_DWORD *)(v2 + 276);
      *(_WORD *)(v2 + 6) = *(_WORD *)(v2 + 4);
      result = *(_WORD *)&byte_5D4594[2598000];
      *(_DWORD *)(v10 + 2180) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
  return result;
}

//----- (00528190) --------------------------------------------------------
int __cdecl sub_528190(int a1)
{
  _WORD *v1; // eax
  bool v2; // zf
  int result; // eax

  v1 = *(_WORD **)(a1 + 556);
  if ( !v1 )
    goto LABEL_11;
  if ( *v1 )
  {
    v2 = v1[2] == 0;
    if ( v1[2] )
      return 1;
  }
  else
  {
    v2 = v1[2] == 0;
  }
  if ( v2 )
    result = 1;
  else
LABEL_11:
    result = 0;
  return result;
}

//----- (005281D0) --------------------------------------------------------
int sub_5281D0()
{
  int result; // eax

  result = *(_DWORD *)&byte_5D4594[2598000] + 1;
  *(_DWORD *)&byte_5D4594[2487684] = *(_DWORD *)&byte_5D4594[2598000] + 1;
  return result;
}

//----- (005281E0) --------------------------------------------------------
int sub_5281E0()
{
  int result; // eax

  result = *(_DWORD *)&byte_5D4594[2598000];
  *(_DWORD *)&byte_5D4594[2487684] = *(_DWORD *)&byte_5D4594[2598000];
  return result;
}

//----- (005281F0) --------------------------------------------------------
void __cdecl sub_5281F0(float a1)
{
  float v1; // edi
  int v2; // eax
  int v3; // ebp
  double v4; // st7
  int v5; // esi
  int *v6; // ebx
  double v7; // st7
  double v8; // st6
  double v9; // st7
  double v10; // st6
  int v11; // eax
  int v12; // eax
  int v13; // esi
  int v14; // eax
  int v15; // eax
  int v16; // esi
  int v17; // [esp+10h] [ebp-10h]
  float v18; // [esp+10h] [ebp-10h]
  int v19; // [esp+14h] [ebp-Ch]
  float v20; // [esp+18h] [ebp-8h]
  float v21; // [esp+24h] [ebp+4h]

  v1 = a1;
  v17 = 0;
  v2 = *(_DWORD *)(LODWORD(a1) + 16);
  v3 = *(_DWORD *)(LODWORD(a1) + 748);
  if ( (v2 & 0x8000) != 0 && !sub_534A40(SLODWORD(a1)) )
    return;
  if ( sub_40A5C0(4096) )
    v4 = 640.0;
  else
    v4 = 250.0;
  if ( v4 >= *(float *)(v3 + 1312) )
    v21 = v4;
  else
    v21 = *(float *)(v3 + 1312);
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v3 + 1212) <= (unsigned int)(2 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    v19 = 0;
  }
  else
  {
    v19 = 1;
    *(_DWORD *)(v3 + 1212) = *(_DWORD *)&byte_5D4594[2598000];
  }
  v5 = 0;
  if ( *(_BYTE *)(v3 + 1129) )
  {
    v6 = (int *)(v3 + 1132);
    do
    {
      if ( *(_DWORD *)(*v6 + 16) & 0x8020
        || !sub_536FB0(SLODWORD(v1), *v6, 0)
        || (v7 = *(float *)(LODWORD(v1) + 56) - *(float *)(*v6 + 56),
            v8 = *(float *)(LODWORD(v1) + 60) - *(float *)(*v6 + 60),
            v20 = (v21 + 30.0) * (v21 + 30.0),
            v8 * v8 + v7 * v7 > v20)
        || (v9 = *(float *)(LODWORD(v1) + 56) - *(float *)(LODWORD(v1) + 72),
            v10 = *(float *)(LODWORD(v1) + 60) - *(float *)(LODWORD(v1) + 76),
            v10 * v10 + v9 * v9 > 1000.0)
        || v19 && !sub_5370E0(SLODWORD(v1), *v6, 0) )
      {
        sub_528560(SLODWORD(v1), v5--);
        v17 = 1;
        --v6;
      }
      ++v5;
      ++v6;
    }
    while ( v5 < *(unsigned __int8 *)(v3 + 1129) );
  }
  v11 = *(_DWORD *)(v3 + 1196);
  if ( v11 && sub_4FF350(v11, 28) )
    v17 = 1;
  if ( (!*(_DWORD *)(v3 + 1196)
     || *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v3 + 1204) > (unsigned int)(2 * *(_DWORD *)&byte_5D4594[2649704]))
    && (*(_DWORD *)(v3 + 1208) <= *(int *)&byte_5D4594[2598000]
     || *(_DWORD *)&byte_5D4594[2598000] == *(_DWORD *)&byte_5D4594[2487684]) )
  {
    sub_517F90((float2 *)(LODWORD(v1) + 56), v21, sub_5286D0, SLODWORD(v1));
    *(_DWORD *)(v3 + 1204) = *(_DWORD *)&byte_5D4594[2598000];
    *(_DWORD *)(v3 + 1212) = *(_DWORD *)&byte_5D4594[2598000];
    goto LABEL_31;
  }
  if ( v17 )
  {
LABEL_31:
    v12 = *(_DWORD *)(v3 + 1196);
    if ( v12 )
      v13 = *(_DWORD *)(v12 + 36);
    else
      v13 = 0;
    sub_528610(SLODWORD(v1));
    v14 = *(_DWORD *)(v3 + 1196);
    if ( v14 && v13 && v13 != *(_DWORD *)(v14 + 36) )
      *(_DWORD *)(v3 + 1200) = v13;
  }
  if ( *(_DWORD *)(v3 + 1204) == *(_DWORD *)&byte_5D4594[2598000] )
  {
    v15 = *(_DWORD *)(v3 + 1440);
    if ( v15 & 0x400 || sub_40A5C0(0x2000) || *(_DWORD *)(v3 + 1196) )
    {
      *(_DWORD *)(v3 + 1208) = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(5, 10);
    }
    else
    {
      v16 = 5 * *(_DWORD *)&byte_5D4594[2649704];
      v18 = sub_5336D0(SLODWORD(v1));
      *(float *)(v3 + 524) = v18;
      if ( v18 < 0.0 )
      {
        *(_DWORD *)(v3 + 1208) = v16 + *(_DWORD *)&byte_5D4594[2598000];
      }
      else if ( v18 > (double)v21 )
      {
        *(_DWORD *)(v3 + 1208) = (unsigned __int64)(__int64)((v18 - v21) * (double)v16 / (1000.0 - v21))
                               + 10
                               + *(_DWORD *)&byte_5D4594[2598000];
      }
      else
      {
        *(_DWORD *)(v3 + 1208) = sub_415FA0(5, 10) + *(_DWORD *)&byte_5D4594[2598000];
      }
    }
  }
}

//----- (00528560) --------------------------------------------------------
int __cdecl sub_528560(int a1, int a2)
{
  int v2; // esi
  int v3; // eax
  int *v4; // edi
  int v5; // eax
  int v6; // eax
  int v7; // edx
  int v8; // ecx
  int result; // eax
  int v10; // [esp-4h] [ebp-14h]

  v2 = *(_DWORD *)(a1 + 748);
  v3 = *(_DWORD *)(v2 + 4 * a2 + 1132);
  v4 = (int *)(v2 + 4 * a2 + 1132);
  v10 = *(_DWORD *)(v3 + 36);
  v5 = sub_4E39D0(v3);
  sub_5341A0((char *)&byte_587000[255232], *(_DWORD *)&byte_5D4594[2598000], v5, v10);
  sub_502490((int *)(v2 + 1296), *v4, a1);
  v6 = *(_DWORD *)(v2 + 1196);
  if ( *v4 == v6 )
  {
    v7 = *(_DWORD *)(v6 + 36);
    *(_DWORD *)(v2 + 1196) = 0;
    *(_DWORD *)(v2 + 1200) = v7;
  }
  v8 = a2;
  LOBYTE(result) = *(_BYTE *)(v2 + 1129) - 1;
  *(_BYTE *)(v2 + 1129) = result;
  result = (unsigned __int8)result;
  if ( a2 < (unsigned __int8)result )
  {
    result = v2 + 4 * a2 + 1132;
    do
    {
      ++v8;
      *(_DWORD *)result = *(_DWORD *)(result + 4);
      result += 4;
    }
    while ( v8 < *(unsigned __int8 *)(v2 + 1129) );
  }
  return result;
}

//----- (00528610) --------------------------------------------------------
void __cdecl sub_528610(int a1)
{
  int v1; // ebx
  int v2; // esi
  int v3; // ebp
  char v4; // al
  int *i; // edi
  double v6; // st7
  double v7; // st6
  double v8; // st5
  float v9; // [esp+14h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  v3 = 0;
  v9 = 100000000.0;
  v4 = *(_BYTE *)(v2 + 1129);
  *(_DWORD *)(v2 + 1196) = 0;
  if ( v4 )
  {
    for ( i = (int *)(v2 + 1132); *i != *(_DWORD *)(v2 + 1216); ++i )
    {
      if ( sub_5330C0(v1, *i) && sub_528190(*i) )
      {
        v6 = *(float *)(*i + 56) - *(float *)(v1 + 56);
        v7 = *(float *)(*i + 60) - *(float *)(v1 + 60);
        v8 = v7 * v7 + v6 * v6;
        if ( v8 < v9 )
        {
          v9 = v8;
          *(_DWORD *)(v2 + 1196) = *i;
        }
      }
      if ( ++v3 >= *(unsigned __int8 *)(v2 + 1129) )
        return;
    }
    *(_DWORD *)(v2 + 1196) = *(_DWORD *)(v2 + 1216);
  }
}

//----- (005286D0) --------------------------------------------------------
void __cdecl sub_5286D0(int a1, int a2)
{
  int v2; // esi
  int v3; // ebx
  int v4; // eax
  int v5; // eax
  double v6; // st7
  double v7; // st6
  float *v8; // eax
  float v9; // [esp+10h] [ebp-4h]
  float v10; // [esp+1Ch] [ebp+8h]

  v2 = a2;
  v3 = *(_DWORD *)(a2 + 748);
  if ( a2 != a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 6 )
    {
      if ( !(*(_DWORD *)(a1 + 16) & 0x8020) )
      {
        v4 = *(_DWORD *)(v3 + 1440);
        if ( (v4 & 0x400 || sub_5330C0(a2, a1)) && !sub_528950(a2, a1) )
        {
          v5 = *(_DWORD *)(v3 + 1440);
          if ( v5 & 0x100
            || (v6 = *(float *)(a1 + 56) - *(float *)(a2 + 56),
                v7 = *(float *)(a1 + 60) - *(float *)(a2 + 60),
                v9 = v7,
                v8 = (float *)&byte_587000[8 * *(__int16 *)(a2 + 124) + 194136],
                v10 = sqrt(v7 * v9 + v6 * v6) + 0.001,
                v9 / v10 * v8[1] + v6 / v10 * *v8 >= 0.5) )
          {
            if ( sub_5370E0(v2, a1, 0) )
              sub_5287B0(v2, a1);
          }
        }
      }
    }
  }
}

//----- (005287B0) --------------------------------------------------------
void __cdecl sub_5287B0(int a1, int a2)
{
  int v2; // esi
  double v3; // st7
  int v4; // edi
  int v5; // ebx
  int v6; // ebp
  int v7; // edx
  double v8; // st6
  double v9; // st5
  double v10; // st4
  int v11; // ebx
  double v12;
  double v13;
  unsigned int v15; // eax
  int v16; // eax
  int v17; // eax
  float v18; // [esp+14h] [ebp+4h]

  v2 = a1;
  v3 = 0.0;
  v4 = *(_DWORD *)(a1 + 748);
  v5 = 16;
  v6 = 0;
  if ( *(_BYTE *)(v4 + 1129) != 16 )
  {
    v11 = a2;
LABEL_9:
    *(_DWORD *)(v4 + 4 * *(unsigned __int8 *)(v4 + 1129) + 1132) = v11;
    v15 = *(_DWORD *)(v4 + 536);
    ++*(_BYTE *)(v4 + 1129);
    if ( *(_DWORD *)&byte_5D4594[2598000] > v15 )
    {
      if ( sub_5330C0(v2, v11) )
      {
        if ( !sub_534A40(v2) || (v16 = *(_DWORD *)(v2 + 16), (v16 & 0x8000) == 0) )
        {
          v17 = sub_424300(v2);
          if ( v17 )
            sub_501960(*(_DWORD *)(v17 + 68), v2, 0, 0);
          *(_DWORD *)(v4 + 536) = *(_DWORD *)&byte_5D4594[2598000]
                                + sub_415FA0(2 * *(_DWORD *)&byte_5D4594[2649704], 4 * *(_DWORD *)&byte_5D4594[2649704]);
        }
      }
    }
    sub_502490((int *)(v4 + 1232), v11, v2);
    return;
  }
  v7 = v4 + 1132;
  do
  {
    v8 = *(float *)(*(_DWORD *)v7 + 56) - *(float *)(v2 + 56);
    v9 = *(float *)(*(_DWORD *)v7 + 60) - *(float *)(v2 + 60);
    v10 = v9 * v9 + v8 * v8;
    if ( v10 > v3 )
    {
      v18 = v10;
      v3 = v18;
      v6 = *(_DWORD *)v7;
    }
    v7 += 4;
    --v5;
  }
  while ( v5 );
  v11 = a2;
  v12 = *(float *)(a2 + 56) - *(float *)(v2 + 56);
  v13 = *(float *)(a2 + 60) - *(float *)(v2 + 60);
  if ( v3 > v13 * v13 + v12 * v12 )
  {
    sub_528910(v2, v6);
    goto LABEL_9;
  }
}

//----- (00528910) --------------------------------------------------------
int __cdecl sub_528910(int a1, int a2)
{
  int result; // eax
  int v3; // edx
  int v4; // ecx
  _DWORD *i; // edx

  result = 0;
  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(unsigned __int8 *)(v3 + 1129);
  if ( v4 > 0 )
  {
    for ( i = (_DWORD *)(v3 + 1132); *i != a2; ++i )
    {
      if ( ++result >= v4 )
        return result;
    }
    result = sub_528560(a1, result);
  }
  return result;
}

//----- (00528950) --------------------------------------------------------
int __cdecl sub_528950(int a1, int a2)
{
  int v2; // ecx
  int v3; // eax
  int v4; // edx
  _DWORD *i; // ecx

  v2 = *(_DWORD *)(a1 + 748);
  v3 = 0;
  v4 = *(unsigned __int8 *)(v2 + 1129);
  if ( v4 <= 0 )
    return 0;
  for ( i = (_DWORD *)(v2 + 1132); *i != a2; ++i )
  {
    if ( ++v3 >= v4 )
      return 0;
  }
  return 1;
}

//----- (00528990) --------------------------------------------------------
int __cdecl sub_528990(int a1)
{
  int result; // eax
  int i; // esi

  result = sub_4DA8A0();
  for ( i = result; result; i = result )
  {
    if ( *(_BYTE *)(i + 8) & 2 )
    {
      if ( !(*(_BYTE *)(i + 16) & 0x20) )
      {
        sub_528910(i, a1);
        sub_528610(i);
      }
    }
    result = sub_4DA8B0(i);
  }
  return result;
}

//----- (005289D0) --------------------------------------------------------
char *__cdecl sub_5289D0(int a1)
{
  char *result; // eax
  int i; // edi
  int v4; // [esp+0h] [ebp-4h]

  result = sub_416EA0();
  for ( i = (int)result; result; i = (int)result )
  {
    if ( (1 << *(_BYTE *)(i + 2064)) & *(_DWORD *)(a1 + 148) )
    {
      LOBYTE(v4) = ((unsigned __int8)*(_DWORD *)(a1 + 20) >> 6) | 0x31;
      *(_WORD *)((char *)&v4 + 1) = sub_578AC0((_DWORD *)a1);
      sub_4E5420(*(unsigned __int8 *)(i + 2064), &v4, 3, 0, 1);
    }
    if ( *(_BYTE *)(a1 + 8) & 6 )
      sub_4D97A0(*(unsigned __int8 *)(i + 2064), (_DWORD *)a1, 0);
    result = sub_416EE0(i);
  }
  return result;
}

//----- (00528A60) --------------------------------------------------------
int __cdecl sub_528A60(int a1, _DWORD *a2)
{
  int v2; // ecx
  char v4[3]; // [esp+0h] [ebp-4h]
  char v5; // [esp+3h] [ebp-1h]

  v5 = HIBYTE(v2);
  v4[0] = 50;
  *(_WORD *)&v4[1] = sub_578AC0(a2);
  return sub_4E5420(a1, v4, 3, 0, 1);
}

//----- (00528A90) --------------------------------------------------------
int __cdecl sub_528A90(int a1, _DWORD *a2)
{
  int v2; // ecx
  char v4[3]; // [esp+0h] [ebp-4h]
  char v5; // [esp+3h] [ebp-1h]

  v5 = HIBYTE(v2);
  v4[0] = 51;
  *(_WORD *)&v4[1] = sub_578AC0(a2);
  return sub_4E5420(a1, v4, 3, 0, 1);
}

//----- (00528AC0) --------------------------------------------------------
int __cdecl sub_528AC0(int a1, wchar_t *a2, wchar_t a3)
{
  char v3; // al
  __int16 v4; // ax
  double v5; // st7
  __int64 v6; // rax
  double v7; // st7
  int v8; // edi
  int result; // eax
  int i; // esi
  char v11[520]; // [esp+8h] [ebp-208h]

  v11[0] = -88;
  v11[3] = 0;
  if ( sub_4100F0((__int16 *)a2) )
    v3 = v11[3] | 2;
  else
    v3 = v11[3] | 4;
  v11[3] = v3;
  v4 = sub_578AC0((_DWORD *)a1);
  v5 = *(float *)(a1 + 56);
  *(_WORD *)&v11[1] = v4;
  v6 = (__int64)v5;
  v7 = *(float *)(a1 + 60);
  *(_WORD *)&v11[4] = v6;
  *(_WORD *)&v11[6] = (__int64)v7;
  *(_WORD *)&v11[9] = a3;
  v11[8] = nox_wcslen(a2) + 1;
  if ( v11[3] & 4 )
  {
    nox_wcscpy((wchar_t *)&v11[11], a2);
    v8 = 2;
  }
  else
  {
    nox_sprintf(&v11[11], (const char *)&byte_587000[255308], a2);
    v8 = 1;
  }
  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    sub_40EBC0(
      *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064),
      1,
      v11,
      v8 * (unsigned __int8)v11[8] + 11);
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (00528BD0) --------------------------------------------------------
int __cdecl sub_528BD0(int a1, int a2, const char *a3, __int16 a4)
{
  __int16 v4; // ax
  double v5; // st7
  __int64 v6; // rax
  double v7; // st7
  int result; // eax
  int i; // esi
  char v10[520]; // [esp+Ch] [ebp-208h]

  v10[0] = -88;
  v10[3] = 8;
  v4 = sub_578AC0((_DWORD *)a1);
  v5 = *(float *)(a1 + 56);
  *(_WORD *)&v10[1] = v4;
  v6 = (__int64)v5;
  v7 = *(float *)(a1 + 60);
  *(_WORD *)&v10[4] = v6;
  *(_WORD *)&v10[6] = (__int64)v7;
  *(_WORD *)&v10[9] = a4;
  v10[8] = strlen(a3) + 1;
  result = a2;
  strcpy(&v10[11], a3);
  if ( a2 )
  {
    if ( *(_BYTE *)(a2 + 8) & 4 )
      result = sub_40EBC0(
                 *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 2064),
                 1,
                 v10,
                 (unsigned __int8)v10[8] + 11);
  }
  else
  {
    result = sub_4DA7C0();
    for ( i = result; result; i = result )
    {
      sub_40EBC0(
        *(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064),
        1,
        v10,
        (unsigned __int8)v10[8] + 11);
      result = sub_4DA7F0(i);
    }
  }
  return result;
}

//----- (00528D00) --------------------------------------------------------
int __cdecl sub_528D00(_DWORD *a1)
{
  int result; // eax
  int i; // esi
  char v3[3]; // [esp+4h] [ebp-4h]

  v3[0] = -54;
  *(_WORD *)&v3[1] = sub_578AC0(a1);
  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064), 1, v3, 3);
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (00528D60) --------------------------------------------------------
int sub_528D60()
{
  int result; // eax
  int i; // esi
  char v2[3]; // [esp+4h] [ebp-4h]

  v2[0] = -54;
  *(_WORD *)&v2[1] = -8531;
  result = sub_4DA7C0();
  for ( i = result; result; i = result )
  {
    sub_40EBC0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(i + 748) + 276) + 2064), 1, v2, 3);
    result = sub_4DA7F0(i);
  }
  return result;
}

//----- (00528DB0) --------------------------------------------------------
int __cdecl sub_528DB0(int a1)
{
  int v1; // esi
  int result; // eax
  char *v3; // edi
  char *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // edi
  int v14; // eax
  __int16 v15; // ax
  int v16; // edx
  _DWORD *v17; // edi
  _DWORD *v18; // eax
  int v19; // ecx
  int v20; // ebx
  char *v21; // ebp
  int i; // edi
  int v23; // eax
  int *v24; // ebp
  char *v25; // ebx
  char *v26; // ebx
  int v27; // ebp
  unsigned __int8 v28; // bl
  _BYTE *v29; // edi
  int v30; // eax
  int v31; // eax
  int v32; // edi
  int v33; // ebx
  int j; // eax
  int v35; // esi
  int v36; // ecx
  _DWORD *v37; // eax
  _DWORD *v38; // eax
  int v39; // edi
  int *v40; // ecx
  _DWORD *v41; // edx
  int v42; // esi
  int v43; // eax
  int v44; // [esp+10h] [ebp-128h]
  int v45; // [esp+14h] [ebp-124h]
  int v46; // [esp+18h] [ebp-120h]
  _BYTE *v47; // [esp+1Ch] [ebp-11Ch]
  int v48; // [esp+20h] [ebp-118h]
  int v49; // [esp+24h] [ebp-114h]
  int v50; // [esp+28h] [ebp-110h]
  int v51; // [esp+2Ch] [ebp-10Ch]
  _DWORD v52[2]; // [esp+30h] [ebp-108h]
  char v53[256]; // [esp+38h] [ebp-100h]

  v1 = *(_DWORD *)(a1 + 748);
  v51 = *(_DWORD *)(a1 + 136);
  if ( !*(_DWORD *)&byte_5D4594[2487692] )
    *(_DWORD *)&byte_5D4594[2487692] = sub_4E3AA0((CHAR *)&byte_587000[258376]);
  v45 = 64;
  sub_426AC0(&v45, 2u);
  if ( (__int16)v45 > 64 )
    return 0;
  result = sub_4F4530((int *)a1, (__int16)v45);
  if ( !result )
    return result;
  if ( !*(_DWORD *)&byte_5D4594[3803300] )
    sub_509E20(*(__int16 *)(a1 + 124), (int2 *)v52);
  sub_426AC0(v52, 8u);
  if ( (__int16)v45 >= 3 )
  {
    v3 = *(char **)(a1 + 756);
    if ( v3 )
      v4 = v3 + 640;
    else
      v4 = 0;
    sub_4F5580(v1 + 1232, v4);
    if ( v3 )
      v5 = v3 + 896;
    else
      v5 = 0;
    sub_4F5580(v1 + 1264, v5);
    sub_426AC0((_BYTE *)(v1 + 1220), 2u);
    if ( v3 )
      v6 = v3 + 768;
    else
      v6 = 0;
    sub_4F5580(v1 + 1224, v6);
    if ( (__int16)v45 >= 31 )
    {
      v7 = v3 ? v3 + 1024 : 0;
      sub_4F5580(v1 + 1240, v7);
      v8 = v3 ? v3 + 1152 : 0;
      sub_4F5580(v1 + 1248, v8);
      v9 = v3 ? v3 + 1280 : 0;
      sub_4F5580(v1 + 1256, v9);
      v10 = v3 ? v3 + 1408 : 0;
      sub_4F5580(v1 + 1272, v10);
      v11 = v3 ? v3 + 1536 : 0;
      sub_4F5580(v1 + 1280, v11);
      v12 = v3 ? v3 + 1664 : 0;
      sub_4F5580(v1 + 1288, v12);
      if ( (__int16)v45 >= 52 )
      {
        if ( v3 )
          v13 = v3 + 1792;
        else
          v13 = 0;
        sub_4F5580(v1 + 1296, v13);
      }
    }
  }
  else
  {
    sub_4F5540(v1 + 1232);
    sub_4F5540(v1 + 1264);
    sub_426AC0((_BYTE *)(v1 + 1220), 2u);
    sub_4F5540(v1 + 1224);
  }
  v14 = *(_DWORD *)&byte_5D4594[3803300];
  if ( *(_DWORD *)&byte_5D4594[3803300] != 1
    || (v15 = sub_509E00(v52),
        *(_WORD *)(a1 + 126) = v15,
        *(_WORD *)(a1 + 124) = v15,
        v14 = *(_DWORD *)&byte_5D4594[3803300],
        *(_DWORD *)&byte_5D4594[3803300] != 1) )
  {
    if ( !v14 )
    {
      v46 = 0;
      sub_426AC0(&v46, 4u);
    }
  }
  else if ( (__int16)v45 >= 11 )
  {
    v46 = 0;
    sub_426AC0(&v46, 4u);
  }
  if ( (__int16)v45 >= 31 )
  {
    sub_426AC0((_BYTE *)(v1 + 1332), 1u);
    if ( (__int16)v45 < 51 )
    {
      sub_426AC0(&v46, 2u);
      *(_DWORD *)(v1 + 1440) = (unsigned __int16)v46;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1440), 4u);
    }
    sub_426AC0((_BYTE *)(v1 + 1352), 4u);
    sub_426AC0((_BYTE *)(v1 + 1336), 4u);
    sub_426AC0((_BYTE *)(v1 + 1344), 4u);
    sub_426AC0((_BYTE *)(v1 + 1312), 4u);
    if ( (__int16)v45 < 33 )
      sub_426AA0(2);
    sub_426AC0((_BYTE *)(v1 + 1304), 4u);
    *(_DWORD *)(v1 + 1308) = *(_DWORD *)(v1 + 1304);
    if ( (__int16)v45 < 34 )
      sub_426AC0((_BYTE *)(v1 + 1360), 4u);
    LOBYTE(v48) = strlen((const char *)(v1 + 1364));
    sub_426AC0(&v48, 1u);
    sub_426AC0((_BYTE *)(v1 + 1364), (unsigned __int8)v48);
    *(_BYTE *)((unsigned __int8)v48 + v1 + 1364) = 0;
    if ( (__int16)v45 >= 34 )
    {
      if ( *(_DWORD *)&byte_5D4594[3803300] )
      {
        memset((void *)(v1 + 1488), 0, 0x224u);
        sub_426AC0(&v44, 4u);
        for ( i = 0; i < v44; ++i )
        {
          sub_426AC0(&v48, 1u);
          sub_426AC0(v53, (unsigned __int8)v48);
          v53[(unsigned __int8)v48] = 0;
          v23 = sub_4243F0(v53);
          sub_426AC0((_BYTE *)(v1 + 4 * v23 + 1488), 4u);
        }
      }
      else
      {
        v16 = 0;
        v17 = (_DWORD *)(v1 + 1488);
        v44 = 0;
        v18 = (_DWORD *)(v1 + 1488);
        v19 = 137;
        do
        {
          if ( *v18 )
            ++v16;
          ++v18;
          --v19;
        }
        while ( v19 );
        v44 = v16;
        sub_426AC0(&v44, 4u);
        v20 = 0;
        v47 = (_BYTE *)(v1 + 1488);
        do
        {
          if ( *v17 )
          {
            v21 = sub_424870(v20);
            LOBYTE(v46) = strlen(v21);
            sub_426AC0(&v46, 1u);
            sub_426AC0(v21, (unsigned __int8)v46);
            sub_426AC0(v47, 4u);
          }
          ++v20;
          v17 = v47 + 4;
          v47 += 4;
        }
        while ( v20 < 137 );
      }
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1488), 0x224u);
    }
    if ( (__int16)v45 < 46 )
    {
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1448) = (unsigned __int8)v44;
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1450) = (unsigned __int8)v44;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1448), 2u);
      sub_426AC0((_BYTE *)(v1 + 1450), 2u);
    }
    if ( (__int16)v45 <= 32 )
      sub_426AC0(&v49, 4u);
    if ( (__int16)v45 < 46 )
    {
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1456) = (unsigned __int8)v44;
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1458) = (unsigned __int8)v44;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1456), 2u);
      sub_426AC0((_BYTE *)(v1 + 1458), 2u);
    }
    if ( (__int16)v45 <= 32 )
      sub_426AC0(&v49, 4u);
    if ( (__int16)v45 < 46 )
    {
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1464) = (unsigned __int8)v44;
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1466) = (unsigned __int8)v44;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1464), 2u);
      sub_426AC0((_BYTE *)(v1 + 1466), 2u);
    }
    if ( (__int16)v45 <= 32 )
      sub_426AC0(&v49, 4u);
    if ( (__int16)v45 < 46 )
    {
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1472) = (unsigned __int8)v44;
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1474) = (unsigned __int8)v44;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1472), 2u);
      sub_426AC0((_BYTE *)(v1 + 1474), 2u);
    }
    if ( (__int16)v45 <= 32 )
      sub_426AC0(&v49, 4u);
    if ( (__int16)v45 < 46 )
    {
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1480) = (unsigned __int8)v44;
      sub_426AC0(&v44, 1u);
      *(_WORD *)(v1 + 1482) = (unsigned __int8)v44;
    }
    else
    {
      sub_426AC0((_BYTE *)(v1 + 1480), 2u);
      sub_426AC0((_BYTE *)(v1 + 1482), 2u);
    }
    if ( (__int16)v45 > 32 || (sub_426AC0(&v49, 4u), (__int16)v45 >= 32) )
      sub_426AC0((_BYTE *)(v1 + 1316), 4u);
    if ( (__int16)v45 >= 33 )
    {
      sub_426AC0((_BYTE *)(v1 + 2040), 4u);
      sub_426AC0((_BYTE *)(v1 + 1320), 4u);
      if ( (__int16)v45 < 42 )
      {
        sub_426AC0(&v44, 2u);
        if ( !(_WORD)v44 )
          *(_BYTE *)(v1 + 1445) = 1;
      }
      if ( (__int16)v45 < 53 )
      {
        sub_426AC0((_BYTE *)(v1 + 2044), 4u);
        sub_426AC0((_BYTE *)(v1 + 2048), 4u);
        sub_426AC0((_BYTE *)(v1 + 2052), 4u);
      }
      else
      {
        v24 = (int *)(v1 + 2044);
        v46 = 3;
        do
        {
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
          {
            sub_426AC0(&v44, 1u);
            sub_426AC0(v53, (unsigned __int8)v44);
            v53[(unsigned __int8)v44] = 0;
            *v24 = sub_4243F0(v53);
          }
          else
          {
            v25 = sub_424870(*v24);
            LOBYTE(v44) = strlen(v25);
            sub_426AC0(&v44, 1u);
            sub_426AC0(v25, (unsigned __int8)v44);
          }
          ++v24;
          --v46;
        }
        while ( v46 );
      }
    }
    if ( (__int16)v45 >= 34 )
    {
      if ( *(_DWORD *)&byte_5D4594[3803300] )
      {
        sub_426AC0(&v44, 1u);
        sub_426AC0(v53, (unsigned __int8)v44);
        v53[(unsigned __int8)v44] = 0;
        *(_DWORD *)(v1 + 1360) = sub_5345F0(v53);
      }
      else
      {
        v26 = sub_5345B0(*(_DWORD *)(v1 + 1360));
        LOBYTE(v44) = strlen(v26);
        sub_426AC0(&v44, 1u);
        sub_426AC0(v26, (unsigned __int8)v44);
      }
    }
  }
  if ( (__int16)v45 >= 41 )
  {
    result = sub_529CE0(a1);
    if ( !result )
      return result;
  }
  if ( (__int16)v45 >= 42 )
    sub_426AC0((_BYTE *)(v1 + 1445), 1u);
  if ( (__int16)v45 >= 43 && *(_BYTE *)(a1 + 12) & 8 )
  {
    LOBYTE(v44) = 0;
    v27 = *(_DWORD *)(a1 + 692);
    if ( (__int16)v45 >= 50 )
      sub_426AC0((_BYTE *)(v27 + 1716), 4u);
    if ( (__int16)v45 >= 61 )
      sub_426AC0((_BYTE *)(v27 + 1720), 4u);
    if ( (__int16)v45 >= 48 )
    {
      LOBYTE(v47) = strlen((const char *)(v27 + 1684));
      sub_426AC0(&v47, 1u);
      sub_426AC0((_BYTE *)(v27 + 1684), (unsigned __int8)v47);
      *(_BYTE *)((unsigned __int8)v47 + v27 + 1684) = 0;
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      sub_426AC0(&v44, 1u);
      if ( !v27 )
        goto LABEL_137;
      *(_BYTE *)v27 = v44;
    }
    else
    {
      if ( v27 )
        LOBYTE(v44) = *(_BYTE *)v27;
      sub_426AC0(&v44, 1u);
    }
    if ( v27 )
    {
      LOBYTE(v44) = 0;
      if ( *(_BYTE *)v27 )
      {
        do
        {
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
            sub_52A840(v27 + 28 * (unsigned __int8)v44 + 4, (__int16)v45);
          else
            sub_52A5F0(v27 + 28 * (unsigned __int8)v44 + 4);
          LOBYTE(v44) = v44 + 1;
        }
        while ( (unsigned __int8)v44 < *(_BYTE *)v27 );
      }
    }
  }
LABEL_137:
  if ( (__int16)v45 >= 44 )
    sub_426AC0((_BYTE *)v1, 4u);
  if ( (__int16)v45 >= 45 )
  {
    v50 = *(_DWORD *)(a1 + 12) & 0x180;
    sub_426AC0(&v50, 4u);
    *(_DWORD *)(a1 + 12) |= v50;
  }
  if ( (__int16)v45 >= 49 )
    sub_426AC0(*(_BYTE **)(a1 + 556), 2u);
  if ( (__int16)v45 >= 51 )
  {
    sub_426AC0((_BYTE *)(v1 + 1348), 1u);
    sub_426AC0((_BYTE *)(v1 + 1340), 1u);
    sub_426AC0((_BYTE *)(v1 + 1444), 1u);
    sub_426AC0((_BYTE *)(v1 + 2036), 1u);
  }
  if ( *(_BYTE *)(a1 + 12) & 0x20 && (__int16)v45 >= 54 )
  {
    v28 = 0;
    v29 = (_BYTE *)(v1 + 2076);
    LOBYTE(v46) = 0;
    do
    {
      sub_426AC0(v29, 3u);
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        sub_4E4A90(a1, v46, (int)v29);
      ++v28;
      v29 += 3;
      LOBYTE(v46) = v28;
    }
    while ( v28 < 6u );
  }
  if ( (__int16)v45 >= 55 && *(_BYTE *)(a1 + 12) & 0x20 )
    sub_52AD10(a1);
  if ( (__int16)v45 < 62 || (result = sub_52AAB0((_DWORD *)a1)) != 0 )
  {
    if ( (__int16)v45 >= 63 && *(_DWORD *)(a1 + 12) & 0x80000 )
      sub_52AD10(a1);
    if ( (__int16)v45 >= 64 )
    {
      LOBYTE(v47) = *(_BYTE *)(a1 + 540);
      sub_426AC0(&v47, 1u);
      if ( *(_DWORD *)&byte_5D4594[3803300] != 1 )
        goto LABEL_171;
      if ( !(_BYTE)v47 )
      {
LABEL_164:
        if ( !*(_BYTE *)(v1 + 1445) )
          goto LABEL_201;
        if ( sub_40A5C0(1) )
        {
          *(_WORD *)(*(_DWORD *)(a1 + 556) + 4) = 0;
          **(_WORD **)(a1 + 556) = 0;
        }
        if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        {
LABEL_201:
          v30 = *(_DWORD *)(a1 + 16);
          if ( (v30 & 0x8000) != 0 && !sub_534A40(a1) )
            *(_DWORD *)(a1 + 16) |= 0x40u;
        }
LABEL_171:
        if ( *(_DWORD *)(a1 + 136) )
        {
          if ( *(_DWORD *)&byte_5D4594[3803300] != 1 )
          {
LABEL_198:
            *(_DWORD *)(a1 + 136) = v51;
            return 1;
          }
          result = sub_4F3E30(v45, a1, *(_DWORD *)(a1 + 136));
          if ( !result )
            return result;
        }
        if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        {
          if ( sub_40A5C0(0x200000) || !sub_4DB240() )
            sub_529BC0(a1);
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
          {
            if ( *(_BYTE *)(a1 + 8) & 2 )
            {
              v31 = *(_DWORD *)(a1 + 12);
              if ( v31 & 0x2000 )
              {
                v32 = 0;
                v33 = 0;
                for ( j = sub_4E7980(a1); j; j = sub_4E7990(j) )
                {
                  if ( *(unsigned __int16 *)(j + 4) == *(_DWORD *)&byte_5D4594[2487692] )
                    v32 = 1;
                }
                v35 = v1 + 2044;
                v36 = 3;
                v37 = (_DWORD *)v35;
                do
                {
                  if ( *v37 )
                    ++v33;
                  ++v37;
                  --v36;
                }
                while ( v36 );
                if ( !v32 && v33 )
                {
                  v38 = sub_4E3810((CHAR *)&byte_587000[258384]);
                  v46 = (int)v38;
                  if ( v38 )
                  {
                    v39 = v38[173];
                    if ( v33 > 0 )
                    {
                      v40 = (int *)v35;
                      v41 = (_DWORD *)v38[173];
                      v42 = v33;
                      do
                      {
                        v43 = *v40;
                        ++v40;
                        *v41 = v43;
                        ++v41;
                        --v42;
                      }
                      while ( v42 );
                      v38 = (_DWORD *)v46;
                    }
                    *(_BYTE *)(v39 + 20) = v33;
                    *(_DWORD *)(v39 + 24) = 0;
                    *(_DWORD *)(v39 + 28) = *(_DWORD *)(a1 + 56);
                    *(_DWORD *)(v39 + 32) = *(_DWORD *)(a1 + 60);
                  }
                  sub_4F3070(a1, (int)v38, 1);
                }
              }
            }
          }
        }
        goto LABEL_198;
      }
      sub_4EEA90(a1, (unsigned __int8)v47);
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] != 1 )
      goto LABEL_171;
    goto LABEL_164;
  }
  return result;
}
// 528DB0: using guessed type char var_100[256];

//----- (00529BC0) --------------------------------------------------------
void __cdecl sub_529BC0(int a1)
{
  int v1; // esi
  _DWORD *v2; // eax
  int i; // ecx
  int v4; // edx
  int v5; // edi
  int v6; // edi
  int v7; // ecx

  if ( a1 )
  {
    v1 = *(_DWORD *)(a1 + 748);
    v2 = sub_517560(*(unsigned __int16 *)(a1 + 4));
    if ( v2 )
    {
      if ( !*(_BYTE *)(v1 + 1445) )
      {
        **(_WORD **)(a1 + 556) = *((_WORD *)v2 + 34);
        *(_WORD *)(*(_DWORD *)(a1 + 556) + 4) = *((_WORD *)v2 + 34);
        *(_WORD *)(*(_DWORD *)(a1 + 556) + 2) = *((_WORD *)v2 + 34);
      }
      if ( *(_BYTE *)(v1 + 1444) == 1 )
      {
        *(_DWORD *)(v1 + 1440) = v2[23];
      }
      else
      {
        for ( i = 0; i < 22; ++i )
        {
          v4 = 1 << i;
          if ( !((1 << i) & 0x19C40) )
          {
            v5 = *(_DWORD *)(v1 + 1440);
            if ( v5 & v4 && !(v4 & v2[23]) )
              *(_DWORD *)(v1 + 1440) = v5 & ~v4;
            v6 = *(_DWORD *)(v1 + 1440);
            if ( !(v6 & v4) && v4 & v2[23] )
              *(_DWORD *)(v1 + 1440) = v4 | v6;
          }
        }
      }
      v7 = *(_DWORD *)(v1 + 1440);
      if ( !(v7 & 0x20) )
      {
        BYTE1(v7) &= 0xE7u;
        *(_DWORD *)(v1 + 1440) = v7;
      }
      if ( *(_BYTE *)(v1 + 1340) == 1 )
        *(_DWORD *)(v1 + 1336) = v2[20];
      if ( *(_BYTE *)(v1 + 1348) == 1 )
        *(_DWORD *)(v1 + 1344) = v2[21];
      if ( *(_BYTE *)(v1 + 2036) == 1 )
        sub_54C0C0(a1);
    }
  }
}

//----- (00529CE0) --------------------------------------------------------
int __cdecl sub_529CE0(int a1)
{
  int v1; // ebp
  int v3; // ebx
  bool v4; // cc
  _BYTE **v5; // esi
  int v6; // esi
  bool v7; // zf
  _BYTE *v8; // esi
  int v9; // ecx
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // eax
  int v14; // ebx
  unsigned __int8 *v15; // edi
  int *v16; // ebp
  int v17; // eax
  int v18; // [esp+4h] [ebp-118h]
  char v19; // [esp+Bh] [ebp-111h]
  int v20; // [esp+Ch] [ebp-110h]
  int v21; // [esp+10h] [ebp-10Ch]
  int v22; // [esp+14h] [ebp-108h]
  int v23; // [esp+18h] [ebp-104h]
  char v24[256]; // [esp+1Ch] [ebp-100h]

  v1 = *(_DWORD *)(a1 + 748);
  v21 = 4;
  sub_426AC0(&v21, 2u);
  if ( (__int16)v21 > 4 )
    return 0;
  v19 = 1;
  if ( (__int16)v21 < 2 )
    goto LABEL_67;
  v19 = 0;
  if ( sub_40A5C0(1) && !sub_40A5C0(0x400000) )
    v19 = 1;
  sub_426AC0(&v19, 1u);
  if ( v19 || (_WORD)v21 == 1 )
  {
LABEL_67:
    v23 = *(_DWORD *)&byte_5D4594[2598000];
    sub_426AC0(&v23, 4u);
    v3 = *(_DWORD *)&byte_5D4594[2598000] - v23;
    v18 = 0;
    sub_426AC0(&v18, 4u);
    sub_426AC0((_BYTE *)(v1 + 8), 4u);
    sub_426AC0((_BYTE *)(v1 + 12), 8 * *(_DWORD *)(v1 + 8));
    sub_426AC0((_BYTE *)(v1 + 268), 4u);
    sub_426AC0((_BYTE *)(v1 + 272), 8u);
    sub_426AC0((_BYTE *)(v1 + 280), 4u);
    sub_426AC0((_BYTE *)(v1 + 284), 1u);
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      sub_52A420((int *)(v1 + 280), v3);
    sub_426AC0((_BYTE *)(v1 + 296), 4u);
    v4 = *(int *)(v1 + 296) <= 0;
    v18 = 0;
    if ( !v4 )
    {
      v5 = (_BYTE **)(v1 + 300);
      do
      {
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          sub_426AC0(&v22, 4u);
          *v5 = sub_579C80(v22);
        }
        else
        {
          sub_426AC0(*v5, 4u);
        }
        ++v5;
        v4 = ++v18 < *(int *)(v1 + 296);
      }
      while ( v4 );
    }
    sub_426AC0((_BYTE *)(v1 + 364), 4u);
    sub_426AC0((_BYTE *)(v1 + 368), 8u);
    sub_426AC0((_BYTE *)(v1 + 376), 4u);
    sub_426AC0((_BYTE *)(v1 + 380), 8u);
    strcpy(v24, sub_40AF80(*(_DWORD *)(v1 + 388)));
    LOBYTE(v20) = strlen(v24);
    sub_426AC0(&v20, 1u);
    sub_426AC0(v24, (unsigned __int8)v20);
    v24[(unsigned __int8)v20] = 0;
    *(_DWORD *)(v1 + 388) = sub_40AF50(v24);
    sub_426AC0((_BYTE *)(v1 + 396), 8u);
    sub_426AC0((_BYTE *)(v1 + 404), 4u);
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      sub_52A420((int *)(v1 + 404), v3);
    sub_426AC0((_BYTE *)(v1 + 481), 1u);
    sub_426AC0((_BYTE *)(v1 + 482), 1u);
    sub_426AC0((_BYTE *)(v1 + 483), 1u);
    if ( (__int16)v21 < 3 )
      sub_426AC0(&v18, 4u);
    sub_426AC0((_BYTE *)(v1 + 496), 4u);
    sub_426AC0((_BYTE *)(v1 + 500), 8u);
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
      sub_52A420((int *)(v1 + 496), v3);
    sub_426AC0(&v18, 4u);
    sub_426AC0((_BYTE *)(v1 + 536), 4u);
    sub_426AC0((_BYTE *)(v1 + 540), 4u);
    sub_52A420((int *)(v1 + 536), v3);
    sub_52A420((int *)(v1 + 540), v3);
    sub_426AC0((_BYTE *)(v1 + 544), 1u);
    v6 = 0;
    if ( (signed char)*(_BYTE *)(v1 + 544) >= 0 )
    {
      v18 = v1 + 552;
      do
      {
        sub_52A440(a1, v18, v3);
        ++v6;
        v18 += 24;
      }
      while ( v6 <= *(char *)(v1 + 544) );
    }
    sub_426AC0((_BYTE *)(v1 + 1129), 1u);
    v7 = *(_BYTE *)(v1 + 1129) == 0;
    v18 = 0;
    if ( !v7 )
    {
      v8 = (_BYTE *)(v1 + 1132);
      do
      {
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          sub_426AC0(v8, 4u);
        }
        else
        {
          if ( !*(_DWORD *)&byte_5D4594[2487688] )
            *(_DWORD *)&byte_5D4594[2487688] = sub_4E3AA0((CHAR *)&byte_587000[258392]);
          sub_426AC0((_BYTE *)(*(_DWORD *)v8 + 44), 4u);
        }
        v9 = *(unsigned __int8 *)(v1 + 1129);
        v8 += 4;
        ++v18;
      }
      while ( v18 < v9 );
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] )
    {
      sub_426AC0((_BYTE *)(v1 + 1196), 4u);
    }
    else
    {
      v10 = *(_DWORD *)(v1 + 1196);
      if ( v10 )
        v22 = *(_DWORD *)(v10 + 44);
      else
        v22 = 0;
      sub_426AC0(&v22, 4u);
    }
    sub_426AC0((_BYTE *)(v1 + 1204), 4u);
    sub_52A420((int *)(v1 + 1204), v3);
    sub_426AC0((_BYTE *)(v1 + 2096), 4u);
    sub_426AC0((_BYTE *)(v1 + 2100), 4u);
    sub_426AC0((_BYTE *)(v1 + 2104), 1u);
    sub_426AC0((_BYTE *)(v1 + 2105), 1u);
    LOBYTE(v20) = strlen((const char *)(v1 + 2106));
    sub_426AC0(&v20, 1u);
    sub_426AC0((_BYTE *)(v1 + 2106), (unsigned __int8)v20);
    *(_BYTE *)((unsigned __int8)v20 + v1 + 2106) = 0;
    if ( (__int16)v21 >= 4 )
    {
      sub_426AC0((_BYTE *)(v1 + 4), 4u);
      sub_426AC0((_BYTE *)(v1 + 288), 4u);
      sub_426AC0((_BYTE *)(v1 + 292), 4u);
      v11 = sub_4ECCB0(*(_DWORD *)(v1 + 392));
      if ( v11 )
        v18 = *(_DWORD *)(v11 + 44);
      else
        v18 = 0;
      sub_426AC0(&v18, 4u);
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        *(_DWORD *)(v1 + 392) = v18;
      sub_426AC0((_BYTE *)(v1 + 492), 4u);
      sub_426AC0((_BYTE *)(v1 + 508), 4u);
      sub_52A420((int *)(v1 + 508), v3);
      sub_426AC0((_BYTE *)(v1 + 512), 4u);
      sub_52A420((int *)(v1 + 512), v3);
      sub_426AC0((_BYTE *)(v1 + 516), 4u);
      sub_52A420((int *)(v1 + 516), v3);
      sub_426AC0((_BYTE *)(v1 + 520), 4u);
      sub_52A420((int *)(v1 + 520), v3);
      sub_426AC0((_BYTE *)(v1 + 528), 4u);
      sub_52A420((int *)(v1 + 528), v3);
      sub_426AC0((_BYTE *)(v1 + 532), 4u);
      sub_52A420((int *)(v1 + 532), v3);
      sub_426AC0((_BYTE *)(v1 + 524), 4u);
      sub_426AC0((_BYTE *)(v1 + 548), 4u);
      sub_52A420((int *)(v1 + 548), v3);
      sub_426AC0((_BYTE *)(v1 + 1128), 1u);
      v12 = sub_4ECCB0(*(_DWORD *)(v1 + 1200));
      if ( v12 )
        v18 = *(_DWORD *)(v12 + 44);
      else
        v18 = 0;
      sub_426AC0(&v18, 4u);
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        *(_DWORD *)(v1 + 1200) = v18;
      sub_426AC0((_BYTE *)(v1 + 1208), 4u);
      sub_52A420((int *)(v1 + 1208), v3);
      sub_426AC0((_BYTE *)(v1 + 1212), 4u);
      sub_52A420((int *)(v1 + 1212), v3);
      v13 = *(_DWORD *)(v1 + 1216);
      v14 = 0;
      if ( v13 )
        v18 = *(_DWORD *)(v13 + 44);
      else
        v18 = 0;
      sub_426AC0(&v18, 4u);
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        *(_DWORD *)(v1 + 1216) = v18;
      v15 = (unsigned __int8 *)(v1 + 2172);
      sub_426AC0((_BYTE *)(v1 + 2172), 1u);
      if ( *(_BYTE *)(v1 + 2172) )
      {
        v16 = (int *)(v1 + 2140);
        do
        {
          v17 = sub_4ECCB0(*v16);
          if ( v17 )
            v18 = *(_DWORD *)(v17 + 44);
          else
            v18 = 0;
          sub_426AC0(&v18, 4u);
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
            *v16 = v18;
          ++v14;
          ++v16;
        }
        while ( v14 < *v15 );
      }
    }
  }
  return 1;
}
// 529CE0: using guessed type char var_100[256];

//----- (0052A420) --------------------------------------------------------
int __cdecl sub_52A420(int *a1, int a2)
{
  int result; // eax

  result = a2 + *a1;
  if ( result >= 1 )
    *a1 = result;
  else
    *a1 = 1;
  return result;
}

//----- (0052A440) --------------------------------------------------------
int __cdecl sub_52A440(int a1, int a2, int a3)
{
  int v3; // eax
  int v4; // edi
  int *v5; // esi
  int result; // eax
  size_t v7; // [esp-4h] [ebp-120h]
  int v8; // [esp+10h] [ebp-10Ch]
  int v9; // [esp+14h] [ebp-108h]
  int v10; // [esp+18h] [ebp-104h]
  char v11[256]; // [esp+1Ch] [ebp-100h]

  strcpy(v11, sub_534650(*(_DWORD *)a2));
  LOBYTE(v10) = strlen(v11);
  sub_426AC0(&v10, 1u);
  sub_426AC0(v11, (unsigned __int8)v10);
  v11[(unsigned __int8)v10] = 0;
  v3 = sub_534670(v11);
  *(_DWORD *)a2 = v3;
  LOBYTE(v8) = byte_587000[16 * v3 + 255604];
  sub_426AC0(&v8, 1u);
  v4 = 0;
  if ( (unsigned __int8)v8 > 0u )
  {
    v5 = (int *)(a2 + 4);
    while ( 2 )
    {
      result = *(_DWORD *)&byte_587000[4 * (v4 + 4 * *(_DWORD *)a2) + 255608];
      switch ( result )
      {
        case 0:
          v7 = 8;
          goto LABEL_17;
        case 1:
          if ( *(_DWORD *)&byte_5D4594[3803300] )
            goto LABEL_15;
          if ( *v5 )
          {
            sub_426AC0((_BYTE *)(*v5 + 44), 4u);
          }
          else
          {
            v9 = 0;
            sub_426AC0(&v9, 4u);
          }
          goto LABEL_18;
        case 2:
          if ( *(_DWORD *)&byte_5D4594[3803300] )
            goto LABEL_15;
          if ( *v5 )
          {
            sub_426AC0((_BYTE *)*v5, 4u);
          }
          else
          {
            v9 = 0;
            sub_426AC0(&v9, 4u);
          }
          goto LABEL_18;
        case 3:
        case 4:
        case 6:
LABEL_15:
          v7 = 4;
          goto LABEL_17;
        case 5:
          sub_426AC0(v5, 4u);
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
            sub_52A420(v5, a3);
          goto LABEL_18;
        case 7:
          v7 = 1;
LABEL_17:
          sub_426AC0(v5, v7);
LABEL_18:
          ++v4;
          v5 += 2;
          if ( v4 >= (unsigned __int8)v8 )
            return sub_426AC0((_BYTE *)(a2 + 20), 4u);
          continue;
        default:
          return result;
      }
    }
  }
  return sub_426AC0((_BYTE *)(a2 + 20), 4u);
}
// 52A440: using guessed type char var_100[256];

//----- (0052A5F0) --------------------------------------------------------
size_t __cdecl sub_52A5F0(int a1)
{
  int *v1; // esi
  int (__cdecl *v2)(int *); // eax
  char *v3; // ebp
  char *v4; // eax
  const char **v5; // eax
  const char **v6; // eax
  const char **v7; // eax
  const char **v8; // eax
  size_t result; // eax
  int v10; // [esp-4h] [ebp-14h]

  v1 = (int *)a1;
  sub_426AC0((_BYTE *)(a1 + 4), 1u);
  LOBYTE(a1) = strlen(*(const char **)(*v1 + 4));
  sub_426AC0(&a1, 1u);
  sub_426AC0(*(_BYTE **)(*v1 + 4), (unsigned __int8)a1);
  v2 = *(int (__cdecl **)(int *))(*v1 + 212);
  if ( v2 == sub_4F6390 )
  {
    v3 = (char *)sub_4E3A80(v1[2]);
    LOBYTE(a1) = 0;
    if ( !v3 )
      goto LABEL_7;
LABEL_6:
    LOBYTE(a1) = strlen(v3);
LABEL_7:
    sub_426AC0(&a1, 1u);
    if ( !v3 )
      goto LABEL_13;
    goto LABEL_12;
  }
  v10 = v1[2];
  if ( v2 == sub_4F6240 )
  {
    v3 = sub_425250(v10);
    LOBYTE(a1) = 0;
    if ( !v3 )
      goto LABEL_7;
    goto LABEL_6;
  }
  v4 = sub_424870(v10);
  v3 = v4;
  LOBYTE(a1) = 0;
  if ( v4 )
    LOBYTE(a1) = strlen(v4);
  sub_426AC0(&a1, 1u);
  if ( v3 )
LABEL_12:
    sub_426AC0(v3, (unsigned __int8)a1);
LABEL_13:
  v5 = (const char **)v1[3];
  if ( v5 )
  {
    LOBYTE(a1) = strlen(*v5);
    sub_426AC0(&a1, 1u);
    sub_426AC0(*(_BYTE **)v1[3], (unsigned __int8)a1);
  }
  else
  {
    LOBYTE(a1) = 0;
    sub_426AC0(&a1, 1u);
  }
  v6 = (const char **)v1[4];
  if ( v6 )
  {
    LOBYTE(a1) = strlen(*v6);
    sub_426AC0(&a1, 1u);
    sub_426AC0(*(_BYTE **)v1[4], (unsigned __int8)a1);
  }
  else
  {
    LOBYTE(a1) = 0;
    sub_426AC0(&a1, 1u);
  }
  v7 = (const char **)v1[5];
  if ( v7 )
  {
    LOBYTE(a1) = strlen(*v7);
    sub_426AC0(&a1, 1u);
    sub_426AC0(*(_BYTE **)v1[5], (unsigned __int8)a1);
  }
  else
  {
    LOBYTE(a1) = 0;
    sub_426AC0(&a1, 1u);
  }
  v8 = (const char **)v1[6];
  if ( v8 )
  {
    LOBYTE(a1) = strlen(*v8);
    sub_426AC0(&a1, 1u);
    result = sub_426AC0(*(_BYTE **)v1[6], (unsigned __int8)a1);
  }
  else
  {
    LOBYTE(a1) = 0;
    result = sub_426AC0(&a1, 1u);
  }
  return result;
}

//----- (0052A840) --------------------------------------------------------
int __cdecl sub_52A840(int a1, int a2)
{
  bool v2; // zf
  int (__cdecl *v3)(int *); // eax
  int v4; // eax
  int v5; // edi
  int v6; // eax
  int v7; // edi
  int v8; // eax
  int v9; // edi
  int v10; // eax
  int result; // eax
  int v12; // [esp+Ch] [ebp-D0h]
  int v13; // [esp+10h] [ebp-CCh]
  char v14[200]; // [esp+14h] [ebp-C8h]

  if ( a2 < 50 )
    sub_426AC0(&v13, 4u);
  sub_426AC0((_BYTE *)(a1 + 4), 1u);
  sub_426AC0(&v12, 1u);
  if ( (_BYTE)v12 )
  {
    sub_426AC0(v14, (unsigned __int8)v12);
    v14[(unsigned __int8)v12] = 0;
    *(_DWORD *)a1 = sub_4E3B60(v14);
  }
  if ( a2 >= 47 )
  {
    sub_426AC0(&v12, 1u);
    sub_426AC0(v14, (unsigned __int8)v12);
    v2 = (_BYTE)v12 == 0;
    v14[(unsigned __int8)v12] = 0;
    if ( !v2 )
    {
      v3 = *(int (__cdecl **)(int *))(*(_DWORD *)a1 + 212);
      if ( v3 == sub_4F6390 )
      {
        v4 = sub_4E3AA0(v14);
      }
      else if ( v3 == sub_4F6240 )
      {
        v4 = sub_424D80(v14);
      }
      else
      {
        v4 = sub_4243F0(v14);
      }
      *(_DWORD *)(a1 + 8) = v4;
    }
  }
  v5 = 0;
  sub_426AC0(&v12, 1u);
  if ( (_BYTE)v12 )
  {
    sub_426AC0(v14, (unsigned __int8)v12);
    v14[(unsigned __int8)v12] = 0;
    v6 = sub_413290(v14);
    if ( v6 != 255 )
      v5 = sub_413330(v6);
  }
  *(_DWORD *)(a1 + 12) = v5;
  v7 = 0;
  sub_426AC0(&v12, 1u);
  if ( (_BYTE)v12 )
  {
    sub_426AC0(v14, (unsigned __int8)v12);
    v14[(unsigned __int8)v12] = 0;
    v8 = sub_413290(v14);
    if ( v8 != 255 )
      v7 = sub_413330(v8);
  }
  *(_DWORD *)(a1 + 16) = v7;
  v9 = 0;
  sub_426AC0(&v12, 1u);
  if ( (_BYTE)v12 )
  {
    sub_426AC0(v14, (unsigned __int8)v12);
    v14[(unsigned __int8)v12] = 0;
    v10 = sub_413290(v14);
    if ( v10 != 255 )
      v9 = sub_413330(v10);
  }
  *(_DWORD *)(a1 + 20) = v9;
  sub_426AC0(&v12, 1u);
  result = v12;
  if ( (_BYTE)v12
    && (sub_426AC0(v14, (unsigned __int8)v12), v14[(unsigned __int8)v12] = 0, result = sub_413290(v14), result != 255) )
  {
    result = sub_413330(result);
    *(_DWORD *)(a1 + 24) = result;
  }
  else
  {
    *(_DWORD *)(a1 + 24) = 0;
  }
  return result;
}
// 52A840: using guessed type char var_C8[200];

//----- (0052AAB0) --------------------------------------------------------
int __cdecl sub_52AAB0(_DWORD *a1)
{
  int v1; // ebp
  char *v2; // ebx
  int v3; // eax
  int v5; // ebx
  int v6; // edi
  int v7; // ecx
  int v8; // eax
  int v9; // eax
  int v10; // [esp-4h] [ebp-138h]
  int v11; // [esp+10h] [ebp-124h]
  int v12; // [esp+14h] [ebp-120h]
  int v13; // [esp+18h] [ebp-11Ch]
  int v14; // [esp+1Ch] [ebp-118h]
  int v15; // [esp+20h] [ebp-114h]
  int v16; // [esp+24h] [ebp-110h]
  int v17[3];
  char v20[256]; // [esp+34h] [ebp-100h]

  v13 = 2;
  sub_426AC0(&v13, 2u);
  if ( (__int16)v13 > 2 || (__int16)v13 <= 0 )
    return 0;
  LOBYTE(v16) = sub_424CB0((int)a1);
  sub_426AC0(&v16, 1u);
  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    v5 = 0;
    if ( !(_BYTE)v16 )
      return 1;
    while ( 1 )
    {
      sub_426AC0(&v11, 1u);
      sub_426AC0(v20, (unsigned __int8)v11);
      v20[(unsigned __int8)v11] = 0;
      v6 = sub_424880(v20);
      if ( v6 == -1 )
        break;
      sub_426AC0(&v15, 1u);
      sub_426AC0(&v14, 4u);
      v7 = a1[15];
      v17[1] = a1[14];
      v10 = (unsigned __int8)v15;
      v17[0] = a1;
      v17[2] = v7;
      v8 = sub_424920(v6);
      sub_4FD400(v8, (int)a1, a1, (int)a1, v17, v10);
      *((_WORD *)a1 + v6 + 172) = v14;
      if ( v6 == 26 && (__int16)v13 >= 2 )
      {
        sub_426AC0(&v12, 4u);
        v9 = sub_4FF2D0(51, (int)a1);
        if ( v9 )
          *(_DWORD *)(v9 + 72) = v12;
      }
      if ( ++v5 >= (unsigned __int8)v16 )
        return 1;
    }
    return 0;
  }
  v1 = sub_424D00();
  if ( v1 == -1 )
    return 1;
  do
  {
    if ( sub_4FF350((int)a1, v1) )
    {
      v2 = sub_4248F0(v1);
      LOBYTE(v11) = strlen(v2);
      sub_426AC0(&v11, 1u);
      sub_426AC0(v2, (unsigned __int8)v11);
      LOBYTE(v15) = sub_4FF570((int)a1, v1);
      sub_426AC0(&v15, 1u);
      v14 = sub_4FF550((int)a1, v1);
      sub_426AC0(&v14, 4u);
      if ( v1 == 26 )
      {
        v3 = sub_4FF2D0(51, (int)a1);
        if ( v3 )
          v12 = *(_DWORD *)(v3 + 72);
        else
          v12 = 100;
        sub_426AC0(&v12, 4u);
      }
    }
    v1 = sub_424D20(v1);
  }
  while ( v1 != -1 );
  return 1;
}
// 52AAB0: using guessed type char var_100[256];

//----- (0052AD10) --------------------------------------------------------
size_t __cdecl sub_52AD10(int a1)
{
  const char **v1; // eax
  const char **v2; // esi
  size_t result; // eax
  const char **v4; // eax
  int v5; // [esp+4h] [ebp-104h]
  char v6[256]; // [esp+8h] [ebp-100h]

  if ( *(_DWORD *)&byte_5D4594[3803300] )
  {
    sub_426AC0(&v5, 1u);
    sub_426AC0(v6, (unsigned __int8)v5);
    v6[(unsigned __int8)v5] = 0;
    v4 = sub_424350(v6);
    result = sub_424320(a1, (int)v4);
  }
  else
  {
    v1 = (const char **)sub_424300(a1);
    v2 = v1;
    if ( v1 )
    {
      LOBYTE(v5) = strlen(*v1);
      sub_426AC0(&v5, 1u);
      result = sub_426AC0(*v2, (unsigned __int8)v5);
    }
    else
    {
      LOBYTE(v5) = 0;
      result = sub_426AC0(&v5, 1u);
    }
  }
  return result;
}
// 52AD10: using guessed type char var_100[256];

//----- (0052ADE0) --------------------------------------------------------
int __cdecl sub_52ADE0(int a1)
{
  int v1; // esi
  char *v2; // edi
  int result; // eax
  _DWORD *v4; // eax
  char *v5; // eax
  char *v6; // eax
  char *v7; // eax
  char *v8; // eax
  char *v9; // eax
  char *v10; // eax
  char *v11; // eax
  char *v12; // eax
  char *v13; // eax
  char *v14; // edi
  int v15; // eax
  __int16 v16; // ax
  unsigned __int8 v17; // bl
  _BYTE *v18; // edi
  int v19; // ebx
  unsigned __int8 i; // bl
  int v21; // edx
  _WORD *v22; // eax
  _WORD *v23; // eax
  int v24; // edx
  _BYTE *v25; // ebx
  _DWORD *v26; // eax
  int v27; // ecx
  char *v28; // ebp
  bool v29; // zf
  unsigned __int8 j; // bl
  int v31; // eax
  int *v32; // ebp
  char *v33; // ebx
  char *v34; // ebx
  int v35; // edi
  int v36; // eax
  int v37; // eax
  int v38; // eax
  int v39; // eax
  _DWORD *k; // esi
  int v41; // eax
  int v42; // eax
  int v43; // [esp+10h] [ebp-238h]
  int v44; // [esp+14h] [ebp-234h]
  int v45; // [esp+18h] [ebp-230h]
  unsigned __int8 v46; // [esp+1Fh] [ebp-229h]
  int v47; // [esp+20h] [ebp-228h]
  int v48; // [esp+24h] [ebp-224h]
  int v49; // [esp+28h] [ebp-220h]
  int v50; // [esp+2Ch] [ebp-21Ch]
  int v51; // [esp+30h] [ebp-218h]
  int v52; // [esp+34h] [ebp-214h]
  char v53[3]; // [esp+38h] [ebp-210h]
  int v54; // [esp+3Ch] [ebp-20Ch]
  _DWORD v55[2]; // [esp+40h] [ebp-208h]
  char v56[256]; // [esp+48h] [ebp-200h]
  char v57[256]; // [esp+148h] [ebp-100h]

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(char **)(a1 + 756);
  v54 = *(_DWORD *)(a1 + 136);
  v44 = 62;
  sub_426AC0(&v44, 2u);
  if ( (__int16)v44 > 62 )
    return 0;
  if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
  {
    v4 = sub_517560(*(unsigned __int16 *)(a1 + 4));
    *(_DWORD *)(v1 + 484) = v4;
    if ( v4 )
      *(_DWORD *)(v1 + 1440) = v4[23];
  }
  result = sub_4F4530((int *)a1, (__int16)v44);
  if ( result )
  {
    if ( !*(_DWORD *)&byte_5D4594[3803300] )
      sub_509E20(*(__int16 *)(a1 + 124), (int2 *)v55);
    sub_426AC0(v55, 8u);
    if ( v2 )
      v5 = v2 + 640;
    else
      v5 = 0;
    sub_4F5580(v1 + 1232, v5);
    if ( v2 )
      v6 = v2 + 896;
    else
      v6 = 0;
    sub_4F5580(v1 + 1264, v6);
    sub_426AC0((_BYTE *)(v1 + 1220), 2u);
    if ( v2 )
      v7 = v2 + 768;
    else
      v7 = 0;
    sub_4F5580(v1 + 1224, v7);
    if ( (__int16)v44 >= 32 )
    {
      v8 = v2 ? v2 + 1024 : 0;
      sub_4F5580(v1 + 1240, v8);
      v9 = v2 ? v2 + 1152 : 0;
      sub_4F5580(v1 + 1248, v9);
      v10 = v2 ? v2 + 1280 : 0;
      sub_4F5580(v1 + 1256, v10);
      v11 = v2 ? v2 + 1408 : 0;
      sub_4F5580(v1 + 1272, v11);
      v12 = v2 ? v2 + 1536 : 0;
      sub_4F5580(v1 + 1280, v12);
      v13 = v2 ? v2 + 1664 : 0;
      sub_4F5580(v1 + 1288, v13);
      if ( (__int16)v44 >= 50 )
      {
        if ( v2 )
          v14 = v2 + 1792;
        else
          v14 = 0;
        sub_4F5580(v1 + 1296, v14);
      }
    }
    v15 = *(_DWORD *)&byte_5D4594[3803300];
    if ( *(_DWORD *)&byte_5D4594[3803300] != 1
      || (v16 = sub_509E00(v55),
          *(_WORD *)(a1 + 126) = v16,
          *(_WORD *)(a1 + 124) = v16,
          v15 = *(_DWORD *)&byte_5D4594[3803300],
          *(_DWORD *)&byte_5D4594[3803300] != 1) )
    {
      if ( !v15 )
        sub_426AC0(&v47, 4u);
    }
    else
    {
      sub_426AC0(&v47, 4u);
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
    {
      v17 = 0;
      LOBYTE(v48) = 0;
      do
      {
        sub_426AC0(v53, 3u);
        sub_4E4A90(a1, v48, v53);
        LOBYTE(v48) = ++v17;
      }
      while ( v17 < 6u );
    }
    else
    {
      v18 = (_BYTE *)(v1 + 2076);
      v19 = 6;
      do
      {
        sub_426AC0(v18, 3u);
        v18 += 3;
        --v19;
      }
      while ( v19 );
    }
    if ( *(_DWORD *)&byte_5D4594[3803300] == 1 && (_WORD)v44 == 31 )
    {
      sub_426AC0(&v49, 2u);
      sub_426AC0(&v46, 1u);
      for ( i = 0; i < v46; ++i )
      {
        sub_426AC0(&v50, 1u);
        sub_426AC0(v56, (unsigned __int8)v50);
        v56[(unsigned __int8)v50] = 0;
        sub_426AC0(&v43, 1u);
        sub_426AC0(&v43, 1u);
      }
    }
    if ( (__int16)v44 >= 32 )
    {
      sub_426AC0((_BYTE *)(v1 + 1332), 1u);
      if ( (__int16)v44 < 49 )
      {
        sub_426AC0(&v47, 2u);
        *(_DWORD *)(v1 + 1440) = (unsigned __int16)v47;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1440), 4u);
      }
      sub_426AC0((_BYTE *)(v1 + 1352), 4u);
      sub_426AC0((_BYTE *)(v1 + 1336), 4u);
      sub_426AC0((_BYTE *)(v1 + 1344), 4u);
      sub_426AC0((_BYTE *)(v1 + 1312), 4u);
      v43 = 0;
      v22 = *(_WORD **)(a1 + 556);
      if ( v22 )
      {
        LOWORD(v21) = *v22;
        v43 = v21;
      }
      sub_426AC0(&v43, 2u);
      v23 = *(_WORD **)(a1 + 556);
      if ( v23 )
        *v23 = v43;
      sub_426AC0((_BYTE *)(v1 + 1304), 4u);
      *(_DWORD *)(v1 + 1308) = *(_DWORD *)(v1 + 1304);
      if ( (__int16)v44 < 35 )
        sub_426AC0((_BYTE *)(v1 + 1360), 4u);
      LOBYTE(v49) = strlen((const char *)(v1 + 1364));
      sub_426AC0(&v49, 1u);
      sub_426AC0((_BYTE *)(v1 + 1364), (unsigned __int8)v49);
      *(_BYTE *)((unsigned __int8)v49 + v1 + 1364) = 0;
      if ( (__int16)v44 >= 34 )
      {
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          memset((void *)(v1 + 1488), 0, 0x224u);
          sub_426AC0(&v43, 4u);
          for ( j = 0; j < v43; LOBYTE(v48) = j )
          {
            sub_426AC0(&v49, 1u);
            sub_426AC0(v56, (unsigned __int8)v49);
            v56[(unsigned __int8)v49] = 0;
            v31 = sub_4243F0(v56);
            sub_426AC0((_BYTE *)(v1 + 4 * v31 + 1488), 4u);
            ++j;
          }
        }
        else
        {
          v24 = 0;
          v25 = (_BYTE *)(v1 + 1488);
          v43 = 0;
          v26 = (_DWORD *)(v1 + 1488);
          v27 = 137;
          do
          {
            if ( *v26 )
              ++v24;
            ++v26;
            --v27;
          }
          while ( v27 );
          v43 = v24;
          sub_426AC0(&v43, 4u);
          v48 = 0;
          v47 = 137;
          do
          {
            if ( *(_DWORD *)v25 )
            {
              v28 = sub_424870(v48);
              LOBYTE(v52) = strlen(v28);
              sub_426AC0(&v52, 1u);
              sub_426AC0(v28, (unsigned __int8)v52);
              sub_426AC0(v25, 4u);
            }
            v25 += 4;
            v29 = v47 == 1;
            ++v48;
            --v47;
          }
          while ( !v29 );
        }
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1488), 0x224u);
      }
      if ( (__int16)v44 < 47 )
      {
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1448) = (unsigned __int8)v43;
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1450) = (unsigned __int8)v43;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1448), 2u);
        sub_426AC0((_BYTE *)(v1 + 1450), 2u);
      }
      if ( (__int16)v44 < 34 )
        sub_426AC0(&v45, 4u);
      if ( (__int16)v44 < 47 )
      {
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1456) = (unsigned __int8)v43;
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1458) = (unsigned __int8)v43;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1456), 2u);
        sub_426AC0((_BYTE *)(v1 + 1458), 2u);
      }
      if ( (__int16)v44 < 34 )
        sub_426AC0(&v45, 4u);
      if ( (__int16)v44 < 47 )
      {
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1464) = (unsigned __int8)v43;
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1466) = (unsigned __int8)v43;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1464), 2u);
        sub_426AC0((_BYTE *)(v1 + 1466), 2u);
      }
      if ( (__int16)v44 < 34 )
        sub_426AC0(&v45, 4u);
      if ( (__int16)v44 < 47 )
      {
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1472) = (unsigned __int8)v43;
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1474) = (unsigned __int8)v43;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1472), 2u);
        sub_426AC0((_BYTE *)(v1 + 1474), 2u);
      }
      if ( (__int16)v44 < 34 )
        sub_426AC0(&v45, 4u);
      if ( (__int16)v44 < 47 )
      {
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1480) = (unsigned __int8)v43;
        sub_426AC0(&v43, 1u);
        *(_WORD *)(v1 + 1482) = (unsigned __int8)v43;
      }
      else
      {
        sub_426AC0((_BYTE *)(v1 + 1480), 2u);
        sub_426AC0((_BYTE *)(v1 + 1482), 2u);
      }
      if ( (__int16)v44 < 34 )
        sub_426AC0(&v45, 4u);
      if ( (__int16)v44 >= 33 )
        sub_426AC0((_BYTE *)(v1 + 1316), 4u);
      if ( (__int16)v44 >= 34 )
      {
        sub_426AC0((_BYTE *)(v1 + 2040), 4u);
        sub_426AC0((_BYTE *)(v1 + 1324), 1u);
        sub_426AC0((_BYTE *)(v1 + 1328), 4u);
        sub_426AC0((_BYTE *)(v1 + 1320), 4u);
        if ( (__int16)v44 < 42 )
        {
          sub_426AC0(&v43, 2u);
          if ( !(_WORD)v43 )
            *(_BYTE *)(v1 + 1445) = 1;
        }
        v32 = (int *)(v1 + 2044);
        v47 = 3;
        do
        {
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
          {
            sub_426AC0(&v43, 1u);
            sub_426AC0(v56, (unsigned __int8)v43);
            v56[(unsigned __int8)v43] = 0;
            *v32 = sub_4243F0(v56);
          }
          else
          {
            v33 = sub_424870(*v32);
            LOBYTE(v43) = strlen(v33);
            sub_426AC0(&v43, 1u);
            sub_426AC0(v33, (unsigned __int8)v43);
          }
          ++v32;
          --v47;
        }
        while ( v47 );
      }
      if ( (__int16)v44 >= 35 )
      {
        if ( *(_DWORD *)&byte_5D4594[3803300] )
        {
          sub_426AC0(&v43, 1u);
          sub_426AC0(v57, (unsigned __int8)v43);
          v57[(unsigned __int8)v43] = 0;
          *(_DWORD *)(v1 + 1360) = sub_5345F0(v57);
        }
        else
        {
          v34 = sub_5345B0(*(_DWORD *)(v1 + 1360));
          LOBYTE(v43) = strlen(v34);
          sub_426AC0(&v43, 1u);
          sub_426AC0(v34, (unsigned __int8)v43);
        }
      }
    }
    if ( (__int16)v44 < 41 )
    {
      v35 = a1;
    }
    else
    {
      v35 = a1;
      result = sub_529CE0(a1);
      if ( !result )
        return result;
    }
    if ( (__int16)v44 >= 42 )
      sub_426AC0((_BYTE *)(v1 + 1445), 1u);
    if ( (__int16)v44 >= 44 )
      sub_426AC0((_BYTE *)v1, 4u);
    if ( (__int16)v44 >= 45 )
    {
      v36 = *(_DWORD *)(v35 + 556);
      v45 = 0;
      if ( v36 )
        v45 = *(unsigned __int16 *)(v36 + 4);
      sub_426AC0(&v45, 4u);
      v37 = *(_DWORD *)(v35 + 556);
      if ( v37 )
        *(_WORD *)(v37 + 4) = v45;
    }
    if ( (__int16)v44 >= 46 )
    {
      v51 = *(_DWORD *)(v35 + 12) & 0x180;
      sub_426AC0(&v51, 4u);
      *(_DWORD *)(v35 + 12) |= v51;
    }
    if ( (__int16)v44 >= 48 )
      sub_426AC0(*(_BYTE **)(v35 + 556), 2u);
    if ( (__int16)v44 >= 51 )
      sub_426AC0((_BYTE *)(v35 + 28), 4u);
    if ( (__int16)v44 >= 52 )
      sub_52AD10(v35);
    if ( (__int16)v44 < 61 || (result = sub_52AAB0((_DWORD *)v35)) != 0 )
    {
      if ( (__int16)v44 >= 62 )
      {
        LOBYTE(v45) = *(_BYTE *)(v35 + 540);
        sub_426AC0(&v45, 1u);
        if ( *(_DWORD *)&byte_5D4594[3803300] != 1 )
          goto LABEL_156;
        if ( !(_BYTE)v45 )
        {
LABEL_149:
          if ( !*(_BYTE *)(v1 + 1445) )
            goto LABEL_170;
          if ( sub_40A5C0(1) )
          {
            v38 = *(_DWORD *)(v35 + 556);
            if ( v38 )
            {
              *(_WORD *)(v38 + 4) = 0;
              **(_WORD **)(v35 + 556) = 0;
            }
          }
          if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
          {
LABEL_170:
            v39 = *(_DWORD *)(v35 + 16);
            if ( (v39 & 0x8000) != 0 )
            {
              LOBYTE(v39) = v39 | 0x40;
              *(_DWORD *)(v35 + 16) = v39;
            }
          }
          goto LABEL_156;
        }
        sub_4EEA90(v35, (unsigned __int8)v45);
      }
      if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        goto LABEL_149;
LABEL_156:
      if ( !*(_DWORD *)(v35 + 136)
        || *(_DWORD *)&byte_5D4594[3803300] != 1
        || (result = sub_4F3E30(v44, v35, *(_DWORD *)(v35 + 136))) != 0 )
      {
        sub_52BA70(v35);
        if ( *(_DWORD *)&byte_5D4594[3803300] == 1 )
        {
          if ( sub_40A5C0(1) )
          {
            for ( k = *(_DWORD **)(v35 + 504); k; k = (_DWORD *)k[124] )
            {
              v41 = k[4];
              if ( v41 & 0x100 )
              {
                v42 = k[2];
                k[4] &= 0xFFFFFEFF;
                if ( v42 & 0x1001000 )
                  sub_53A2C0(v35, (int)k);
                else
                  sub_53E520(v35, k);
              }
            }
          }
        }
        *(_DWORD *)(v35 + 136) = v54;
        result = 1;
      }
      return result;
    }
  }
  return result;
}
// 52B1CD: variable 'v21' is possibly undefined
// 52ADE0: using guessed type char var_200[256];
// 52ADE0: using guessed type char var_100[256];

//----- (0052BA70) --------------------------------------------------------
int __cdecl sub_52BA70(int a1)
{
  int result; // eax
  int v2; // edi
  int v3; // esi
  int v4; // ecx
  int v5; // edx

  result = a1;
  v2 = 0;
  v3 = 0;
  if ( a1 )
  {
    for ( result = *(_DWORD *)(a1 + 504); result; result = *(_DWORD *)(result + 496) )
    {
      v4 = *(_DWORD *)(result + 16);
      if ( v4 & 0x100 )
      {
        v5 = *(_DWORD *)(result + 8);
        if ( v5 & 0x1001000 && *(_DWORD *)(result + 12) & 0x7FFE40C )
        {
          if ( v3 == 1 )
          {
            BYTE1(v4) &= 0xFEu;
            *(_DWORD *)(result + 16) = v4;
          }
          else
          {
            v2 = 1;
          }
        }
        else if ( v5 & 0x2000000 && *(_BYTE *)(result + 12) & 2 )
        {
          if ( v2 == 1 )
          {
            BYTE1(v4) &= 0xFEu;
            *(_DWORD *)(result + 16) = v4;
          }
          else
          {
            v3 = 1;
          }
        }
      }
    }
  }
  return result;
}

//----- (0052BAF0) --------------------------------------------------------
int __cdecl sub_52BAF0(int a1)
{
  int v1; // eax
  int result; // eax
  _DWORD *v3; // ebx
  int v4; // edi
  int v5; // ebp
  int *v6; // esi
  int v7; // [esp+0h] [ebp-4h]
  int v8; // [esp+8h] [ebp+4h]

  v1 = a1;
  v8 = 0;
  result = *(_DWORD *)(v1 + 748);
  v7 = result;
  if ( *(_BYTE *)(result + 544) & 0x80 )
    return result;
  v3 = (_DWORD *)(result + 552);
  do
  {
    v4 = 0;
    v5 = *(_DWORD *)&byte_587000[16 * *v3 + 255604];
    if ( v5 <= 0 )
      goto LABEL_14;
    v6 = v3 + 1;
    do
    {
      if ( *(_DWORD *)&byte_587000[4 * (v4 + 4 * *v3) + 255608] == 1 )
      {
        if ( *v6 )
        {
          *v6 = sub_4ECF10(*v6);
          goto LABEL_12;
        }
      }
      else
      {
        if ( *(_DWORD *)&byte_587000[4 * (v4 + 4 * *v3) + 255608] != 2 )
          goto LABEL_12;
        if ( *v6 )
        {
          *v6 = sub_579C40(*v6);
          goto LABEL_12;
        }
      }
      *v6 = 0;
LABEL_12:
      ++v4;
      v6 += 2;
    }
    while ( v4 < v5 );
    result = v7;
LABEL_14:
    v3 += 6;
    ++v8;
  }
  while ( v8 <= *(char *)(result + 544) );
  return result;
}

//----- (0052BBA0) --------------------------------------------------------
int sub_52BBA0()
{
  return 1;
}

//----- (0052BBB0) --------------------------------------------------------
int __cdecl sub_52BBB0(int a1, int a2, int a3, int a4)
{
  float2 *v4; // edi
  int i; // esi
  double v6; // st7
  double v7; // st6
  int v8; // eax
  float v10; // [esp+10h] [ebp-4h]

  v10 = sub_419D40(&byte_587000[258408]);
  v4 = (float2 *)(a4 + 56);
  sub_518170(a4 + 56, v10, sub_52BC90, 0);
  for ( i = sub_4FE930(); i; i = sub_4FE940(i) )
  {
    if ( sub_424A50(*(_DWORD *)(i + 4), 0x40000) && (!(*(_BYTE *)(i + 88) & 2) || *(_DWORD *)(i + 4) == 43) )
    {
      v6 = *(float *)(i + 28) - v4->field_0;
      v7 = *(float *)(i + 32) - *(float *)(a4 + 60);
      if ( v10 * v10 >= v7 * v7 + v6 * v6 )
        sub_4FE9D0(i);
    }
  }
  sub_517F90(v4, v10, sub_52BDB0, a4);
  v8 = sub_424800(a1, 0);
  sub_501960(v8, a4, 0, 0);
  return 1;
}

//----- (0052BC90) --------------------------------------------------------
void __cdecl sub_52BC90(int a1)
{
  int v1; // eax

  if ( !*(_DWORD *)&byte_5D4594[2487720] )
  {
    *(_DWORD *)&byte_5D4594[2487720] = sub_4E3AA0((CHAR *)&byte_587000[258428]);
    *(_DWORD *)&byte_5D4594[2487724] = sub_4E3AA0((CHAR *)&byte_587000[258436]);
  }
  if ( *(_BYTE *)(a1 + 12) & 1 && !(*(_BYTE *)(a1 + 16) & 0x20) )
  {
    sub_522FF0(135, (float2 *)(a1 + 56));
    v1 = *(unsigned __int16 *)(a1 + 4);
    if ( (unsigned __int16)v1 == *(_DWORD *)&byte_5D4594[2487720] )
      goto LABEL_12;
    if ( v1 == *(_DWORD *)&byte_5D4594[2487724] )
    {
      sub_52BD30((int *)a1);
      sub_4E5CC0(a1);
      return;
    }
    (*(void (__cdecl **)(int, _DWORD, _DWORD))(a1 + 696))(a1, 0, 0);
    if ( !(*(_BYTE *)(a1 + 16) & 0x20) )
LABEL_12:
      sub_4E5CC0(a1);
  }
}

//----- (0052BD30) --------------------------------------------------------
int __cdecl sub_52BD30(int *a1)
{
  int v1; // ebx
  int result; // eax
  float *v3; // esi
  __int16 v4; // ax

  v1 = 3;
  do
  {
    result = sub_4E3810((CHAR *)&byte_587000[258448]);
    v3 = (float *)result;
    if ( result )
    {
      sub_4DAA50(result, a1[127], *((float *)a1 + 14), *((float *)a1 + 15));
      v4 = sub_415FA0(0, 255);
      *((_WORD *)v3 + 62) = v4;
      result = 8 * v4;
      v3[20] = *(float *)&byte_587000[result + 194136] * v3[136];
      v3[21] = *(float *)&byte_587000[result + 194140] * v3[136];
    }
    --v1;
  }
  while ( v1 );
  return result;
}

//----- (0052BDB0) --------------------------------------------------------
int __cdecl sub_52BDB0(int a1, int a2)
{
  int result; // eax
  int v3; // ebx
  int i; // esi

  result = a2;
  v3 = 0;
  if ( a1 != a2 && !(*(_DWORD *)(a1 + 16) & 0x8020) )
  {
    for ( i = 0; i < 32; ++i )
    {
      result = sub_4FF350(a1, i);
      if ( result )
      {
        result = sub_4FF550(a1, i);
        if ( result )
        {
          result = sub_424920(i);
          if ( result )
          {
            result = sub_424A50(result, 0x40000);
            if ( result )
            {
              if ( !v3 )
              {
                sub_522FF0(135, (float2 *)(a1 + 56));
                v3 = 1;
              }
              result = sub_4FF5B0(a1, i);
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (0052BE40) --------------------------------------------------------
void __cdecl sub_52BE40(int a1, int a2)
{
  int *v2; // eax

  if ( *(_BYTE *)(a1 + 8) & 1 && *(_BYTE *)(a1 + 12) & 2 )
  {
    v2 = *(int **)(a1 + 748);
    if ( v2[3] == 115 )
    {
      sub_52BC90(a1);
    }
    else if ( v2[1] == a2 )
    {
      v2[1] = *v2;
      *v2 = a2;
      sub_4EC300(a1);
      sub_4EC290(a2, a1);
      *(_DWORD *)(a1 + 128) = *(_DWORD *)&byte_5D4594[2598000];
      sub_501960(64, a2, 0, 0);
    }
  }
}

//----- (0052BEB0) --------------------------------------------------------
int __cdecl sub_52BEB0(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  float v6; // [esp+0h] [ebp-10h]

  v6 = sub_419D40(&byte_587000[258516]);
  sub_518170(a4 + 56, v6, sub_52BE40, a3);
  v4 = sub_424800(a1, 0);
  sub_501960(v4, a4, 0, 0);
  return 1;
}

//----- (0052BF00) --------------------------------------------------------
int sub_52BF00()
{
  return 1;
}

//----- (0052BF10) --------------------------------------------------------
int sub_52BF10()
{
  return 1;
}

//----- (0052BF20) --------------------------------------------------------
int __cdecl sub_52BF20(int a1, int a2, int a3, int a4, int *a5)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    sub_4EE6F0(*a5);
    sub_501960(754, *a5, 0, 0);
    result = 1;
  }
  return result;
}

//----- (0052BF50) --------------------------------------------------------
int __cdecl sub_52BF50(int a1, int a2, int a3, int a4, int *a5)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    if ( *(_BYTE *)(result + 8) & 4 )
    {
      sub_4EEB80(result, *(_WORD *)(*(_DWORD *)(result + 748) + 8));
      sub_501960(755, *a5, 0, 0);
    }
    result = 1;
  }
  return result;
}

//----- (0052BFA0) --------------------------------------------------------
int __cdecl sub_52BFA0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  float v8; // [esp+0h] [ebp-10h]

  v8 = -(sub_419D40(&byte_587000[258532]) * (double)a6);
  sub_52E040(a4 + 56, 600.0, 1092616192, v8, 0, 0, 0);
  v6 = sub_424800(a1, 0);
  sub_501960(v6, a3, 0, 0);
  return 1;
}

//----- (0052C000) --------------------------------------------------------
int __cdecl sub_52C000(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  float v8; // [esp+18h] [ebp+18h]

  v8 = sub_419D40(&byte_587000[258548]) * (double)a6;
  sub_52E040(a4 + 56, 600.0, 1092616192, v8, 0, 0, 0);
  v6 = sub_424800(a1, 0);
  sub_501960(v6, a3, 0, 0);
  return 1;
}

//----- (0052C060) --------------------------------------------------------
int __cdecl sub_52C060(int a1, int a2, int a3, int a4, int *a5)
{
  int result; // eax
  int v6; // ecx
  int v7; // ecx
  int v8; // eax
  int v9; // ecx
  int v10; // esi
  int v11; // ecx
  int v12; // eax
  int v13; // esi
  int v14; // eax
  int v15; // [esp-10h] [ebp-14h]

  result = *a5;
  if ( *a5 )
  {
    if ( *(_DWORD *)(result + 8) & 4 || (v6 = *(_DWORD *)(result + 8) & 2) != 0 && *(_BYTE *)(result + 12) & 0x10 )
    {
      v8 = *(_DWORD *)(result + 504);
      if ( v8 )
      {
        do
        {
          v9 = *(_DWORD *)(v8 + 16);
          v10 = *(_DWORD *)(v8 + 496);
          if ( v9 & 0x100 )
          {
            v11 = *(_DWORD *)(v8 + 8);
            if ( v11 & 0x1001000 || v11 & 0x2000000 && *(_BYTE *)(v8 + 12) & 2 )
              sub_4ED930(*a5, (_DWORD *)v8);
          }
          v8 = v10;
        }
        while ( v10 );
      }
      v12 = *(_DWORD *)&byte_5D4594[2487728];
      if ( !*(_DWORD *)&byte_5D4594[2487728] )
      {
        v12 = sub_4E3AA0((CHAR *)&byte_587000[258564]);
        *(_DWORD *)&byte_5D4594[2487728] = v12;
      }
      v13 = *(_DWORD *)(*a5 + 516);
      if ( v13 )
      {
        while ( *(unsigned __int16 *)(v13 + 4) != v12 )
        {
          v13 = *(_DWORD *)(v13 + 512);
          if ( !v13 )
            goto LABEL_22;
        }
        sub_52DF80(*a5 + 56, v13, 100.0);
        sub_4EC300(v13);
        sub_501960(926, *a5, 0, 0);
      }
    }
    else if ( !v6 || (v7 = *(_DWORD *)(result + 12), !(v7 & 0x2000)) )
    {
      sub_4EDA40((_DWORD *)result);
      sub_52DF80(a4 + 56, *a5, 50.0);
    }
LABEL_22:
    v15 = *a5;
    v14 = sub_424800(a1, 1);
    sub_501960(v14, v15, 0, 0);
    result = 1;
  }
  return result;
}

//----- (0052C190) --------------------------------------------------------
int __cdecl sub_52C190(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-Ch]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258576]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 4, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C1E0) --------------------------------------------------------
int __cdecl sub_52C1E0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258596]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 3, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C230) --------------------------------------------------------
int __cdecl sub_52C230(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax

  if ( !*a5 )
    return 0;
  v7 = sub_425470(2);
  sub_4FF380(*a5, 29, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C270) --------------------------------------------------------
int __cdecl sub_52C270(int a1, int a2, int a3, int a4, int *a5, __int16 a6)
{
  if ( !*a5 )
    return 0;
  sub_4FF380(*a5, 10, 12 * a6 * *(_WORD *)&byte_5D4594[2649704], a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C2C0) --------------------------------------------------------
int __cdecl sub_52C2C0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  int v8; // ecx
  __int16 v9; // dx
  int v10; // eax
  float v11; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v11 = sub_419D40(&byte_587000[258620]);
  v7 = sub_419A70(v11);
  v8 = *a5;
  v9 = v7;
  v10 = *(_DWORD *)(*a5 + 8);
  if ( !(v10 & 4) )
  {
    if ( v10 & 2 && *(float *)(v8 + 120) > 15.0 )
      goto LABEL_5;
LABEL_9:
    sub_4FF380(v8, 5, v9, a6);
    goto LABEL_6;
  }
  if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v8 + 748) + 276) + 2251) )
    goto LABEL_9;
LABEL_5:
  sub_4FF380(v8, 4, v9, a6);
LABEL_6:
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C350) --------------------------------------------------------
int __cdecl sub_52C350(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    sub_4FF380(result, 25, 4 * *(_WORD *)&byte_5D4594[2649704], a6);
    sub_4E7540(a3, *a5);
    result = 1;
  }
  return result;
}

//----- (0052C390) --------------------------------------------------------
int __cdecl sub_52C390(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258640]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 14, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C3E0) --------------------------------------------------------
int __cdecl sub_52C3E0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax
  int v6; // ebp
  float *v7; // ebx
  float v8; // edx
  float v9; // ecx
  float v10; // edx
  int v11; // edx
  int v13; // eax
  float *v14; // esi
  int v15; // eax
  int v16; // eax
  float v17; // [esp+0h] [ebp-24h]
  float4 v18; // [esp+14h] [ebp-10h]

  v5 = *(_DWORD *)&byte_5D4594[2487712];
  if ( !*(_DWORD *)&byte_5D4594[2487712] )
  {
    v5 = sub_4E3AA0((CHAR *)&byte_587000[258664]);
    *(_DWORD *)&byte_5D4594[2487712] = v5;
  }
  v6 = a5;
  if ( !a5 || !a4 )
    return 0;
  if ( *(unsigned __int16 *)(a4 + 4) != v5 )
  {
    v8 = *(float *)(a4 + 56);
    v9 = *(float *)(a5 + 4);
    v18.field_4 = *(float *)(a4 + 60);
    v18.field_0 = v8;
    v10 = *(float *)(a5 + 8);
    v18.field_8 = v9;
    v18.field_C = v10;
    if ( (unsigned __int8)sub_5374B0(&v18) )
    {
      v7 = (float *)(v6 + 4);
      goto LABEL_12;
    }
    if ( *(_BYTE *)(a4 + 8) & 4 )
    {
      v11 = *(_DWORD *)(a4 + 748);
      a5 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v11 + 276) + 2064), 0, &a5);
    }
    return 0;
  }
  v7 = (float *)(a4 + 56);
LABEL_12:
  v13 = *(_DWORD *)&byte_5D4594[2487732];
  if ( !*(_DWORD *)&byte_5D4594[2487732] )
  {
    v13 = sub_4E3AA0((CHAR *)&byte_587000[258672]);
    *(_DWORD *)&byte_5D4594[2487732] = v13;
  }
  v14 = (float *)sub_4E3450(v13);
  if ( v14 )
  {
    sub_4DAA50((int)v14, a4, *v7, v7[1]);
    v17 = sub_419D40(&byte_587000[258684]);
    v15 = sub_419A70(v17);
    sub_511660(v14, v15);
    sub_5231B0(v14 + 14, 64);
  }
  v16 = sub_424800(a1, 0);
  sub_501A30(v16, (float2 *)(v6 + 4), 0, 0);
  return 1;
}

//----- (0052C530) --------------------------------------------------------
int __cdecl sub_52C530(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  int *v6; // edi
  int v8; // eax
  __int16 v9; // si
  float v10; // [esp+0h] [ebp-Ch]
  float v11; // [esp+0h] [ebp-Ch]
  int v12; // [esp+20h] [ebp+14h]

  v6 = a5;
  if ( !*a5 )
    return 0;
  v10 = sub_419D40(&byte_587000[258700]);
  v8 = sub_419A70(v10);
  v9 = v8;
  v12 = v8;
  if ( sub_40A5C0(4096) )
  {
    v11 = sub_419D40(&byte_587000[258728]) * (double)v12;
    v9 = sub_419A70(v11);
  }
  sub_4FF380(*v6, 13, v9, a6);
  return 1;
}

//----- (0052C5A0) --------------------------------------------------------
int __cdecl sub_52C5A0(int a1, int a2, int a3, int a4, int *a5, int a6)
{
  int result; // eax
  int v7; // eax
  int v8; // eax
  __int16 v9; // ax
  float v10; // [esp+0h] [ebp-8h]
  float v11; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v7 = *(_DWORD *)&byte_5D4594[2487712];
  if ( !*(_DWORD *)&byte_5D4594[2487712] )
  {
    v7 = sub_4E3AA0((CHAR *)&byte_587000[258752]);
    *(_DWORD *)&byte_5D4594[2487712] = v7;
  }
  if ( a4 && *(unsigned __int16 *)(a4 + 4) == v7 )
  {
    v10 = sub_419D70(&byte_587000[258760], a6 - 1);
    v8 = sub_419A70(v10);
    (*(void (__cdecl **)(int, int, int, int, int))(*a5 + 716))(*a5, a3, a3, v8, 9);
    result = 1;
  }
  else
  {
    v11 = sub_419D40(&byte_587000[258776]);
    v9 = sub_419A70(v11);
    sub_4FF380(*a5, 22, v9, a6);
    result = 1;
  }
  return result;
}

//----- (0052C640) --------------------------------------------------------
int __cdecl sub_52C640(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258800]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 9, v7, a6);
  return 1;
}

//----- (0052C680) --------------------------------------------------------
int __cdecl sub_52C680(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258824]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 8, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C6D0) --------------------------------------------------------
int __cdecl sub_52C6D0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258844]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 15, v7, a6);
  sub_4E7540(a3, *a5);
  return 1;
}

//----- (0052C720) --------------------------------------------------------
int __cdecl sub_52C720(int a1, int a2, int a3, int a4, int *a5, int a6)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    sub_4EE7E0(result, a6, a6);
    sub_4E7540(a3, *a5);
    result = 1;
  }
  return result;
}

//----- (0052C750) --------------------------------------------------------
int __cdecl sub_52C750(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    sub_4FF380(result, 2, 4 * *(_WORD *)&byte_5D4594[2649704], a6);
    sub_4E7540(a3, *a5);
    result = 1;
  }
  return result;
}

//----- (0052C790) --------------------------------------------------------
int __cdecl sub_52C790(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // ebx
  float *v7; // esi
  int v8; // edi
  double v9; // st7
  int v10; // eax
  float v11; // ecx
  double v12; // st6
  double v13; // st7
  double v14; // st7
  double v15; // st7
  __int16 v16; // t0
  int v17; // eax
  float4 v19; // [esp+8h] [ebp-10h]
  float v20; // [esp+28h] [ebp+10h]
  float v21; // [esp+30h] [ebp+18h]
  float v22; // [esp+30h] [ebp+18h]

  v6 = a6;
  v7 = (float *)sub_4E3810(*(CHAR **)&byte_587000[4 * a6 + 258864]);
  if ( !v7 )
    return 1;
  v8 = a4;
  v9 = *(float *)(a4 + 176) + *(float *)(a4 + 176);
  v10 = 8 * *(__int16 *)(a4 + 124);
  v21 = *(float *)&byte_587000[v10 + 194136];
  v20 = *(float *)&byte_587000[v10 + 194140];
  v11 = *(float *)(v8 + 60);
  v19.field_0 = *(float *)(v8 + 56);
  v12 = v9 * v21 + *(float *)(v8 + 56);
  v19.field_4 = v11;
  v19.field_8 = v12;
  v13 = v9 * v20 + *(float *)(v8 + 60);
  v19.field_8 = v19.field_8 + *(float *)(v8 + 80);
  v19.field_C = v13 + *(float *)(v8 + 84);
  if ( !sub_535250(&v19, 0, 0, 5) )
  {
    v19.field_8 = v19.field_0;
    v19.field_C = v19.field_4;
  }
  sub_4DAA50((int)v7, v8, v19.field_8, v19.field_C);
  v14 = sub_419D70(&byte_587000[258964], v6 - 1) * v7[136];
  v7[136] = v14;
  v22 = v14 * v21;
  v7[20] = v22;
  v15 = v14 * v20;
  v7[21] = v15;
  v7[20] = v22 + *(float *)(v8 + 80);
  v7[21] = v15 + *(float *)(v8 + 84);
  v16 = *(_WORD *)(v8 + 124);
  *((_WORD *)v7 + 62) = *(_WORD *)(v8 + 124);
  *((_WORD *)v7 + 63) = v16;
  v17 = sub_424800(a1, 0);
  sub_501960(v17, v8, 0, 0);
  return 1;
}

//----- (0052C8D0) --------------------------------------------------------
int __cdecl sub_52C8D0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  if ( !*a5 )
    return 0;
  sub_4FF380(*a5, 6, 60 * *(_WORD *)&byte_5D4594[2649704], a6);
  return 1;
}

//----- (0052C910) --------------------------------------------------------
int __cdecl sub_52C910(int a1)
{
  int result; // eax

  result = a1 * *(_DWORD *)&byte_5D4594[2649704];
  *(_DWORD *)&byte_587000[258404] = a1 * *(_DWORD *)&byte_5D4594[2649704];
  return result;
}

//----- (0052C920) --------------------------------------------------------
int __cdecl sub_52C920(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  int result; // eax

  result = *a5;
  if ( *a5 )
  {
    if ( sub_4FF350(result, 16) )
    {
      result = 0;
    }
    else
    {
      sub_4FF380(*a5, 16, *(__int16 *)&byte_587000[258404], a6);
      if ( a3 )
        sub_4E7540(a3, *a5);
      result = 1;
    }
  }
  return result;
}

//----- (0052C980) --------------------------------------------------------
int __cdecl sub_52C980(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // di
  float v8; // [esp+0h] [ebp-Ch]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[258984]);
  v7 = sub_419A70(v8);
  sub_4FF310(*a5);
  sub_4FF380(*a5, 0, v7, a6);
  sub_522FF0(138, (float2 *)(*a5 + 56));
  return 1;
}

//----- (0052C9E0) --------------------------------------------------------
int __cdecl sub_52C9E0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // di
  float v8; // [esp+0h] [ebp-Ch]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[259012]);
  v7 = sub_419A70(v8);
  sub_4FF310(*a5);
  sub_4FF380(*a5, 23, v7, a6);
  return 1;
}

//----- (0052CA30) --------------------------------------------------------
int __cdecl sub_52CA30(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[259044]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 21, v7, a6);
  return 1;
}

//----- (0052CA70) --------------------------------------------------------
int sub_52CA70()
{
  return 1;
}

//----- (0052CA80) --------------------------------------------------------
int __cdecl sub_52CA80(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // eax
  float2 *v6; // ebp
  int v7; // edi
  int v8; // esi
  int v9; // ebx
  _DWORD *v10; // eax
  unsigned int v11; // edx
  int i; // eax
  int v13; // eax
  _DWORD *v14; // eax
  int v15; // eax
  const char *v17[4]; // [esp+0h] [ebp-10h]

  v4 = *(_DWORD *)&byte_5D4594[2487712];
  if ( !*(_DWORD *)&byte_5D4594[2487712] )
  {
    v4 = sub_4E3AA0((CHAR *)&byte_587000[259072]);
    *(_DWORD *)&byte_5D4594[2487712] = v4;
  }
  if ( a4 && *(unsigned __int16 *)(a4 + 4) == v4 )
  {
    v5 = a3;
    v6 = (float2 *)(a4 + 56);
  }
  else
  {
    v5 = a3;
    v6 = (float2 *)(a3 + 56);
  }
  if ( *(_BYTE *)(v5 + 8) & 4 )
  {
    v7 = *(_DWORD *)(v5 + 748);
    v8 = 0;
    v9 = v7 + 116;
    v10 = (_DWORD *)(v7 + 116);
    do
    {
      if ( !*v10 )
        break;
      ++v8;
      ++v10;
    }
    while ( v8 < 4 );
    if ( v8 == 4 )
    {
      v11 = *(_DWORD *)&byte_5D4594[2598000];
      v8 = a3;
      for ( i = 0; i < 4; ++i )
      {
        if ( *(_DWORD *)(*(_DWORD *)v9 + 136) < v11 )
        {
          v11 = *(_DWORD *)(*(_DWORD *)v9 + 136);
          v8 = i;
        }
        v9 += 4;
      }
    }
    v13 = *(_DWORD *)(v7 + 4 * v8 + 116);
    if ( v13 )
    {
      sub_4E7010(v13, v6);
      *(_DWORD *)(*(_DWORD *)(v7 + 4 * v8 + 116) + 136) = *(_DWORD *)&byte_5D4594[2598000];
    }
    else
    {
	  v17[0] = "TeleportGlyph1";
      v17[1] = "TeleportGlyph2";
      v17[2] = "TeleportGlyph3";
      v17[3] = "TeleportGlyph4";
      v14 = sub_4E3810(v17[v8]);
      *(_DWORD *)(v7 + 4 * v8 + 116) = v14;
      if ( !v14 )
      {
LABEL_21:
        v15 = sub_424800(a1, 0);
        sub_501960(v15, a3, 0, 0);
        return 1;
      }
      sub_4DAA50((int)v14, a3, v6->field_0, v6->field_4);
    }
    *(_BYTE *)(v8 + v7 + 156) = 3;
    goto LABEL_21;
  }
  return 1;
}

//----- (0052CBD0) --------------------------------------------------------
int __cdecl sub_52CBD0(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // ebx
  int v6; // edi
  int v7; // eax
  _DWORD *v8; // eax
  float v9; // ecx
  float v10; // edx
  int v11; // eax
  int v13[39]; // [esp+0h] [ebp-C8h]
  int v14; // [esp+9Ch] [ebp-2Ch]
  int v15; // [esp+A0h] [ebp-28h]
  int v16; // [esp+A4h] [ebp-24h]
  const char *v17[4];

  v4 = *(_DWORD *)&byte_5D4594[2487712];
  if ( !*(_DWORD *)&byte_5D4594[2487712] )
  {
    v4 = sub_4E3AA0((CHAR *)&byte_587000[259208]);
    *(_DWORD *)&byte_5D4594[2487712] = v4;
  }
  if ( !a4 || (v5 = a4 + 56, *(unsigned __int16 *)(a4 + 4) != v4) )
    v5 = a3 + 56;
  if ( *(_BYTE *)(a3 + 8) & 4 )
  {
    v6 = *(_DWORD *)(a3 + 748);
    v7 = *(_DWORD *)(v6 + 4 * a1 - 68);
    if ( v7 )
    {
      sub_4E7010(v7, (float2 *)v5);
      *(_DWORD *)(*(_DWORD *)(v6 + 4 * a1 - 68) + 136) = *(_DWORD *)&byte_5D4594[2598000];
    }
    else
    {
      v17[0] = "TeleportGlyph1";
      v17[1] = "TeleportGlyph2";
      v17[2] = "TeleportGlyph3";
      v17[3] = "TeleportGlyph4";
      v8 = sub_4E3810(v17[a1 - 46]);
      *(_DWORD *)(v6 + 4 * a1 - 68) = v8;
      if ( !v8 )
      {
LABEL_12:
        v16 = 0;
        v15 = 0;
        v14 = a3;
        v11 = sub_424800(a1, 0);
        sub_501960(v11, v14, v15, v16);
        return 1;
      }
      v9 = *(float *)(v5 + 4);
      v10 = *(float *)v5;
      v16 = 0;
      sub_4DAA50((int)v8, a3, v10, v9);
    }
    *(_BYTE *)(a1 + v6 + 110) = 3;
    goto LABEL_12;
  }
  return 1;
}
// 52CBD0: using guessed type int var_C8[39];

//----- (0052CCD0) --------------------------------------------------------
int __cdecl sub_52CCD0(int a1, int a2, int a3)
{
  int v3; // ebx
  double v4; // st7
  double v5; // st6
  double v6; // st5
  int v7; // eax
  float v9; // [esp+Ch] [ebp-8h]
  struct tm *Tm; // [esp+10h] [ebp-4h]

  Tm = 0;
  v9 = 100000000.0;
  v3 = sub_4DA790();
  if ( !v3 )
    return 0;
  do
  {
    if ( sub_4EC4F0(v3, a3) && !strcmp((const char *)sub_4E39D0(v3), (const char *)&byte_587000[259344]) )
    {
      v4 = *(float *)(a3 + 56) - *(float *)(v3 + 56);
      v5 = *(float *)(a3 + 60) - *(float *)(v3 + 60);
      v6 = v5 * v5 + v4 * v4;
      if ( v6 < v9 )
      {
        v9 = v6;
        Tm = (struct tm *)v3;
      }
    }
    v3 = sub_4DA7A0(v3);
  }
  while ( v3 );
  if ( !Tm )
    return 0;
  v7 = sub_424800(a1, 0);
  sub_501960(v7, a3, 0, 0);
  sub_54DF30(Tm);
  return 1;
}

//----- (0052CDB0) --------------------------------------------------------
int __cdecl sub_52CDB0(int a1, int a2, int a3, int a4, int *a5, int a6)
{
  int result; // eax
  int v7; // eax
  __int16 v8; // ax
  int v9; // [esp-Ch] [ebp-10h]

  result = *a5;
  if ( *a5 )
  {
    if ( *(_BYTE *)(result + 540) )
    {
      if ( *(unsigned __int8 *)(result + 540) > a6 )
      {
        sub_4EE8F0(result, a6);
        sub_4DA2C0(*a5, (const char *)&byte_587000[259376], 0);
      }
      else
      {
        sub_4EE9D0(*a5);
        sub_4DA2C0(*a5, (const char *)&byte_587000[259352], 0);
      }
      goto LABEL_5;
    }
    if ( result != a2 )
    {
LABEL_5:
      v9 = *a5;
      v7 = sub_424800(a1, 1);
      sub_501960(v7, v9, 0, 0);
      return 1;
    }
    v8 = sub_4249A0(a1, 1);
    sub_4FD030(*a5, v8);
    result = 1;
  }
  return result;
}

//----- (0052CE60) --------------------------------------------------------
void __cdecl sub_52CE60(int a1)
{
  if ( *(_BYTE *)(a1 + 8) & 0x80 )
  {
    *(_DWORD *)(a1 + 508) = *(_DWORD *)&byte_5D4594[2487716];
    *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000] + 60 * *(_DWORD *)&byte_5D4594[2649704];
  }
}

//----- (0052CE90) --------------------------------------------------------
int __cdecl sub_52CE90(int a1, int a2, int a3, int a4)
{
  int v5; // ecx
  int v7; // eax
  int v8; // [esp-Ch] [ebp-20h]
  float4 v9; // [esp+4h] [ebp-10h]

  v9.field_0 = *(float *)(a3 + 56) - 150.0;
  v9.field_4 = *(float *)(a3 + 60) - 150.0;
  v9.field_8 = *(float *)(a3 + 56) + 150.0;
  v9.field_C = *(float *)(a3 + 60) + 150.0;
  *(_DWORD *)&byte_5D4594[2487708] = 0;
  *(_DWORD *)&byte_5D4594[2487704] = 1287568416;
  sub_517C10(&v9, (void (__cdecl *)(float *, int))sub_52CF90, a4);
  if ( !*(_DWORD *)&byte_5D4594[2487708] )
    return 0;
  v5 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487708] + 508);
  if ( v5 && v5 != a3 )
  {
    sub_4DA2C0(a3, (const char *)&byte_587000[259400], 0);
    return 0;
  }
  *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487708] + 508) = a3;
  *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487708] + 136) = *(_DWORD *)&byte_5D4594[2598000]
                                                      + 60 * *(_DWORD *)&byte_5D4594[2649704];
  sub_52D060(*(int *)&byte_5D4594[2487708], a3);
  v8 = *(_DWORD *)&byte_5D4594[2487708];
  v7 = sub_424800(a1, 0);
  sub_501960(v7, v8, 0, 0);
  return 1;
}

//----- (0052CF90) --------------------------------------------------------
void __cdecl sub_52CF90(int a1, int a2)
{
  int v2; // esi
  double v3; // st7
  double v4; // st6
  int v5; // eax
  float v6; // ecx
  float4 v7; // [esp+4h] [ebp-10h]
  float v8; // [esp+18h] [ebp+4h]

  v2 = a1;
  if ( *(_BYTE *)(a1 + 8) & 0x80 )
  {
    v3 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
    v4 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
    v8 = v4 * v4 + v3 * v3;
    if ( v8 <= 22500.0 && v8 < (double)*(float *)&byte_5D4594[2487704] )
    {
      v5 = *(_DWORD *)(v2 + 748);
      v6 = *(float *)(a2 + 60);
      v7.field_0 = *(float *)(a2 + 56);
      v7.field_4 = v6;
      v7.field_8 = (double)*(int *)&byte_587000[8 * *(_DWORD *)(v5 + 12) + 196184] * 0.5 + *(float *)(v2 + 56);
      v7.field_C = (double)*(int *)&byte_587000[8 * *(_DWORD *)(v5 + 12) + 196188] * 0.5 + *(float *)(v2 + 60);
      if ( sub_535250(&v7, 0, 0, 0) )
      {
        *(_DWORD *)&byte_5D4594[2487708] = v2;
        *(float *)&byte_5D4594[2487704] = v4 * v4 + v3 * v3;
      }
    }
  }
}

//----- (0052D060) --------------------------------------------------------
void __cdecl sub_52D060(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  float4 v5; // [esp+0h] [ebp-10h]

  v2 = *(_DWORD *)(a1 + 748);
  v5.field_0 = (double)(int)(23 * *(_DWORD *)(v2 + 16)) - 34.0;
  v5.field_4 = (double)(int)(23 * *(_DWORD *)(v2 + 20)) - 34.0;
  v5.field_8 = (double)(int)(23 * *(_DWORD *)(v2 + 16)) + 34.0;
  v3 = *(_DWORD *)(v2 + 20);
  *(_DWORD *)&byte_5D4594[2487716] = a2;
  v5.field_C = (double)(23 * v3) + 34.0;
  sub_517C10(&v5, (void (__cdecl *)(float *, int))sub_52CE60, 0);
  *(_DWORD *)&byte_5D4594[2487716] = 0;
}

//----- (0052D110) --------------------------------------------------------
int __cdecl sub_52D110(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[259432]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 17, v7, a6);
  return 1;
}

//----- (0052D150) --------------------------------------------------------
int __cdecl sub_52D150(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[259460]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 20, v7, a6);
  return 1;
}

//----- (0052D190) --------------------------------------------------------
int sub_52D190()
{
  return 1;
}

//----- (0052D1A0) --------------------------------------------------------
int __cdecl sub_52D1A0(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-8h]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[259496]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 18, v7, a6);
  return 1;
}

//----- (0052D1E0) --------------------------------------------------------
int __cdecl sub_52D1E0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ebp
  float v6; // edx
  float v7; // ecx
  float v8; // edx
  int v9; // edx
  int v11; // eax
  float v12; // [esp+0h] [ebp-44h]
  float v13; // [esp+4h] [ebp-40h]
  float v14; // [esp+8h] [ebp-3Ch]
  int v15; // [esp+8h] [ebp-3Ch]
  float4 v16; // [esp+24h] [ebp-20h]
  int4 v20; // [esp+34h] [ebp-10h]

  if ( !a5 || !a4 )
    return 0;
  if ( *(_BYTE *)(a3 + 8) & 4 )
    v5 = *(_DWORD *)(a3 + 748);
  else
    v5 = a5;
  v6 = *(float *)(a4 + 60);
  v16.field_0 = *(float *)(a4 + 56);
  v7 = *(float *)(a5 + 4);
  v16.field_4 = v6;
  v8 = *(float *)(a5 + 8);
  v16.field_8 = v7;
  v16.field_C = v8;
  if ( !(unsigned __int8)sub_5374B0(&v16) )
  {
    if ( *(_BYTE *)(a4 + 8) & 4 )
    {
      v9 = *(_DWORD *)(v5 + 276);
      a5 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(v9 + 2064), 0, &a5);
    }
    return 0;
  }
  sub_4E25A0(0);
  v14 = sub_419D40(&byte_587000[259528]);
  v15 = sub_419A70(v14);
  v13 = sub_419D40(&byte_587000[259544]);
  v12 = sub_419D40(&byte_587000[259564]);
  sub_4E25B0(&v16.field_8, v12, v13, v15, 16, a3, 0);
  v20.field_0 = (__int64)v16.field_0;
  v20.field_4 = (__int64)v16.field_4;
  v20.field_8 = (__int64)v16.field_8;
  v20.field_C = (__int64)v16.field_C;
  sub_523250(&v20);
  v11 = sub_424800(a1, 0);
  sub_501960(v11, a4, 0, 0);
  sub_537AF0(&v16.field_8, 1);
  return 1;
}

//----- (0052D330) --------------------------------------------------------
int __cdecl sub_52D330(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  int result; // eax
  _DWORD *v7; // eax
  int v8; // eax
  int v9; // [esp-Ch] [ebp-10h]

  result = *a5;
  if ( *a5 )
  {
    if ( *(_BYTE *)(result + 8) & 4 )
    {
      v7 = sub_4E3810((CHAR *)&byte_587000[259584]);
      if ( v7 )
      {
        sub_4DAA50((int)v7, *a5, *(float *)(*a5 + 56), *(float *)(*a5 + 60));
        sub_4FF380(*a5, 24, 20 * *(_WORD *)&byte_5D4594[2649704], a6);
        sub_4FEB10(24, *a5);
        sub_4FEB10(43, *a5);
        v9 = *a5;
        v8 = sub_424800(a1, 1);
        sub_501960(v8, v9, 0, 0);
      }
    }
    result = 1;
  }
  return result;
}

//----- (0052D3C0) --------------------------------------------------------
int __cdecl sub_52D3C0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  unsigned __int8 *v7; // eax
  float v8; // ecx
  float v9; // edx
  float v10; // eax
  BOOL v11; // eax
  int v12; // eax
  int result; // eax
  _DWORD *v14; // eax
  int v15; // esi
  _DWORD *v16; // ebp
  double v17; // st7
  unsigned int v18; // ecx
  int v19; // eax
  float v20; // [esp+0h] [ebp-24h]
  float4 v21; // [esp+14h] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2487736] )
  {
    *(_DWORD *)&byte_5D4594[2487740] = sub_4E3AA0((CHAR *)&byte_587000[259600]);
    *(_DWORD *)&byte_5D4594[2487744] = sub_4E3AA0((CHAR *)&byte_587000[259612]);
    *(_DWORD *)&byte_5D4594[2487748] = sub_4E3AA0((CHAR *)&byte_587000[259624]);
    *(_DWORD *)&byte_5D4594[2487752] = sub_4E3AA0((CHAR *)&byte_587000[259636]);
    *(_DWORD *)&byte_5D4594[2487756] = sub_4E3AA0((CHAR *)&byte_587000[259648]);
    *(_DWORD *)&byte_5D4594[2487736] = 1;
  }
  v6 = *(_DWORD *)(a3 + 516);
  if ( v6 )
  {
    while ( 2 )
    {
      v7 = &byte_5D4594[2487740];
      do
      {
        if ( *(unsigned __int16 *)(v6 + 4) == *(_DWORD *)v7 )
        {
          sub_4DA2C0(a3, (const char *)&byte_587000[259660], 0);
          return 0;
        }
        v7 += 4;
      }
      while ( (int)v7 < (int)&byte_5D4594[2487760] );
      v6 = *(_DWORD *)(v6 + 512);
      if ( v6 )
        continue;
      break;
    }
  }
  v8 = *(float *)(a4 + 60);
  v9 = *(float *)(a5 + 4);
  v21.field_0 = *(float *)(a4 + 56);
  v10 = *(float *)(a5 + 8);
  v21.field_4 = v8;
  v21.field_8 = v9;
  v21.field_C = v10;
  v11 = sub_40A5C0(2048);
  if ( sub_535250(&v21, 0, 0, !v11 ? 73 : 9) )
  {
    v14 = sub_4E3450(*(_DWORD *)&byte_5D4594[4 * a6 + 2487736]);
    v15 = (int)v14;
    if ( v14 )
    {
      v16 = (_DWORD *)v14[187];
      v20 = sub_419D70(&byte_587000[259684], a6 - 1);
      *v16 = sub_419A70(v20);
      sub_4DAA50(v15, a4, *(float *)(a5 + 4), *(float *)(a5 + 8));
      *(_DWORD *)(v15 + 20) |= 0x20u;
      sub_4E46F0(v15, 255.0);
      v17 = sub_419D40(&byte_587000[259708]);
      v18 = 0x800000 | *(_DWORD *)(v15 + 16);
      *(float *)(v15 + 108) = -v17;
      *(_DWORD *)(v15 + 16) = v18;
      *(_DWORD *)(v15 + 116) = 1091567616;
      v19 = sub_424800(a1, 0);
      sub_501960(v19, a4, 0, 0);
    }
    result = 1;
  }
  else
  {
    if ( *(_BYTE *)(a4 + 8) & 4 )
    {
      v12 = *(_DWORD *)(a4 + 748);
      a6 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v12 + 276) + 2064), 0, &a6);
    }
    result = 0;
  }
  return result;
}

//----- (0052D5C0) --------------------------------------------------------
int __cdecl sub_52D5C0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // edx
  unsigned __int8 *v7; // eax
  int v8; // ecx
  float *v9; // esi
  __int16 v10; // ax
  double v11; // st7
  double v12; // st7
  int v13; // eax
  float v14; // edx
  double v15; // st6
  int v17; // edx
  int v18; // eax
  int v19; // [esp+0h] [ebp-14h]
  float4 v20; // [esp+4h] [ebp-10h]
  float v21; // [esp+1Ch] [ebp+8h]
  float v22; // [esp+20h] [ebp+Ch]

  if ( !*(_DWORD *)&byte_5D4594[2487760] )
  {
    *(_DWORD *)&byte_5D4594[2487760] = sub_4E3AA0((CHAR *)&byte_587000[259720]);
    *(_DWORD *)&byte_5D4594[2487764] = sub_4E3AA0((CHAR *)&byte_587000[259740]);
    *(_DWORD *)&byte_5D4594[2487768] = sub_4E3AA0((CHAR *)&byte_587000[259760]);
    *(_DWORD *)&byte_5D4594[2487772] = sub_4E3AA0((CHAR *)&byte_587000[259780]);
    *(_DWORD *)&byte_5D4594[2487776] = sub_4E3AA0((CHAR *)&byte_587000[259796]);
    *(_DWORD *)&byte_5D4594[2487780] = sub_4E3AA0((CHAR *)&byte_587000[259816]);
    *(_DWORD *)&byte_5D4594[2487784] = sub_4E3AA0((CHAR *)&byte_587000[259840]);
    *(_DWORD *)&byte_5D4594[2487788] = sub_4E3AA0((CHAR *)&byte_587000[259864]);
    *(_DWORD *)&byte_5D4594[2487792] = sub_4E3AA0((CHAR *)&byte_587000[259888]);
    *(_DWORD *)&byte_5D4594[2487796] = sub_4E3AA0((CHAR *)&byte_587000[259908]);
  }
  if ( a2 )
  {
    v6 = *(_DWORD *)(a2 + 516);
    if ( v6 )
    {
      while ( 2 )
      {
        v7 = &byte_5D4594[2487760];
        do
        {
          if ( *(unsigned __int16 *)(v6 + 4) == *(_DWORD *)v7 )
          {
            sub_4DA2C0(a3, (const char *)&byte_587000[259932], 0);
            return 0;
          }
          v7 += 4;
        }
        while ( (int)v7 < (int)&byte_5D4594[2487800] );
        v6 = *(_DWORD *)(v6 + 512);
        if ( v6 )
          continue;
        break;
      }
    }
  }
  if ( !sub_40A5C0(2048) )
    a6 = 4;
  v19 = 48;
  do
  {
    v8 = a6 - sub_415FA0(0, 1);
    if ( v8 >= 1 )
    {
      v9 = (float *)sub_4E3450(*(_DWORD *)&byte_5D4594[4 * ((a1 != 10 ? 5 : 0) + v8) + 2487756]);
      if ( v9 )
      {
        v10 = sub_415FA0(0, 255);
        v11 = v9[44];
        *((_WORD *)v9 + 62) = v10;
        v12 = v11 + *(float *)(a4 + 176) + 4.0;
        v13 = 8 * v10;
        v21 = *(float *)&byte_587000[v13 + 194136];
        v22 = *(float *)&byte_587000[v13 + 194140];
        v14 = *(float *)(a4 + 60);
        v15 = v12 * v21 + *(float *)(a4 + 56);
        v20.field_0 = *(float *)(a4 + 56);
        v20.field_4 = v14;
        v20.field_8 = v15;
        v20.field_C = v12 * v22 + *(float *)(a4 + 60);
        if ( sub_535250(&v20, 0, 0, 65) )
        {
          sub_4DAA50((int)v9, a4, v20.field_8, v20.field_C);
          *((_WORD *)v9 + 63) = *((_WORD *)v9 + 62);
          v9[20] = v21 * 4.0;
          v9[21] = v22 * 4.0;
          *((_DWORD *)v9 + 34) = *(_DWORD *)&byte_5D4594[2598000]
                               + sub_415FA0(3 * *(_DWORD *)&byte_5D4594[2649704], 6 * *(_DWORD *)&byte_5D4594[2649704]);
          v9[39] = *(float *)(a4 + 56);
          v9[40] = *(float *)(a4 + 60);
          *((_DWORD *)v9 + 186) = sub_53D510;
          sub_4DA8D0((int)v9);
          v17 = *((_DWORD *)v9 + 2) | 0x40000000;
          v9[28] = 0.0;
          *((_DWORD *)v9 + 2) = v17;
          sub_523530((int)v9);
        }
        else
        {
          sub_4E5CC0((int)v9);
        }
      }
    }
    --v19;
  }
  while ( v19 );
  v18 = sub_424800(a1, 0);
  sub_501960(v18, a4, 0, 0);
  return 1;
}

//----- (0052D8A0) --------------------------------------------------------
int __cdecl sub_52D8A0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // esi
  int v7; // edi
  float v8; // edx
  float v9; // ecx
  float v10; // eax
  BOOL v11; // eax
  int v12; // eax
  int result; // eax
  _DWORD *v14; // eax
  int v15; // edi
  _DWORD *v16; // ebx
  int v17; // eax
  float v18; // [esp+0h] [ebp-20h]
  float4 v19; // [esp+10h] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2487800] )
    *(_DWORD *)&byte_5D4594[2487800] = sub_4E3AA0((CHAR *)&byte_587000[260104]);
  v6 = a5;
  v7 = a4;
  v8 = *(float *)(a5 + 4);
  v9 = *(float *)(a4 + 60);
  v19.field_0 = *(float *)(a4 + 56);
  v10 = *(float *)(a5 + 8);
  v19.field_4 = v9;
  v19.field_8 = v8;
  v19.field_C = v10;
  v11 = sub_40A5C0(2048);
  if ( sub_535250(&v19, 0, 0, !v11 ? 73 : 9) )
  {
    v14 = sub_4E3450(*(int *)&byte_5D4594[2487800]);
    v15 = (int)v14;
    if ( v14 )
    {
      v16 = (_DWORD *)v14[187];
      v18 = sub_419D70(&byte_587000[260120], a6 - 1);
      *v16 = sub_419A70(v18);
      sub_4DAA50(v15, a3, *(float *)(v6 + 4), *(float *)(v6 + 8));
      v17 = sub_424800(a1, 0);
      sub_501960(v17, a3, 0, 0);
    }
    result = 1;
  }
  else
  {
    if ( *(_BYTE *)(v7 + 8) & 4 )
    {
      v12 = *(_DWORD *)(v7 + 748);
      a4 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v12 + 276) + 2064), 0, &a4);
    }
    result = 0;
  }
  return result;
}

//----- (0052D9D0) --------------------------------------------------------
int __cdecl sub_52D9D0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  int v7; // ecx
  int v8; // esi
  int v9; // ebp
  float v10; // ecx
  float v11; // edx
  float2 *v12; // edi
  float v13; // eax
  BOOL v14; // eax
  int v15; // eax
  int result; // eax
  _DWORD *v17; // eax
  int v18; // esi
  int *v19; // ebx
  int v20; // eax
  int v21; // ecx
  int v22; // eax
  float v23; // [esp+0h] [ebp-24h]
  float4 v24; // [esp+14h] [ebp-10h]

  v6 = *(_DWORD *)&byte_5D4594[2487804];
  if ( !*(_DWORD *)&byte_5D4594[2487804] )
  {
    v6 = sub_4E3AA0((CHAR *)&byte_587000[260136]);
    *(_DWORD *)&byte_5D4594[2487804] = v6;
  }
  v7 = *(_DWORD *)(a3 + 516);
  if ( v7 )
  {
    while ( *(unsigned __int16 *)(v7 + 4) != v6 )
    {
      v7 = *(_DWORD *)(v7 + 512);
      if ( !v7 )
        goto LABEL_6;
    }
    sub_4DA2C0(a3, (const char *)&byte_587000[260144], 0);
    result = 0;
  }
  else
  {
LABEL_6:
    v8 = a4;
    v9 = a5;
    v10 = *(float *)(a4 + 60);
    v11 = *(float *)(a5 + 4);
    v12 = (float2 *)(a5 + 4);
    v24.field_0 = *(float *)(a4 + 56);
    v24.field_4 = v10;
    v13 = *(float *)(a5 + 8);
    v24.field_8 = v11;
    v24.field_C = v13;
    v14 = sub_40A5C0(2048);
    if ( sub_535250(&v24, 0, 0, !v14 ? 73 : 9) )
    {
      v17 = sub_4E3450(*(int *)&byte_5D4594[2487804]);
      v18 = (int)v17;
      if ( v17 )
      {
        v19 = (int *)v17[187];
        v23 = sub_419D70(&byte_587000[260172], a6 - 1);
        v20 = sub_419A70(v23);
        v21 = a3;
        *v19 = v20;
        sub_4DAA50(v18, v21, v12->field_0, *(float *)(v9 + 8));
        *(_DWORD *)(v18 + 20) |= 0x20u;
        sub_4E46F0(v18, 255.0);
        *(float *)(v18 + 108) = -sub_419D40(&byte_587000[260188]);
        v22 = sub_424800(a1, 0);
        sub_501A30(v22, v12, 0, 0);
      }
      result = 1;
    }
    else
    {
      if ( *(_BYTE *)(v8 + 8) & 4 )
      {
        v15 = *(_DWORD *)(v8 + 748);
        a3 = 2;
        sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v15 + 276) + 2064), 0, &a3);
      }
      result = 0;
    }
  }
  return result;
}

//----- (0052DB60) --------------------------------------------------------
int __cdecl sub_52DB60(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // esi
  int v6; // edi
  float v7; // eax
  float v8; // edx
  float v9; // eax
  int v10; // eax
  int result; // eax
  _DWORD *v12; // esi
  _DWORD *v13; // ebx
  int v14; // eax
  float v15; // [esp+0h] [ebp-28h]
  float4 v16; // [esp+18h] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2487808] )
    *(_DWORD *)&byte_5D4594[2487808] = sub_4E3AA0((CHAR *)&byte_587000[260200]);
  v5 = a4;
  v6 = a5;
  v7 = *(float *)(a4 + 56);
  v8 = *(float *)(a5 + 4);
  v16.field_4 = *(float *)(a4 + 60);
  v16.field_0 = v7;
  v9 = *(float *)(a5 + 8);
  v16.field_8 = v8;
  v16.field_C = v9;
  if ( (unsigned __int8)sub_5374B0(&v16) )
  {
    v12 = sub_4E3450(*(int *)&byte_5D4594[2487808]);
    if ( v12 )
    {
      v13 = (_DWORD *)v12[187];
      sub_4DAA50((int)v12, a3, *(float *)(v6 + 4), *(float *)(v6 + 8));
      v15 = sub_419D40(&byte_587000[260212]) * (double)*(int *)&byte_5D4594[2649704];
      *v13 = sub_419A70(v15);
    }
    v14 = sub_424800(a1, 0);
    sub_501960(v14, (int)v12, 0, 0);
    result = 1;
  }
  else
  {
    if ( *(_BYTE *)(v5 + 8) & 4 )
    {
      v10 = *(_DWORD *)(v5 + 748);
      a4 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v10 + 276) + 2064), 0, &a4);
    }
    result = 0;
  }
  return result;
}

//----- (0052DC80) --------------------------------------------------------
int __cdecl sub_52DC80(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // esi
  int v6; // edi
  float v7; // eax
  float v8; // edx
  float v9; // eax
  int v10; // eax
  int result; // eax
  _DWORD *v12; // eax
  float4 v13; // [esp+0h] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2487812] )
    *(_DWORD *)&byte_5D4594[2487812] = sub_4E3AA0((CHAR *)&byte_587000[260232]);
  v5 = a4;
  v6 = a5;
  v7 = *(float *)(a4 + 56);
  v8 = *(float *)(a5 + 4);
  v13.field_4 = *(float *)(a4 + 60);
  v13.field_0 = v7;
  v9 = *(float *)(a5 + 8);
  v13.field_8 = v8;
  v13.field_C = v9;
  if ( (unsigned __int8)sub_5374B0(&v13) )
  {
    v12 = sub_4E3450(*(int *)&byte_5D4594[2487812]);
    if ( v12 )
      sub_4DAA50((int)v12, a3, *(float *)(v6 + 4), *(float *)(v6 + 8));
    result = 1;
  }
  else
  {
    if ( *(_BYTE *)(v5 + 8) & 4 )
    {
      v10 = *(_DWORD *)(v5 + 748);
      a4 = 2;
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v10 + 276) + 2064), 0, &a4);
    }
    result = 0;
  }
  return result;
}

//----- (0052DD50) --------------------------------------------------------
int __cdecl sub_52DD50(int a1, int a2, int a3, int a4, float a5)
{
  float v5; // edi
  int v6; // esi
  __int16 v8; // bx
  __int16 v9; // ax
  char v10; // al
  double v11; // st7
  int v12; // eax
  int v13; // eax
  int v14; // [esp-Ch] [ebp-14h]
  float v15; // [esp+1Ch] [ebp+14h]

  v5 = a5;
  v6 = *(_DWORD *)LODWORD(a5);
  if ( !*(_DWORD *)LODWORD(a5) )
    return 0;
  v8 = sub_4EE780(*(_DWORD *)LODWORD(a5));
  if ( v8 == sub_4EE7A0(v6) && a2 == *(_DWORD *)LODWORD(a5) )
  {
    v9 = sub_4249A0(a1, 1);
    sub_4FD030(a3, v9);
    return 1;
  }
  v15 = sub_419D40(&byte_587000[260252]);
  if ( a3 && *(_BYTE *)(a3 + 8) & 4 )
  {
    v10 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a3 + 748) + 276) + 2251);
    switch ( v10 )
    {
      case 0:
        v11 = *(float *)&byte_587000[312784];
LABEL_14:
        v15 = v11 * v15;
        break;
      case 2:
        v11 = *(float *)&byte_587000[312800];
        goto LABEL_14;
      case 1:
        v11 = *(float *)&byte_587000[312816];
        goto LABEL_14;
    }
  }
  v12 = sub_419A70(v15);
  sub_4EE460(*(_DWORD *)LODWORD(v5), v12);
  v14 = *(_DWORD *)LODWORD(v5);
  v13 = sub_424800(a1, 1);
  sub_501960(v13, v14, 0, 0);
  return 1;
}

//----- (0052DE40) --------------------------------------------------------
int __cdecl sub_52DE40(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // eax
  int v7; // eax
  float v9; // [esp+0h] [ebp-18h]
  float v10; // [esp+8h] [ebp-10h]

  *(_DWORD *)&byte_5D4594[2487700] = a6;
  v9 = sub_419D40(&byte_587000[260272]);
  sub_517F90((float2 *)(a4 + 56), v9, sub_52DEC0, a4);
  v6 = sub_424800(a1, 0);
  sub_501960(v6, a4, 0, 0);
  v10 = sub_419D70(&byte_587000[260288], a6 - 1);
  v7 = sub_419A70(v10);
  sub_4D9110((float *)(a4 + 56), v7);
  return 1;
}

//----- (0052DEC0) --------------------------------------------------------
__int16 __cdecl sub_52DEC0(int a1, int a2)
{
  int v2; // edi
  int v3; // eax
  int v4; // ebx
  double v5; // st7
  float v7; // [esp+14h] [ebp+8h]
  float v8; // [esp+14h] [ebp+8h]

  v2 = a2;
  v3 = sub_4EC580(a2);
  v4 = v3;
  if ( a1 != a2 )
  {
    v3 = *(_DWORD *)(a1 + 16);
    if ( !(v3 & 0x4000) )
    {
      LOWORD(v3) = sub_4EE780(a1);
      if ( (_WORD)v3 )
      {
        v7 = sub_4E6C00(a1, a2);
        v8 = 1.0 - v7 / sub_419D40(&byte_587000[260328]);
        v5 = sub_419D70(&byte_587000[260308], *(_DWORD *)&byte_5D4594[2487700] - 1) * v8;
        LOWORD(v3) = (*(int (__cdecl **)(int, int, int, _DWORD, int))(a1 + 716))(a1, v4, v2, (__int64)v5, 11);
      }
    }
  }
  return v3;
}

//----- (0052DF40) --------------------------------------------------------
int __cdecl sub_52DF40(int a1, int a2, int a3, int a4, int *a5, char a6)
{
  __int16 v7; // ax
  float v8; // [esp+0h] [ebp-Ch]

  if ( !*a5 )
    return 0;
  v8 = sub_419D40(&byte_587000[260344]);
  v7 = sub_419A70(v8);
  sub_4FF380(*a5, 11, v7, a6);
  return 1;
}

//----- (0052DF80) --------------------------------------------------------
char __cdecl sub_52DF80(int a1, int a2, float a3)
{
  int v3; // esi
  unsigned int v4; // eax
  double v5; // st7
  double v6; // st7
  float v8; // [esp+4h] [ebp-4h]
  float v9; // [esp+Ch] [ebp+4h]
  float v10; // [esp+10h] [ebp+8h]
  float v11; // [esp+14h] [ebp+Ch]

  v3 = a2;
  v4 = sub_52E020(a2);
  if ( v4 )
  {
    v10 = *(float *)(a2 + 56) - *(float *)a1;
    v5 = *(float *)(v3 + 60) - *(float *)(a1 + 4);
    v9 = v5;
    v8 = sqrt(v5 * v9 + v10 * v10) + 0.1;
    v11 = a3 * 10.0;
    v6 = v11 / sub_4E4A70(v3);
    LOBYTE(v4) = *(_BYTE *)(v3 + 8);
    *(float *)(v3 + 88) = v10 * v6 / v8 + *(float *)(v3 + 88);
    *(float *)(v3 + 92) = v9 * v6 / v8 + *(float *)(v3 + 92);
    if ( !(v4 & 1) )
      LOBYTE(v4) = sub_537610(v3);
  }
  return v4;
}

//----- (0052E020) --------------------------------------------------------
unsigned int __cdecl sub_52E020(int a1)
{
  unsigned int result; // eax

  if ( *(_DWORD *)(a1 + 16) & 0x8068 )
    result = 0;
  else
    result = ((unsigned int)~*(_DWORD *)(a1 + 8) >> 22) & 1;
  return result;
}

//----- (0052E040) --------------------------------------------------------
void __cdecl sub_52E040(int a1, float a2, int a3, float a4, int a5, int a6, int a7)
{
  double v7; // st7
  double v8; // st7
  float4 a1a; // [esp+0h] [ebp-2Ch]
  int a3a[7]; // [esp+10h] [ebp-1Ch]

  a3a[0] = a1;
  v7 = *(float *)a1 - a2;
  a3a[5] = a6;
  a3a[6] = a7;
  a1a.field_0 = v7;
  a1a.field_4 = *(float *)(a1 + 4) - a2;
  a1a.field_8 = a2 + *(float *)a1;
  v8 = a2 + *(float *)(a1 + 4);
  a3a[4] = a5;
  a3a[2] = a3;
  a1a.field_C = v8;
  *(float *)&a3a[3] = a4 * 10.0;
  if ( a2 >= (double)*(float *)&a3 )
    *(float *)&a3a[1] = a2;
  else
    a3a[1] = a3;
  sub_517ED0(&a1a, sub_52E0E0, (int)a3a);
}

//----- (0052E0E0) --------------------------------------------------------
void __cdecl sub_52E0E0(int a1, int **a2)
{
  int v2; // esi
  int **v3; // edi
  int *v4; // eax
  float v5; // edx
  float v6; // eax
  float v7; // ecx
  double v8; // st7
  long double v9; // st7
  double v10; // st7
  int *v11; // eax
  bool v12; // zf
  float v13; // [esp+8h] [ebp-18h]
  float v14; // [esp+Ch] [ebp-14h]
  float4 v15; // [esp+10h] [ebp-10h]
  float v16; // [esp+24h] [ebp+4h]
  float v17; // [esp+28h] [ebp+8h]
  float v18; // [esp+28h] [ebp+8h]

  v2 = a1;
  if ( sub_52E020(a1) )
  {
    v3 = a2;
    v4 = *a2;
    LODWORD(v15.field_0) = **a2;
    v5 = *((float *)v4 + 1);
    v6 = *(float *)(a1 + 56);
    v7 = *(float *)(a1 + 60);
    v15.field_4 = v5;
    v15.field_8 = v6;
    v15.field_C = v7;
    if ( sub_535250(&v15, 0, 0, 0) )
    {
      v13 = *(float *)(a1 + 56) - *(float *)*a2;
      v8 = *(float *)(a1 + 60) - *((float *)*a2 + 1);
      v14 = v8;
      v9 = sqrt(v8 * v14 + v13 * v13) + 0.1;
      v16 = v9;
      if ( v9 <= *((float *)a2 + 1) )
      {
        if ( v16 > (double)*((float *)a2 + 2) )
          v17 = (1.0 - (v16 - *((float *)a2 + 2)) / (*((float *)a2 + 1) - *((float *)a2 + 2))) * *((float *)a2 + 3);
        else
          v17 = *((float *)a2 + 3);
        v10 = sub_4E4A70(v2);
        v11 = v3[5];
        v18 = v17 / v10;
        if ( v11 )
          ((void (__cdecl *)(int, _DWORD, int *))v11)(v2, LODWORD(v16), v3[6]);
        v12 = (*(_BYTE *)(v2 + 8) & 1) == 0;
        *(float *)(v2 + 88) = v18 * v13 / v16 + *(float *)(v2 + 88);
        *(float *)(v2 + 92) = v18 * v14 / v16 + *(float *)(v2 + 92);
        if ( v12 )
          sub_537610(v2);
      }
    }
  }
}

//----- (0052E210) --------------------------------------------------------
int __cdecl sub_52E210(float a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // eax
  float v4; // edx
  int v5; // eax
  int v7; // edi
  unsigned __int16 v8; // bx
  int v9; // eax
  int v10; // ecx
  double v11; // st7
  double v12; // st7
  int v13; // eax
  int v14; // eax
  _DWORD *v15; // ecx
  double v16; // st7
  _DWORD *v17; // eax
  int v18; // eax
  float2 v19; // [esp+8h] [ebp-8h]
  float v21; // [esp+14h] [ebp+4h]
  float v22; // [esp+14h] [ebp+4h]

  v1 = LODWORD(a1);
  v2 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( v2 )
  {
    if ( sub_4FF350(v2, 8) )
      return 1;
  }
  else if ( !*(_DWORD *)(LODWORD(a1) + 20) )
  {
    return 1;
  }
  if ( *(_DWORD *)(LODWORD(a1) + 20) )
  {
    v3 = *(_DWORD *)(LODWORD(a1) + 16);
    if ( v3 )
    {
      v19.field_0 = *(float *)(v3 + 56);
      v4 = *(float *)(v3 + 60);
    }
    else
    {
      v4 = *(float *)(LODWORD(a1) + 32);
      v19.field_0 = *(float *)(LODWORD(a1) + 28);
    }
    v19.field_4 = v4;
    v5 = sub_52E610((int *)&v19, v3);
    if ( v5 )
    {
      sub_4EEBF0(v5, 50);
      return 1;
    }
    return 1;
  }
  v7 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( *(_BYTE *)(v7 + 8) & 4 )
  {
    v8 = sub_4EEC80(v7);
    if ( v8 >= (unsigned __int16)sub_4EECB0(v7) )
      return 1;
  }
  v9 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( *(_BYTE *)(v9 + 8) & 2 )
  {
    if ( sub_4FEA70(v9, (float2 *)(LODWORD(a1) + 28)) )
      return 1;
  }
  v10 = *(_DWORD *)(LODWORD(a1) + 16);
  v11 = *(float *)(LODWORD(a1) + 28) - *(float *)(v10 + 56);
  if ( v11 < 0.0 )
    v11 = -v11;
  v19.field_0 = v11;
  v12 = *(float *)(LODWORD(a1) + 32) - *(float *)(v10 + 60);
  if ( v12 < 0.0 )
    v12 = -v12;
  v19.field_4 = v12;
  if ( sub_4E6BD0(v10) || v19.field_0 >= 5.0 || v19.field_4 >= 5.0 )
    return 1;
  v13 = sub_52E610((int *)(*(_DWORD *)(LODWORD(a1) + 16) + 56), *(_DWORD *)(LODWORD(a1) + 16));
  *(_DWORD *)(LODWORD(a1) + 48) = v13;
  if ( !v13 )
  {
    if ( *(_DWORD *)(LODWORD(a1) + 36) )
      sub_4FEF90(SLODWORD(a1), *(_DWORD **)(LODWORD(a1) + 36));
    return 1;
  }
  v21 = *(float *)(LODWORD(a1) + 72);
  v22 = sub_419D70(&byte_587000[260408], *(_DWORD *)(v1 + 8) - 1) + v21;
  *(float *)&v14 = COERCE_FLOAT(sub_419A70(v22));
  v15 = *(_DWORD **)(v1 + 48);
  v19.field_0 = *(float *)&v14;
  v16 = (double)v14;
  v17 = *(_DWORD **)(v1 + 36);
  *(float *)(v1 + 72) = v22 - v16;
  if ( v15 != v17 )
  {
    if ( v17 )
      sub_4FEF90(v1, v17);
    sub_4FF130(v1);
  }
  v18 = sub_419A70(v22);
  if ( sub_52E450(*(_DWORD *)(v1 + 16), *(_DWORD *)(v1 + 48), v18)
    && !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] >> 1)) )
  {
    sub_501960(230, *(_DWORD *)(v1 + 16), 0, 0);
    sub_501960(229, *(_DWORD *)(v1 + 48), 0, 0);
  }
  *(_DWORD *)(v1 + 36) = *(_DWORD *)(v1 + 48);
  return 0;
}

//----- (0052E450) --------------------------------------------------------
int __cdecl sub_52E450(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // eax
  int *v5; // ebp
  int v6; // esi
  int v7; // eax
  char v8; // al
  double v9; // st7
  float v11; // [esp+0h] [ebp-14h]

  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a1 + 748);
    if ( (unsigned __int16)sub_4EEC80(a1) >= *(_WORD *)(v3 + 8) )
      return 0;
  }
  v4 = *(_DWORD *)(a2 + 8);
  if ( v4 & 0x400000 && *(_BYTE *)(a2 + 12) & 0x18 )
  {
    v5 = *(int **)(a2 + 748);
    if ( sub_419130(a2 + 48) && !sub_419150(a2 + 48, a1 + 48) )
      return 0;
    v6 = a3;
    if ( *v5 <= a3 )
    {
      v6 = *v5;
      a3 = *v5;
      if ( !sub_40A5C0(4096) )
        *v5 = 0;
    }
    else if ( !sub_40A5C0(4096) )
    {
      *v5 -= a3;
    }
    if ( !v6 )
      return 0;
    if ( !sub_40A5C0(4096) )
      sub_4E44F0(a2);
    goto LABEL_23;
  }
  if ( v4 & 2 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(a2 + 748) + 1440) & 0x20 )
    {
      LOWORD(v6) = 1;
      a3 = 1;
LABEL_24:
      if ( !sub_40A5C0(4096) || !(*(_BYTE *)(a1 + 8) & 4) )
        goto LABEL_33;
      v8 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2251);
      if ( v8 )
      {
        if ( v8 == 1 )
        {
          v9 = (double)a3 * *(float *)&byte_587000[312820];
        }
        else
        {
          if ( v8 != 2 )
          {
LABEL_33:
            sub_4EEB80(a1, v6);
            return 1;
          }
          v9 = (double)a3 * *(float *)&byte_587000[312804];
        }
      }
      else
      {
        v9 = (double)a3 * *(float *)&byte_587000[312788];
      }
      v11 = v9;
      LOWORD(v6) = sub_419A70(v11);
      goto LABEL_33;
    }
    goto LABEL_22;
  }
  if ( !(v4 & 4) )
  {
LABEL_22:
    v6 = a3;
    goto LABEL_23;
  }
  v6 = a3;
  v7 = *(unsigned __int16 *)(*(_DWORD *)(a2 + 748) + 4);
  if ( (unsigned __int16)v7 <= a3 )
  {
    v6 = *(unsigned __int16 *)(*(_DWORD *)(a2 + 748) + 4);
    a3 = *(unsigned __int16 *)(*(_DWORD *)(a2 + 748) + 4);
    sub_4EEBF0(a2, v7);
  }
  else
  {
    sub_4EEBF0(a2, a3);
  }
LABEL_23:
  if ( v6 > 0 )
    goto LABEL_24;
  return 0;
}

//----- (0052E610) --------------------------------------------------------
int __cdecl sub_52E610(int *a1, int a2)
{
  float v3; // [esp+0h] [ebp-10h]

  *(_DWORD *)&byte_5D4594[2487828] = 0;
  *(_DWORD *)&byte_5D4594[2487876] = 1287568416;
  *(_DWORD *)&byte_5D4594[2487836] = *a1;
  *(_DWORD *)&byte_5D4594[2487840] = a1[1];
  v3 = sub_419D40(&byte_587000[260424]);
  sub_517F90((float2 *)a1, v3, sub_52E660, a2);
  return *(_DWORD *)&byte_5D4594[2487828];
}

//----- (0052E660) --------------------------------------------------------
void __cdecl sub_52E660(int a1, int a2)
{
  int v2; // eax
  int v3; // ebx
  double v4; // st7
  int v5; // ebx
  double v6; // st6
  double v7; // st5
  double v8; // st5
  float v9; // eax
  float v10; // ecx
  float4 v11; // [esp+Ch] [ebp-10h]
  float v12; // [esp+20h] [ebp+4h]

  if ( a1 == a2 || !sub_52E7C0(a1) || *(_DWORD *)(a1 + 16) & 0x8020 )
    return;
  v2 = *(_DWORD *)(a1 + 8);
  if ( !(v2 & 2) )
  {
    if ( v2 & 0x400000 && *(_BYTE *)(a1 + 12) & 0x18 )
    {
      v4 = 1.0;
    }
    else
    {
      if ( !(v2 & 4) )
        return;
      v5 = *(_DWORD *)(a1 + 748);
      if ( a2 )
      {
        if ( !sub_5330C0(a2, a1) )
          return;
      }
      if ( sub_4EC520(a1, a2) || *(_BYTE *)(*(_DWORD *)(v5 + 276) + 3680) & 1 )
        return;
      v4 = 0.5;
    }
LABEL_18:
    v6 = *(float *)&byte_5D4594[2487836] - *(float *)(a1 + 56);
    v7 = *(float *)&byte_5D4594[2487840] - *(float *)(a1 + 60);
    v8 = v4 * (v7 * v7 + v6 * v6);
    if ( v8 < *(float *)&byte_5D4594[2487876] )
    {
      v9 = *(float *)(a1 + 56);
      v11.field_4 = *(float *)&byte_5D4594[2487840];
      v11.field_0 = *(float *)&byte_5D4594[2487836];
      v10 = *(float *)(a1 + 60);
      v11.field_8 = v9;
      v11.field_C = v10;
      if ( sub_535250(&v11, 0, 0, 5) )
      {
        *(_DWORD *)&byte_5D4594[2487828] = a1;
        v12 = v8;
        *(float *)&byte_5D4594[2487876] = v12;
      }
    }
    return;
  }
  v3 = *(_DWORD *)(a1 + 748);
  if ( (!a2 || sub_5330C0(a2, a1)) && *(_BYTE *)(v3 + 1440) & 0x20 )
  {
    v4 = 1.0;
    goto LABEL_18;
  }
}

//----- (0052E7C0) --------------------------------------------------------
int __cdecl sub_52E7C0(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 & 0x400000 && *(_BYTE *)(a1 + 12) & 0x18 )
  {
    if ( **(_DWORD **)(a1 + 748) > 0 )
      return 1;
  }
  else if ( v1 & 2 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(a1 + 748) + 1440) & 0x20 )
      return 1;
  }
  else if ( v1 & 4 && sub_4EEC80(a1) )
  {
    return 1;
  }
  return 0;
}

//----- (0052E820) --------------------------------------------------------
int __cdecl sub_52E820(int a1)
{
  if ( *(_DWORD *)(a1 + 16) )
    sub_4FEB10(43, *(_DWORD *)(a1 + 16));
  sub_522FF0(130, (float2 *)(a1 + 28));
  return 0;
}

//----- (0052E850) --------------------------------------------------------
int __cdecl sub_52E850(float a1)
{
  int v1; // esi
  int v2; // eax
  int result; // eax
  int v4; // ecx
  int v5; // eax
  void (__cdecl **v6)(_DWORD, _DWORD, _DWORD, int, int); // edi
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // ecx
  int v13; // edi
  int v14; // eax
  int v15; // edx
  float v16; // edi
  int v17; // eax
  _DWORD *v18; // ecx
  double v19; // st7
  _DWORD *v20; // eax
  int v21; // eax
  int v22; // eax
  int v23; // eax
  int v24; // eax
  int v25; // ecx
  int v26; // [esp-4h] [ebp-20h]
  float v27; // [esp+0h] [ebp-1Ch]
  float v28; // [esp+4h] [ebp-18h]
  float2 v29; // [esp+14h] [ebp-8h]
  float v31; // [esp+20h] [ebp+4h]
  float v32; // [esp+20h] [ebp+4h]
  float v33; // [esp+20h] [ebp+4h]
  int v34; // [esp+20h] [ebp+4h]

  v1 = LODWORD(a1);
  v2 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( v2 )
  {
    if ( sub_4FF350(v2, 8) )
      return 1;
  }
  else if ( !*(_DWORD *)(LODWORD(a1) + 20) )
  {
    return 1;
  }
  v31 = sub_419D40(&byte_587000[260440]);
  if ( !*(_DWORD *)(v1 + 20) )
  {
    v9 = *(_DWORD *)(v1 + 16);
    if ( v9 && *(_BYTE *)(v9 + 8) & 2 && sub_4FEA70(v9, (float2 *)(v1 + 28)) )
      return 1;
    if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 60)) > 2 && sub_4E6BD0(*(_DWORD *)(v1 + 16)) )
      return 1;
    v10 = *(_DWORD *)(v1 + 48);
    if ( v10 )
    {
      if ( !(*(_DWORD *)(v10 + 16) & 0x8020)
        && sub_4E6E50(
             (float2 *)(*(_DWORD *)(v1 + 16) + 56),
             *(__int16 *)(*(_DWORD *)(v1 + 16) + 124),
             (float2 *)(v10 + 56)) & 1
        && sub_4E6C00(*(_DWORD *)(v1 + 48), *(_DWORD *)(v1 + 16)) <= v31
        && sub_5370E0(*(_DWORD *)(v1 + 16), *(_DWORD *)(v1 + 48), 0) )
      {
        goto LABEL_31;
      }
      *(_DWORD *)(v1 + 48) = 0;
    }
    v11 = *(_DWORD *)(v1 + 16);
    if ( *(_BYTE *)(v11 + 8) & 4 )
    {
      v12 = *(_DWORD *)(v11 + 748);
      v13 = *(_DWORD *)(v12 + 288);
      if ( v13 )
      {
        if ( sub_5330C0(v11, *(_DWORD *)(v12 + 288)) && sub_4E6C00(*(_DWORD *)(v1 + 16), v13) <= v31 )
          *(_DWORD *)(v1 + 48) = v13;
      }
    }
    if ( *(_DWORD *)(v1 + 48) )
      goto LABEL_32;
    *(_DWORD *)&byte_5D4594[2487832] = 0;
    *(_DWORD *)&byte_5D4594[2487880] = 0;
    v14 = *(_DWORD *)(v1 + 16);
    *(_DWORD *)&byte_5D4594[2487868] = *(_DWORD *)(v14 + 56);
    v15 = *(_DWORD *)(v14 + 60);
    *(float *)&byte_5D4594[2487884] = v31 * v31;
    *(_DWORD *)&byte_5D4594[2487872] = v15;
    sub_517F90((float2 *)(*(_DWORD *)(v1 + 16) + 56), v31, sub_52EC60, *(_DWORD *)(v1 + 16));
    *(_DWORD *)(v1 + 48) = *(_DWORD *)&byte_5D4594[2487880];
LABEL_31:
    if ( !*(_DWORD *)(v1 + 48) )
    {
      if ( *(_DWORD *)(v1 + 36) )
      {
        sub_4FEF90(v1, *(_DWORD **)(v1 + 36));
        *(_DWORD *)(v1 + 36) = 0;
      }
      return 0;
    }
LABEL_32:
    v32 = *(float *)(v1 + 72);
    v33 = sub_419D70(&byte_587000[260480], *(_DWORD *)(v1 + 8) - 1) + v32;
    v16 = v33;
    v17 = sub_419A70(v33);
    v18 = *(_DWORD **)(v1 + 48);
    LODWORD(v29.field_0) = v17;
    v19 = (double)v17;
    v20 = *(_DWORD **)(v1 + 36);
    *(float *)(v1 + 72) = v33 - v19;
    if ( v18 != v20 )
    {
      if ( v20 )
        sub_4FEF90(v1, v20);
      sub_4FF130(v1);
    }
    v34 = *(_DWORD *)(v1 + 48);
    v21 = sub_419A70(v16);
    (*(void (__cdecl **)(_DWORD, _DWORD, _DWORD, int, int))(v34 + 716))(
      *(_DWORD *)(v1 + 48),
      *(_DWORD *)(v1 + 16),
      0,
      v21,
      17);
    v22 = *(_DWORD *)(v1 + 48);
    if ( *(_DWORD *)(v22 + 16) & 0x8020 )
      sub_522FF0(130, (float2 *)(v22 + 56));
    v23 = *(_DWORD *)(v1 + 16);
    *(_DWORD *)(v1 + 36) = *(_DWORD *)(v1 + 48);
    if ( *(_BYTE *)(v23 + 8) & 4 )
      sub_4FA020((_DWORD *)v23, 10);
    if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] / 3u)) )
    {
      sub_501960(32, *(_DWORD *)(v1 + 16), 0, 0);
      sub_501960(32, *(_DWORD *)(v1 + 48), 0, 0);
    }
    v28 = sub_419D40(&byte_587000[260500]);
    *(_DWORD *)(v1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v28);
    v24 = *(_DWORD *)(v1 + 16);
    if ( *(_BYTE *)(v24 + 8) & 4 )
    {
      sub_4FA020((_DWORD *)v24, 10);
      sub_4EEBF0(*(_DWORD *)(v1 + 16), 1);
      if ( !sub_4EEC80(*(_DWORD *)(v1 + 16)) )
        return 1;
    }
    v25 = *(_DWORD *)(*(_DWORD *)(v1 + 48) + 16);
    if ( (v25 & 0x8000) != 0 )
    {
      result = 0;
      *(_DWORD *)(v1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + 1;
      return result;
    }
    return 0;
  }
  v4 = *(_DWORD *)(v1 + 32);
  v29.field_0 = *(float *)(v1 + 28);
  *(_DWORD *)&byte_5D4594[2487868] = v29.field_0;
  *(_DWORD *)&byte_5D4594[2487872] = v4;
  *(_DWORD *)&byte_5D4594[2487880] = 0;
  *(float *)&byte_5D4594[2487884] = v31 * v31;
  *(_DWORD *)&byte_5D4594[2487832] = 1;
  v5 = *(_DWORD *)(v1 + 16);
  v29.field_4 = v4;
  sub_517F90(&v29, v31, sub_52EC60, v5);
  if ( *(_DWORD *)&byte_5D4594[2487880] )
  {
    v6 = (void (__cdecl **)(_DWORD, _DWORD, _DWORD, int, int))(*(_DWORD *)&byte_5D4594[2487880] + 716);
    v27 = sub_419D40(&byte_587000[260456]);
    v7 = sub_419A70(v27);
    (*v6)(*(_DWORD *)&byte_5D4594[2487880], *(_DWORD *)(v1 + 12), 0, v7, 17);
    v26 = *(_DWORD *)&byte_5D4594[2487880];
    v8 = sub_424800(24, 0);
    sub_501960(v8, v26, 0, 0);
    sub_522FF0(130, (float2 *)(*(_DWORD *)&byte_5D4594[2487880] + 56));
  }
  return 1;
}

//----- (0052EC60) --------------------------------------------------------
void __cdecl sub_52EC60(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  double v4; // st7
  double v5; // st6
  double v6; // st5

  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 & 0x20006 )
  {
    if ( !(*(_DWORD *)(a1 + 16) & 0x8020) && a1 != a2 )
    {
      if ( !(v2 & 2) || (v3 = *(_DWORD *)(a1 + 12), (v3 & 0x8000) == 0) )
      {
        if ( !a2
          || sub_5330C0(a2, a1)
          && (*(_DWORD *)&byte_5D4594[2487832]
           || sub_4E6E50((float2 *)(a2 + 56), *(__int16 *)(a2 + 124), (float2 *)(a1 + 56)) & 1 && sub_5370E0(a2, a1, 0)) )
        {
          v4 = *(float *)(a1 + 56) - *(float *)&byte_5D4594[2487868];
          v5 = *(float *)(a1 + 60) - *(float *)&byte_5D4594[2487872];
          v6 = v5 * v5 + v4 * v4;
          if ( v6 < *(float *)&byte_5D4594[2487884] )
          {
            *(float *)&byte_5D4594[2487884] = v6;
            *(_DWORD *)&byte_5D4594[2487880] = a1;
          }
        }
      }
    }
  }
}

//----- (0052ED40) --------------------------------------------------------
int __cdecl sub_52ED40(float *a1)
{
  float *v1; // edi
  int v2; // eax
  int result; // eax
  int v4; // edx
  float *v5; // eax
  int v6; // ecx
  double v7; // st7
  double v8; // st6
  long double v9; // st5
  int v10; // ebx
  float v11; // edx
  int v12; // ebp
  int v13; // eax
  _DWORD *v14; // eax
  _DWORD *v15; // esi
  int v16; // ecx
  float v17; // [esp+4h] [ebp-Ch]
  float2 v18; // [esp+8h] [ebp-8h]
  float v19; // [esp+14h] [ebp+4h]

  v1 = a1;
  v2 = *((_DWORD *)a1 + 12);
  if ( !v2 )
    return 1;
  if ( *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( !*(_DWORD *)&byte_5D4594[2487888] )
  {
    *(_DWORD *)&byte_5D4594[2487888] = sub_4E3AA0((CHAR *)&byte_587000[260520]);
    *(_DWORD *)&byte_5D4594[2487892] = sub_4E3AA0((CHAR *)&byte_587000[260532]);
    *(_DWORD *)&byte_5D4594[2487896] = sub_4E3AA0((CHAR *)&byte_587000[260544]);
  }
  if ( *((_DWORD *)a1 + 15) == *((_DWORD *)a1 + 16) )
  {
    v4 = *(_DWORD *)(*((_DWORD *)a1 + 12) + 56);
    *((_DWORD *)a1 + 18) = v4;
    a1[19] = *(float *)(*((_DWORD *)a1 + 12) + 60);
    *((_DWORD *)a1 + 20) = v4;
    a1[21] = a1[19];
    ++*((_DWORD *)a1 + 16);
    result = 0;
  }
  else
  {
    v5 = (float *)*((_DWORD *)a1 + 12);
    v6 = *((_DWORD *)a1 + 2);
    v7 = v5[14] - a1[18];
    v8 = v5[15] - a1[19];
    v9 = sqrt(v8 * v8 + v7 * v7);
    if ( v6 >= 2 )
      v10 = (v6 >= 4) + 1;
    else
      v10 = 0;
    if ( v9 - v5[44] > 15.0 )
    {
      v11 = a1[19];
      v18.field_0 = a1[18];
      v18.field_4 = v11;
      v12 = 2;
      do
      {
        v13 = sub_415FA0(0, v10);
        v14 = sub_4E3450(*(_DWORD *)&byte_5D4594[4 * v13 + 2487888]);
        v15 = v14;
        if ( v14 )
        {
          sub_4DAA50((int)v14, 0, v18.field_0, v18.field_4);
          sub_501A30(46, &v18, 0, 0);
          sub_511660(v15, 25 * *(_DWORD *)&byte_5D4594[2649704]);
        }
        v19 = v18.field_0 - v1[20];
        v17 = v18.field_4 - v1[21];
        if ( v19 != 0.0 && v17 != 0.0 )
        {
          v18.field_0 = v18.field_0 - v19 * 0.5;
          v18.field_4 = v18.field_4 - v17 * 0.5;
        }
        --v12;
      }
      while ( v12 );
      v1[20] = v1[18];
      v1[21] = v1[19];
      v16 = *((_DWORD *)v1 + 12);
      v1[18] = *(float *)(v16 + 56);
      v1[19] = *(float *)(v16 + 60);
    }
    result = 0;
  }
  return result;
}

//----- (0052EF30) --------------------------------------------------------
int __cdecl sub_52EF30(int a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  float v4; // ebx
  float v5; // ebp
  int v6; // eax
  _DWORD *v7; // eax
  _DWORD *v8; // edi

  if ( *(_DWORD *)(a1 + 20) )
  {
    *(_WORD *)(a1 + 72) = *(_WORD *)(*(_DWORD *)(a1 + 24) + 124);
    v3 = *(_DWORD *)(a1 + 24);
    v4 = *(float *)(v3 + 56);
    v5 = *(float *)(v3 + 60);
  }
  else
  {
    v1 = *(_DWORD *)(a1 + 16);
    if ( *(_BYTE *)(v1 + 8) & 4 )
    {
      v2 = *(_DWORD *)(*(_DWORD *)(v1 + 748) + 104);
      if ( v2 )
      {
        if ( *(_DWORD *)(v2 + 12) & 0x200000 && *(_BYTE *)(*(_DWORD *)(v2 + 736) + 96) & 4 )
          *(_BYTE *)(a1 + 88) |= 2u;
      }
    }
    v6 = *(_DWORD *)(a1 + 16);
    v4 = *(float *)(v6 + 56);
    v5 = *(float *)(v6 + 60);
    *(_WORD *)(a1 + 72) = *(_WORD *)(v6 + 124);
  }
  v7 = sub_4E3810((CHAR *)&byte_587000[260596]);
  v8 = v7;
  if ( v7 )
  {
    sub_4DAA50((int)v7, 0, v4, v5);
    *(_DWORD *)(a1 + 76) = v8;
  }
  return 0;
}

//----- (0052EFD0) --------------------------------------------------------
int __cdecl sub_52EFD0(int a1)
{
  int v1; // esi
  int v2; // eax
  int result; // eax
  float *v4; // edi
  float v5; // edx
  float v6; // ebp
  __int16 v7; // bx
  double v8; // st7
  int v9; // ecx
  int v10; // eax
  int v11; // esi
  float v12; // [esp+4h] [ebp-1Ch]
  float v13; // [esp+8h] [ebp-18h]
  float v14; // [esp+Ch] [ebp-14h]
  float4 v15; // [esp+10h] [ebp-10h]
  float v16; // [esp+24h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 16);
  if ( v2 && sub_4FF350(v2, 8) )
    return 1;
  if ( *(_DWORD *)(a1 + 68) - 7 == *(_DWORD *)&byte_5D4594[2598000] && *(_DWORD *)(a1 + 76) )
  {
    sub_4E5CC0(*(_DWORD *)(a1 + 76));
    *(_DWORD *)(a1 + 76) = 0;
  }
  if ( *(_DWORD *)(a1 + 68) - 1 == *(_DWORD *)&byte_5D4594[2598000] )
  {
    v4 = (float *)sub_4E3810((CHAR *)&byte_587000[260616]);
    if ( v4 )
    {
      if ( *(_DWORD *)(a1 + 20) )
      {
        v5 = *(float *)(a1 + 28);
        v6 = *(float *)(a1 + 32);
        v7 = *(_WORD *)(a1 + 72);
        v13 = *(float *)(a1 + 28);
        v8 = 0.0;
        v14 = *(float *)(a1 + 32);
      }
      else
      {
        v9 = *(_DWORD *)(a1 + 16);
        v5 = *(float *)(v9 + 56);
        v6 = *(float *)(v9 + 60);
        v7 = *(_WORD *)(v9 + 124);
        v13 = *(float *)(v9 + 56);
        v14 = *(float *)(v9 + 60);
        switch ( *(_DWORD *)(v9 + 172) )
        {
          case 1:
            v8 = 4.0;
            break;
          case 2:
            v8 = *(float *)(v9 + 176) + 4.0;
            break;
          case 3:
            if ( *(float *)(v9 + 184) <= (double)*(float *)(v9 + 188) )
              v8 = *(float *)(v9 + 188) + 4.0;
            else
              v8 = *(float *)(v9 + 184) + 4.0;
            break;
          default:
            v8 = 24.0;
            break;
        }
      }
      v10 = 8 * v7;
      v15.field_4 = v6;
      v16 = *(float *)&byte_587000[v10 + 194136];
      v12 = *(float *)&byte_587000[v10 + 194140];
      v15.field_0 = v5;
      v15.field_8 = v16 * v8 + v13;
      v15.field_C = v12 * v8 + v14;
      if ( !sub_535250(&v15, 0, 0, 5) )
      {
        v15.field_8 = v15.field_0;
        v15.field_C = v15.field_4;
      }
      sub_4DAA50((int)v4, *(_DWORD *)(v1 + 16), v15.field_8, v15.field_C);
      if ( *(_DWORD *)(v1 + 20) == 1 )
      {
        v4[20] = 0.0;
        v4[21] = 0.0;
      }
      else
      {
        v4[20] = v16 * v4[136];
        v4[21] = v12 * v4[136];
      }
      *((_WORD *)v4 + 62) = v7;
      *((_WORD *)v4 + 63) = v7;
      sub_501960(38, *(_DWORD *)(v1 + 16), 0, 0);
    }
    result = 1;
  }
  else
  {
    if ( !*(_DWORD *)(a1 + 20) )
    {
      v11 = *(_DWORD *)(a1 + 16);
      if ( v11 )
      {
        if ( *(_BYTE *)(v11 + 8) & 4 )
          sub_4FA020((_DWORD *)v11, 10);
      }
    }
    result = 0;
  }
  return result;
}

//----- (0052F1D0) --------------------------------------------------------
int __cdecl sub_52F1D0(int a1)
{
  int result; // eax

  if ( *(_DWORD *)(a1 + 76) )
    sub_4E5CC0(*(_DWORD *)(a1 + 76));
  result = *(_DWORD *)(a1 + 16);
  if ( result )
  {
    if ( *(_BYTE *)(result + 8) & 4 )
    {
      result = *(_DWORD *)(*(_DWORD *)(result + 748) + 104);
      if ( result )
      {
        if ( *(_DWORD *)(result + 12) & 0x200000 )
        {
          result = *(_DWORD *)(result + 736);
          *(_DWORD *)(result + 96) &= 0xFFFFFFFB;
        }
      }
    }
  }
  return result;
}

//----- (0052F220) --------------------------------------------------------
BOOL __cdecl sub_52F220(int *a1)
{
  int v1; // ecx
  BOOL result; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // [esp-4h] [ebp-8h]

  v1 = a1[5];
  if ( !a1[4] )
  {
    if ( !v1 )
      return 1;
    goto LABEL_5;
  }
  if ( v1 )
  {
LABEL_5:
    v3 = sub_424A70(a1[1]);
    v4 = sub_540610((float2 *)(a1 + 13), 0, v3, 400.0, 1, 0);
    if ( v4 )
      sub_4EE460(v4, 20);
    return 1;
  }
  v7 = a1[4];
  v5 = sub_424A70(a1[1]);
  v6 = sub_540610((float2 *)(a1 + 13), a1[4], v5, 400.0, 1, v7);
  a1[12] = v6;
  if ( v6 )
  {
    result = sub_5330C0(a1[4], v6);
    if ( !result )
    {
      sub_4FF130((int)a1);
      result = 0;
    }
  }
  else
  {
    sub_4DA2C0(a1[4], (const char *)&byte_587000[260628], 0);
    result = 1;
  }
  return result;
}

//----- (0052F2E0) --------------------------------------------------------
int __cdecl sub_52F2E0(float a1)
{
  float v1; // esi
  int v2; // eax
  int v4; // eax
  int v5; // eax
  __int16 v6; // di
  int v7; // eax
  char v8; // al
  double v9; // st7
  int v10; // eax
  float v11; // [esp+10h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(LODWORD(a1) + 48);
  if ( !v2 )
    return 1;
  if ( *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  v4 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( v4 && sub_4FF350(v4, 8) )
    return 1;
  if ( !sub_5370E0(*(_DWORD *)(LODWORD(a1) + 16), *(_DWORD *)(LODWORD(a1) + 48), 0) )
    return 1;
  if ( !sub_4EEC80(*(_DWORD *)(LODWORD(a1) + 16)) )
    return 1;
  v5 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( *(_BYTE *)(v5 + 8) & 2 && sub_4FEA70(v5, (float2 *)(LODWORD(a1) + 28)) )
    return 1;
  if ( sub_4E6BD0(*(_DWORD *)(LODWORD(a1) + 16)) )
    return 1;
  v6 = sub_4EE7A0(*(_DWORD *)(LODWORD(a1) + 48));
  if ( v6 == sub_4EE780(*(_DWORD *)(LODWORD(a1) + 48)) )
    return 1;
  v7 = *(_DWORD *)(LODWORD(a1) + 16);
  v11 = *(float *)(LODWORD(a1) + 72) + *(float *)&byte_587000[4 * *(_DWORD *)(LODWORD(a1) + 8) + 260360];
  if ( v7 && *(_BYTE *)(v7 + 8) & 4 )
  {
    v8 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v7 + 748) + 276) + 2251);
    switch ( v8 )
    {
      case 0:
        v9 = *(float *)&byte_587000[312784];
LABEL_27:
        v11 = v9 * v11;
        break;
      case 2:
        v9 = *(float *)&byte_587000[312800];
        goto LABEL_27;
      case 1:
        v9 = *(float *)&byte_587000[312816];
        goto LABEL_27;
    }
  }
  *(float *)(LODWORD(v1) + 72) = v11 - (double)sub_419A70(v11);
  v10 = sub_419A70(v11);
  sub_4EE460(*(_DWORD *)(LODWORD(v1) + 48), v10);
  sub_4EEBF0(*(_DWORD *)(LODWORD(v1) + 16), 1);
  return 0;
}

//----- (0052F460) --------------------------------------------------------
int __cdecl sub_52F460(float a1)
{
  float v1; // esi
  int v2; // eax
  int result; // eax
  int v4; // eax
  int v5; // eax
  __int16 v6; // di
  __int16 v7; // ax
  float v8; // [esp+10h] [ebp+4h]
  float v9; // [esp+10h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(LODWORD(a1) + 48);
  if ( !v2 )
    return 1;
  if ( *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( *(_DWORD *)(LODWORD(a1) + 20) )
  {
    sub_4EEB80(v2, 20);
    sub_4EE5E0(*(_DWORD *)(LODWORD(a1) + 48), 20);
    result = 1;
  }
  else
  {
    v4 = *(_DWORD *)(LODWORD(a1) + 16);
    if ( v4 && sub_4FF350(v4, 8) )
    {
      result = 1;
    }
    else
    {
      v5 = *(_DWORD *)(LODWORD(a1) + 48);
      if ( *(_BYTE *)(v5 + 8) & 2 && sub_4FEA70(v5, (float2 *)(LODWORD(a1) + 28)) )
      {
        result = 1;
      }
      else
      {
        v6 = sub_4EECB0(*(_DWORD *)(LODWORD(a1) + 48));
        if ( v6 == sub_4EEC80(*(_DWORD *)(LODWORD(a1) + 48)) )
        {
          result = 1;
        }
        else if ( (unsigned __int16)sub_4EE780(*(_DWORD *)(LODWORD(a1) + 16)) > 1u )
        {
          if ( sub_4EE780(*(_DWORD *)(LODWORD(a1) + 16)) )
          {
            v8 = *(float *)(LODWORD(a1) + 72);
            v9 = sub_419D70(&byte_587000[260660], *(_DWORD *)(LODWORD(v1) + 8) - 1) + v8;
            *(float *)(LODWORD(v1) + 72) = v9 - (double)sub_419A70(v9);
            v7 = sub_419A70(v9);
            sub_4EEB80(*(_DWORD *)(LODWORD(v1) + 48), v7);
            sub_4EE5E0(*(_DWORD *)(LODWORD(v1) + 16), 1);
          }
          result = 0;
        }
        else
        {
          result = 1;
        }
      }
    }
  }
  return result;
}

//----- (0052F5A0) --------------------------------------------------------
int __cdecl sub_52F5A0(_DWORD *a1)
{
  int v1; // eax
  int v3; // edi
  int v4; // [esp-14h] [ebp-20h]
  float v5; // [esp+0h] [ebp-Ch]
  float v6; // [esp+0h] [ebp-Ch]

  v1 = a1[12];
  if ( !v1 )
    return 1;
  if ( *(_DWORD *)(v1 + 16) & 0x8020 )
    return 1;
  if ( *(_DWORD *)(v1 + 8) & 2 && *(_BYTE *)(v1 + 12) & 4 )
    return 1;
  if ( !(*(_DWORD *)(v1 + 8) & 4) && !(*(_DWORD *)(v1 + 8) & 2) )
    return 1;
  v5 = sub_419D70(&byte_587000[260680], a1[2] - 1);
  v3 = sub_419A70(v5);
  sub_4FF380(a1[12], 26, v3, a1[2]);
  v4 = a1[2] - 1;
  a1[17] = v3 + *(_DWORD *)&byte_5D4594[2598000];
  v6 = sub_419D70(&byte_587000[260696], v4);
  a1[18] = sub_419A70(v6);
  return 0;
}

//----- (0052F650) --------------------------------------------------------
BOOL __cdecl sub_52F650(int a1)
{
  int v1; // eax
  BOOL result; // eax

  v1 = *(_DWORD *)(a1 + 48);
  if ( v1 )
    result = (*(_DWORD *)(v1 + 16) & 0x8020) != 0;
  else
    result = 1;
  return result;
}

//----- (0052F670) --------------------------------------------------------
int __cdecl sub_52F670(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 48);
  if ( result )
    result = sub_4FF5B0(result, 26);
  return result;
}

//----- (0052F690) --------------------------------------------------------
char __cdecl sub_52F690(int a1, int a2)
{
  _DWORD *v2; // eax
  int v3; // ecx

  v2 = (_DWORD *)sub_4FE930();
  if ( v2 )
  {
    while ( v2[12] != a1 || v2[1] != 51 )
    {
      v2 = (_DWORD *)sub_4FE940((int)v2);
      if ( !v2 )
        goto LABEL_5;
    }
    v3 = v2[12];
    if ( v3 )
    {
      if ( *(_DWORD *)(v3 + 16) & 0x8020 )
      {
        LOBYTE(v2) = sub_4FE9D0((int)v2);
      }
      else if ( (int)v2[18] - a2 > 0 )
      {
        v2[18] -= a2;
      }
      else
      {
        LOBYTE(v2) = sub_4FE9D0((int)v2);
      }
    }
    else
    {
      LOBYTE(v2) = sub_4FE9D0((int)v2);
    }
  }
  else
  {
LABEL_5:
    LOBYTE(v2) = sub_4FF5B0(a1, 26);
  }
  return (char)v2;
}

//----- (0052F710) --------------------------------------------------------
void __cdecl sub_52F710(int a1, int *a2, int a3, int a4)
{
  int v4; // edi
  int v5; // eax

  if ( a1 && a2 )
  {
    sub_501960(131, a1, 0, 0);
    if ( a4 )
      sub_523670(a1, (float *)(a4 + 56));
    else
      sub_523670(a1, 0);
    v4 = *a2;
    if ( (unsigned __int16)sub_4EE780(a1) > v4 )
    {
      *a2 = v4 / 2;
      if ( !(v4 / 2) )
        *a2 = 1;
      sub_52F690(a1, *a2);
    }
    else
    {
      if ( *(_BYTE *)(a1 + 8) & 4
        && (v5 = *(_DWORD *)(a1 + 748), !*(_BYTE *)(*(_DWORD *)(v5 + 276) + 2251))
        && *(_BYTE *)(v5 + 88) == 16
        && a4
        && sub_4E6E50((float2 *)(a1 + 56), *(__int16 *)(a1 + 124), (float2 *)(a4 + 72)) & 1 )
      {
        *a2 = 1;
      }
      else
      {
        sub_4E4560(a1, 2u);
        *a2 = 0;
      }
      sub_52F690(a1, 999999);
      *(_DWORD *)(a1 + 520) = a4;
      *(_DWORD *)(a1 + 524) = a3;
      *(_DWORD *)(a1 + 536) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
}

//----- (0052F820) --------------------------------------------------------
int __cdecl sub_52F820(int a1)
{
  int v1; // eax
  int v2; // eax

  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  if ( *(_DWORD *)(a1 + 16) )
    sub_4FEB10(24, *(_DWORD *)(a1 + 16));
  if ( !*(_DWORD *)(a1 + 20) )
  {
    v1 = *(_DWORD *)(a1 + 16);
    if ( *(_BYTE *)(v1 + 8) & 4 )
    {
      v2 = *(_DWORD *)(*(_DWORD *)(v1 + 748) + 104);
      if ( v2 )
      {
        if ( *(_DWORD *)(v2 + 12) & 0x40000 && *(_BYTE *)(*(_DWORD *)(v2 + 736) + 96) & 4 )
          *(_DWORD *)(a1 + 72) = v2;
      }
    }
  }
  if ( *(_DWORD *)(a1 + 72) )
    *(_BYTE *)(a1 + 88) |= 2u;
  sub_522FF0(129, (float2 *)(a1 + 28));
  return 0;
}

//----- (0052F8A0) --------------------------------------------------------
int __cdecl sub_52F8A0(float a1)
{
  int v1; // esi
  int v2; // eax
  int v4; // eax
  int v5; // eax
  int v6; // edi
  int v7; // ecx
  int v8; // edx
  int v9; // ebx
  int v10; // eax
  int v11; // ecx
  int v12; // edi
  int v13; // eax
  int v14; // ecx
  int v15; // ecx
  int v16; // ecx
  int v17; // ecx
  int v18; // ecx
  int v19; // eax
  int v20; // ebx
  _DWORD *v21; // edi
  _DWORD *j; // ebp
  int v23; // eax
  int v24; // eax
  int v25; // ecx
  int v26; // eax
  int v27; // edi
  char v28; // al
  unsigned __int8 v29; // al
  int v30; // eax
  int v31; // ebp
  int i; // edi
  int v33; // eax
  int v34; // edi
  float v35; // [esp+0h] [ebp-20h]
  float v36; // [esp+0h] [ebp-20h]
  float v37; // [esp+0h] [ebp-20h]
  float v38; // [esp+0h] [ebp-20h]
  float v39; // [esp+8h] [ebp-18h]
  float v40; // [esp+1Ch] [ebp-4h]
  float v41; // [esp+24h] [ebp+4h]
  float v42; // [esp+24h] [ebp+4h]

  v1 = LODWORD(a1);
  v2 = *(_DWORD *)(LODWORD(a1) + 16);
  if ( v2 )
  {
    if ( sub_4FF350(v2, 8) )
      return 1;
  }
  else if ( !*(_DWORD *)(LODWORD(a1) + 20) )
  {
    return 1;
  }
  v41 = sub_419D40(&byte_587000[260712]);
  if ( *(_DWORD *)(v1 + 20) )
  {
    *(_DWORD *)&byte_5D4594[2487820] = *(_DWORD *)(v1 + 28);
    *(_DWORD *)&byte_5D4594[2487824] = *(_DWORD *)(v1 + 32);
    sub_517F90((float2 *)(v1 + 28), v41, sub_530020, *(_DWORD *)(v1 + 16));
    return 1;
  }
  if ( *(_BYTE *)(*(_DWORD *)(v1 + 16) + 8) & 4 && !sub_4EEC80(*(_DWORD *)(v1 + 16)) )
    return 1;
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 60)) > 2 && sub_4E6BD0(*(_DWORD *)(v1 + 16)) )
    return 1;
  v4 = *(_DWORD *)(v1 + 16);
  if ( *(_BYTE *)(v4 + 8) & 2 && sub_4FEA70(v4, (float2 *)(v1 + 28)) )
    return 1;
  v5 = *(_DWORD *)(v1 + 104);
  if ( v5 )
  {
    do
    {
      v6 = *(_DWORD *)(v5 + 116);
      sub_4FE980(v5);
      v5 = v6;
    }
    while ( v6 );
  }
  v7 = *(_DWORD *)(v1 + 8);
  *(_DWORD *)(v1 + 104) = *(_DWORD *)(v1 + 108);
  *(_DWORD *)(v1 + 108) = 0;
  *(_DWORD *)&byte_5D4594[2487908] = 0;
  *(_DWORD *)&byte_5D4594[2487904] = 0;
  v8 = *(_DWORD *)(v1 + 16);
  *(_DWORD *)&byte_5D4594[2487844] = 0;
  v9 = *(_DWORD *)&byte_587000[4 * v7 + 260380];
  *(_DWORD *)&byte_5D4594[2487848] = 0;
  *(_DWORD *)&byte_5D4594[2487900] = v8;
  *(_DWORD *)&byte_5D4594[2487852] = 0;
  *(_DWORD *)&byte_5D4594[2487856] = 0;
  *(_DWORD *)&byte_5D4594[2487860] = 0;
  v10 = *(_DWORD *)(v1 + 16);
  if ( !(*(_BYTE *)(v10 + 8) & 4)
    || (v11 = *(_DWORD *)(v10 + 748), (v12 = *(_DWORD *)(v11 + 288)) == 0)
    || (!sub_5330C0(v10, *(_DWORD *)(v11 + 288)) || sub_4E6C00(*(_DWORD *)(v1 + 16), v12) > v41 ? (v13 = *(_DWORD *)&byte_5D4594[2487908]) : (v13 = v12, *(_DWORD *)&byte_5D4594[2487908] = v12),
        !v13) )
  {
    *(float *)&byte_5D4594[2487912] = v41 * v41;
    sub_517F90((float2 *)(v1 + 28), v41, sub_52FF10, *(_DWORD *)(v1 + 16));
    v13 = *(_DWORD *)&byte_5D4594[2487908];
    if ( !*(_DWORD *)&byte_5D4594[2487908] )
    {
      for ( i = *(_DWORD *)(v1 + 104); i; i = *(_DWORD *)(i + 116) )
      {
        if ( *(_DWORD *)(i + 48) )
          sub_4FEF90(i, *(_DWORD **)(i + 48));
      }
      v33 = *(_DWORD *)(v1 + 104);
      if ( v33 )
      {
        do
        {
          v34 = *(_DWORD *)(v33 + 116);
          sub_4FE980(v33);
          v33 = v34;
        }
        while ( v34 );
      }
      *(_DWORD *)(v1 + 104) = 0;
      return 0;
    }
  }
  v14 = *(_DWORD *)&byte_5D4594[2487904];
  *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487904] + 2487844] = v13;
  *(_DWORD *)&byte_5D4594[2487904] = v14 + 1;
  if ( v9 > 1 )
  {
    *(_DWORD *)&byte_5D4594[2487908] = 0;
    *(float *)&byte_5D4594[2487912] = v41 * v41;
    v35 = v41 * 0.94999999;
    sub_517F90((float2 *)(*(_DWORD *)&byte_5D4594[2487844] + 56), v35, sub_52FF10, *(int *)&byte_5D4594[2487844]);
    if ( *(_DWORD *)&byte_5D4594[2487908] )
    {
      v15 = *(_DWORD *)&byte_5D4594[2487904];
      *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487904] + 2487844] = *(_DWORD *)&byte_5D4594[2487908];
      *(_DWORD *)&byte_5D4594[2487904] = v15 + 1;
    }
  }
  if ( v9 > 2 )
  {
    *(_DWORD *)&byte_5D4594[2487908] = 0;
    *(float *)&byte_5D4594[2487912] = v41 * v41;
    v36 = v41 * 0.89999998;
    sub_517F90((float2 *)(*(_DWORD *)&byte_5D4594[2487844] + 56), v36, sub_52FF10, *(int *)&byte_5D4594[2487844]);
    if ( *(_DWORD *)&byte_5D4594[2487908] )
    {
      v16 = *(_DWORD *)&byte_5D4594[2487904];
      *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487904] + 2487844] = *(_DWORD *)&byte_5D4594[2487908];
      *(_DWORD *)&byte_5D4594[2487904] = v16 + 1;
    }
  }
  if ( *(_DWORD *)&byte_5D4594[2487848] )
  {
    if ( v9 > 3 )
    {
      *(_DWORD *)&byte_5D4594[2487908] = 0;
      *(float *)&byte_5D4594[2487912] = v41 * v41;
      v37 = v41 * 0.85000002;
      sub_517F90((float2 *)(*(_DWORD *)&byte_5D4594[2487848] + 56), v37, sub_52FF10, *(int *)&byte_5D4594[2487848]);
      if ( *(_DWORD *)&byte_5D4594[2487908] )
      {
        v17 = *(_DWORD *)&byte_5D4594[2487904];
        *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487904] + 2487844] = *(_DWORD *)&byte_5D4594[2487908];
        *(_DWORD *)&byte_5D4594[2487904] = v17 + 1;
      }
    }
  }
  if ( *(_DWORD *)&byte_5D4594[2487852] )
  {
    if ( v9 > 4 )
    {
      *(_DWORD *)&byte_5D4594[2487908] = 0;
      v40 = v41 * v41;
      *(float *)&byte_5D4594[2487912] = v40 * v40;
      v38 = v41 * 0.80000001;
      sub_517F90((float2 *)(*(_DWORD *)&byte_5D4594[2487852] + 56), v38, sub_52FF10, *(int *)&byte_5D4594[2487852]);
      if ( *(_DWORD *)&byte_5D4594[2487908] )
      {
        v18 = *(_DWORD *)&byte_5D4594[2487904];
        *(_DWORD *)&byte_5D4594[4 * *(_DWORD *)&byte_5D4594[2487904] + 2487844] = *(_DWORD *)&byte_5D4594[2487908];
        *(_DWORD *)&byte_5D4594[2487904] = v18 + 1;
      }
    }
  }
  sub_52FFD0(v1, *(_DWORD *)(v1 + 16), *(int *)&byte_5D4594[2487844]);
  if ( v9 > 1 && *(_DWORD *)&byte_5D4594[2487848] )
    sub_52FFD0(v1, *(int *)&byte_5D4594[2487844], *(int *)&byte_5D4594[2487848]);
  v19 = *(_DWORD *)&byte_5D4594[2487852];
  if ( v9 > 2 && *(_DWORD *)&byte_5D4594[2487852] )
  {
    sub_52FFD0(v1, *(int *)&byte_5D4594[2487844], *(int *)&byte_5D4594[2487852]);
    v19 = *(_DWORD *)&byte_5D4594[2487852];
  }
  if ( v9 > 3 && *(_DWORD *)&byte_5D4594[2487856] )
  {
    if ( *(_DWORD *)&byte_5D4594[2487848] )
    {
      sub_52FFD0(v1, *(int *)&byte_5D4594[2487848], *(int *)&byte_5D4594[2487856]);
LABEL_54:
      v19 = *(_DWORD *)&byte_5D4594[2487852];
      goto LABEL_55;
    }
    if ( v19 )
    {
      sub_52FFD0(v1, v19, *(int *)&byte_5D4594[2487856]);
      goto LABEL_54;
    }
  }
LABEL_55:
  if ( v9 > 4 )
  {
    if ( *(_DWORD *)&byte_5D4594[2487860] )
    {
      if ( v19 || (v19 = *(_DWORD *)&byte_5D4594[2487848]) != 0 )
        sub_52FFD0(v1, v19, *(int *)&byte_5D4594[2487860]);
    }
  }
  if ( !*(_DWORD *)&byte_5D4594[2487844] )
    return 0;
  v42 = sub_419D40(&byte_587000[260728]) + *(float *)(v1 + 76);
  v20 = sub_419A70(v42);
  *(float *)(v1 + 76) = v42 - (double)v20;
  v21 = *(_DWORD **)(v1 + 108);
  for ( j = *(_DWORD **)(v1 + 104); v21; v21 = (_DWORD *)v21[29] )
  {
    if ( j )
    {
      v23 = j[12];
      if ( v21[12] != v23 || v21[4] != j[4] )
      {
        if ( v23 )
          sub_4FEF90((int)j, (_DWORD *)j[12]);
        sub_4FF130((int)v21);
      }
      j = (_DWORD *)j[29];
    }
    else
    {
      sub_4FF130((int)v21);
    }
    if ( v20 > 0 )
      (*(void (__cdecl **)(_DWORD, _DWORD, _DWORD, int, int))(v21[12] + 716))(v21[12], *(_DWORD *)(v1 + 16), 0, v20, 17);
    v24 = v21[12];
    if ( *(_DWORD *)(v24 + 16) & 0x8020 )
      sub_522FF0(129, (float2 *)(v24 + 56));
  }
  for ( ; j; j = (_DWORD *)j[29] )
  {
    if ( j[12] )
      sub_4FEF90((int)j, (_DWORD *)j[12]);
  }
  v25 = *(_DWORD *)(v1 + 16);
  if ( *(_BYTE *)(v25 + 8) & 4 )
  {
    v26 = *(_DWORD *)(v1 + 72);
    if ( v26 )
    {
      v27 = *(_DWORD *)(v26 + 736);
      v28 = *(_BYTE *)(v27 + 108);
      if ( !v28 )
        return 1;
      v29 = v28 - 1;
      *(_BYTE *)(v27 + 108) = v29;
      *(_DWORD *)(v27 + 112) = 100 * v29 / *(unsigned __int8 *)(v27 + 109);
      v30 = *(_DWORD *)(v1 + 16);
      if ( v30 && *(_BYTE *)(v30 + 8) & 4 )
      {
        v31 = *(_DWORD *)(v30 + 748);
        sub_4FA020((_DWORD *)v30, 22);
        sub_4D82B0(
          *(unsigned __int8 *)(*(_DWORD *)(v31 + 276) + 2064),
          *(_DWORD **)(v1 + 72),
          *(_BYTE *)(v27 + 108),
          *(_BYTE *)(v27 + 109));
      }
      if ( !*(_BYTE *)(v27 + 108) )
        return 1;
    }
    else
    {
      sub_4FA020((_DWORD *)v25, 10);
      sub_4EEBF0(*(_DWORD *)(v1 + 16), 1);
      if ( !sub_4EEC80(*(_DWORD *)(v1 + 16)) )
        return 1;
    }
  }
  if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] / 3u)) )
  {
    sub_501960(78, *(_DWORD *)(v1 + 16), 0, 0);
    sub_501960(78, *(int *)&byte_5D4594[2487844], 0, 0);
  }
  v39 = sub_419D40(&byte_587000[260744]);
  *(_DWORD *)(v1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v39);
  return 0;
}

//----- (0052FF10) --------------------------------------------------------
void __cdecl sub_52FF10(int a1, int a2)
{
  int v2; // eax
  int v3; // ecx
  int v4; // eax
  unsigned __int8 *v5; // ecx
  double v6; // st7
  double v7; // st6
  double v8; // st5

  if ( *(_DWORD *)(a1 + 8) & 0x20006 )
  {
    v2 = *(_DWORD *)&byte_5D4594[2487900];
    if ( *(_DWORD *)&byte_5D4594[2487900] )
    {
      if ( !sub_5330C0(*(int *)&byte_5D4594[2487900], a1) )
        return;
      v2 = *(_DWORD *)&byte_5D4594[2487900];
    }
    if ( !(*(_BYTE *)(a1 + 8) & 2) || (v3 = *(_DWORD *)(a1 + 12), (v3 & 0x8000) == 0) )
    {
      if ( !(*(_DWORD *)(a1 + 16) & 0x8020) && a1 != a2 && a1 != v2 )
      {
        v4 = 0;
        if ( *(int *)&byte_5D4594[2487904] <= 0 )
        {
LABEL_14:
          if ( sub_5370E0(a2, a1, 0) )
          {
            v6 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
            v7 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
            v8 = v7 * v7 + v6 * v6;
            if ( v8 < *(float *)&byte_5D4594[2487912] )
            {
              *(float *)&byte_5D4594[2487912] = v8;
              *(_DWORD *)&byte_5D4594[2487908] = a1;
            }
          }
        }
        else
        {
          v5 = &byte_5D4594[2487844];
          while ( *(_DWORD *)v5 != a1 )
          {
            ++v4;
            v5 += 4;
            if ( v4 >= *(int *)&byte_5D4594[2487904] )
              goto LABEL_14;
          }
        }
      }
    }
  }
}

//----- (0052FFD0) --------------------------------------------------------
_DWORD *__cdecl sub_52FFD0(int a1, int a2, int a3)
{
  _DWORD *result; // eax
  int v4; // ecx
  int v5; // ecx

  result = sub_4FE950();
  if ( result )
  {
    result[12] = a3;
    result[4] = a2;
    result[1] = 7;
    result[27] = 0;
    result[26] = 0;
    v4 = *(_DWORD *)(a1 + 108);
    result[28] = 0;
    result[29] = v4;
    v5 = *(_DWORD *)(a1 + 108);
    if ( v5 )
      *(_DWORD *)(v5 + 112) = result;
    *(_DWORD *)(a1 + 108) = result;
  }
  return result;
}

//----- (00530020) --------------------------------------------------------
void __cdecl sub_530020(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  float v4; // edx
  float v5; // eax
  int v6; // eax
  int v7; // eax
  float v8; // [esp+0h] [ebp-20h]
  float4 v9; // [esp+10h] [ebp-10h]

  if ( a1 != a2 )
  {
    v2 = *(_DWORD *)(a1 + 8);
    if ( v2 & 6 )
    {
      if ( !(*(_DWORD *)(a1 + 16) & 0x8020) )
      {
        if ( !(v2 & 2) || (v3 = *(_DWORD *)(a1 + 12), (v3 & 0x8000) == 0) )
        {
          if ( !a2 || sub_5330C0(a2, a1) )
          {
            v4 = *(float *)(a1 + 56);
            v9.field_4 = *(float *)&byte_5D4594[2487824];
            v9.field_0 = *(float *)&byte_5D4594[2487820];
            v5 = *(float *)(a1 + 60);
            v9.field_8 = v4;
            v9.field_C = v5;
            if ( sub_535250(&v9, 0, 0, 9) )
            {
              v8 = sub_419D40(&byte_587000[260764]);
              v6 = sub_419A70(v8);
              (*(void (__cdecl **)(int, _DWORD, _DWORD, int, int))(a1 + 716))(a1, 0, 0, v6, 17);
              sub_522FF0(129, (float2 *)(a1 + 56));
              v7 = sub_424800(43, 0);
              sub_501960(v7, a1, 0, 0);
            }
          }
        }
      }
    }
  }
}

//----- (00530100) --------------------------------------------------------
char __cdecl sub_530100(_DWORD *a1)
{
  int v1; // eax
  int v2; // esi
  int v3; // eax
  int v4; // esi
  int v5; // edi
  int v6; // edi

  v1 = a1[27];
  if ( v1 )
  {
    do
    {
      v2 = *(_DWORD *)(v1 + 116);
      sub_4FE980(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  v3 = a1[26];
  a1[27] = 0;
  if ( v3 )
  {
    do
    {
      v4 = *(_DWORD *)(v3 + 116);
      sub_4FE980(v3);
      v3 = v4;
    }
    while ( v4 );
  }
  a1[26] = 0;
  v5 = a1[18];
  if ( v5 )
  {
    v6 = *(_DWORD *)(v5 + 736);
    v3 = *(_DWORD *)(v6 + 96);
    LOBYTE(v3) = v3 & 0xFB;
    *(_DWORD *)(v6 + 96) = v3;
  }
  return v3;
}

//----- (00530160) --------------------------------------------------------
int __cdecl sub_530160(_DWORD *a1)
{
  int v1; // eax
  int v2; // edi
  int v3; // eax
  _DWORD *v4; // eax
  __int16 v5; // ax
  int v6; // ecx
  __int16 v7; // dx
  float v9; // [esp+0h] [ebp-14h]
  char v10[7]; // [esp+Ch] [ebp-8h]

  v1 = a1[4];
  v2 = *(_DWORD *)(v1 + 748);
  if ( !v1 )
    return 1;
  if ( *(_DWORD *)(v1 + 16) & 0x8020 )
    return 1;
  if ( !(*(_BYTE *)(v1 + 8) & 4) )
    return 1;
  v3 = a1[12];
  if ( !v3 || *(_DWORD *)(v3 + 16) & 0x8020 )
    return 1;
  v9 = sub_419D40(&byte_587000[260788]);
  a1[17] = *(_DWORD *)&byte_5D4594[2598000] + a1[2] * sub_419A70(v9);
  sub_417190(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), a1[12], 1);
  v4 = (_DWORD *)a1[12];
  v10[0] = -46;
  v5 = sub_578AC0(v4);
  v6 = a1[12];
  *(_WORD *)&v10[1] = v5;
  v7 = *(_WORD *)(v6 + 4);
  v10[5] = 1;
  *(_WORD *)&v10[3] = v7;
  v10[6] = 1;
  sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), v10, 7, 0, 1);
  return 0;
}

//----- (00530250) --------------------------------------------------------
unsigned int __cdecl sub_530250(int a1)
{
  int v1; // eax
  unsigned int result; // eax

  v1 = *(_DWORD *)(a1 + 48);
  if ( v1 )
    result = ((*(_DWORD *)(v1 + 16) & 0xFFu) >> 5) & 1;
  else
    result = 1;
  return result;
}

//----- (00530270) --------------------------------------------------------
int __cdecl sub_530270(int a1)
{
  int result; // eax
  int v2; // edi
  _DWORD *v3; // edx
  __int16 v4; // cx
  char v5[7]; // [esp+8h] [ebp-8h]

  result = *(_DWORD *)(a1 + 16);
  if ( result )
  {
    if ( *(_BYTE *)(result + 8) & 4 )
    {
      v2 = *(_DWORD *)(result + 748);
      result = *(_DWORD *)(a1 + 48);
      if ( result )
      {
        if ( !(*(_BYTE *)(result + 8) & 4) )
          sub_417300(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), result, 1);
        v3 = *(_DWORD **)(a1 + 48);
        v5[0] = -46;
        *(_WORD *)&v5[1] = sub_578AC0(v3);
        v4 = *(_WORD *)(*(_DWORD *)(a1 + 48) + 4);
        v5[5] = 2;
        *(_WORD *)&v5[3] = v4;
        v5[6] = 1;
        result = sub_4E5420(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), v5, 7, 0, 1);
      }
    }
  }
  return result;
}

//----- (00530310) --------------------------------------------------------
int __cdecl sub_530310(_DWORD *a1)
{
  int result; // eax
  float v2; // [esp+0h] [ebp-8h]

  if ( !sub_40A5C0(4096) || (result = 1, a1[5] != 1) )
  {
    if ( sub_40A5C0(2048) )
    {
      v2 = sub_419D70(&byte_587000[260808], a1[2] - 1);
      a1[17] = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v2);
      result = 0;
    }
    else
    {
      result = 0;
      a1[17] = *(_DWORD *)&byte_5D4594[2598000] + 1;
    }
  }
  return result;
}

//----- (00530380) --------------------------------------------------------
int __cdecl sub_530380(int *a1)
{
  int v1; // eax
  int v3; // eax
  float2 *v4; // ecx
  int v5; // eax
  bool v6; // zf
  int v7; // eax
  int v8; // eax
  int v9; // [esp-Ch] [ebp-18h]
  int v10; // [esp-Ch] [ebp-18h]
  int v11; // [esp-8h] [ebp-14h]
  int v12; // [esp-4h] [ebp-10h]
  float2 v13; // [esp+4h] [ebp-8h]

  v1 = a1[12];
  if ( !v1 )
    return 1;
  if ( *(_DWORD *)(v1 + 16) & 0x8020 )
    return 1;
  if ( a1[17] - 1 == *(_DWORD *)&byte_5D4594[2598000] )
  {
    if ( sub_4FF350(v1, 14) )
    {
      sub_501960(231, a1[12], 0, 0);
      return 1;
    }
    if ( sub_40A5C0(4096) && (v3 = a1[12], *(_BYTE *)(v3 + 8) & 4) )
    {
      v4 = *(float2 **)(*(_DWORD *)(v3 + 748) + 308);
      if ( v4 )
        sub_4ED970(60.0, v4 + 7, &v13);
      else
        sub_4F7AB0(&v13, a1[12]);
    }
    else if ( !sub_579F00(&v13, a1[12]) )
    {
      sub_4F7AB0(&v13, a1[12]);
    }
    sub_530560(a1[12], (int *)(a1[12] + 56), &v13);
    sub_522FF0(137, (float2 *)(a1[12] + 56));
    v9 = a1[12];
    v5 = sub_424800(a1[1], 0);
    sub_501960(v5, v9, 0, 0);
    if ( !sub_4FF350(a1[12], 0) )
    {
      sub_522FF0(137, (float2 *)(a1[12] + 56));
      sub_522FF0(137, &v13);
    }
    sub_4E7190((_BYTE *)a1[12], &v13.field_0);
    v6 = !sub_4FF350(a1[12], 0);
    v7 = a1[12];
    if ( v6 )
    {
      sub_522FF0(137, (float2 *)(v7 + 56));
      v12 = 0;
      v11 = 0;
      v10 = a1[12];
    }
    else
    {
      if ( !(*(_BYTE *)(v7 + 8) & 4) )
      {
LABEL_22:
        sub_4E7540(a1[4], a1[12]);
        return 1;
      }
      v12 = *(_DWORD *)(v7 + 36);
      v11 = 2;
      v10 = a1[12];
    }
    v8 = sub_424800(a1[1], 0);
    sub_501960(v8, v10, v11, v12);
    goto LABEL_22;
  }
  return 0;
}

//----- (00530560) --------------------------------------------------------
_DWORD *__cdecl sub_530560(int a1, int *a2, _DWORD *a3)
{
  int v3; // eax
  _DWORD *result; // eax
  _DWORD *v5; // esi
  _DWORD *v6; // eax

  v3 = *(_DWORD *)&byte_5D4594[2487916];
  if ( !*(_DWORD *)&byte_5D4594[2487916] )
  {
    v3 = sub_4E3AA0((CHAR *)&byte_587000[260824]);
    *(_DWORD *)&byte_5D4594[2487916] = v3;
  }
  result = sub_4E3450(v3);
  v5 = result;
  if ( result )
  {
    v6 = (_DWORD *)result[175];
    *v6 = *a3;
    v6[1] = a3[1];
    sub_4DAA50((int)v5, a1, *(float *)a2, *((float *)a2 + 1));
    result = (_DWORD *)(*(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)&byte_5D4594[2649704]);
    v5[34] = *(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)&byte_5D4594[2649704];
  }
  return result;
}

//----- (005305D0) --------------------------------------------------------
int __cdecl sub_5305D0(_DWORD *a1)
{
  int v1; // eax
  int v2; // eax
  float v4; // [esp+0h] [ebp-8h]

  v1 = a1[3];
  if ( *(_BYTE *)(v1 + 8) & 4 )
  {
    v2 = *(_DWORD *)(v1 + 748);
    if ( !v2 || !*(_DWORD *)(v2 + 4 * a1[1] - 372) )
      return 1;
  }
  if ( sub_40A5C0(2048) )
  {
    v4 = sub_419D70(&byte_587000[260840], a1[2] - 1);
    a1[17] = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v4);
  }
  else
  {
    a1[17] = *(_DWORD *)&byte_5D4594[2598000] + 1;
  }
  return 0;
}

//----- (00530650) --------------------------------------------------------
int __cdecl sub_530650(int *a1)
{
  int v1; // ecx
  int v2; // eax
  int v4; // eax
  int v5; // ebp
  int v6; // edi
  int v7; // edx
  int v8; // ecx
  int v9; // eax
  int v10; // eax
  int v11; // eax
  char v12; // al
  int v13; // eax
  int v14; // [esp-10h] [ebp-24h]
  int v15; // [esp-Ch] [ebp-20h]
  int v16; // [esp-8h] [ebp-1Ch]
  int v17; // [esp-4h] [ebp-18h]
  float2 v18; // [esp+Ch] [ebp-8h]

  v1 = a1[3];
  if ( !v1 )
    return 1;
  if ( *(_BYTE *)(v1 + 16) & 0x20 )
    return 1;
  v2 = a1[12];
  if ( !v2 || *(_DWORD *)(v2 + 16) & 0x8020 || v2 != v1 && !a1[5] )
    return 1;
  if ( a1[17] - 1 != *(_DWORD *)&byte_5D4594[2598000] )
    return 0;
  if ( sub_4FF350(v2, 14) )
  {
    sub_501960(231, a1[12], 0, 0);
    return 1;
  }
  v4 = a1[3];
  if ( *(_BYTE *)(v4 + 8) & 4 )
  {
    v5 = *(_DWORD *)(v4 + 748);
    v6 = a1[1] - 122;
    v7 = *(_DWORD *)(v5 + 4 * v6 + 116);
    if ( !v7 )
      return 1;
    v8 = a1[12];
    v18 = *(float2 *)(v8 + 56);
    sub_530560(v8, (int *)(v8 + 56), (_DWORD *)(v7 + 56));
    v14 = a1[12];
    v9 = sub_424800(a1[1], 1);
    sub_501960(v9, v14, 0, 0);
    sub_4E7190((_BYTE *)a1[12], (float *)(*(_DWORD *)(v5 + 4 * v6 + 116) + 56));
    if ( sub_4FF350(a1[12], 0) )
    {
      v10 = a1[12];
      if ( !(*(_BYTE *)(v10 + 8) & 4) )
        goto LABEL_18;
      v17 = *(_DWORD *)(v10 + 36);
      v16 = 2;
      v15 = a1[12];
    }
    else
    {
      sub_522FF0(137, &v18);
      sub_522FF0(137, (float2 *)(a1[12] + 56));
      v17 = 0;
      v16 = 0;
      v15 = a1[12];
    }
    v11 = sub_424800(a1[1], 1);
    sub_501960(v11, v15, v16, v17);
LABEL_18:
    *(_DWORD *)(*(_DWORD *)(v5 + 4 * v6 + 116) + 136) = *(_DWORD *)&byte_5D4594[2598000];
    v12 = *(_BYTE *)(v6 + v5 + 156) - 1;
    *(_BYTE *)(v6 + v5 + 156) = v12;
    if ( !v12 )
    {
      sub_522FF0(129, (float2 *)(*(_DWORD *)(v5 + 4 * v6 + 116) + 56));
      sub_4E5CC0(*(_DWORD *)(v5 + 4 * v6 + 116));
      *(_DWORD *)(v5 + 4 * v6 + 116) = 0;
    }
  }
  v13 = a1[4];
  if ( !v13 || *(_BYTE *)(v13 + 16) & 0x20 )
    return 1;
  sub_4E7540(v13, a1[12]);
  return 1;
}

//----- (00530820) --------------------------------------------------------
int __cdecl sub_530820(int a1)
{
  int result; // eax
  float v2; // [esp+0h] [ebp-8h]

  if ( sub_40A5C0(2048) )
  {
    v2 = sub_419D70(&byte_587000[260856], *(_DWORD *)(a1 + 8) - 1);
    *(_DWORD *)(a1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v2);
    result = 0;
  }
  else
  {
    result = 0;
    *(_DWORD *)(a1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + 1;
  }
  return result;
}

//----- (00530880) --------------------------------------------------------
int __cdecl sub_530880(int *a1)
{
  int v1; // eax
  int v2; // eax
  int v4; // eax
  int v5; // edi
  int v6; // edx
  int v7; // ecx
  _DWORD *v8; // eax
  int v9; // eax
  int v10; // esi
  int v11; // eax
  char v12; // al
  int v13; // [esp-Ch] [ebp-20h]
  float2 v14; // [esp+Ch] [ebp-8h]

  v1 = a1[4];
  if ( !v1 )
    return 1;
  if ( *(_DWORD *)(v1 + 16) & 0x8020 )
    return 1;
  v2 = a1[12];
  if ( !v2 || *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( a1[17] - 1 != *(_DWORD *)&byte_5D4594[2598000] )
    return 0;
  if ( sub_4FF350(v2, 14) )
  {
    sub_501960(231, a1[12], 0, 0);
    return 1;
  }
  v4 = a1[4];
  if ( *(_BYTE *)(v4 + 8) & 4 )
  {
    v5 = *(_DWORD *)(v4 + 748);
    v6 = 0;
    v7 = 4;
    v8 = (_DWORD *)(v5 + 116);
    do
    {
      if ( *v8 )
        ++v6;
      ++v8;
      --v7;
    }
    while ( v7 );
    if ( !v6 )
      return 1;
    v9 = a1[12];
    v14 = *(float2 *)(a1[12] + 56);
    do
      v10 = sub_415FA0(0, 3);
    while ( !*(_DWORD *)(v5 + 4 * v10 + 116) );
    sub_530560(a1[12], (int *)(a1[12] + 56), (_DWORD *)(*(_DWORD *)(v5 + 4 * v10 + 116) + 56));
    sub_4E7190((_BYTE *)a1[12], (float *)(*(_DWORD *)(v5 + 4 * v10 + 116) + 56));
    if ( !sub_4FF350(a1[12], 0) )
    {
      sub_522FF0(137, &v14);
      sub_522FF0(137, (float2 *)(a1[12] + 56));
    }
    v13 = a1[12];
    v11 = sub_424800(a1[1], 0);
    sub_501960(v11, v13, 0, 0);
    v12 = *(_BYTE *)(v10 + v5 + 156) - 1;
    *(_BYTE *)(v10 + v5 + 156) = v12;
    if ( !v12 )
    {
      sub_522FF0(129, (float2 *)(*(_DWORD *)(v5 + 4 * v10 + 116) + 56));
      sub_4E5CC0(*(_DWORD *)(v5 + 4 * v10 + 116));
      *(_DWORD *)(v5 + 4 * v10 + 116) = 0;
    }
  }
  sub_4E7540(a1[4], a1[12]);
  return 1;
}

//----- (00530A30) --------------------------------------------------------
int __cdecl sub_530A30(int a1)
{
  int v1; // esi
  int v2; // ebx
  int v3; // eax
  wchar_t *v4; // eax
  int result; // eax
  int v6; // eax
  float v7; // ecx
  float v8; // edx
  int v9; // eax
  int v10; // ecx
  float v11; // [esp+0h] [ebp-20h]
  float4 v12; // [esp+10h] [ebp-10h]

  v1 = a1;
  v2 = 0;
  if ( !*(_DWORD *)(a1 + 48) )
    *(_DWORD *)(a1 + 48) = *(_DWORD *)(a1 + 16);
  v3 = *(_DWORD *)(v1 + 16);
  if ( *(_BYTE *)(v3 + 8) & 4 )
    v2 = *(_DWORD *)(v3 + 748);
  if ( sub_411A90((float2 *)(v1 + 52)) )
  {
    v4 = sub_40F1D0((char *)&byte_587000[260960], 0, (const char *)&byte_587000[260916], 2912);
    sub_4D9EB0(*(_DWORD *)(v1 + 48), v4);
    sub_501960(231, *(_DWORD *)(v1 + 48), 0, 0);
    result = 1;
  }
  else
  {
    v6 = *(_DWORD *)(v1 + 48);
    v12.field_0 = *(float *)(v6 + 56);
    v7 = *(float *)(v1 + 56);
    v8 = *(float *)(v6 + 60);
    v12.field_8 = *(float *)(v1 + 52);
    v9 = *(_DWORD *)(v1 + 16);
    v12.field_4 = v8;
    v12.field_C = v7;
    if ( !v9 || (unsigned __int8)sub_5374B0((float4 *)&v12) )
    {
      if ( sub_40A5C0(2048) )
      {
        v11 = sub_419D70(&byte_587000[260976], *(_DWORD *)(v1 + 8) - 1);
        *(_DWORD *)(v1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v11);
        result = 0;
      }
      else
      {
        result = 0;
        *(_DWORD *)(v1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + 1;
      }
    }
    else
    {
      if ( v2 )
      {
        v10 = *(_DWORD *)(v2 + 276);
        a1 = 2;
        sub_4DA0F0(*(unsigned __int8 *)(v10 + 2064), 0, &a1);
      }
      result = 1;
    }
  }
  return result;
}

//----- (00530B70) --------------------------------------------------------
int __cdecl sub_530B70(int *a1)
{
  int v1; // ecx
  int v2; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // [esp-Ch] [ebp-14h]
  int v8; // [esp-Ch] [ebp-14h]
  int v9; // [esp-8h] [ebp-10h]
  int v10; // [esp-4h] [ebp-Ch]

  v1 = a1[12];
  if ( !v1 )
    return 1;
  v2 = a1[4];
  if ( !v2 || *(_DWORD *)(v1 + 16) & 0x8020 || *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( a1[17] - 1 == *(_DWORD *)&byte_5D4594[2598000] )
  {
    if ( sub_4FF350(v1, 14) )
    {
      sub_501960(231, a1[12], 0, 0);
      return 1;
    }
    sub_522FF0(137, (float2 *)(a1[12] + 56));
    v7 = a1[12];
    v4 = sub_424800(a1[1], 0);
    sub_501960(v4, v7, 0, 0);
    sub_530560(a1[12], (int *)(a1[12] + 56), a1 + 13);
    sub_4E7190((_BYTE *)a1[12], (float *)a1 + 13);
    if ( sub_4FF350(a1[12], 0) )
    {
      v6 = a1[12];
      if ( !(*(_BYTE *)(v6 + 8) & 4) )
      {
LABEL_14:
        sub_4E7540(a1[4], a1[12]);
        return 1;
      }
      v10 = *(_DWORD *)(v6 + 36);
      v9 = 2;
      v8 = a1[12];
      v5 = sub_424800(a1[1], 0);
    }
    else
    {
      sub_522FF0(137, (float2 *)(a1[12] + 56));
      v10 = 0;
      v9 = 0;
      v8 = a1[12];
      v5 = sub_424800(a1[1], 0);
    }
    sub_501960(v5, v8, v9, v10);
    goto LABEL_14;
  }
  return 0;
}

//----- (00530CA0) --------------------------------------------------------
int __cdecl sub_530CA0(int a1)
{
  int v1; // ecx
  int v2; // eax
  int v3; // ecx
  int result; // eax
  float v5; // [esp+0h] [ebp-8h]

  v1 = *(_DWORD *)(a1 + 16);
  if ( !v1 )
    return 1;
  if ( *(_BYTE *)(a1 + 88) & 0x20 )
    return 1;
  v2 = *(_DWORD *)(a1 + 48);
  if ( !v2 )
    return 1;
  if ( *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( v1 == v2 )
    return 1;
  if ( *(_BYTE *)(v2 + 8) & 2 )
  {
    v3 = *(_DWORD *)(v2 + 12);
    if ( v3 & 0x4000 )
      return 1;
  }
  if ( sub_40A5C0(2048) )
  {
    v5 = sub_419D70(&byte_587000[260992], *(_DWORD *)(a1 + 8) - 1);
    *(_DWORD *)(a1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v5);
    result = 0;
  }
  else
  {
    result = 0;
    *(_DWORD *)(a1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + 1;
  }
  return result;
}

//----- (00530D30) --------------------------------------------------------
int __cdecl sub_530D30(int *a1)
{
  int *v1; // esi
  int v2; // ecx
  int v3; // eax
  int result; // eax
  int v5; // eax
  int v6; // ecx
  float2 *v7; // ecx
  int v8; // eax
  int v9; // eax
  int v10; // eax
  int v11; // [esp-Ch] [ebp-24h]
  int v12; // [esp-Ch] [ebp-24h]
  float *v13; // [esp-4h] [ebp-1Ch]
  float4 v14; // [esp+8h] [ebp-10h]
  int v18; // [esp+1Ch] [ebp+4h]

  v1 = a1;
  v2 = a1[12];
  if ( !v2 )
    return 1;
  v3 = a1[4];
  if ( !v3 || *(_DWORD *)(v2 + 16) & 0x8020 || *(_DWORD *)(v3 + 16) & 0x8020 )
    return 1;
  if ( a1[17] - 1 != *(_DWORD *)&byte_5D4594[2598000] )
    return 0;
  if ( sub_4FF350(v2, 14) || sub_4FF350(a1[4], 14) )
  {
    sub_501960(231, a1[12], 0, 0);
    sub_501960(231, a1[4], 0, 0);
    result = 1;
  }
  else
  {
    if ( a1[5] )
      goto LABEL_23;
    if ( !sub_5370E0(a1[4], a1[12], 0) )
    {
      sub_4DA2C0(a1[4], (const char *)&byte_587000[261008], 0);
      return 1;
    }
    v5 = a1[4];
    if ( !(*(_BYTE *)(v5 + 8) & 4)
      || (v6 = *(_DWORD *)(v5 + 748),
          v14.field_0 = *(float *)(v5 + 56) - (double)*(unsigned __int16 *)(*(_DWORD *)(v6 + 276) + 10),
          v14.field_4 = *(float *)(v5 + 60) - (double)*(unsigned __int16 *)(*(_DWORD *)(v6 + 276) + 12),
          v14.field_8 = (double)*(unsigned __int16 *)(*(_DWORD *)(v6 + 276) + 10) + *(float *)(v5 + 56),
          v18 = *(unsigned __int16 *)(*(_DWORD *)(v6 + 276) + 12),
          v7 = (float2 *)(v1[12] + 56),
          v14.field_C = (double)v18 + *(float *)(v5 + 60),
          sub_428220(v7, &v14)) )
    {
LABEL_23:
      v8 = v1[12];
      v14.field_0 = *(float *)(v8 + 56);
      v13 = (float *)(v1[4] + 56);
      v14.field_4 = *(float *)(v8 + 60);
      sub_4E7190((_BYTE *)v8, v13);
      sub_4E7190((_BYTE *)v1[4], &v14);
      if ( !sub_4FF350(v1[12], 0) && !sub_4FF350(v1[4], 0) )
      {
        sub_522FF0(137, (float2 *)(v1[4] + 56));
        sub_522FF0(137, (float2 *)(v1[12] + 56));
      }
      v11 = v1[12];
      v9 = sub_424800(v1[1], 0);
      sub_501960(v9, v11, 0, 0);
      v12 = v1[4];
      v10 = sub_424800(v1[1], 0);
      sub_501960(v10, v12, 0, 0);
      sub_4E7540(v1[4], v1[12]);
      result = 1;
    }
    else
    {
      sub_4DA2C0(v1[4], (const char *)&byte_587000[261040], 0);
      result = 1;
    }
  }
  return result;
}

//----- (00530F90) --------------------------------------------------------
int __cdecl sub_530F90(_DWORD *a1)
{
  int v1; // ecx
  _DWORD *v2; // ebx
  float v4; // [esp+0h] [ebp-10h]
  float v5; // [esp+0h] [ebp-10h]

  if ( !*(_DWORD *)&byte_5D4594[2487920] )
    *(_DWORD *)&byte_5D4594[2487920] = sub_4E3AA0((CHAR *)&byte_587000[261072]);
  v4 = sub_419D70(&byte_587000[261088], a1[2] - 1);
  a1[18] = sub_419A70(v4);
  a1[19] = 0;
  a1[21] = 0;
  v1 = a1[4];
  if ( v1 && !(*(_BYTE *)(v1 + 8) & 4) || a1[5] )
  {
    v5 = sub_419D40(&byte_587000[261108]);
    a1[17] = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v5);
  }
  else
  {
    sub_4FF380(v1, 5, 10 * *(_WORD *)&byte_5D4594[2649704], 5);
    sub_4FF380(a1[4], 14, 10 * *(_WORD *)&byte_5D4594[2649704], 5);
    sub_4FF380(a1[4], 29, 10 * *(_WORD *)&byte_5D4594[2649704], 5);
    a1[20] = *(_DWORD *)(a1[4] + 120);
    *(_DWORD *)(a1[4] + 120) = 1203982323;
    *(_DWORD *)(a1[4] + 84) = 0;
    *(_DWORD *)(a1[4] + 80) = 0;
    *(_DWORD *)(a1[4] + 92) = 0;
    *(_DWORD *)(a1[4] + 88) = 0;
    *(_DWORD *)(a1[4] + 100) = 0;
    *(_DWORD *)(a1[4] + 96) = 0;
  }
  v2 = sub_4E3450(*(int *)&byte_5D4594[2487920]);
  if ( v2 )
  {
    sub_4DAA50((int)v2, 0, *((float *)a1 + 7), *((float *)a1 + 8));
    a1[19] = v2;
  }
  return 0;
}

//----- (005310C0) --------------------------------------------------------
int __cdecl sub_5310C0(int *a1)
{
  int v1; // edi
  int v2; // eax
  int v4; // eax
  bool v5; // zf
  int v6; // edi
  float v7; // edx
  int v8; // eax
  int v9; // eax
  float v10; // [esp+0h] [ebp-28h]
  float v11; // [esp+4h] [ebp-24h]
  int v12; // [esp+10h] [ebp-18h]
  float v13; // [esp+14h] [ebp-14h]
  float v14; // [esp+14h] [ebp-14h]
  float2 v15; // [esp+20h] [ebp-8h]

  v1 = 0;
  v2 = a1[4];
  if ( !v2 && !a1[5] )
    return 1;
  if ( a1[17] - 1 == *(_DWORD *)&byte_5D4594[2598000] )
    v1 = 1;
  if ( v2 && *(_BYTE *)(v2 + 8) & 4 && !sub_4EEC80(a1[4]) )
    v1 = 1;
  if ( a1[19] )
  {
    if ( !a1[5] && (v4 = a1[4]) != 0 && *(_BYTE *)(v4 + 8) & 4 )
    {
      if ( (unsigned __int16)sub_4EEC80(a1[4]) >= 0xFu )
        goto LABEL_18;
    }
    else if ( (unsigned int)(a1[17] - *(_DWORD *)&byte_5D4594[2598000]) >= 0xA )
    {
      goto LABEL_18;
    }
    sub_4E5CC0(a1[19]);
    a1[19] = 0;
  }
LABEL_18:
  v5 = v1 == 0;
  v6 = a1[18];
  if ( !v5 )
  {
    if ( a1[5] )
    {
      v7 = *((float *)a1 + 8);
      v15.field_0 = *((float *)a1 + 7);
    }
    else
    {
      v8 = a1[4];
      if ( !v8 )
        return 1;
      v15.field_0 = *(float *)(v8 + 56);
      v7 = *(float *)(v8 + 60);
    }
    v15.field_4 = v7;
    sub_4E25A0(1);
    v12 = a1[4];
    v11 = sub_419D40(&byte_587000[261132]);
    v10 = sub_419D40(&byte_587000[261152]);
    sub_4E25B0(&v15, v10, v11, v6, 15, v12, 0);
    v13 = sub_419D40(&byte_587000[261172]);
    v9 = sub_419A70(v13);
    sub_4D9110(&v15, v9);
    sub_522FF0(129, &v15);
    sub_522FF0(154, &v15);
    sub_501960(81, a1[4], 0, 0);
    a1[21] = 1;
    return 1;
  }
  v14 = sub_419D70(&byte_587000[261192], a1[2] - 1);
  a1[18] = v6 + sub_419A70(v14);
  if ( !a1[5] )
  {
    if ( sub_4E7BC0(a1[4]) )
      sub_4EEBF0(a1[4], a1[2]);
  }
  return 0;
}

//----- (00531290) --------------------------------------------------------
int __cdecl sub_531290(int a1)
{
  int v1; // eax
  int result; // eax

  if ( *(_DWORD *)(a1 + 76) )
  {
    sub_4E5CC0(*(_DWORD *)(a1 + 76));
    *(_DWORD *)(a1 + 76) = 0;
  }
  if ( !*(_DWORD *)(a1 + 20) )
  {
    v1 = *(_DWORD *)(a1 + 16);
    if ( v1 )
    {
      if ( *(_BYTE *)(v1 + 8) & 4 )
      {
        sub_4FF5B0(v1, 5);
        sub_4FF5B0(*(_DWORD *)(a1 + 16), 14);
        sub_4FF5B0(*(_DWORD *)(a1 + 16), 29);
        *(_DWORD *)(*(_DWORD *)(a1 + 16) + 120) = *(_DWORD *)(a1 + 80);
      }
    }
  }
  result = *(_DWORD *)(a1 + 84);
  if ( !result )
    result = sub_522FF0(163, (float2 *)(a1 + 28));
  return result;
}

//----- (00531310) --------------------------------------------------------
int __cdecl sub_531310(_DWORD *a1)
{
  int v1; // ecx
  int v2; // edi
  _DWORD *v3; // eax
  _DWORD *v4; // esi
  int v5; // eax
  double v6; // st7
  float v8; // [esp+0h] [ebp-18h]
  float2 v9; // [esp+10h] [ebp-8h]

  v8 = sub_419D70(&byte_587000[261212], a1[2] - 1);
  a1[18] = sub_419A70(v8);
  if ( !*(_DWORD *)&byte_5D4594[2487924] )
    *(_DWORD *)&byte_5D4594[2487924] = sub_4E3AA0((CHAR *)&byte_587000[261236]);
  if ( a1[5] )
    v1 = a1[6];
  else
    v1 = a1[4];
  v2 = 0;
  v9 = *(float2 *)(v1 + 56);
  do
  {
    v3 = sub_4E3450(*(int *)&byte_5D4594[2487924]);
    v4 = v3;
    if ( v3 )
    {
      *(_DWORD *)v3[175] = a1;
      sub_4DAA50((int)v3, a1[4], v9.field_0, v9.field_4);
      *((_WORD *)v4 + 63) = v2;
      v5 = 8 * (__int16)v2;
      *((_WORD *)v4 + 62) = v2;
      *((float *)v4 + 20) = *(float *)&byte_587000[v5 + 194136] * 4.0;
      v6 = *(float *)&byte_587000[v5 + 194140] * 4.0;
      v4[28] = 0;
      *((float *)v4 + 21) = v6;
    }
    v2 += 6;
  }
  while ( v2 < 256 );
  sub_522FF0(160, &v9);
  return 0;
}

//----- (00531410) --------------------------------------------------------
int sub_531410()
{
  return 0;
}

//----- (00531420) --------------------------------------------------------
int __cdecl sub_531420(int a1)
{
  int result; // eax
  int i; // esi

  if ( !*(_DWORD *)&byte_5D4594[2487928] )
    *(_DWORD *)&byte_5D4594[2487928] = sub_4E3AA0((CHAR *)&byte_587000[261252]);
  result = sub_4DA790();
  for ( i = result; result; i = result )
  {
    if ( *(unsigned __int16 *)(i + 4) == *(_DWORD *)&byte_5D4594[2487928] && **(_DWORD **)(i + 700) == a1 )
      sub_4E5CC0(i);
    result = sub_4DA7A0(i);
  }
  return result;
}

//----- (00531490) --------------------------------------------------------
int __cdecl sub_531490(_DWORD *a1)
{
  int v1; // eax
  int v2; // edi
  int result; // eax

  v1 = a1[12];
  v2 = 20 * a1[2] * *(_DWORD *)&byte_5D4594[2649704];
  if ( !v1 )
    return 1;
  if ( !(*(_BYTE *)(v1 + 8) & 4) )
    return 1;
  sub_4FF310(a1[12]);
  sub_4FF380(a1[12], 27, v2, a1[2]);
  result = 0;
  a1[17] = v2 + *(_DWORD *)&byte_5D4594[2598000];
  return result;
}

//----- (005314F0) --------------------------------------------------------
BOOL __cdecl sub_5314F0(int a1)
{
  int v1; // eax
  BOOL result; // eax
  int v3; // eax

  v1 = *(_DWORD *)(a1 + 48);
  if ( !v1 )
    return 1;
  if ( sub_4FF350(v1, 8) )
    return 1;
  v3 = *(_DWORD *)(a1 + 48);
  if ( v3 && *(_BYTE *)(v3 + 8) & 2 && sub_4FEA70(v3, (float2 *)(a1 + 28)) )
    result = 1;
  else
    result = (*(_DWORD *)(*(_DWORD *)(a1 + 48) + 16) & 0x8020) != 0;
  return result;
}

//----- (00531560) --------------------------------------------------------
int __cdecl sub_531560(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 48);
  if ( result )
    result = sub_4FF5B0(result, 27);
  return result;
}

//----- (00531580) --------------------------------------------------------
int __cdecl sub_531580(int a1)
{
  int v1; // eax
  int v2; // eax

  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 48) = 0;
  sub_522FF0(131, (float2 *)(a1 + 28));
  v1 = *(_DWORD *)(a1 + 16);
  if ( !v1 || !(*(_BYTE *)(v1 + 8) & 4) )
    return 0;
  v2 = *(_DWORD *)(*(_DWORD *)(v1 + 748) + 104);
  if ( v2 && *(_DWORD *)(v2 + 12) & 0x4000000 )
  {
    if ( *(_BYTE *)(*(_DWORD *)(v2 + 736) + 96) & 4 )
    {
      *(_DWORD *)(a1 + 72) = v2;
      *(_BYTE *)(a1 + 88) |= 2u;
    }
    return 0;
  }
  return 1;
}

//----- (00531600) --------------------------------------------------------
int __cdecl sub_531600(int a1)
{
  int v1; // eax
  int v2; // eax
  int v3; // edi
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  double v9; // st7
  int v10; // eax
  int v11; // eax
  int v12; // eax
  int v13; // edi
  unsigned __int8 v14; // al
  unsigned __int8 v15; // al
  int v16; // eax
  int v17; // ebp
  _DWORD *v19; // [esp-4h] [ebp-18h]
  float v20; // [esp+0h] [ebp-14h]
  float v21; // [esp+0h] [ebp-14h]

  if ( !*(_DWORD *)&byte_5D4594[2487936] )
  {
    *(_DWORD *)&byte_5D4594[2487936] = sub_4E3AA0((CHAR *)&byte_587000[261268]);
    *(_DWORD *)&byte_5D4594[2487940] = sub_4E3AA0((CHAR *)&byte_587000[261276]);
  }
  v1 = *(_DWORD *)(a1 + 16);
  if ( !v1 || *(_BYTE *)(a1 + 88) & 0x20 || *(_BYTE *)(v1 + 8) & 2 && sub_4FEA70(v1, (float2 *)(a1 + 28)) )
    return 1;
  v2 = *(_DWORD *)(a1 + 48);
  if ( !v2 )
    goto LABEL_16;
  if ( *(_DWORD *)(v2 + 16) & 0x8020 )
    goto LABEL_53;
  if ( sub_4E6E50((float2 *)(*(_DWORD *)(a1 + 16) + 56), *(__int16 *)(*(_DWORD *)(a1 + 16) + 124), (float2 *)(v2 + 56)) & 2 )
  {
    if ( !*(_DWORD *)(a1 + 76) )
      *(_DWORD *)(a1 + 76) = 3 * *(_DWORD *)&byte_5D4594[2649704];
  }
  else
  {
    *(_DWORD *)(a1 + 76) = 0;
  }
  if ( sub_4E6C00(*(_DWORD *)(a1 + 48), *(_DWORD *)(a1 + 16)) > 400.0
    || !sub_5370E0(*(_DWORD *)(a1 + 16), *(_DWORD *)(a1 + 48), 0) )
  {
LABEL_53:
    *(_DWORD *)(a1 + 48) = 0;
LABEL_16:
    v3 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 16) + 748) + 288);
    *(_DWORD *)&byte_5D4594[2487932] = 0;
    if ( !v3 )
      goto LABEL_54;
    if ( sub_5330C0(*(_DWORD *)(a1 + 16), v3) && sub_4E6C00(*(_DWORD *)(a1 + 16), v3) <= 400.0 )
      *(_DWORD *)&byte_5D4594[2487932] = v3;
    if ( !*(_DWORD *)&byte_5D4594[2487932] )
    {
LABEL_54:
      *(_DWORD *)&byte_587000[260404] = 1209810944;
      sub_517F90((float2 *)(*(_DWORD *)(a1 + 16) + 56), 400.0, sub_531920, *(_DWORD *)(a1 + 16));
    }
    *(_DWORD *)(a1 + 48) = *(_DWORD *)&byte_5D4594[2487932];
    *(_DWORD *)(a1 + 76) = 0;
  }
  v4 = *(_DWORD *)(a1 + 76);
  if ( v4 )
  {
    v5 = v4 - 1;
    *(_DWORD *)(a1 + 76) = v5;
    if ( !v5 )
      *(_DWORD *)(a1 + 48) = 0;
  }
  v6 = *(_DWORD *)(a1 + 48);
  v7 = *(_DWORD *)(a1 + 36);
  if ( v6 )
  {
    if ( v6 != v7 )
    {
      if ( v7 )
        sub_4FEF90(a1, *(_DWORD **)(a1 + 36));
      sub_4FF130(a1);
    }
    v8 = *(unsigned __int16 *)(*(_DWORD *)(a1 + 48) + 4);
    if ( (unsigned __int16)v8 == *(_DWORD *)&byte_5D4594[2487936] || v8 == *(_DWORD *)&byte_5D4594[2487940] )
      v9 = sub_419D40(&byte_587000[261292]);
    else
      v9 = sub_419D40(&byte_587000[261312]);
    v20 = v9;
    v10 = sub_419A70(v20);
    (*(void (__cdecl **)(_DWORD, _DWORD, _DWORD, int, int))(*(_DWORD *)(a1 + 48) + 716))(
      *(_DWORD *)(a1 + 48),
      *(_DWORD *)(a1 + 16),
      0,
      v10,
      14);
    v11 = *(_DWORD *)(a1 + 48);
    if ( *(_DWORD *)(v11 + 16) & 0x8020 )
      sub_522FF0(131, (float2 *)(v11 + 56));
    v19 = *(_DWORD **)(a1 + 16);
    *(_DWORD *)(a1 + 36) = *(_DWORD *)(a1 + 48);
    sub_4FA020(v19, 22);
    if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] / 3u)) )
    {
      sub_501960(98, *(_DWORD *)(a1 + 16), 0, 0);
      sub_501960(98, *(_DWORD *)(a1 + 48), 0, 0);
    }
    if ( !*(_DWORD *)(a1 + 76) )
    {
      v21 = sub_419D40(&byte_587000[261328]);
      *(_DWORD *)(a1 + 68) = *(_DWORD *)&byte_5D4594[2598000] + sub_419A70(v21);
    }
    v12 = *(_DWORD *)(a1 + 72);
    if ( v12 )
    {
      v13 = *(_DWORD *)(v12 + 736);
      v14 = *(_BYTE *)(v13 + 108);
      if ( v14 <= 0u )
        return 1;
      v15 = v14 - 1;
      *(_BYTE *)(v13 + 108) = v15;
      *(_DWORD *)(v13 + 112) = 100 * v15 / *(unsigned __int8 *)(v13 + 109);
      v16 = *(_DWORD *)(a1 + 16);
      if ( v16 )
      {
        if ( *(_BYTE *)(v16 + 8) & 4 )
        {
          v17 = *(_DWORD *)(v16 + 748);
          sub_4FA020((_DWORD *)v16, 22);
          sub_4D82B0(
            *(unsigned __int8 *)(*(_DWORD *)(v17 + 276) + 2064),
            *(_DWORD **)(a1 + 72),
            *(_BYTE *)(v13 + 108),
            *(_BYTE *)(v13 + 109));
        }
      }
      if ( *(_BYTE *)(v13 + 108) <= 0u )
        return 1;
    }
  }
  else if ( v7 )
  {
    sub_4FEF90(a1, *(_DWORD **)(a1 + 36));
    *(_DWORD *)(a1 + 36) = 0;
  }
  return 0;
}

//----- (00531920) --------------------------------------------------------
void __cdecl sub_531920(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  double v4; // st7
  double v5; // st6
  double v6; // st5

  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 & 0x20006 )
  {
    if ( !(*(_DWORD *)(a1 + 16) & 0x8020) && a1 != a2 )
    {
      if ( !(v2 & 2) || (v3 = *(_DWORD *)(a1 + 12), (v3 & 0x8000) == 0) )
      {
        if ( sub_5330C0(a2, a1)
          && sub_4E6E50((float2 *)(a2 + 56), *(__int16 *)(a2 + 124), (float2 *)(a1 + 56)) & 1 | 0xC
          && sub_5370E0(a2, a1, 0) )
        {
          v4 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
          v5 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
          v6 = v5 * v5 + v4 * v4;
          if ( v6 < *(float *)&byte_587000[260404] )
          {
            *(float *)&byte_587000[260404] = v6;
            *(_DWORD *)&byte_5D4594[2487932] = a1;
          }
        }
      }
    }
  }
}

//----- (005319E0) --------------------------------------------------------
int __cdecl sub_5319E0(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 72);
  if ( result )
  {
    result = *(_DWORD *)(result + 736);
    *(_DWORD *)(result + 96) &= 0xFFFFFFFB;
  }
  return result;
}

//----- (00531A00) --------------------------------------------------------
int __cdecl sub_531A00(_DWORD *a1)
{
  __int16 v1; // di
  int v2; // eax
  _DWORD *v3; // eax
  int v4; // ecx
  int v5; // edx
  float v7; // [esp+0h] [ebp-14h]
  float v8; // [esp+Ch] [ebp-8h]
  float v9; // [esp+10h] [ebp-4h]

  v7 = sub_419D40(&byte_587000[261348]);
  v1 = sub_419A70(v7);
  v2 = a1[12];
  if ( !v2 || *(_DWORD *)(v2 + 16) & 0x8020 )
    return 1;
  if ( (*(_BYTE *)(v2 + 8) & 4) != 4 )
  {
    sub_4FF380(v2, 15, v1, a1[2]);
    return 1;
  }
  v3 = sub_4E3810((CHAR *)&byte_587000[261376]);
  a1[18] = v3;
  if ( !v3 )
    return 1;
  v4 = a1[12];
  v5 = *(_DWORD *)(*(_DWORD *)(v4 + 748) + 276);
  if ( *(_BYTE *)(v5 + 3680) & 0x10 )
  {
    v8 = (double)*(int *)(v5 + 2284);
    v9 = (double)*(int *)(v5 + 2288);
  }
  else
  {
    v8 = 2944.0;
    v9 = 2944.0;
  }
  sub_4DAA50((int)v3, v4, v8, v9);
  sub_4FF380(a1[12], 1, v1, a1[2]);
  return 0;
}

//----- (00531AF0) --------------------------------------------------------
int __cdecl sub_531AF0(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 48);
  if ( result )
  {
    if ( (*(_BYTE *)(result + 8) & 4) == 4 )
    {
      if ( *(_DWORD *)(a1 + 72) )
        sub_4E5CC0(*(_DWORD *)(a1 + 72));
      *(_DWORD *)(a1 + 72) = 0;
      result = sub_4FF5B0(*(_DWORD *)(a1 + 48), 1);
    }
    else
    {
      result = sub_4FF5B0(result, 15);
    }
  }
  return result;
}

//----- (00531B40) --------------------------------------------------------
int *__cdecl sub_531B40(int a1, int a2)
{
  int v2; // ebx
  int *result; // eax
  BOOL v4; // eax
  long double v5; // st7
  int v6; // [esp-8h] [ebp-14h]
  int v7; // [esp-4h] [ebp-10h]

  v2 = *(_DWORD *)(a1 + 748);
  if ( sub_4FF350(a1, 29) || (result = (int *)sub_540D90(a1, a2)) == 0 )
  {
    if ( sub_534280(a1) )
    {
      v4 = sub_534220(a1);
      v7 = a2;
      v6 = a1;
      if ( v4 && (v5 = sub_4E6C00(a1, a2), v7 = a2, v6 = a1, v5 < *(float *)(*(_DWORD *)(v2 + 484) + 212) * 0.5) )
        result = sub_531C60(a1, a2);
      else
        result = sub_531D50(v6, v7);
    }
    else if ( sub_534220(a1) )
    {
      result = sub_531C60(a1, a2);
    }
    else
    {
      result = (int *)sub_534300(a1);
      if ( !result )
        result = sub_531C10(a1, a2);
    }
  }
  return result;
}

//----- (00531C10) --------------------------------------------------------
int *__cdecl sub_531C10(int a1, int a2)
{
  int *v2; // eax
  int *v3; // eax
  int *result; // eax

  v2 = sub_50A260(a1, 60);
  if ( v2 )
    v2[1] = a2;
  v3 = sub_50A260(a1, 42);
  if ( v3 )
    v3[1] = a2;
  result = sub_50A260(a1, 7);
  if ( result )
  {
    result[1] = *(_DWORD *)(a2 + 56);
    result[2] = *(_DWORD *)(a2 + 60);
    result[3] = a2;
  }
  return result;
}

//----- (00531C60) --------------------------------------------------------
int *__cdecl sub_531C60(int a1, int a2)
{
  int v2; // ebx
  int *v3; // eax
  int *v4; // eax
  int *v5; // eax
  double v6; // st7
  int *v7; // eax
  int *v8; // eax
  int *v9; // eax
  int v10; // ecx
  int *result; // eax

  v2 = *(_DWORD *)(a1 + 748);
  v3 = sub_50A260(a1, 60);
  if ( v3 )
    v3[1] = a2;
  v4 = sub_50A260(a1, 42);
  if ( v4 )
    v4[1] = a2;
  if ( sub_534280(a1) )
  {
    v5 = sub_50A260(a1, 50);
    if ( v5 )
    {
      v6 = *(float *)(*(_DWORD *)(v2 + 484) + 212) * 0.60000002;
      v5[3] = a2;
      *((float *)v5 + 1) = v6;
    }
  }
  v7 = sub_50A260(a1, 45);
  if ( v7 )
    v7[1] = a2;
  sub_50A260(a1, 16);
  v8 = sub_50A260(a1, 26);
  if ( v8 )
    v8[1] = a2;
  v9 = sub_50A260(a1, 49);
  if ( v9 )
  {
    v10 = *(_DWORD *)(*(_DWORD *)(v2 + 484) + 112);
    v9[3] = a2;
    v9[1] = v10;
  }
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
  {
    sub_50A260(a1, 65);
    sub_50A260(a1, 40);
  }
  result = sub_50A260(a1, 7);
  if ( result )
  {
    result[1] = *(_DWORD *)(a2 + 56);
    result[2] = *(_DWORD *)(a2 + 60);
    result[3] = a2;
  }
  return result;
}

//----- (00531D50) --------------------------------------------------------
int *__cdecl sub_531D50(int a1, int a2)
{
  int v2; // ebx
  int *v3; // eax
  int *v4; // eax
  int *v5; // eax
  int *v6; // eax
  int *result; // eax
  int *v8; // eax
  int *v9; // eax
  int v10; // edx

  v2 = *(_DWORD *)(a1 + 748);
  v3 = sub_50A260(a1, 60);
  if ( v3 )
    v3[1] = a2;
  v4 = sub_50A260(a1, 45);
  if ( v4 )
    v4[1] = a2;
  v5 = sub_50A260(a1, 17);
  if ( v5 )
  {
    v5[1] = *(_DWORD *)(a2 + 56);
    v5[2] = *(_DWORD *)(a2 + 60);
    v5[3] = a2;
  }
  v6 = sub_50A260(a1, 26);
  if ( v6 )
    v6[1] = a2;
  result = (int *)sub_534710(a1);
  if ( !result )
  {
    v8 = sub_50A260(a1, 47);
    if ( v8 )
      v8[1] = a2;
    v9 = sub_50A260(a1, 49);
    if ( v9 )
    {
      v10 = *(_DWORD *)(*(_DWORD *)(v2 + 484) + 212);
      v9[3] = a2;
      v9[1] = v10;
    }
    sub_50A260(a1, 40);
    result = sub_50A260(a1, 7);
    if ( result )
    {
      result[1] = *(_DWORD *)(a2 + 56);
      result[2] = *(_DWORD *)(a2 + 60);
      result[3] = a2;
    }
  }
  return result;
}

//----- (00531E20) --------------------------------------------------------
int __cdecl sub_531E20(float a1)
{
  int *v1; // edi
  int v2; // eax
  int v3; // eax

  v1 = *(int **)(LODWORD(a1) + 748);
  v2 = sub_424300(SLODWORD(a1));
  if ( v2 )
    sub_501960(*(_DWORD *)(v2 + 20), SLODWORD(a1), 0, 0);
  sub_502490(v1 + 310, v1[299], SLODWORD(a1));
  v3 = v1[360];
  BYTE1(v3) |= 1u;
  v1[360] = v3;
  sub_5281E0();
  sub_5281F0(a1);
  return sub_534750(SLODWORD(a1));
}

//----- (00531E90) --------------------------------------------------------
int __cdecl sub_531E90(int a1)
{
  int v1; // eax
  int v2; // edx

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 1440);
  BYTE1(v2) &= 0xFEu;
  *(_DWORD *)(v1 + 1440) = v2;
  return sub_534780(a1);
}

//----- (00531EC0) --------------------------------------------------------
char __cdecl sub_531EC0(int a1)
{
  int v1; // esi
  int v2; // ebx
  int *v3; // eax
  float *v4; // ebp
  double v5; // st7
  double v6; // st6

  v1 = *(_DWORD *)(a1 + 748);
  v2 = v1 + 24 * (*(char *)(v1 + 544) + 23);
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 24 * (*(char *)(v1 + 544) + 23) + 12) > (unsigned int)(10 * *(_DWORD *)&byte_5D4594[2649704]) )
    goto LABEL_15;
  if ( *(_DWORD *)(v1 + 1196) )
  {
    *(_DWORD *)(v2 + 12) = *(_DWORD *)&byte_5D4594[2598000];
    if ( sub_528190(*(_DWORD *)(v1 + 1196)) )
    {
      if ( sub_4FF350(a1, 29)
        || (v3 = (int *)sub_540B90(a1)) == 0 && (v3 = (int *)sub_540F20(a1, *(_DWORD *)(v1 + 1196))) == 0 )
      {
        LOBYTE(v3) = (unsigned int)sub_531B40(a1, *(_DWORD *)(v1 + 1196));
      }
      return (char)v3;
    }
LABEL_15:
    LOBYTE(v3) = sub_50A160(a1);
    return (char)v3;
  }
  if ( sub_534710(a1) )
    goto LABEL_15;
  v4 = (float *)(v2 + 4);
  *(_DWORD *)&byte_5D4594[2487944] = 0;
  sub_517F90((float2 *)(v2 + 4), 30.0, sub_532040, v1);
  if ( *(_DWORD *)&byte_5D4594[2487944] )
  {
    sub_50A160(a1);
    v3 = *(int **)(v1 + 1200);
    if ( *(int **)(v1 + 392) == v3 )
      *(_DWORD *)(v1 + 388) = 0;
  }
  else
  {
    v5 = *v4 - *(float *)(a1 + 56);
    v6 = *(float *)(v2 + 8) - *(float *)(a1 + 60);
    if ( v6 * v6 + v5 * v5 < 64.0 )
      goto LABEL_15;
    sub_50A260(a1, 56);
    v3 = sub_50A260(a1, 7);
    if ( v3 )
    {
      v3[1] = *(_DWORD *)v4;
      v3[2] = *(_DWORD *)(v2 + 8);
      v3[3] = 0;
    }
  }
  return (char)v3;
}

//----- (00532040) --------------------------------------------------------
int __cdecl sub_532040(int a1, int a2)
{
  int result; // eax
  int v3; // ecx

  result = a1;
  if ( *(_DWORD *)(a1 + 36) == *(_DWORD *)(a2 + 1200) )
  {
    v3 = *(_DWORD *)(a1 + 16);
    if ( (v3 & 0x8000) != 0 )
      *(_DWORD *)&byte_5D4594[2487944] = 1;
  }
  return result;
}

//----- (00532070) --------------------------------------------------------
char __cdecl sub_532070(int a1)
{
  int v1; // edi
  unsigned int v2; // eax

  v1 = *(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23);
  if ( sub_533E70(a1) )
    *(_DWORD *)(v1 + 4) = *(_DWORD *)&byte_5D4594[2598000] + (*(_DWORD *)&byte_5D4594[2649704] >> 1);
  v2 = *(_DWORD *)(v1 + 4);
  if ( *(_DWORD *)&byte_5D4594[2598000] > v2 )
  {
    sub_50A160(a1);
    LOBYTE(v2) = *(_BYTE *)(a1 + 12);
    if ( !(v2 & 0x10) )
      LOBYTE(v2) = (unsigned int)sub_50A260(a1, 22);
  }
  return v2;
}

//----- (005320E0) --------------------------------------------------------
char __cdecl sub_5320E0(int a1)
{
  char result; // al

  result = a1;
  if ( *(_BYTE *)(*(_DWORD *)(a1 + 748) + 483) )
    result = sub_50A160(a1);
  return result;
}

//----- (00532100) --------------------------------------------------------
char __cdecl sub_532100(int a1)
{
  return sub_50A160(a1);
}

//----- (00532110) --------------------------------------------------------
char __cdecl sub_532110(int a1)
{
  char result; // al

  result = a1;
  if ( *(_BYTE *)(*(_DWORD *)(a1 + 748) + 483) )
    result = sub_50A160(a1);
  return result;
}

//----- (00532130) --------------------------------------------------------
int *__cdecl sub_532130(int a1)
{
  int v1; // edi
  int *v2; // eax
  int *result; // eax
  int v4; // eax
  double v5; // st7
  int v6; // eax
  int v7; // ecx
  int v8; // eax
  int *v9; // eax
  int *v10; // edi
  int v11; // ecx
  int v12; // ecx
  int v13; // [esp-4h] [ebp-1Ch]
  float4 v14; // [esp+8h] [ebp-10h]

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_DWORD *)&byte_5D4594[2598000] >= *(int *)(v1 + 512) )
  {
    if ( *(_BYTE *)(a1 + 12) & 0x10 )
    {
      v4 = sub_4F7E80(*(_DWORD *)(v1 + 2056));
      if ( v4 > *(unsigned __int8 *)(v1 + 1128) )
        *(_BYTE *)(v1 + 1128) -= v4;
      else
        *(_BYTE *)(v1 + 1128) = 0;
    }
    v14.field_0 = *(float *)(a1 + 56) - *(float *)&byte_587000[261388];
    v14.field_4 = *(float *)(a1 + 60) - *(float *)&byte_587000[261388];
    v14.field_8 = *(float *)&byte_587000[261388] + *(float *)(a1 + 56);
    v5 = *(float *)&byte_587000[261388] + *(float *)(a1 + 60);
    *(_DWORD *)&byte_5D4594[2487948] = 0;
    v14.field_C = v5;
    *(float *)&byte_5D4594[2487952] = *(float *)&byte_587000[261388] + 1.0;
    sub_517C10(&v14, (void (__cdecl *)(float *, int))sub_532390, a1);
    if ( *(_DWORD *)&byte_5D4594[2487948]
      && !sub_5330C0(a1, *(int *)&byte_5D4594[2487948])
      && *(_BYTE *)(a1 + 12) & 0x10
      && (v6 = *(_DWORD *)(v1 + 2064)) != 0
      && (v7 = *(_DWORD *)(v6 + 12), BYTE1(v7) & 0x40) )
    {
      v13 = *(_DWORD *)(a1 + 36);
      v8 = sub_4E39D0(a1);
      sub_5341A0((char *)&byte_587000[261392], *(_DWORD *)&byte_5D4594[2598000], v8, v13);
      sub_50A160(a1);
      v9 = sub_50A260(a1, 27);
      if ( v9 )
        v9[1] = *(__int16 *)(a1 + 124);
      v10 = sub_50A260(a1, 41);
      if ( v10 )
        v10[1] = *(_DWORD *)&byte_5D4594[2598000]
               + sub_415FA0(*(_DWORD *)&byte_5D4594[2649704] >> 2, *(_DWORD *)&byte_5D4594[2649704] >> 1);
      result = sub_50A260(a1, 24);
      if ( result )
      {
        v11 = *(_DWORD *)&byte_5D4594[2487948] + 56;
        result[1] = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2487948] + 56);
        v12 = *(_DWORD *)(v11 + 4);
        result[3] = 0;
        result[2] = v12;
      }
    }
    else
    {
      sub_5341D0(a1);
      *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
      *(_DWORD *)(v1 + 512) = *(_DWORD *)&byte_5D4594[2598000]
                            + sub_415FA0(
                                *(_DWORD *)(*(_DWORD *)(v1 + 484) + 128),
                                *(_DWORD *)(*(_DWORD *)(v1 + 484) + 132));
      result = (int *)sub_424300(a1);
      if ( result )
        result = sub_501960(result[6], a1, 0, 0);
    }
  }
  else
  {
    v2 = sub_50A260(a1, 50);
    if ( v2 )
    {
      *((float *)v2 + 1) = *(float *)(*(_DWORD *)(v1 + 484) + 112) * 1.2;
      v2[3] = *(_DWORD *)(v1 + 1196);
    }
    result = sub_50A260(a1, 1);
    if ( result )
      result[1] = *(_DWORD *)(v1 + 512);
  }
  return result;
}

//----- (00532390) --------------------------------------------------------
void __cdecl sub_532390(int a1, int a2)
{
  int v2; // ecx
  int v3; // eax
  double v4; // st7
  double v5; // st6
  float *v6; // edx
  double v7; // st7
  float v8; // [esp+4h] [ebp-4h]
  float v9; // [esp+Ch] [ebp+4h]

  v2 = a1;
  if ( *(_BYTE *)(a1 + 8) & 6 )
  {
    v3 = *(_DWORD *)(a1 + 16);
    if ( (v3 & 0x8000) == 0 )
    {
      v4 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
      v5 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
      v8 = v5;
      v9 = sqrt(v5 * v8 + v4 * v4) + 0.000099999997;
      v7 = v4 / v9;
      if ( v9 < (double)*(float *)&byte_5D4594[2487952] )
      {
        v6 = (float *)&byte_587000[8 * *(__int16 *)(a2 + 124) + 194136];
        if ( v8 / v9 * v6[1] + v7 * *v6 > 0.5 )
        {
          *(_DWORD *)&byte_5D4594[2487948] = v2;
          *(float *)&byte_5D4594[2487952] = v9;
        }
      }
    }
  }
}

//----- (00532440) --------------------------------------------------------
char __cdecl sub_532440(int a1)
{
  int v1; // edi
  BOOL v2; // ebx
  int v3; // eax
  int v4; // ecx
  int (__cdecl *v5)(int); // eax
  int v6; // eax
  int v7; // ebx
  int v8; // eax
  int v10; // [esp-4h] [ebp-10h]

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
  {
    if ( *(_DWORD *)(v1 + 1440) & 0x20000 )
      sub_4FAAF0((_DWORD *)a1);
    v2 = sub_538960(a1);
    v3 = *(_DWORD *)(v1 + 1440);
    if ( v3 & 0x20000 )
      LOBYTE(v3) = sub_4FAAC0((_DWORD *)a1);
    if ( !v2 )
      LOBYTE(v3) = sub_50A160(a1);
  }
  else
  {
    v4 = *(_DWORD *)(v1 + 484);
    v5 = *(int (__cdecl **)(int))(v4 + 236);
    if ( v5 )
    {
      if ( *(unsigned __int8 *)(v1 + 481) == *(_DWORD *)(v4 + 108) && !*(_BYTE *)(v1 + 482) )
      {
        v7 = v5(a1);
        v8 = sub_424300(a1);
        if ( v8 )
        {
          if ( v7 )
            sub_501960(*(_DWORD *)(v8 + 32), a1, 0, 0);
          else
            sub_501960(*(_DWORD *)(v8 + 36), a1, 0, 0);
        }
      }
      LOBYTE(v3) = *(_BYTE *)(v1 + 483);
      if ( (_BYTE)v3 )
        LOBYTE(v3) = sub_50A160(a1);
    }
    else
    {
      v10 = *(_DWORD *)(a1 + 36);
      v6 = sub_4E39D0(a1);
      sub_5341A0((char *)&byte_587000[261556], *(_DWORD *)&byte_5D4594[2598000], v6, v10);
      LOBYTE(v3) = sub_50A160(a1);
    }
  }
  return v3;
}

//----- (00532540) --------------------------------------------------------
_DWORD *__cdecl sub_532540(int a1)
{
  _DWORD *v1; // edi
  int *v2; // eax
  _DWORD *result; // eax

  v1 = *(_DWORD **)(a1 + 748);
  if ( *(_DWORD *)&byte_5D4594[2598000] >= v1[128] )
  {
    sub_5341D0(a1);
    *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
    v1[128] = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(*(_DWORD *)(v1[121] + 220), *(_DWORD *)(v1[121] + 224));
    result = (_DWORD *)sub_424300(a1);
    if ( result )
      result = sub_501960(result[10], a1, 0, 0);
  }
  else
  {
    v2 = sub_50A260(a1, 50);
    if ( v2 )
    {
      *((float *)v2 + 1) = *(float *)(v1[121] + 212) * 1.2;
      v2[3] = v1[299];
    }
    result = sub_50A260(a1, 1);
    if ( result )
      result[1] = v1[128];
  }
  return result;
}

//----- (00532610) --------------------------------------------------------
char __cdecl sub_532610(int a1)
{
  int v1; // esi
  int v2; // ebx
  int v3; // eax
  int *v4; // ebp
  int v5; // eax
  float *v6; // edi
  int v7; // eax
  float v8; // eax
  double v9; // st7
  double v10; // st6
  int v11; // eax
  float v12; // edx
  __int16 v13; // ax
  int v14; // eax
  float v16; // [esp+8h] [ebp-2Ch]
  float v17; // [esp+Ch] [ebp-28h]
  float v18; // [esp+10h] [ebp-24h]
  float v19; // [esp+10h] [ebp-24h]
  float v20; // [esp+14h] [ebp-20h]
  float v21; // [esp+18h] [ebp-1Ch]
  float2 v22; // [esp+1Ch] [ebp-18h]
  float4 v24; // [esp+24h] [ebp-10h]
  float v25; // [esp+38h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
  {
    v3 = sub_538960(a1);
    if ( !v3 )
      LOBYTE(v3) = sub_50A160(a1);
  }
  else
  {
    v4 = (int *)(v2 + 24 * (*(char *)(v2 + 544) + 23));
    v5 = *(_DWORD *)(v2 + 484);
    if ( *(unsigned __int8 *)(v2 + 481) == *(_DWORD *)(v5 + 216) && !*(_BYTE *)(v2 + 482) )
    {
      v6 = (float *)sub_4E3810((CHAR *)(v5 + 148));
      if ( v6 )
      {
        v7 = v4[3];
        if ( v7 )
        {
          sub_533080(a1, v7, v6[136], (int)&v22);
        }
        else
        {
          v8 = *((float *)v4 + 2);
          v22.field_0 = *(float *)(v4 + 4);
          v22.field_4 = v8;
        }
        v9 = v22.field_0 - *(float *)(a1 + 56);
        v10 = v22.field_4 - *(float *)(a1 + 60);
        v18 = v10;
        v11 = 8 * *(__int16 *)(a1 + 124);
        v12 = *(float *)(a1 + 60);
        v24.field_0 = *(float *)(a1 + 56);
        v24.field_4 = v12;
        v25 = sqrt(v10 * v18 + v9 * v9) + 0.1;
        v16 = *(float *)(v1 + 176) + 4.0;
        v20 = v9 * v6[136] / v25;
        v21 = v18 * v6[136] / v25;
        v17 = v16 * *(float *)&byte_587000[v11 + 194136] + *(float *)(v1 + 56);
        v19 = v16 * *(float *)&byte_587000[v11 + 194140] + *(float *)(v1 + 60);
        v24.field_8 = v17 + v20;
        v24.field_C = v19 + v21;
        if ( sub_535250(&v24, 0, 0, 5) )
        {
          sub_4DAA50((int)v6, v1, v17, v19);
          v6[20] = v20;
          v6[21] = v21;
          v13 = *(_WORD *)(v1 + 124);
          *((_WORD *)v6 + 62) = v13;
          *((_WORD *)v6 + 63) = v13;
        }
        else
        {
          sub_4E5CC0((int)v6);
        }
      }
      v14 = sub_424300(v1);
      if ( v14 )
        sub_501960(*(_DWORD *)(v14 + 44), v1, 0, 0);
    }
    LOBYTE(v3) = *(_BYTE *)(v2 + 483);
    if ( (_BYTE)v3 )
      LOBYTE(v3) = sub_50A160(v1);
  }
  return v3;
}

//----- (00532800) --------------------------------------------------------
char __cdecl sub_532800(int a1)
{
  int v1; // eax
  int v2; // edi

  LOBYTE(v1) = *(_BYTE *)(a1 + 8);
  v2 = *(_DWORD *)(a1 + 748);
  if ( v1 & 2 )
  {
    LOBYTE(v1) = byte_5D4594[2598000];
    if ( *(_DWORD *)&byte_5D4594[2598000] >= *(int *)(v2 + 532) )
    {
      *(_DWORD *)(v2 + 532) = *(_DWORD *)&byte_5D4594[2598000]
                            + sub_415FA0(2 * *(_DWORD *)&byte_5D4594[2649704], 4 * *(_DWORD *)&byte_5D4594[2649704]);
      v1 = sub_424300(a1);
      if ( v1 )
        LOBYTE(v1) = (unsigned int)sub_501960(*(_DWORD *)(v1 + 8), a1, 0, 0);
    }
  }
  return v1;
}

//----- (00532880) --------------------------------------------------------
int __cdecl sub_532880(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 748);
  if ( !*(_DWORD *)(result + 520) )
    *(_DWORD *)(result + 520) = *(_DWORD *)&byte_5D4594[2598000];
  return result;
}

//----- (005328B0) --------------------------------------------------------
int __cdecl sub_5328B0(int a1, int a2)
{
  unsigned __int16 v2; // di
  int i; // esi

  v2 = 1;
  if ( !a2 )
    return 1;
  for ( i = *(_DWORD *)(a1 + 504); i; i = *(_DWORD *)(i + 496) )
  {
    if ( *(_DWORD *)(i + 8) & 0x2000000 && *(_BYTE *)(i + 12) & 4 )
    {
      if ( sub_4133D0(i) )
      {
        v2 = 0x2000;
      }
      else if ( *(_WORD *)(i + 24) > v2 )
      {
        v2 = *(_WORD *)(i + 24);
      }
    }
  }
  sub_532930(a1, v2, *(_WORD *)(a2 + 24));
  return 1;
}

//----- (00532930) --------------------------------------------------------
int __cdecl sub_532930(int a1, unsigned __int16 a2, unsigned __int16 a3)
{
  int result; // eax

  result = a2;
  if ( (int)a2 <= 32 )
  {
    if ( a2 == 32 )
    {
      result = a3;
      if ( (int)a3 > 16 )
      {
        if ( a3 == 32 )
        {
          result = sub_501960(848, a1, 0, 0);
        }
        else if ( a3 == 0x2000 )
        {
          result = sub_501960(868, a1, 0, 0);
        }
      }
      else if ( a3 == 16 )
      {
        result = sub_501960(858, a1, 0, 0);
      }
      else
      {
        result = a3 - 1;
        switch ( a3 )
        {
          case 1u:
          case 2u:
          case 4u:
            result = sub_501960(863, a1, 0, 0);
            break;
          case 8u:
            result = sub_501960(853, a1, 0, 0);
            break;
          default:
            return result;
        }
      }
    }
    else
    {
      result = a2 - 1;
      switch ( a2 )
      {
        case 1u:
        case 2u:
        case 4u:
          result = a3;
          if ( (int)a3 > 16 )
          {
            if ( a3 == 32 )
            {
              result = sub_501960(852, a1, 0, 0);
            }
            else if ( a3 == 0x2000 )
            {
              result = sub_501960(872, a1, 0, 0);
            }
          }
          else if ( a3 == 16 )
          {
            result = sub_501960(862, a1, 0, 0);
          }
          else
          {
            result = a3 - 1;
            switch ( a3 )
            {
              case 1u:
              case 2u:
              case 4u:
                result = sub_501960(867, a1, 0, 0);
                break;
              case 8u:
                result = sub_501960(857, a1, 0, 0);
                break;
              default:
                return result;
            }
          }
          break;
        case 8u:
          result = a3;
          if ( (int)a3 > 16 )
          {
            if ( a3 == 32 )
            {
              result = sub_501960(850, a1, 0, 0);
            }
            else if ( a3 == 0x2000 )
            {
              result = sub_501960(870, a1, 0, 0);
            }
          }
          else if ( a3 == 16 )
          {
            result = sub_501960(860, a1, 0, 0);
          }
          else
          {
            result = a3 - 1;
            switch ( a3 )
            {
              case 1u:
              case 2u:
              case 4u:
                result = sub_501960(865, a1, 0, 0);
                break;
              case 8u:
                result = sub_501960(855, a1, 0, 0);
                break;
              default:
                return result;
            }
          }
          break;
        case 0x10u:
          result = a3;
          if ( (int)a3 > 16 )
          {
            if ( a3 == 32 )
            {
              result = sub_501960(851, a1, 0, 0);
            }
            else if ( a3 == 0x2000 )
            {
              result = sub_501960(871, a1, 0, 0);
            }
          }
          else if ( a3 == 16 )
          {
            result = sub_501960(861, a1, 0, 0);
          }
          else
          {
            result = a3 - 1;
            switch ( a3 )
            {
              case 1u:
              case 2u:
              case 4u:
                result = sub_501960(866, a1, 0, 0);
                break;
              case 8u:
                result = sub_501960(856, a1, 0, 0);
                break;
              default:
                return result;
            }
          }
          break;
        default:
          return result;
      }
    }
    return result;
  }
  if ( a2 != 64 && a2 != 1024 )
  {
    if ( a2 != 0x2000 )
      return result;
    result = a3;
    if ( (int)a3 > 16 )
    {
      if ( a3 == 32 )
        return sub_501960(868, a1, 0, 0);
      if ( a3 != 0x2000 )
        return result;
    }
    else if ( a3 != 16 )
    {
      result = a3 - 1;
      switch ( a3 )
      {
        case 1u:
        case 2u:
        case 4u:
          result = sub_501960(872, a1, 0, 0);
          break;
        case 8u:
          result = sub_501960(870, a1, 0, 0);
          break;
        default:
          return result;
      }
      return result;
    }
    return sub_501960(871, a1, 0, 0);
  }
  result = a3;
  if ( (int)a3 > 16 )
  {
    if ( a3 == 32 )
    {
      result = sub_501960(849, a1, 0, 0);
    }
    else if ( a3 == 0x2000 )
    {
      result = sub_501960(869, a1, 0, 0);
    }
  }
  else if ( a3 == 16 )
  {
    result = sub_501960(859, a1, 0, 0);
  }
  else
  {
    result = a3 - 1;
    switch ( a3 )
    {
      case 1u:
      case 2u:
      case 4u:
        result = sub_501960(864, a1, 0, 0);
        break;
      case 8u:
        result = sub_501960(854, a1, 0, 0);
        break;
      default:
        return result;
    }
  }
  return result;
}

//----- (00532E20) --------------------------------------------------------
int __cdecl sub_532E20(int a1, int a2)
{
  int v3; // eax

  if ( a1 && *(_DWORD *)(a1 + 8) & 0x1001000 && *(_DWORD *)(a1 + 492) )
    return 1;
  if ( a2 && *(_WORD *)(a2 + 24) != 0x4000 && sub_532F70(*(_DWORD *)(a1 + 524)) )
  {
    v3 = *(_DWORD *)(a1 + 556);
    if ( v3 && *(_WORD *)(v3 + 4) && sub_532FB0(*(_WORD *)(a1 + 24)) )
    {
      sub_532EC0(a1, *(_WORD *)(a1 + 24));
      return 1;
    }
    sub_532930(a1, *(_WORD *)(a1 + 24), *(_WORD *)(a2 + 24));
  }
  return 1;
}

//----- (00532EC0) --------------------------------------------------------
_DWORD *__cdecl sub_532EC0(int a1, unsigned __int16 a2)
{
  _DWORD *result; // eax

  result = (_DWORD *)a2;
  if ( (int)a2 <= 64 )
  {
    if ( a2 != 64 )
    {
      switch ( a2 )
      {
        case 8u:
          return sub_501960(875, a1, 0, 0);
        case 0x10u:
          return sub_501960(876, a1, 0, 0);
        case 0x20u:
          result = sub_501960(873, a1, 0, 0);
          break;
      }
      return result;
    }
    return sub_501960(874, a1, 0, 0);
  }
  if ( a2 == 1024 )
    return sub_501960(874, a1, 0, 0);
  if ( a2 == 4096 )
    result = sub_501960(877, a1, 0, 0);
  return result;
}

//----- (00532F70) --------------------------------------------------------
int __cdecl sub_532F70(int a1)
{
  int result; // eax

  switch ( a1 )
  {
    case 0:
    case 2:
    case 3:
    case 10:
    case 11:
      result = 1;
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (00532FB0) --------------------------------------------------------
BOOL __cdecl sub_532FB0(__int16 a1)
{
  return a1 == 8 || a1 == 32 || a1 == 64;
}

//----- (00532FE0) --------------------------------------------------------
int __cdecl sub_532FE0(unsigned __int16 a1, int a2)
{
  if ( a2 )
    sub_532930(a2, a1, *(_WORD *)(a2 + 24));
  return 1;
}

//----- (00533010) --------------------------------------------------------
int __cdecl sub_533010(unsigned __int16 a1, int a2)
{
  if ( a2 )
    sub_532EC0(a2, a1);
  return 1;
}

//----- (00533030) --------------------------------------------------------
unsigned __int8 *__cdecl sub_533030(int a1, int a2)
{
  int v2; // edi
  int v3; // eax

  v2 = *(_DWORD *)(a1 + 748);
  v3 = sub_424300(a1);
  if ( v3 )
    sub_501960(*(_DWORD *)(v3 + 68), a1, 0, 0);
  return sub_502490((int *)(v2 + 1232), a2, a1);
}

//----- (00533080) --------------------------------------------------------
int __cdecl sub_533080(int a1, int a2, float a3, int a4)
{
  int result; // eax
  double v5; // st7
  double v6; // st6
  long double v7; // st7

  result = a2;
  v5 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
  v6 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
  v7 = sqrt(v6 * v6 + v5 * v5) / a3;
  *(float *)a4 = v7 * *(float *)(a2 + 80) + *(float *)(a2 + 56);
  *(float *)(a4 + 4) = v7 * *(float *)(a2 + 84) + *(float *)(a2 + 60);
  return result;
}

//----- (005330C0) --------------------------------------------------------
BOOL __cdecl sub_5330C0(int a1, int a2)
{
  int v2; // edx
  int v3; // eax
  int v5; // ecx
  int v6; // edi
  int v7; // esi
  int v8; // eax

  if ( !*(_DWORD *)&byte_5D4594[2488512] )
  {
    *(_DWORD *)&byte_5D4594[2488512] = sub_4E3AA0((CHAR *)&byte_587000[263780]);
    *(_DWORD *)&byte_5D4594[2488516] = sub_4E3AA0((CHAR *)&byte_587000[263800]);
    *(_DWORD *)&byte_5D4594[2488520] = sub_4E3AA0((CHAR *)&byte_587000[263808]);
  }
  if ( a1 )
  {
    if ( a2 )
    {
      if ( a1 != a2 )
      {
        v2 = *(_DWORD *)(a2 + 8);
        if ( !(*(_DWORD *)(a2 + 8) & 2) || !(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 1440) & 0x40000) )
        {
          v3 = *(_DWORD *)(a1 + 8) & 4;
          if ( v3 && *(unsigned __int16 *)(a2 + 4) == *(_DWORD *)&byte_5D4594[2488516] )
            return 1;
          if ( v3 && v2 & 0x20000 )
            return 1;
          v5 = *(_DWORD *)(a1 + 8) & 2;
          if ( (!v5 || !(v2 & 0x20000))
            && (!v3 || !(*(_DWORD *)(a2 + 8) & 2) || !(*(_BYTE *)(a2 + 12) & 0x20))
            && (!v5 || !(*(_BYTE *)(a1 + 12) & 0x20) || !(v2 & 4)) )
          {
            if ( sub_534B10(a1) || sub_534B90(a1) )
            {
              if ( !sub_534B10(a2) && !sub_534B90(a2) )
                return 1;
            }
            else
            {
              if ( sub_534B60(a1) )
                return !sub_534B60(a2);
              if ( !sub_534B10(a2)
                && (!(*(_BYTE *)(a2 + 8) & 2) || !(*(_BYTE *)(a2 + 12) & 8))
                && (!(*(_BYTE *)(a1 + 8) & 2) || !(*(_BYTE *)(a1 + 12) & 8))
                && !sub_4FF350(a1, 28)
                && !sub_4FF350(a2, 28)
                && (!(*(_BYTE *)(a2 + 8) & 4) || !(*(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a2 + 748) + 276) + 3680) & 1)) )
              {
                v6 = sub_4EC580(a1);
                v7 = sub_4EC580(a2);
                if ( v6 != v7 && !sub_419150(v6 + 48, v7 + 48) )
                {
                  v8 = *(_DWORD *)(v6 + 8);
                  if ( v8 & 4 && *(_DWORD *)(v7 + 8) & 0x20000 )
                    return 1;
                  if ( !(v8 & 2) || !(*(_DWORD *)(v7 + 8) & 0x20000) )
                  {
                    if ( !sub_40A5C0(4096)
                      && *(_BYTE *)(a1 + 8) & 2
                      && *(unsigned __int16 *)(a2 + 4) == *(_DWORD *)&byte_5D4594[2488520] )
                    {
                      return sub_50A0D0(a2, 15) != 0;
                    }
                    if ( sub_419130(v6 + 48)
                      || sub_419130(v7 + 48)
                      || !(*(_BYTE *)(v6 + 8) & 2)
                      || !(*(_BYTE *)(v7 + 8) & 2) )
                    {
                      return 1;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;
}

//----- (00533360) --------------------------------------------------------
BOOL __cdecl sub_533360(int a1, int a2)
{
  double v2; // st7
  double v3; // st6
  float *v4; // eax
  BOOL result; // eax
  float v6; // [esp+Ch] [ebp-4h]
  float v7; // [esp+18h] [ebp+8h]

  result = 0;
  if ( sub_5370E0(a1, a2, 0) )
  {
    v2 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
    v3 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
    v6 = v3;
    v4 = (float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136];
    v7 = sqrt(v3 * v6 + v2 * v2) + 0.001;
    if ( v6 / v7 * v4[1] + v2 / v7 * *v4 > 0.5 )
      result = 1;
  }
  return result;
}

//----- (005333F0) --------------------------------------------------------
int __cdecl sub_5333F0(int a1)
{
  int v2; // [esp+0h] [ebp-4h]

  v2 = 1142947840;
  if ( !sub_40A5C0(4096) )
    v2 = 1132068864;
  *(_DWORD *)&byte_5D4594[2487984] = 0;
  *(_DWORD *)&byte_5D4594[2487980] = 1259902592;
  *(_DWORD *)&byte_5D4594[2487992] = 1;
  sub_517F90((float2 *)(a1 + 56), *(float *)&v2, sub_533460, a1);
  return *(_DWORD *)&byte_5D4594[2487984];
}

//----- (00533460) --------------------------------------------------------
void __cdecl sub_533460(int a1, int a2)
{
  int v2; // edi
  int v3; // eax
  double v4; // st7
  float *v5; // eax
  double v6; // st7
  float v7; // [esp+10h] [ebp-8h]
  float v8; // [esp+14h] [ebp-4h]
  float v9; // [esp+20h] [ebp+8h]

  v2 = a2;
  if ( a2 != a1 )
  {
    if ( *(_DWORD *)(a1 + 8) & 0x20006 )
    {
      if ( sub_5330C0(a2, a1) )
      {
        v3 = *(_DWORD *)(a1 + 16);
        if ( (v3 & 0x8000) == 0 )
        {
          if ( sub_5370E0(a2, a1, 0) )
          {
            v7 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
            v4 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
            v8 = v4;
            v9 = sub_419AF0(sqrt(v4 * v8 + v7 * v7)) + 0.001;
            if ( !*(_DWORD *)&byte_5D4594[2487992]
              || (v5 = (float *)&byte_587000[8 * *(__int16 *)(v2 + 124) + 194136], v8 / v9 * v5[1] + v7 / v9 * *v5 > 0.5) )
            {
              v6 = v9;
              if ( sub_4FF350(a1, 10) )
                v6 = v6 * 0.33333334;
              if ( v6 < *(float *)&byte_5D4594[2487980] )
              {
                *(float *)&byte_5D4594[2487980] = v6;
                *(_DWORD *)&byte_5D4594[2487984] = a1;
              }
            }
          }
        }
      }
    }
  }
}

//----- (00533570) --------------------------------------------------------
int __cdecl sub_533570(int a1)
{
  int v2; // [esp+0h] [ebp-4h]

  v2 = 1142947840;
  if ( !sub_40A5C0(4096) )
    v2 = 1132068864;
  *(_DWORD *)&byte_5D4594[2487984] = 0;
  *(_DWORD *)&byte_5D4594[2487992] = 0;
  *(_DWORD *)&byte_5D4594[2487980] = 1259902592;
  sub_517F90((float2 *)(a1 + 56), *(float *)&v2, sub_533460, a1);
  return *(_DWORD *)&byte_5D4594[2487984];
}

//----- (005335D0) --------------------------------------------------------
int __cdecl sub_5335D0(int a1, float a2)
{
  *(_DWORD *)&byte_5D4594[2487984] = 0;
  *(_DWORD *)&byte_5D4594[2487992] = 0;
  *(float *)&byte_5D4594[2487980] = a2;
  sub_517F90((float2 *)(a1 + 56), a2, sub_533460, a1);
  return *(_DWORD *)&byte_5D4594[2487984];
}

//----- (00533610) --------------------------------------------------------
BOOL __cdecl sub_533610(int a1, int a2)
{
  char *v2; // esi
  char *v3; // eax
  BOOL result; // eax

  v2 = sub_533660(a1);
  v3 = sub_533660(a2);
  if ( v2 && v3 )
    result = v2[130] == v3[130];
  else
    result = 1;
  return result;
}

//----- (00533660) --------------------------------------------------------
char *__cdecl sub_533660(int a1)
{
  int v1; // eax
  int2 v3; // [esp+4h] [ebp-8h]

  v1 = *(_DWORD *)(a1 + 8);
  if ( v1 & 4 )
    return sub_4214A0(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 3664));
  if ( !(v1 & 2) )
    return 0;
  v3.field_0 = sub_419A70(*(float *)(a1 + 56));
  v3.field_4 = sub_419A70(*(float *)(a1 + 60));
  return (char *)sub_4217B0(&v3, 0);
}

//----- (005336D0) --------------------------------------------------------
long double __cdecl sub_5336D0(int a1)
{
  long double result; // st7

  *(_DWORD *)&byte_5D4594[2487984] = 0;
  *(_DWORD *)&byte_5D4594[2487980] = 1287568416;
  sub_517F90((float2 *)(a1 + 56), 1000.0, sub_533720, a1);
  if ( *(_DWORD *)&byte_5D4594[2487984] )
    result = sqrt(*(float *)&byte_5D4594[2487980]);
  else
    result = -1.0;
  return result;
}

//----- (00533720) --------------------------------------------------------
void __cdecl sub_533720(int a1, int a2)
{
  double v2; // st7
  double v3; // st6
  double v4; // st5

  if ( *(_BYTE *)(a1 + 8) & 6 && sub_5330C0(a2, a1) && !(*(_DWORD *)(a1 + 16) & 0x8020) )
  {
    v2 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
    v3 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
    v4 = v3 * v3 + v2 * v2;
    if ( v4 < *(float *)&byte_5D4594[2487980] )
    {
      *(float *)&byte_5D4594[2487980] = v4;
      *(_DWORD *)&byte_5D4594[2487984] = a1;
    }
  }
}

//----- (00533790) --------------------------------------------------------
int __cdecl sub_533790(int a1)
{
  int v1; // edi
  char v2; // al
  unsigned int v3; // esi
  int result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_BYTE *)(v1 + 544);
  if ( v2 == -1 )
  {
LABEL_15:
    v3 = 8;
  }
  else
  {
    switch ( *(_DWORD *)(v1 + 24 * (v2 + 23)) )
    {
      case 7:
      case 8:
      case 0xA:
      case 0xD:
      case 0x1D:
      case 0x24:
      case 0x25:
        v3 = (*(_DWORD *)(v1 + 1440) & 0x4000 | 0x30000u) >> 14;
        break;
      case 9:
        v3 = 12;
        break;
      case 0x10:
        v3 = 1;
        break;
      case 0x11:
        v3 = 3;
        break;
      case 0x12:
      case 0x13:
      case 0x14:
        v3 = 7;
        break;
      case 0x15:
      case 0x17:
        v3 = 5;
        break;
      case 0x16:
        v3 = 6;
        break;
      case 0x18:
        v3 = 13;
        break;
      case 0x1E:
        v3 = 9;
        break;
      case 0x1F:
        v3 = 10;
        break;
      case 0x21:
      case 0x23:
        v3 = 14;
        break;
      case 0x22:
        v3 = 15;
        break;
      default:
        goto LABEL_15;
    }
  }
  if ( sub_534840(a1) && v3 == 8 )
  {
    if ( *(_DWORD *)(v1 + 1440) & 0x40000 )
      return 0;
    return v3;
  }
  if ( sub_534A10(a1) && v3 == 8 )
  {
    if ( !*(_DWORD *)(v1 + 1196) )
      return 14;
    return v3;
  }
  if ( !sub_534A40(a1) )
    return v3;
  if ( v3 != 9 )
    return v3;
  result = 15;
  if ( !(*(_DWORD *)(v1 + 1440) & 0x80000) )
    return v3;
  return result;
}

//----- (00533900) --------------------------------------------------------
void __cdecl sub_533900(int a1, int a2, int a3)
{
  int i; // esi

  if ( a1 )
  {
    if ( a2 )
    {
      sub_5339A0(a1, a2, a3);
    }
    else
    {
      if ( *(_BYTE *)(a1 + 8) & 4 && (a3 == 4 || a3 == 3 || a3 == 5) )
        sub_500C70(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064), a3);
      for ( i = *(_DWORD *)(a1 + 516); i; i = *(_DWORD *)(i + 512) )
      {
        if ( *(_BYTE *)(i + 8) & 2 )
        {
          if ( *(_BYTE *)(*(_DWORD *)(i + 748) + 1440) & 0x80 )
            sub_5339A0(a1, i, a3);
        }
      }
    }
  }
}

//----- (005339A0) --------------------------------------------------------
void __cdecl sub_5339A0(int a1, int a2, int a3)
{
  _DWORD *v3; // edi
  int v4; // eax
  _DWORD *v5; // eax
  int v6; // eax
  unsigned int v7; // ebp
  int v8; // eax
  int v9; // eax
  int *v10; // eax
  int v11; // edi
  int v12; // eax
  unsigned int v13; // edx
  int *v14; // eax
  int v15; // edx
  int v16; // eax
  unsigned int v17; // ebp

  v3 = *(_DWORD **)(a2 + 748);
  if ( a1 && *(_BYTE *)(a2 + 8) & 2 )
  {
    if ( sub_534A40(a2) && !a3 || (v4 = *(_DWORD *)(a2 + 16), (v4 & 0x8000) == 0) )
    {
      if ( v3[121] || (v5 = sub_517560(*(unsigned __int16 *)(a2 + 4)), (v3[121] = v5) != 0) )
      {
        switch ( a3 )
        {
          case 0:
            if ( *(_DWORD *)(a2 + 508) == a1 )
              sub_5017F0(a2);
            break;
          case 1:
            if ( *(_BYTE *)(a1 + 8) & 4 )
              sub_4DDE80(a1, a2);
            break;
          case 2:
            if ( *(_BYTE *)(a1 + 8) & 4 )
              sub_528BD0(a2, a1, (const char *)&byte_587000[263820], 0);
            v6 = sub_424300(a2);
            if ( v6 )
              sub_501960(*(_DWORD *)(v6 + 68), a2, 0, 0);
            v7 = v3[360] & 0xFFFFFFBF;
            v3[326] = 1056964608;
            v3[360] = v7;
            sub_50A3A0(a2);
            sub_50A260(a2, 0);
            break;
          case 3:
            if ( sub_534320(a2) )
            {
              if ( *(_BYTE *)(a1 + 8) & 4 )
                sub_528BD0(a2, a1, (const char *)&byte_587000[263836], 0);
              v8 = sub_424300(a2);
              if ( v8 )
                sub_501960(*(_DWORD *)(v8 + 68), a2, 0, 0);
              v3[326] = 1056964608;
              if ( sub_534280(a2) )
              {
                v9 = v3[360];
                LOBYTE(v9) = v9 | 0x40;
                v3[360] = v9;
              }
              v3[328] = 1132068864;
              sub_50A3A0(a2);
              v10 = sub_50A260(a2, 4);
              if ( v10 )
              {
                v10[1] = *(_DWORD *)(a2 + 56);
                v10[2] = *(_DWORD *)(a2 + 60);
                v10[3] = *(__int16 *)(a2 + 124);
              }
            }
            break;
          case 4:
            v11 = *(_DWORD *)(a2 + 748);
            if ( sub_534320(a2) )
            {
              if ( *(_BYTE *)(a1 + 8) & 4 )
                sub_528BD0(a2, a1, (const char *)&byte_587000[263856], 0);
              v12 = sub_424300(a2);
              if ( v12 )
                sub_501960(*(_DWORD *)(v12 + 68), a2, 0, 0);
              v13 = *(_DWORD *)(v11 + 1440) & 0xFFFFFFBF;
              *(_DWORD *)(v11 + 1304) = 1062501089;
              *(_DWORD *)(v11 + 1440) = v13;
              sub_50A3A0(a2);
              v14 = sub_50A260(a2, 3);
              if ( v14 )
              {
                v14[1] = *(_DWORD *)(a1 + 56);
                v15 = *(_DWORD *)(a1 + 60);
                v14[3] = a1;
                v14[2] = v15;
              }
            }
            break;
          case 5:
            if ( sub_534320(a2) )
            {
              v16 = sub_424300(a2);
              if ( v16 )
                sub_501960(*(_DWORD *)(v16 + 68), a2, 0, 0);
              if ( *(_BYTE *)(a1 + 8) & 4 )
                sub_528BD0(a2, a1, (const char *)&byte_587000[263876], 0);
              v17 = v3[360] & 0xFFFFFFBF;
              v3[326] = 1062501089;
              v3[360] = v17;
              sub_50A3A0(a2);
              sub_50A260(a2, 5);
            }
            break;
          default:
            return;
        }
      }
    }
  }
}

//----- (00533C80) --------------------------------------------------------
BOOL __cdecl sub_533C80(int a1, int a2)
{
  float *v2; // ecx

  v2 = (float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136];
  return (*(float *)(a2 + 60) - *(float *)(a1 + 60)) * v2[1] + (*(float *)(a2 + 56) - *(float *)(a1 + 56)) * *v2 > 0.0;
}

//----- (00533CC0) --------------------------------------------------------
void __cdecl sub_533CC0(int a1, float *a2)
{
  float2 v2; // [esp+4h] [ebp-8h]

  if ( a1 )
  {
    v2.field_0 = *a2 - *(float *)(a1 + 56);
    v2.field_4 = a2[1] - *(float *)(a1 + 60);
    *(_WORD *)(a1 + 126) = sub_509ED0(&v2);
  }
}

//----- (00533D00) --------------------------------------------------------
unsigned __int8 *__cdecl sub_533D00(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // eax
  int v4; // eax
  unsigned __int8 *result; // eax
  int v6; // [esp+4h] [ebp-4h]

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
  {
    v2 = *(char *)(v1 + 544) + 23;
    a1 = 0;
    v6 = 0;
    v3 = *(_DWORD *)(v1 + 24 * v2);
    switch ( v3 )
    {
      case 16:
      case 17:
        if ( *(_DWORD *)(v1 + 2056) & 0xFFFFFFFC )
          v4 = sub_4FA280(*(_DWORD *)(v1 + 2056) & 0xFFFFFFFC);
        else
          v4 = *(unsigned __int8 *)(v1 + 2068);
        sub_4F9F90(v4, &a1, &v6);
        break;
      case 18:
      case 19:
      case 20:
        sub_4F9F90(21, &a1, &v6);
        break;
      case 30:
        sub_4F9F90(1, &a1, &v6);
        break;
      case 31:
        sub_4F9F90(2, &a1, &v6);
        break;
      case 21:
        sub_4F9F90(40, &a1, &v6);
        break;
      case 23:
        if ( *(_DWORD *)(v1 + 2056) & 0x7FF8000 )
          sub_4F9F90(30, &a1, &v6);
        else
          sub_4F9F90(47, &a1, &v6);
        break;
    }
    *(_DWORD *)&byte_5D4594[2487968] = 0;
    *(_DWORD *)&byte_5D4594[2487964] = 0;
    *(_DWORD *)&byte_5D4594[2487972] = 0;
    *(_DWORD *)&byte_5D4594[2487976] = 0;
    byte_5D4594[2487973] = a1;
    byte_5D4594[2487974] = v6;
    result = &byte_5D4594[2487964];
  }
  else if ( *(_DWORD *)(v1 + 476) )
  {
    result = (unsigned __int8 *)(*(_DWORD *)(v1 + 476) + 16 * sub_533790(a1));
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (00533E70) --------------------------------------------------------
int __cdecl sub_533E70(int a1)
{
  *(_DWORD *)&byte_5D4594[2487956] = 0;
  *(_DWORD *)&byte_5D4594[2487988] = 1315859240;
  sub_518170(a1 + 56, 100.0, sub_533EB0, a1);
  return *(_DWORD *)&byte_5D4594[2487956];
}

//----- (00533EB0) --------------------------------------------------------
void __cdecl sub_533EB0(int a1, int a2)
{
  int v2; // esi
  float v3; // ecx
  int v4; // ecx
  double v5; // st7
  double v6; // st6
  float *v7; // ecx
  double v8; // st7
  long double v9; // st5
  float v10; // [esp+Ch] [ebp-18h]
  float v11; // [esp+10h] [ebp-14h]
  float2 a3; // [esp+14h] [ebp-10h]
  float v13; // [esp+1Ch] [ebp-8h]
  float v14; // [esp+28h] [ebp+4h]

  v2 = a1;
  v3 = *(float *)(a1 + 76);
  a3.field_0 = *(float *)(a1 + 72);
  a3.field_4 = v3;
  if ( sub_54E6F0(a2, a1) )
  {
    if ( sub_4E6E50((float2 *)(a2 + 56), *(__int16 *)(a2 + 124), &a3) & 1 )
    {
      v4 = *(__int16 *)(a2 + 124);
      v5 = *(float *)(a1 + 80) * *(float *)&byte_587000[8 * v4 + 194136];
      v6 = *(float *)(a1 + 84) * *(float *)&byte_587000[8 * v4 + 194140];
      v7 = (float *)&byte_587000[8 * v4 + 194136];
      if ( v5 + v6 < 0.0 )
      {
        v10 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
        v11 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
        v8 = *v7 * v11 + -v7[1] * v10;
        if ( v8 < 0.0 )
          v8 = -v8;
        if ( v8 < 20.0 )
        {
          v9 = sqrt(*(float *)(a1 + 80) * *(float *)(a1 + 80) + *(float *)(a1 + 84) * *(float *)(a1 + 84));
          v13 = *(float *)(a1 + 80) / v9;
          v14 = sqrt(v11 * v11 + v10 * v10);
          if ( *(float *)(v2 + 84) / v9 * -(v11 / v14) + v13 * -(v10 / v14) > 0.69999999 )
          {
            if ( sub_5370E0(a2, v2, 0) )
            {
              if ( v14 < (double)*(float *)&byte_5D4594[2487988] )
              {
                *(_DWORD *)&byte_5D4594[2487956] = v2;
                *(float *)&byte_5D4594[2487988] = v14;
              }
            }
          }
        }
      }
    }
  }
}

//----- (00534020) --------------------------------------------------------
int __cdecl sub_534020(int a1)
{
  return (*(_DWORD *)(a1 + 12) >> 10) & 1;
}

//----- (00534030) --------------------------------------------------------
char __cdecl sub_534030(int a1)
{
  int v1; // ebx
  char v2; // al
  int v3; // esi
  unsigned int v4; // ecx
  unsigned int v5; // edi
  unsigned int v6; // eax
  int v7; // ecx
  unsigned int v9; // [esp+Ch] [ebp-8h]
  int v10; // [esp+10h] [ebp-4h]

  v1 = a1;
  v2 = *(_BYTE *)(a1 + 12);
  v3 = *(_DWORD *)(a1 + 748);
  v10 = *(_DWORD *)(a1 + 748);
  if ( v2 & 0x30 )
  {
    sub_4F9F90(4, &v9, &a1);
    v4 = *(_DWORD *)(v1 + 36) + *(_DWORD *)&byte_5D4594[2598000];
    v5 = v4 / (a1 + 1) % v9;
    v6 = (v4 - 1) / (a1 + 1) / v9;
    if ( v5 != (v4 - 1) / (a1 + 1) % v9 )
    {
      v6 = *(_DWORD *)(v10 + 484);
      if ( v5 == *(_DWORD *)(v6 + 100) || v5 == *(_DWORD *)(v6 + 104) )
      {
        v6 = sub_424300(v1);
        if ( v6 )
          LOBYTE(v6) = (unsigned int)sub_501960(*(_DWORD *)(v6 + 72), v1, 0, 0);
      }
    }
  }
  else
  {
    v6 = *(_DWORD *)(v3 + 484);
    v7 = *(unsigned __int8 *)(v3 + 481);
    if ( v7 == *(_DWORD *)(v6 + 100) || v7 == *(_DWORD *)(v6 + 104) )
    {
      LOBYTE(v6) = *(_BYTE *)(v3 + 482);
      if ( !(_BYTE)v6 )
      {
        v6 = sub_424300(a1);
        if ( v6 )
          LOBYTE(v6) = (unsigned int)sub_501960(*(_DWORD *)(v6 + 72), v1, 0, 0);
      }
    }
  }
  return v6;
}

//----- (00534120) --------------------------------------------------------
BOOL __cdecl sub_534120(int a1, float2 *a2)
{
  return *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194140] * a2->field_4
       + *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136] * a2->field_0 > 0.89999998;
}

//----- (00534160) --------------------------------------------------------
int __cdecl sub_534160(int a1)
{
  int result; // eax
  int i; // ecx

  result = a1;
  if ( a1 )
  {
    for ( i = *(_DWORD *)(a1 + 508); i; i = *(_DWORD *)(i + 508) )
    {
      if ( *(_BYTE *)(result + 8) & 6 )
        break;
      result = i;
    }
    if ( result )
    {
      if ( !(*(_BYTE *)(result + 8) & 6) )
        result = 0;
    }
  }
  return result;
}

//----- (005341A0) --------------------------------------------------------
void sub_5341A0(char *a1, ...)
{
  //char debug[1024];
  va_list va; // [esp+8h] [ebp+8h]

  va_start(va, a1);
  //nox_vsprintf(debug, a1, va);
  // OutputDebugStringA(debug);
  if ( byte_5D4594[2650636] & 8 )
    nox_vsprintf((char *)&byte_5D4594[2487996], a1, va);
}

//----- (005341D0) --------------------------------------------------------
int __cdecl sub_5341D0(int a1)
{
  sub_4FF5B0(a1, 0);
  return sub_4FF5B0(a1, 23);
}

//----- (005341F0) --------------------------------------------------------
BOOL __cdecl sub_5341F0(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 748);
  return !*(_BYTE *)(v1 + 544) && !*(_DWORD *)(v1 + 552);
}

//----- (00534220) --------------------------------------------------------
BOOL __cdecl sub_534220(int a1)
{
  int v1; // edi
  BOOL result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( sub_534300(a1) )
    goto LABEL_9;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    return !sub_534280(a1);
  if ( *(float *)(*(_DWORD *)(v1 + 484) + 112) <= 0.0 )
LABEL_9:
    result = 0;
  else
    result = 1;
  return result;
}

//----- (00534280) --------------------------------------------------------
BOOL __cdecl sub_534280(int a1)
{
  int v1; // ecx
  BOOL result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    result = (*(_DWORD *)(v1 + 2056) & 0x47F00FE) != 0;
  else
    result = *(_BYTE *)(*(_DWORD *)(v1 + 484) + 148) != 0;
  return result;
}

//----- (005342C0) --------------------------------------------------------
int __cdecl sub_5342C0(int a1)
{
  int v1; // ecx
  int result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    result = (*(_DWORD *)(v1 + 2060) & 0x3000000) != 0;
  else
    result = (*(_DWORD *)(v1 + 1440) >> 2) & 1;
  return result;
}

//----- (00534300) --------------------------------------------------------
int __cdecl sub_534300(int a1)
{
  return (*(_DWORD *)(*(_DWORD *)(a1 + 748) + 1440) >> 5) & 1;
}

//----- (00534320) --------------------------------------------------------
BOOL __cdecl sub_534320(int a1)
{
  return *(float *)(a1 + 548) >= 0.0099999998;
}

//----- (00534340) --------------------------------------------------------
BOOL __cdecl sub_534340(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23));
  return !v1 || v1 == 1 || v1 == 4 || v1 == 25 || v1 == 26 || v1 == 27 || v1 == 23;
}

//----- (00534390) --------------------------------------------------------
BOOL __cdecl sub_534390(int a1)
{
  return *(float *)(*(_DWORD *)(a1 + 748) + 1304) > 0.66000003;
}

//----- (005343C0) --------------------------------------------------------
BOOL __cdecl sub_5343C0(int a1)
{
  int v1; // ecx

  v1 = *(_DWORD *)(a1 + 748);
  return *(float *)(v1 + 1304) < 0.66000003 && *(float *)(v1 + 1304) > 0.33000001;
}

//----- (00534400) --------------------------------------------------------
BOOL __cdecl sub_534400(int a1)
{
  int v1; // ecx

  v1 = *(_DWORD *)(a1 + 748);
  return *(float *)(v1 + 1304) < 0.33000001 && *(float *)(v1 + 1304) > 0.079999998;
}

//----- (00534440) --------------------------------------------------------
BOOL __cdecl sub_534440(int a1)
{
  return *(float *)(*(_DWORD *)(a1 + 748) + 1304) < 0.079999998;
}

//----- (00534470) --------------------------------------------------------
double __cdecl sub_534470(int a1)
{
  return *(float *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 484) + 112);
}

//----- (00534490) --------------------------------------------------------
char *__cdecl sub_534490(float a1)
{
  int v1; // edx
  float *v2; // ecx

  v1 = 0;
  v2 = (float *)&byte_587000[261712];
  while ( a1 != *v2 )
  {
    v2 += 2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[261744] )
      return *(char **)&byte_587000[261716];
  }
  return *(char **)&byte_587000[8 * v1 + 261716];
}

//----- (005344C0) --------------------------------------------------------
double __cdecl sub_5344C0(const char *a1)
{
  int v1; // ebp
  const char **v2; // edi

  v1 = 0;
  v2 = (const char **)&byte_587000[261716];
  while ( strcmp(*v2, a1) )
  {
    v2 += 2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[261748] )
      return 0.5;
  }
  return *(float *)&byte_587000[8 * v1 + 261712];
}

//----- (00534530) --------------------------------------------------------
char *__cdecl sub_534530(int a1)
{
  char *result; // eax

  if ( a1 < 0 || a1 >= 5 )
    result = *(char **)&byte_587000[261744];
  else
    result = *(char **)&byte_587000[4 * a1 + 261744];
  return result;
}

//----- (00534550) --------------------------------------------------------
int __cdecl sub_534550(const char *a1)
{
  int v1; // ebp
  const char **v2; // edi

  v1 = 0;
  v2 = (const char **)&byte_587000[261744];
  while ( strcmp(*v2, a1) )
  {
    ++v2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[261764] )
      return 3;
  }
  return v1;
}

//----- (005345B0) --------------------------------------------------------
char *__cdecl sub_5345B0(int a1)
{
  unsigned __int8 *v1; // ecx
  int v2; // eax

  v1 = &byte_587000[262056];
  while ( *(_DWORD *)v1 != a1 )
  {
LABEL_6:
    v1 += 4;
    if ( (int)v1 >= (int)&byte_587000[262072] )
      return *(char **)&byte_587000[261920];
  }
  v2 = 0;
  while ( v2 != a1 )
  {
    if ( ++v2 >= 39 )
      goto LABEL_6;
  }
  return *(char **)&byte_587000[4 * v2 + 261768];
}

//----- (005345F0) --------------------------------------------------------
int __cdecl sub_5345F0(const char *a1)
{
  int v1; // ebp
  const char **v2; // edi

  v1 = 0;
  v2 = (const char **)&byte_587000[261768];
  while ( strcmp(*v2, a1) )
  {
    ++v2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[261924] )
      return 38;
  }
  return v1;
}

//----- (00534650) --------------------------------------------------------
char *__cdecl sub_534650(int a1)
{
  int v1; // eax

  v1 = 0;
  while ( v1 != a1 )
  {
    if ( ++v1 >= 72 )
      return 0;
  }
  return *(char **)&byte_587000[4 * v1 + 261768];
}

//----- (00534670) --------------------------------------------------------
int __cdecl sub_534670(const char *a1)
{
  int v1; // ebp
  const char **v2; // edi

  v1 = 0;
  v2 = (const char **)&byte_587000[261768];
  while ( strcmp(*v2, a1) )
  {
    ++v2;
    ++v1;
    if ( (int)v2 >= (int)&byte_587000[262056] )
      return 0;
  }
  return v1;
}

//----- (005346D0) --------------------------------------------------------
int __cdecl sub_5346D0(int a1)
{
  int result; // eax

  result = *(_DWORD *)(a1 + 748);
  *(_DWORD *)(result + 8) = 0;
  *(_DWORD *)(result + 296) = 0;
  return result;
}

//----- (005346F0) --------------------------------------------------------
int __cdecl sub_5346F0(int a1)
{
  int result; // eax

  result = a1;
  *(_DWORD *)(*(_DWORD *)(a1 + 748) + 1196) = 0;
  return result;
}

//----- (00534710) --------------------------------------------------------
BOOL __cdecl sub_534710(int a1)
{
  int v1; // ecx
  BOOL result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( *(_BYTE *)(v1 + 1440) & 0x40 )
    result = 1;
  else
    result = *(_DWORD *)(v1 + 24 * (*(char *)(v1 + 544) + 23)) == 4;
  return result;
}

//----- (00534750) --------------------------------------------------------
int __cdecl sub_534750(int a1)
{
  int v1; // ecx
  int result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  result = *(_DWORD *)(v1 + 1440);
  if ( !(result & 0x10000) )
  {
    BYTE1(result) |= 0x40u;
    *(_DWORD *)(v1 + 1440) = result;
  }
  return result;
}

//----- (00534780) --------------------------------------------------------
int __cdecl sub_534780(int a1)
{
  int v1; // ecx
  int result; // eax

  v1 = *(_DWORD *)(a1 + 748);
  result = *(_DWORD *)(v1 + 1440);
  if ( (result & 0x8000) == 0 )
  {
    BYTE1(result) &= 0xBFu;
    *(_DWORD *)(v1 + 1440) = result;
  }
  return result;
}

//----- (005347A0) --------------------------------------------------------
int __cdecl sub_5347A0(int a1)
{
  return (*(_DWORD *)(*(_DWORD *)(a1 + 748) + 1440) >> 9) & 1;
}

//----- (005347C0) --------------------------------------------------------
BOOL __cdecl sub_5347C0(int a1)
{
  unsigned __int16 *v1; // eax
  unsigned __int16 v2; // cx
  BOOL result; // eax

  v1 = *(unsigned __int16 **)(a1 + 556);
  result = 0;
  if ( v1 )
  {
    v2 = v1[2];
    if ( *v1 < v2 )
    {
      if ( v2 )
        result = 1;
    }
  }
  return result;
}

//----- (005347F0) --------------------------------------------------------
BOOL __cdecl sub_5347F0(int a1)
{
  return *(_BYTE *)(a1 + 540) != 0;
}

//----- (00534810) --------------------------------------------------------
BOOL __cdecl sub_534810(int a1)
{
  return *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(*(_DWORD *)(a1 + 748) + 508) < (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]);
}

//----- (00534840) --------------------------------------------------------
BOOL __cdecl sub_534840(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2488524];
  if ( !*(_DWORD *)&byte_5D4594[2488524] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[263896]);
    *(_DWORD *)&byte_5D4594[2488524] = v1;
  }
  return *(unsigned __int16 *)(a1 + 4) == v1;
}

//----- (00534870) --------------------------------------------------------
int *__cdecl sub_534870(int a1)
{
  int *result; // eax

  result = (int *)sub_534840(a1);
  if ( result )
  {
    sub_50A260(a1, 61);
    result = sub_50A260(a1, 33);
  }
  return result;
}

//----- (005348A0) --------------------------------------------------------
int *__cdecl sub_5348A0(int a1)
{
  int *result; // eax

  result = (int *)sub_534840(a1);
  if ( result )
  {
    sub_50A260(a1, 61);
    result = sub_50A260(a1, 34);
  }
  return result;
}

//----- (005348D0) --------------------------------------------------------
char __cdecl sub_5348D0(int a1)
{
  int v1; // esi
  char result; // al

  v1 = *(_DWORD *)(a1 + 748);
  result = *(_BYTE *)(v1 + 483);
  if ( result )
  {
    sub_50A160(a1);
    *(_DWORD *)(v1 + 1440) |= 0x40000u;
    result = (unsigned int)sub_4E8020(a1);
  }
  return result;
}

//----- (00534910) --------------------------------------------------------
char __cdecl sub_534910(int a1)
{
  int v1; // esi
  char result; // al

  v1 = *(_DWORD *)(a1 + 748);
  result = *(_BYTE *)(v1 + 483);
  if ( result )
  {
    sub_50A160(a1);
    *(_DWORD *)(v1 + 1440) &= 0xFFFBFFFF;
    result = (unsigned int)sub_4E8020(a1);
  }
  return result;
}

//----- (00534950) --------------------------------------------------------
void __cdecl sub_534950(int a1)
{
  int v1; // ecx
  int v2; // edx
  int v3; // eax
  double v4; // st7
  double v5; // st6

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 24 * (*(char *)(v1 + 544) + 23));
  v3 = v1 + 24 * (*(char *)(v1 + 544) + 23);
  if ( v2
    && (v2 != 4
     || (v4 = *(float *)(v3 + 4) - *(float *)(a1 + 56),
         v5 = *(float *)(v3 + 8) - *(float *)(a1 + 60),
         v5 * v5 + v4 * v4 > 64.0)) )
  {
    if ( v2 != 34 && *(_DWORD *)(v1 + 1440) & 0x40000 )
    {
      sub_50A260(a1, 61);
      sub_50A260(a1, 34);
      goto LABEL_10;
    }
  }
  else if ( !(*(_DWORD *)(v1 + 1440) & 0x40000)
         && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 548)) > *(int *)&byte_5D4594[2649704] )
  {
    sub_50A260(a1, 61);
    sub_50A260(a1, 33);
LABEL_10:
    sub_501960(460, a1, 0, 0);
    return;
  }
}

//----- (00534A10) --------------------------------------------------------
BOOL __cdecl sub_534A10(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2488528];
  if ( !*(_DWORD *)&byte_5D4594[2488528] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[263904]);
    *(_DWORD *)&byte_5D4594[2488528] = v1;
  }
  return *(unsigned __int16 *)(a1 + 4) == v1;
}

//----- (00534A40) --------------------------------------------------------
BOOL __cdecl sub_534A40(int a1)
{
  int v1; // eax

  if ( !*(_DWORD *)&byte_5D4594[2488532] )
  {
    *(_DWORD *)&byte_5D4594[2488532] = sub_4E3AA0((CHAR *)&byte_587000[263924]);
    *(_DWORD *)&byte_5D4594[2488536] = sub_4E3AA0((CHAR *)&byte_587000[263932]);
  }
  v1 = *(unsigned __int16 *)(a1 + 4);
  return (unsigned __int16)v1 == *(_DWORD *)&byte_5D4594[2488532] || v1 == *(_DWORD *)&byte_5D4594[2488536];
}

//----- (00534A90) --------------------------------------------------------
char __cdecl sub_534A90(int a1)
{
  char result; // al

  result = a1;
  if ( *(_BYTE *)(*(_DWORD *)(a1 + 748) + 483) )
    result = sub_50A160(a1);
  return result;
}

//----- (00534AB0) --------------------------------------------------------
unsigned int __cdecl sub_534AB0(int a1)
{
  unsigned int result; // eax

  result = sub_534A40(a1);
  if ( result )
  {
    result = sub_50A020(a1);
    if ( result == 31 )
    {
      sub_50A160(a1);
      sub_50A260(a1, 61);
      sub_50A260(a1, 35);
      sub_501960(469, a1, 0, 0);
      sub_4EE6F0(a1);
      result = *(_DWORD *)(a1 + 16) & 0xFFFF7FA7;
      *(_DWORD *)(a1 + 16) = result;
    }
  }
  return result;
}

//----- (00534B10) --------------------------------------------------------
BOOL __cdecl sub_534B10(int a1)
{
  int v1; // eax
  int v2; // ecx

  v1 = *(_DWORD *)&byte_5D4594[2488544];
  if ( !*(_DWORD *)&byte_5D4594[2488544] )
  {
    *(_DWORD *)&byte_5D4594[2488540] = sub_4E3AA0((CHAR *)&byte_587000[263944]);
    v1 = sub_4E3AA0((CHAR *)&byte_587000[263952]);
    *(_DWORD *)&byte_5D4594[2488544] = v1;
  }
  v2 = *(unsigned __int16 *)(a1 + 4);
  return (unsigned __int16)v2 == v1 || v2 == *(_DWORD *)&byte_5D4594[2488540];
}

//----- (00534B60) --------------------------------------------------------
BOOL __cdecl sub_534B60(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2488548];
  if ( !*(_DWORD *)&byte_5D4594[2488548] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[263964]);
    *(_DWORD *)&byte_5D4594[2488548] = v1;
  }
  return *(unsigned __int16 *)(a1 + 4) == v1;
}

//----- (00534B90) --------------------------------------------------------
BOOL __cdecl sub_534B90(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)&byte_5D4594[2488552];
  if ( !*(_DWORD *)&byte_5D4594[2488552] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[263968]);
    *(_DWORD *)&byte_5D4594[2488552] = v1;
  }
  return *(unsigned __int16 *)(a1 + 4) == v1;
}

//----- (00534BC0) --------------------------------------------------------
int __cdecl sub_534BC0(int a1, int a2, int a3, int a4, int a5)
{
  unsigned __int8 *v5; // esi
  unsigned __int8 v6; // al
  int v7; // eax
  int v8; // ecx
  int result; // eax
  unsigned __int8 v10; // al
  int v11; // ecx
  int v12; // eax
  int v13; // eax
  char *v14; // eax
  _DWORD *v15; // edi
  float v16; // [esp+0h] [ebp-1Ch]
  int2 v17;

  v5 = (unsigned __int8 *)sub_410580(a1, a2);
  if ( !*(_DWORD *)&byte_5D4594[2488556] )
    *(_DWORD *)&byte_5D4594[2488556] = sub_410D60((const char *)&byte_587000[263980]);
  if ( !v5 )
    return 0;
  v6 = v5[4];
  if ( v6 & 0x20 )
    return 0;
  if ( !(v6 & 8) )
  {
    sub_532FE0(*(_WORD *)&byte_5D4594[12332 * v5[1] + 2692784], a5);
    return 0;
  }
  if ( !sub_40A5C0(4096)
    || !a5
    || v5[1] != *(_DWORD *)&byte_5D4594[2488556]
    || (v7 = sub_4EC580(a5)) == 0
    || (v8 = 99999999, !(*(_BYTE *)(v7 + 8) & 4)) )
  {
    v8 = a3;
  }
  if ( v5[7] - v8 > 0 )
  {
    v10 = v5[7] - v8;
    v11 = v5[1];
    v5[7] = v10;
    *(float *)&v17.field_0 = (double)a1 * 23.0 + 11.5;
    *(float *)&v17.field_4 = (double)a2 * 23.0 + 11.5;
    v12 = sub_410E40(v11);
    if ( v12 )
    {
      v13 = sub_415FA0(0, v12 - 1);
      v14 = sub_410E60(v5[1], v13);
      v15 = sub_4E3810(v14);
      if ( v15 )
      {
        sub_4DAA50((int)v15, 0, *(float *)&v17.field_0, *(float *)&v17.field_4);
        v16 = sub_416030(10.0, 20.0);
        sub_52DF80((int)&v17, (int)v15, v16);
      }
    }
    sub_533010(*(_WORD *)&byte_5D4594[12332 * v5[1] + 2692784], a5);
    result = 0;
  }
  else
  {
    v17.field_0 = a1;
    v17.field_4 = a2;
    result = sub_534DA0(&v17);
  }
  return result;
}

//----- (00534DA0) --------------------------------------------------------
int __cdecl sub_534DA0(int *a1)
{
  int v1; // edi
  char v2; // al
  double v3; // st7
  char *v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // ebx
  int v8; // eax
  int v9; // ebp
  char *v10; // eax
  _DWORD *v11; // esi
  int v13; // [esp+0h] [ebp-24h]
  float v14; // [esp+0h] [ebp-24h]
  float v15; // [esp+4h] [ebp-20h]
  float v16; // [esp+8h] [ebp-1Ch]
  float2 v17; // [esp+1Ch] [ebp-8h]

  v1 = sub_410580(*a1, a1[1]);
  if ( !*(_DWORD *)&byte_5D4594[2488560] )
    *(_DWORD *)&byte_5D4594[2488560] = sub_410D60((const char *)&byte_587000[264100]);
  if ( !v1 )
    return 0;
  v2 = *(_BYTE *)(v1 + 4);
  if ( !(v2 & 8) || v2 & 0x20 )
    return 0;
  v13 = *(unsigned __int8 *)(v1 + 1);
  v17.field_0 = (double)*a1 * 23.0 + 11.5;
  v3 = (double)a1[1];
  *(_BYTE *)(v1 + 7) = 0;
  v17.field_4 = v3 * 23.0 + 11.5;
  v4 = sub_410EA0(v13);
  v5 = sub_40AF50(v4);
  sub_501A30(v5, &v17, 0, 0);
  sub_522FF0(138, &v17);
  if ( !sub_40A5C0(4096) )
  {
    v6 = sub_410E40(*(unsigned __int8 *)(v1 + 1));
    if ( v6 )
    {
      v7 = sub_415FA0(0, v6 - 1);
      v8 = sub_415FA0(3, 6);
      if ( v8 > 0 )
      {
        v9 = v8;
        do
        {
          v10 = sub_410E60(*(unsigned __int8 *)(v1 + 1), v7);
          v11 = sub_4E3810(v10);
          if ( v11 )
          {
            v15 = sub_416030(-2.0, 2.0) + v17.field_4;
            v14 = sub_416030(-2.0, 2.0) + v17.field_0;
            sub_4DAA50((int)v11, 0, v14, v15);
            v16 = sub_416030(4.0, 10.0);
            sub_52DF80((int)&v17, (int)v11, v16);
          }
          if ( ++v7 >= sub_410E40(*(unsigned __int8 *)(v1 + 1)) )
            v7 = 0;
          --v9;
        }
        while ( v9 );
      }
    }
  }
  if ( *(unsigned __int8 *)(v1 + 1) == *(_DWORD *)&byte_5D4594[2488560] )
  {
    sub_4FF840(v1);
  }
  else
  {
    sub_410520(*(_WORD *)(v1 + 10));
    sub_4DF0A0(v1, 32);
  }
  return 1;
}

//----- (00534FC0) --------------------------------------------------------
bool __cdecl sub_534FC0(int4 *a1, int a2, float a3, int a4, int a5, int a6)
{
  int4 *v6; // edx
  int v7; // edi
  int v8; // eax
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ebx
  int v14; // esi
  char *v15; // edi
  float *v16; // eax
  double v17; // st7
  double v18; // st7
  double v19; // st7
  double v20; // st7
  long double v21; // st7
  float v22; // eax
  int *v23; // esi
  int v25; // [esp+8h] [ebp-144h]
  float v26; // [esp+Ch] [ebp-140h]
  float v27; // [esp+Ch] [ebp-140h]
  float v28; // [esp+10h] [ebp-13Ch]
  int v29; // [esp+14h] [ebp-138h]
  float v30; // [esp+18h] [ebp-134h]
  float v31; // [esp+1Ch] [ebp-130h]
  int v32; // [esp+20h] [ebp-12Ch]
  int v33; // [esp+24h] [ebp-128h]
  float *v34; // [esp+28h] [ebp-124h]
  float v35; // [esp+2Ch] [ebp-120h]
  int v36[2]; // [esp+30h] [ebp-11Ch]
  float v37; // [esp+38h] [ebp-114h]
  float4 v38;
  char v41[256]; // [esp+4Ch] [ebp-100h]

  v6 = a1;
  v7 = 0;
  v25 = 0;
  if ( !a1 || !a2 )
    return 0;
  v8 = a6;
  v29 = 0;
  if ( a6 )
  {
    v9 = *(_DWORD *)(a6 + 8);
    if ( v9 & 6 )
    {
      v10 = *(__int16 *)(a6 + 124);
      v29 = 1;
    }
    else
    {
      if ( !(v9 & 0x1001000) )
        goto LABEL_10;
      v11 = *(_DWORD *)(a6 + 492);
      if ( !v11 )
        goto LABEL_10;
      v10 = *(__int16 *)(v11 + 124);
      v29 = 1;
    }
    v34 = (float *)&byte_587000[8 * v10 + 194136];
  }
LABEL_10:
  v12 = a1->field_C;
  v13 = a1->field_4;
  v33 = a1->field_4;
  v37 = a3 * a3;
  if ( v13 <= v12 )
  {
    do
    {
      v14 = v6->field_0;
      v32 = v6->field_0;
      if ( v6->field_0 <= v6->field_8 )
      {
        v15 = &v41[8 * v7 + 4];
        do
        {
          if ( sub_410580(v14, v13) )
          {
            v16 = (float *)(v29 ? a6 + 56 : a2);
            v17 = (double)v32;
            v35 = v17;
            v26 = v17 * 23.0 + 11.5 - *v16;
            v18 = (double)v33;
            v31 = v18;
            v19 = v18 * 23.0 + 11.5 - v16[1];
            v28 = v19;
            v20 = v19 * v28 + v26 * v26;
            v30 = v20;
            if ( v20 < v37 )
            {
              if ( !v29
                || v30 <= 0.0
                || (v21 = sqrt(v30) + 0.5,
                    v27 = v26 / v21,
                    v28 / v21 * v34[1] + v27 * *v34 > *(double *)&byte_581450[9544]) )
              {
                v22 = *(float *)(a2 + 4);
                v38.field_0 = *(float *)a2;
                v38.field_4 = v22;
                v38.field_8 = v35 * 23.0 + 11.5;
                v36[1] = 0;
                v36[0] = 0;
                v38.field_C = v31 * 23.0 + 11.5;
                if ( (sub_535250(&v38, 0, (int2 *)v36, 1) == 1 || v36[0] == v14 && v36[1] == v13) && v25 < 32 )
                {
                  *((_DWORD *)v15 - 1) = v14;
                  *(_DWORD *)v15 = v13;
                  ++v25;
                  v15 += 8;
                }
              }
            }
          }
          v32 = ++v14;
        }
        while ( v14 <= a1->field_8 );
        v7 = v25;
        v8 = a6;
        v6 = a1;
      }
      v33 = ++v13;
    }
    while ( v13 <= v6->field_C );
  }
  if ( v7 > 0 )
  {
    v23 = (int *)v41;
    while ( 1 )
    {
      sub_534BC0(*v23, v23[1], a4, a5, v8);
      v23 += 2;
      if ( !--v7 )
        break;
      v8 = a6;
    }
    v7 = v25;
  }
  return v7 > 0;
}
// 535128: variable 'v34' is possibly undefined

//----- (00535250) --------------------------------------------------------
int __cdecl sub_535250(float4 *a1, float2 *a2, int2 *a3, char a4)
{
  int v4; // edi
  int v5; // ebx
  float v6; // eax
  double v7; // st7
  int v8; // eax
  float v10; // edx
  double v11; // st7
  int v12; // eax
  float v13; // ecx
  double v14; // st7
  double v15; // st7
  float v16; // et1
  float v17; // et1
  double v18; // st7
  float v19; // et1
  double v20; // st7
  float v21; // et1
  double v22; // st7
  float v23; // et1
  int v24; // eax
  float v25; // et1
  int v26; // edi
  int v27; // eax
  int v28; // ebx
  float v29; // ecx
  double v30; // st7
  float v31; // et1
  float v32; // et1
  double v33; // st7
  float v34; // et1
  float v35; // et1
  double v36; // st7
  float v37; // et1
  int v38; // eax
  float v39; // et1
  int v40; // edi
  int v41; // eax
  int v42; // ebx
  float v43; // edx
  float v44; // [esp+8h] [ebp-5Ch]
  float v45; // [esp+8h] [ebp-5Ch]
  float v46; // [esp+8h] [ebp-5Ch]
  float v47; // [esp+8h] [ebp-5Ch]
  float v48; // [esp+1Ch] [ebp-48h]
  float v49; // [esp+1Ch] [ebp-48h]
  float v50; // [esp+20h] [ebp-44h]
  float v51; // [esp+20h] [ebp-44h]
  int v52; // [esp+24h] [ebp-40h]
  int v53; // [esp+24h] [ebp-40h]
  float v54; // [esp+24h] [ebp-40h]
  float v55; // [esp+24h] [ebp-40h]
  float v56; // [esp+28h] [ebp-3Ch]
  float v57; // [esp+28h] [ebp-3Ch]
  float v58; // [esp+28h] [ebp-3Ch]
  float a1c; // [esp+2Ch] [ebp-38h]
  int a1a; // [esp+2Ch] [ebp-38h]
  int a1b; // [esp+2Ch] [ebp-38h]
  float v62; // [esp+30h] [ebp-34h]
  float v63; // [esp+34h] [ebp-30h]
  int v64; // [esp+38h] [ebp-2Ch]
  int v65; // [esp+38h] [ebp-2Ch]
  float v66; // [esp+38h] [ebp-2Ch]
  int v67; // [esp+38h] [ebp-2Ch]
  int v68; // [esp+38h] [ebp-2Ch]
  float v69; // [esp+3Ch] [ebp-28h]
  float v70; // [esp+3Ch] [ebp-28h]
  float v71; // [esp+40h] [ebp-24h]
  float v72; // [esp+40h] [ebp-24h]
  double v73; // [esp+44h] [ebp-20h]
  float v74; // [esp+4Ch] [ebp-18h]
  float v75; // [esp+50h] [ebp-14h]
  float4 a4a; // [esp+54h] [ebp-10h]

  v44 = a1->field_0 * 0.043478262;
  v4 = sub_419A70(v44);
  v45 = a1->field_4 * 0.043478262;
  v5 = sub_419A70(v45);
  v46 = a1->field_8 * 0.043478262;
  v6 = COERCE_FLOAT(sub_419A70(v46));
  v7 = a1->field_C * 0.043478262;
  v74 = v6;
  v47 = v7;
  v8 = sub_419A70(v47);
  if ( v4 < 0 || v4 >= 256 || v5 < 0 || v5 >= 256 )
    return 0;
  if ( v4 == LODWORD(v74) )
  {
    v52 = -1;
    if ( a1->field_C >= (double)a1->field_4 )
      v52 = 1;
    v64 = v8 + v52;
    if ( v5 != v8 + v52 )
    {
      while ( !sub_57C9A0(v4, v5, a1, &a4a, a4) )
      {
        v5 += v52;
        if ( v5 == v64 )
          return 1;
      }
      if ( a2 )
      {
        v10 = a4a.field_4;
        a2->field_0 = a4a.field_0;
        a2->field_4 = v10;
      }
LABEL_14:
      if ( a3 )
      {
        a3->field_0 = v4;
        a3->field_4 = v5;
      }
      return 0;
    }
  }
  else
  {
    v11 = a1->field_8;
    if ( v5 == v8 )
    {
      if ( v11 >= a1->field_0 )
        v12 = 1;
      else
        v12 = -1;
      v53 = v12;
      v65 = LODWORD(v74) + v12;
      if ( v4 != LODWORD(v74) + v12 )
      {
        while ( !sub_57C9A0(v4, v5, a1, &a4a, a4) )
        {
          v4 += v53;
          if ( v4 == v65 )
            return 1;
        }
        if ( a2 )
        {
          v13 = a4a.field_4;
          a2->field_0 = a4a.field_0;
          a2->field_4 = v13;
        }
        goto LABEL_14;
      }
    }
    else
    {
      a1c = v11 - a1->field_0;
      v14 = a1->field_C - a1->field_4;
      v56 = v14;
      v62 = v14 / a1c;
      v63 = a1->field_4 - v56 * a1->field_0 / a1c;
      v66 = sub_419A10(a1c);
      if ( sub_419A10(v56) >= v66 )
      {
        if ( a1->field_0 >= (double)a1->field_8 )
        {
          v58 = a1->field_8;
          v55 = a1->field_0;
          v51 = -1.0;
        }
        else
        {
          v58 = a1->field_0;
          v55 = a1->field_8;
          v51 = 1.0;
        }
        v49 = 1.0;
        if ( a1->field_4 >= (double)a1->field_C )
          v49 = -1.0;
        v30 = a1->field_0;
        if ( v30 <= v55 )
        {
          while ( v30 >= v58 )
          {
            v31 = *(float *)&byte_587000[264364];
            modf(v30 / v31, &v73);
            v32 = *(float *)&byte_587000[264364];
            v33 = sub_419AF0(v32 * v73);
            if ( v51 <= *(double *)&byte_581450[9568] )
            {
              v70 = v33;
              v35 = *(float *)&byte_587000[264364];
              v74 = v33 + v35;
            }
            else
            {
              v74 = v33;
              v34 = *(float *)&byte_587000[264364];
              v70 = v33 + v34;
            }
            a1b = sub_419B10(v73);
            v36 = v74 * v62 + v63;
            if ( v49 > *(double *)&byte_581450[9568] && v36 < a1->field_4
              || v49 < *(double *)&byte_581450[9568] && v36 > a1->field_4 )
            {
              v36 = a1->field_4;
            }
            v72 = v70 * v62 + v63;
            if ( v49 > *(double *)&byte_581450[9568] && v72 > (double)a1->field_C
              || v49 < *(double *)&byte_581450[9568] && v72 < (double)a1->field_C )
            {
              v72 = a1->field_C;
            }
            v37 = *(float *)&byte_587000[264364];
            modf(v36 / v37, &v73);
            v38 = sub_419B10(v73 - v49);
            v39 = *(float *)&byte_587000[264364];
            v40 = v38;
            modf(v72 / v39, &v73);
            v41 = sub_419B10(v49 + v73);
            v42 = v40 >= v41 ? -1 : 1;
            v68 = v42 + v41;
            if ( v40 != v42 + v41 )
            {
              while ( !sub_57C9A0(a1b, v40, a1, &a4a, a4) )
              {
                v40 += v42;
                if ( v40 == v68 )
                  goto LABEL_80;
              }
              if ( a2 )
              {
                v43 = a4a.field_4;
                a2->field_0 = a4a.field_0;
                a2->field_4 = v43;
              }
              if ( a3 )
              {
                a3->field_4 = v40;
                a3->field_0 = a1b;
                return 0;
              }
              return 0;
            }
LABEL_80:
            v30 = v51 * 0.1 + v70;
            if ( v30 > v55 )
              return 1;
          }
        }
      }
      else
      {
        if ( a1->field_4 >= (double)a1->field_C )
        {
          v57 = a1->field_C;
          v54 = a1->field_4;
          v50 = -1.0;
        }
        else
        {
          v57 = a1->field_4;
          v54 = a1->field_C;
          v50 = 1.0;
        }
        v48 = 1.0;
        if ( a1->field_0 >= (double)a1->field_8 )
          v48 = -1.0;
        v15 = a1->field_4;
        if ( v15 <= v54 )
        {
          while ( v15 >= v57 )
          {
            v16 = *(float *)&byte_587000[264364];
            modf(v15 / v16, &v73);
            v17 = *(float *)&byte_587000[264364];
            v18 = v17 * v73;
            if ( v50 <= *(double *)&byte_581450[9568] )
            {
              v20 = sub_419AF0(v18);
              v71 = v20;
              v21 = *(float *)&byte_587000[264364];
              v75 = v20 + v21;
            }
            else
            {
              v75 = sub_419AF0(v18);
              v19 = *(float *)&byte_587000[264364];
              v71 = v19 + v75;
            }
            a1a = sub_419B10(v73);
            v22 = (v75 - v63) / v62;
            if ( v48 > *(double *)&byte_581450[9568] && v22 < a1->field_0
              || v48 < *(double *)&byte_581450[9568] && v22 > a1->field_0 )
            {
              v22 = a1->field_0;
            }
            v69 = (v71 - v63) / v62;
            if ( v48 > *(double *)&byte_581450[9568] && v69 > (double)a1->field_8
              || v48 < *(double *)&byte_581450[9568] && v69 < (double)a1->field_8 )
            {
              v69 = a1->field_8;
            }
            v23 = *(float *)&byte_587000[264364];
            modf(v22 / v23, &v73);
            v24 = sub_419B10(v73 - v48);
            v25 = *(float *)&byte_587000[264364];
            v26 = v24;
            modf(v69 / v25, &v73);
            v27 = sub_419B10(v48 + v73);
            v28 = v26 >= v27 ? -1 : 1;
            v67 = v28 + v27;
            if ( v26 != v28 + v27 )
            {
              while ( !sub_57C9A0(v26, a1a, a1, &a4a, a4) )
              {
                v26 += v28;
                if ( v26 == v67 )
                  goto LABEL_51;
              }
              if ( a2 )
              {
                v29 = a4a.field_4;
                a2->field_0 = a4a.field_0;
                a2->field_4 = v29;
              }
              if ( a3 )
              {
                a3->field_0 = v26;
                a3->field_4 = a1a;
                return 0;
              }
              return 0;
            }
LABEL_51:
            v15 = v50 * 0.1 + v71;
            if ( v15 > v54 )
              return 1;
          }
        }
      }
    }
  }
  return 1;
}

//----- (00535960) --------------------------------------------------------
void sub_535960()
{
  srand(0x8A2u);
}

//----- (00535970) --------------------------------------------------------
int __cdecl sub_535970(int a1, int a2, char *a3)
{
  sscanf(a3, (const char *)&byte_587000[268084], a1 + 44);
  return 1;
}

//----- (00535990) --------------------------------------------------------
int __cdecl sub_535990(int a1, int a2, char *a3)
{
  return sub_423AD0((shape *)(a1 + 60), a3);
}

//----- (005359B0) --------------------------------------------------------
int __cdecl sub_5359B0(int a1, int a2, char *a3)
{
  int v5; // [esp+0h] [ebp-4h]

  sscanf(a3, (const char *)&byte_587000[268088], &v5, &a3);
  if ( (int)a3 < (int)v5 )
    a3 = v5;
  *(float *)(a1 + 112) = (double)(int)v5;
  *(float *)(a1 + 116) = (double)(int)a3;
  return 1;
}

//----- (00535A00) --------------------------------------------------------
int __cdecl sub_535A00(int a1, int a2, char *a3)
{
  sscanf(a3, (const char *)&byte_587000[268096], a1 + 48);
  return 1;
}

//----- (00535A20) --------------------------------------------------------
int __cdecl sub_535A20(int a1, int a2, char *a3)
{
  double v3; // st7

  sscanf(a3, (const char *)&byte_587000[268100], &a3);
  v3 = (double)(int)a3 * 0.03125;
  *(_DWORD *)(a1 + 132) = 0;
  *(float *)(a1 + 124) = v3;
  *(float *)(a1 + 128) = v3;
  return 1;
}

//----- (00535A60) --------------------------------------------------------
int __cdecl sub_535A60(int a1, int a2, char *a3)
{
  int result; // eax

  sscanf(a3, (const char *)&byte_587000[268104], &a3);
  if ( *(_DWORD *)(a1 + 136) )
    free(*(LPVOID *)(a1 + 136));
  result = (int)nox_calloc(1u, 0x14u);
  *(_DWORD *)(a1 + 136) = result;
  if ( result )
  {
    *(_WORD *)(result + 4) = (_WORD)a3;
    **(_WORD **)(a1 + 136) = (_WORD)a3;
    result = 1;
  }
  return result;
}

//----- (00535AD0) --------------------------------------------------------
int __cdecl sub_535AD0(int a1, int a2, const char *a3)
{
  *(_DWORD *)(a1 + 32) = 0;
  sub_423930(a3, (_DWORD *)(a1 + 32), (const char **)&byte_587000[264368]);
  return 1;
}

//----- (00535B00) --------------------------------------------------------
int __cdecl sub_535B00(int a1, int a2, const char *a3)
{
  *(_DWORD *)(a1 + 24) = 0;
  sub_423930(a3, (_DWORD *)(a1 + 24), (const char **)&byte_587000[264500]);
  return 1;
}

//----- (00535B30) --------------------------------------------------------
int __cdecl sub_535B30(int a1, int a2, const char *a3)
{
  *(_DWORD *)(a1 + 28) = 0;
  sub_423A10(a3, (_DWORD *)(a1 + 28));
  return 1;
}

//----- (00535B60) --------------------------------------------------------
int __cdecl sub_535B60(int a1, int a2, char *a3)
{
  sscanf(a3, (const char *)&byte_587000[268108], a1 + 56);
  return 1;
}

//----- (00535B80) --------------------------------------------------------
int __cdecl sub_535B80(int a1, int a2, char *a3)
{
  sscanf(a3, (const char *)&byte_587000[268112], &a3);
  *(_WORD *)(a1 + 122) = (_WORD)a3;
  return 1;
}

//----- (00535BB0) --------------------------------------------------------
int __cdecl sub_535BB0(int a1, int a2, char *a3)
{
  sscanf(a3, (const char *)&byte_587000[268116], &a3);
  *(_BYTE *)(a1 + 120) = (_BYTE)a3;
  return 1;
}

//----- (00535BE0) --------------------------------------------------------
int __cdecl sub_535BE0(int a1, int a2, const char *a3)
{
  int v4; // [esp+0h] [ebp-4h]

  v4 = 0;
  sub_423930(a3, &v4, (const char **)&byte_587000[265912]);
  *(_WORD *)(a1 + 40) = v4;
  return 1;
}

//----- (00535C20) --------------------------------------------------------
int sub_535C20(int a1, int a2, char *a3)
{
  return 1;
}

//----- (00535C30) --------------------------------------------------------
int __cdecl sub_535C30(int a1, int a2, char *a3)
{
  int v2; // edx

  *(_DWORD *)(a1 + 12) = **(_DWORD **)(a2 + 8);
  v2 = *(_DWORD *)(a2 + 8) + 4;
  *(_DWORD *)(a2 + 8) = v2;
  if ( *(int *)(a1 + 12) == -1 )
  {
    *(_DWORD *)(a2 + 8) = v2 + 1;
    *(_DWORD *)(a2 + 8) = *(unsigned __int8 *)(v2 + 1) + v2 + 1 + 1;
  }
  return 1;
}

//----- (00535C80) --------------------------------------------------------
int __cdecl sub_535C80(int a1, int a2)
{
  int *v2; // ecx
  int v3; // edx
  int v4; // ecx
  unsigned __int8 *v5; // ecx

  v2 = *(int **)(a2 + 8);
  v3 = *v2;
  v4 = (int)(v2 + 1);
  *(_DWORD *)(a2 + 8) = v4;
  if ( v3 == -1 )
  {
    v5 = (unsigned __int8 *)(v4 + 1);
    *(_DWORD *)(a2 + 8) = v5;
    *(_DWORD *)(a2 + 8) = &v5[*v5 + 1];
  }
  return 1;
}

//----- (00535CC0) --------------------------------------------------------
void sub_535CC0()
{
  srand(0x8A3u);
}

//----- (00535CD0) --------------------------------------------------------
int __cdecl sub_535CD0(int a1, _DWORD *a2, void *a3)
{
  _DWORD *v3; // ebp
  void *v4; // ebx
  unsigned __int8 *v5; // eax
  int result; // eax
  int v7; // esi
  char *v8; // eax
  _DWORD *v9; // eax
  int v10; // ecx
  char *v11; // eax
  int v12; // edi
  unsigned __int8 *v13; // eax
  int v14; // edi
  char *v15; // esi
  unsigned __int8 *v16; // eax
  int i; // eax
  char *v18; // ecx
  char v19; // dl
  char *v20; // eax
  char v21; // cl
  char *v22; // eax
  char v23; // cl
  unsigned __int8 *v24; // eax
  int v25; // esi
  int *v26; // eax
  int v27; // ecx
  int v28; // eax
  unsigned __int8 *v29; // eax
  unsigned __int8 v30; // di
  _DWORD *v31; // eax
  int v32; // ecx
  unsigned __int8 *v33; // eax
  const char **v34; // ecx
  unsigned __int8 *v35; // eax
  unsigned __int8 v36; // cl
  char v37; // cl
  int v38; // esi
  int *v39; // ecx
  int v40; // edx
  int v41; // ecx
  unsigned __int8 *v42; // ecx
  int v43; // [esp-14h] [ebp-2Ch]
  _DWORD *v44; // [esp-4h] [ebp-1Ch]
  int v45; // [esp+10h] [ebp-8h]
  int v46; // [esp+14h] [ebp-4h]
  char *v47; // [esp+1Ch] [ebp+4h]
  unsigned __int8 v48; // [esp+1Ch] [ebp+4h]
  unsigned __int8 v49; // [esp+20h] [ebp+8h]
  unsigned __int8 v50; // [esp+20h] [ebp+8h]
  unsigned __int8 v51; // [esp+20h] [ebp+8h]
  unsigned __int8 v52; // [esp+20h] [ebp+8h]
  unsigned __int8 v53; // [esp+20h] [ebp+8h]
  unsigned __int8 v54; // [esp+20h] [ebp+8h]
  unsigned __int8 v55; // [esp+20h] [ebp+8h]
  int v56; // [esp+24h] [ebp+Ch]
  int v57; // [esp+24h] [ebp+Ch]

  v3 = a2;
  v4 = a3;
  v5 = (unsigned __int8 *)a2[2];
  v44 = a2;
  v49 = *v5;
  v44[2] = v5 + 1;
  sub_40ACC0(a3, 1u, v49, (int)v44);
  *((_BYTE *)a3 + v49) = 0;
  sub_40AD60((char *)&v45, 4, 1, v3);
  result = 0;
  if ( !strcmp((const char *)a3, (const char *)&byte_587000[269064]) )
  {
    v7 = *(_DWORD *)(a1 + 192);
    if ( !v7 )
      return result;
    v8 = (char *)nox_calloc(1u, 0x100u);
    v47 = v8;
    if ( !v8 )
      return 0;
    *(_DWORD *)(v7 + 476) = v8;
    while ( 1 )
    {
      v9 = (_DWORD *)v3[2];
      v10 = *v9;
      v11 = (char *)(v9 + 1);
      v3[2] = v11;
      if ( v10 != 1398030676 )
        break;
      v12 = *v11;
      v13 = (unsigned __int8 *)(v11 + 1);
      v3[2] = v13;
      if ( v12 >= 16 )
        return 0;
      v50 = *v13;
      v3[2] = v13 + 1;
      sub_40ACC0(v4, 1u, v50, (int)v3);
      *((_BYTE *)v4 + v50) = 0;
      v14 = 16 * v12;
      v15 = &v47[v14];
      v56 = (int)&v47[v14];
      *(_DWORD *)&v47[v14] = sub_40AF50(v4);
      v16 = (unsigned __int8 *)v3[2];
      v51 = *v16;
      v3[2] = v16 + 1;
      for ( i = 0; i < v51; ++i )
      {
        v18 = (char *)v3[2];
        v19 = *v18;
        v3[2] = v18 + 1;
        v15[i + 4] = v19;
      }
      v15[8] = i;
      v20 = (char *)v3[2];
      v21 = *v20;
      v3[2] = v20 + 1;
      v15[9] = v21;
      v22 = (char *)v3[2];
      v23 = *v22;
      v3[2] = v22 + 1;
      v15[10] = v23;
      v24 = (unsigned __int8 *)v3[2];
      v52 = *v24;
      v3[2] = v24 + 1;
      sub_40ACC0(v4, 1u, v52, (int)v3);
      *((_BYTE *)v4 + v52) = 0;
      *(_DWORD *)(v56 + 12) = !strcmp((const char *)v4, (const char *)&byte_587000[269076])
                           || !strcmp((const char *)v4, (const char *)&byte_587000[269084]);
      v45 = 8 * *(unsigned __int8 *)(v56 + 9);
      if ( v45 > 0 )
      {
        v25 = v45;
        do
        {
          v26 = (int *)v3[2];
          v27 = *v26;
          v28 = (int)(v26 + 1);
          v3[2] = v28;
          if ( v27 == -1 )
          {
            v29 = (unsigned __int8 *)(v28 + 1);
            v3[2] = v29;
            v3[2] = &v29[*v29 + 1];
          }
          --v25;
        }
        while ( v25 );
      }
    }
  }
  else
  {
    if ( !strcmp((const char *)a3, (const char *)&byte_587000[269096]) )
    {
      v3[2] += v45;
      return 1;
    }
    if ( !strcmp((const char *)a3, (const char *)&byte_587000[269116]) )
    {
      v30 = a1;
      while ( 1 )
      {
        v31 = (_DWORD *)v3[2];
        v32 = *v31;
        v33 = (unsigned __int8 *)(v31 + 1);
        v3[2] = v33;
        if ( v32 == 1162757152 )
          break;
        if ( v32 == 1398030676 )
        {
          v53 = *v33;
          v3[2] = v33 + 1;
          sub_40ACC0(v4, 1u, v53, (int)v3);
          *((_BYTE *)v4 + v53) = 0;
          v57 = 0;
          v34 = (const char **)&byte_587000[268120];
          do
          {
            if ( !strcmp(*v34, (const char *)v4) )
              break;
            ++v34;
            ++v57;
          }
          while ( (int)v34 < (int)&byte_587000[268340] );
          if ( v57 == 55 )
            return 0;
          v35 = (unsigned __int8 *)v3[2];
          v36 = *v35++;
          v3[2] = v35;
          v48 = v36;
          v37 = *v35++;
          v3[2] = v35;
          LOBYTE(v46) = v37;
          v54 = *v35;
          v3[2] = v35 + 1;
          sub_40ACC0(v4, 1u, v54, (int)v3);
          v30 = v48;
          v43 = (unsigned __int8)v46;
          *((_BYTE *)v4 + v54) = 0;
          sub_4F9FB0(v57, v48, v43);
        }
        else if ( v32 == 1397051733 )
        {
          v55 = *v33;
          v3[2] = v33 + 1;
          sub_40ACC0(v4, 1u, v55, (int)v3);
          *((_BYTE *)v4 + v55) = 0;
          v45 = 8 * v30;
          if ( 8 * v30 > 0 )
          {
            v38 = 8 * v30;
            do
            {
              v39 = (int *)v3[2];
              v40 = *v39;
              v41 = (int)(v39 + 1);
              v3[2] = v41;
              if ( v40 == -1 )
              {
                v42 = (unsigned __int8 *)(v41 + 1);
                v3[2] = v42;
                v3[2] = &v42[*v42 + 1];
              }
              --v38;
            }
            while ( v38 );
          }
        }
      }
    }
    else
    {
      v3[2] += v45;
    }
  }
  return 1;
}

//----- (005360A0) --------------------------------------------------------
int __cdecl sub_5360A0(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi

  v3 = strtok(a3, (const char *)&byte_587000[269772]);
  v4 = *(const char **)&byte_587000[269128];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[269128] )
  {
    v6 = &byte_587000[269128];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 2);
      v6 += 8;
      ++v5;
    }
    while ( v4 );
  }
  if ( !*(_DWORD *)&byte_587000[8 * v5 + 269128] )
    return 0;
  *(_DWORD *)(a1 + 212) = *(_DWORD *)&byte_587000[8 * v5 + 269132];
  return 1;
}

//----- (00536130) --------------------------------------------------------
char *__cdecl sub_536130(char *a1, int *a2)
{
  char *result; // eax
  int v3; // eax
  char *v4; // eax

  result = strtok(a1, (const char *)&byte_587000[270252]);
  if ( result )
  {
    v3 = sub_424880(result);
    *a2 = v3;
    if ( v3 == -1 )
    {
      result = 0;
    }
    else
    {
      v4 = strtok(0, (const char *)&byte_587000[270256]);
      a2[1] = atoi(v4);
      result = (char *)1;
    }
  }
  return result;
}

//----- (00536180) --------------------------------------------------------
char *__cdecl sub_536180(char *a1, int *a2)
{
  char *result; // eax

  result = strtok(a1, (const char *)&byte_587000[270260]);
  if ( result )
  {
    *a2 = sub_4243F0(result);
    result = (char *)1;
  }
  return result;
}

//----- (005361B0) --------------------------------------------------------
char *__cdecl sub_5361B0(char *a1, int a2)
{
  char *result; // eax
  char v3; // al
  double v4; // [esp+4h] [ebp-8h]

  *(_DWORD *)a2 = 1;
  result = strtok(a1, (const char *)&byte_587000[270264]);
  if ( result )
  {
    v3 = atoi(result);
    *(_BYTE *)(a2 + 109) = v3;
    *(_BYTE *)(a2 + 108) = v3;
    *(_DWORD *)(a2 + 112) = 100;
    result = strtok(0, (const char *)&byte_587000[270268]);
    if ( result )
    {
      v4 = (double)*(unsigned int *)&byte_5D4594[2649704];
      *(_DWORD *)(a2 + 100) = (__int64)(v4 / atof(result));
      result = strtok(0, (const char *)&byte_587000[270272]);
      if ( result )
      {
        *(_DWORD *)(a2 + 92) = sub_4243F0(result);
        result = (char *)1;
      }
    }
  }
  return result;
}

//----- (00536260) --------------------------------------------------------
char *__cdecl sub_536260(char *a1, int a2)
{
  char *result; // eax
  char v3; // al
  char *v4; // eax
  int v5; // eax
  char *v6; // eax
  double v7; // [esp+Ch] [ebp-8h]

  *(_DWORD *)a2 = 0;
  result = strtok(a1, (const char *)&byte_587000[270276]);
  if ( result )
  {
    v3 = atoi(result);
    *(_BYTE *)(a2 + 109) = v3;
    *(_BYTE *)(a2 + 108) = v3;
    *(_DWORD *)(a2 + 112) = 100;
    result = strtok(0, (const char *)&byte_587000[270280]);
    if ( result )
    {
      strcpy((char *)(a2 + 4), result);
      *(_DWORD *)(a2 + 84) = 0;
      result = strtok(0, (const char *)&byte_587000[270284]);
      if ( result )
      {
        v7 = (double)*(unsigned int *)&byte_5D4594[2649704];
        *(_DWORD *)(a2 + 100) = (__int64)(v7 / atof(result));
        v4 = strtok(0, (const char *)&byte_587000[270288]);
        if ( v4 && !strcmp(v4, (const char *)&byte_587000[270292]) )
        {
          v5 = *(_DWORD *)(a2 + 96);
          LOBYTE(v5) = v5 | 1;
          *(_DWORD *)(a2 + 96) = v5;
        }
        v6 = strtok(0, (const char *)&byte_587000[270304]);
        if ( v6 )
          *(_DWORD *)(a2 + 88) = sub_40AF50(v6);
        result = (char *)1;
      }
    }
  }
  return result;
}

//----- (00536390) --------------------------------------------------------
char *__cdecl sub_536390(char *a1, int *a2)
{
  char *result; // eax

  result = strtok(a1, (const char *)&byte_587000[270308]);
  if ( result )
  {
    *a2 = atoi(result);
    result = (char *)1;
  }
  return result;
}

//----- (005363C0) --------------------------------------------------------
char *__cdecl sub_5363C0(char *a1, int *a2)
{
  char *result; // eax

  result = strtok(a1, (const char *)&byte_587000[270312]);
  if ( result )
  {
    *a2 = atoi(result);
    result = (char *)1;
  }
  return result;
}

//----- (005363F0) --------------------------------------------------------
int __cdecl sub_5363F0(_DWORD *a1, int a2, char *a3)
{
  char *v3; // ebx
  const char *v4; // eax
  int v5; // ebp
  unsigned __int8 *v6; // edi
  int v7; // ebp
  int result; // eax
  int (__cdecl *v9)(char *, int); // esi
  char *v10; // [esp+1Ch] [ebp+Ch]

  v3 = strtok(a3, (const char *)&byte_587000[270316]);
  v10 = strtok(0, (const char *)&byte_5D4594[2488564]);
  v4 = *(const char **)&byte_587000[269784];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[269784] )
  {
    v6 = &byte_587000[269784];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 4);
      v6 += 16;
      ++v5;
    }
    while ( v4 );
  }
  v7 = 16 * v5;
  if ( !*(_DWORD *)&byte_587000[v7 + 269784] )
    goto LABEL_13;
  a1[50] = *(_DWORD *)&byte_587000[v7 + 269788];
  a1[52] = *(_DWORD *)&byte_587000[v7 + 269792];
  if ( !*(_DWORD *)&byte_587000[v7 + 269792] )
    goto LABEL_13;
  result = (int)nox_calloc(1u, *(_DWORD *)&byte_587000[v7 + 269792]);
  a1[51] = result;
  if ( !result )
    return result;
  v9 = *(int (__cdecl **)(char *, int))&byte_587000[v7 + 269796];
  if ( v9 )
    result = v9(v10, result);
  else
LABEL_13:
    result = 1;
  return result;
}

//----- (005364E0) --------------------------------------------------------
int __cdecl sub_5364E0(char *a1, int a2)
{
  unsigned int v2; // ecx
  char v3; // al
  char *v4; // edi
  char *v5; // esi
  int result; // eax
  char v7[256]; // [esp+Ch] [ebp-100h]

  sscanf(a1, (const char *)&byte_587000[272308], v7);
  v2 = strlen(v7) + 1;
  v3 = v2;
  v2 >>= 2;
  qmemcpy((void *)(a2 + 16), v7, 4 * v2);
  v5 = &v7[4 * v2];
  v4 = (char *)(a2 + 16 + 4 * v2);
  LOBYTE(v2) = v3;
  result = 1;
  qmemcpy(v4, v5, v2 & 3);
  *(_DWORD *)(a2 + 12) = 0;
  return result;
}
// 5364E0: using guessed type char var_100[256];

//----- (00536550) --------------------------------------------------------
int __cdecl sub_536550(char *a1, _DWORD *a2)
{
  sscanf(a1, (const char *)&byte_587000[272312], a2, a2 + 2);
  a2[1] = *a2;
  return 1;
}

//----- (00536580) --------------------------------------------------------
int __cdecl sub_536580(char *a1, int a2)
{
  sscanf(a1, (const char *)&byte_587000[272320], a2, a2 + 4, a2 + 8);
  return 1;
}

//----- (005365B0) --------------------------------------------------------
int __cdecl sub_5365B0(char *a1, int a2)
{
  char *v2; // eax
  char *v3; // eax

  v2 = strtok(a1, (const char *)&byte_587000[272332]);
  if ( v2 )
    *(_DWORD *)(a2 + 36) = sub_40AF50(v2);
  v3 = strtok(0, (const char *)&byte_587000[272336]);
  if ( v3 )
    *(_DWORD *)(a2 + 40) = sub_40AF50(v3);
  return 1;
}

//----- (00536600) --------------------------------------------------------
int __cdecl sub_536600(char *a1, int a2)
{
  sscanf(a1, (const char *)&byte_587000[272340], a2);
  return 1;
}

//----- (00536620) --------------------------------------------------------
int __cdecl sub_536620(_DWORD *a1, int a2, char *a3)
{
  char *v3; // ebx
  const char *v4; // eax
  int v5; // ebp
  unsigned __int8 *v6; // edi
  int v7; // ebp
  int result; // eax
  int (__cdecl *v9)(char *, int); // esi
  char *v10; // [esp+1Ch] [ebp+Ch]

  v3 = strtok(a3, (const char *)&byte_587000[272344]);
  v10 = strtok(0, (const char *)&byte_5D4594[2488568]);
  v4 = *(const char **)&byte_587000[270328];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[270328] )
  {
    v6 = &byte_587000[270328];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 4);
      v6 += 16;
      ++v5;
    }
    while ( v4 );
  }
  v7 = 16 * v5;
  if ( !*(_DWORD *)&byte_587000[v7 + 270328] )
    goto LABEL_13;
  a1[47] = *(_DWORD *)&byte_587000[v7 + 270332];
  a1[49] = *(_DWORD *)&byte_587000[v7 + 270336];
  if ( !*(_DWORD *)&byte_587000[v7 + 270336] )
    goto LABEL_13;
  result = (int)nox_calloc(1u, *(_DWORD *)&byte_587000[v7 + 270336]);
  a1[48] = result;
  if ( !result )
    return result;
  v9 = *(int (__cdecl **)(char *, int))&byte_587000[v7 + 270340];
  if ( v9 )
    result = v9(v10, result);
  else
LABEL_13:
    result = 1;
  return result;
}

//----- (00536710) --------------------------------------------------------
int __cdecl sub_536710(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi
  void (__cdecl *v7)(int); // eax

  v3 = strtok(a3, (const char *)&byte_587000[272792]);
  v4 = *(const char **)&byte_587000[272352];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[272352] )
  {
    v6 = &byte_587000[272352];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 3);
      v6 += 12;
      ++v5;
    }
    while ( v4 );
  }
  if ( *(_DWORD *)&byte_587000[12 * v5 + 272352] )
  {
    *(_DWORD *)(a1 + 184) = *(_DWORD *)&byte_587000[12 * v5 + 272356];
    v7 = *(void (__cdecl **)(int))&byte_587000[12 * v5 + 272360];
    if ( v7 )
      v7(a1);
  }
  return 1;
}

//----- (005367B0) --------------------------------------------------------
char *__cdecl sub_5367B0(__int16 *a1)
{
  unsigned __int8 *v1; // eax
  int v2; // ecx
  char *result; // eax
  unsigned __int8 *i; // esi
  __int16 v5; // dx

  if ( !*(_DWORD *)&byte_5D4594[2488572] )
  {
    v1 = &byte_5D4594[3815404];
    v2 = 51;
    do
    {
      *(_WORD *)v1 = -1;
      *((_WORD *)v1 + 1) = 0;
      v1 += 4;
      --v2;
    }
    while ( v2 );
    *(_DWORD *)&byte_5D4594[2488572] = 1;
  }
  result = 0;
  for ( i = &byte_5D4594[3815404]; *(short *)i != -1; i += 4 )
  {
    if ( (int)++result >= 50 )
      return result;
  }
  result = strtok(0, (const char *)&byte_587000[272800]);
  if ( result && *result )
  {
    result = (char *)sub_40AF50(result);
    if ( (_WORD)result )
    {
      v5 = *a1;
      *((_WORD *)i + 1) = (_WORD)result;
      *(_WORD *)i = v5;
    }
  }
  return result;
}

//----- (00536830) --------------------------------------------------------
int __cdecl sub_536830(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi

  v3 = strtok(a3, (const char *)&byte_587000[273100]);
  v4 = *(const char **)&byte_587000[272808];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[272808] )
  {
    v6 = &byte_587000[272808];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 3);
      v6 += 12;
      ++v5;
    }
    while ( v4 );
  }
  if ( *(_DWORD *)&byte_587000[12 * v5 + 272808] )
    *(_DWORD *)(a1 + 216) = *(_DWORD *)&byte_587000[12 * v5 + 272812];
  return 1;
}

//----- (005368C0) --------------------------------------------------------
int __cdecl sub_5368C0(char *a1, int a2)
{
  int *v2; // esi
  char *v3; // eax
  char *v4; // eax

  v2 = *(int **)(a2 + 176);
  v3 = strtok(a1, (const char *)&byte_587000[273752]);
  *v2 = atoi(v3);
  v4 = strtok(0, (const char *)&byte_587000[273756]);
  v2[1] = atoi(v4);
  return 1;
}

//----- (00536910) --------------------------------------------------------
int __cdecl sub_536910(int a1, int a2)
{
  *(_DWORD *)(a2 + 36) = 2;
  return 1;
}

//----- (00536930) --------------------------------------------------------
int __cdecl sub_536930(_DWORD *a1, int a2, char *a3)
{
  char *v3; // ebx
  const char *v4; // eax
  int v5; // ebp
  unsigned __int8 *v6; // edi
  int v7; // ebp
  int result; // eax
  int (__cdecl *v9)(char *, _DWORD *); // esi
  char *v10; // [esp+1Ch] [ebp+Ch]

  v3 = strtok(a3, (const char *)&byte_587000[273760]);
  v10 = strtok(0, (const char *)&byte_5D4594[2488576]);
  v4 = *(const char **)&byte_587000[273112];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[273112] )
  {
    v6 = &byte_587000[273112];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 4);
      v6 += 16;
      ++v5;
    }
    while ( v4 );
  }
  v7 = 16 * v5;
  if ( !*(_DWORD *)&byte_587000[v7 + 273112] )
    goto LABEL_13;
  a1[43] = *(_DWORD *)&byte_587000[v7 + 273116];
  a1[45] = *(_DWORD *)&byte_587000[v7 + 273120];
  if ( !*(_DWORD *)&byte_587000[v7 + 273120] )
    goto LABEL_13;
  result = (int)nox_calloc(1u, *(_DWORD *)&byte_587000[v7 + 273120]);
  a1[44] = result;
  if ( !result )
    return result;
  v9 = *(int (__cdecl **)(char *, _DWORD *))&byte_587000[v7 + 273124];
  if ( v9 )
    result = v9(v10, a1);
  else
LABEL_13:
    result = 1;
  return result;
}

//----- (00536A20) --------------------------------------------------------
int __cdecl sub_536A20(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi
  void (__cdecl *v7)(int); // eax

  v3 = strtok(a3, (const char *)&byte_587000[274060]);
  v4 = *(const char **)&byte_587000[273768];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[273768] )
  {
    v6 = &byte_587000[273768];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 3);
      v6 += 12;
      ++v5;
    }
    while ( v4 );
  }
  if ( *(_DWORD *)&byte_587000[12 * v5 + 273768] )
  {
    *(_DWORD *)(a1 + 168) = *(_DWORD *)&byte_587000[12 * v5 + 273772];
    v7 = *(void (__cdecl **)(int))&byte_587000[12 * v5 + 273776];
    if ( v7 )
      v7(a1);
  }
  return 1;
}

//----- (00536AC0) --------------------------------------------------------
char *__cdecl sub_536AC0(__int16 *a1)
{
  unsigned __int8 *v1; // eax
  int v2; // ecx
  char *result; // eax
  unsigned __int8 *i; // esi
  __int16 v5; // dx

  if ( !*(_DWORD *)&byte_5D4594[2488580] )
  {
    v1 = &byte_5D4594[3815180];
    v2 = 51;
    do
    {
      *(_WORD *)v1 = -1;
      *((_WORD *)v1 + 1) = 0;
      v1 += 4;
      --v2;
    }
    while ( v2 );
    *(_DWORD *)&byte_5D4594[2488580] = 1;
  }
  result = 0;
  for ( i = &byte_5D4594[3815180]; *(short *)i != -1; i += 4 )
  {
    if ( (int)++result >= 50 )
      return result;
  }
  result = strtok(0, (const char *)&byte_587000[274068]);
  if ( result && *result )
  {
    result = (char *)sub_40AF50(result);
    if ( (_WORD)result )
    {
      v5 = *a1;
      *((_WORD *)i + 1) = (_WORD)result;
      *(_WORD *)i = v5;
    }
  }
  return result;
}

//----- (00536B40) --------------------------------------------------------
int __cdecl sub_536B40(char *a1, int a2)
{
  char v3[64]; // [esp+4h] [ebp-40h]

  sscanf(a1, (const char *)&byte_587000[274504], a2, v3);
  *(_DWORD *)(a2 + 128) = sub_40AF50(v3);
  return 1;
}

//----- (00536B80) --------------------------------------------------------
int __cdecl sub_536B80(int a1, int a2, char *a3)
{
  char *v3; // ebx
  const char *v4; // eax
  int v5; // ebp
  unsigned __int8 *v6; // edi
  int v7; // ebp
  int result; // eax
  int (__cdecl *v9)(char *, int); // esi
  char *v10; // [esp+1Ch] [ebp+Ch]

  v3 = strtok(a3, (const char *)&byte_587000[274512]);
  v10 = strtok(0, (const char *)&byte_5D4594[2488584]);
  v4 = *(const char **)&byte_587000[274080];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[274080] )
  {
    v6 = &byte_587000[274080];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 4);
      v6 += 16;
      ++v5;
    }
    while ( v4 );
  }
  v7 = 16 * v5;
  if ( !*(_DWORD *)&byte_587000[v7 + 274080] )
    return 0;
  *(_DWORD *)(a1 + 160) = *(_DWORD *)&byte_587000[v7 + 274084];
  if ( !*(_DWORD *)&byte_587000[v7 + 274088] )
    goto LABEL_14;
  result = (int)nox_calloc(1u, *(_DWORD *)&byte_587000[v7 + 274088]);
  *(_DWORD *)(a1 + 164) = result;
  if ( !result )
    return result;
  v9 = *(int (__cdecl **)(char *, int))&byte_587000[v7 + 274092];
  if ( v9 )
    result = v9(v10, result);
  else
LABEL_14:
    result = 1;
  return result;
}

//----- (00536C60) --------------------------------------------------------
int __cdecl sub_536C60(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi

  v3 = strtok(a3, (const char *)&byte_587000[274856]);
  v4 = *(const char **)&byte_587000[274520];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[274520] )
  {
    v6 = &byte_587000[274520];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 2);
      v6 += 8;
      ++v5;
    }
    while ( v4 );
  }
  if ( !*(_DWORD *)&byte_587000[8 * v5 + 274520] )
    return 0;
  *(_DWORD *)(a1 + 152) = *(_DWORD *)&byte_587000[8 * v5 + 274524];
  return 1;
}

//----- (00536CF0) --------------------------------------------------------
int __cdecl sub_536CF0(int a1, int a2, char *a3)
{
  char *v3; // eax
  const char *v4; // ecx
  int v5; // ebp
  unsigned __int8 *v6; // edi

  v3 = strtok(a3, (const char *)&byte_587000[274864]);
  v4 = *(const char **)&byte_587000[274616];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[274616] )
  {
    v6 = &byte_587000[274616];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 2);
      v6 += 8;
      ++v5;
    }
    while ( v4 );
  }
  if ( !*(_DWORD *)&byte_587000[8 * v5 + 274616] )
    return 0;
  *(_DWORD *)(a1 + 156) = *(_DWORD *)&byte_587000[8 * v5 + 274620];
  return 1;
}

//----- (00536D80) --------------------------------------------------------
int __cdecl sub_536D80(char *a1, int a2)
{
  sscanf(a1, (const char *)&byte_587000[276692], a2);
  return 1;
}

//----- (00536DA0) --------------------------------------------------------
BOOL __cdecl sub_536DA0(char *a1, int *a2)
{
  int v2; // eax
  char v4[256]; // [esp+0h] [ebp-100h]

  sscanf(a1, (const char *)&byte_587000[276696], v4);
  v2 = sub_40AF50(v4);
  *a2 = v2;
  return v2 != 0;
}

//----- (00536DE0) --------------------------------------------------------
int __cdecl sub_536DE0(char *a1, _BYTE *a2)
{
  sscanf(a1, (const char *)&byte_587000[276700], &a1);
  *a2 = (_BYTE)a1;
  return 1;
}

//----- (00536E10) --------------------------------------------------------
BOOL __cdecl sub_536E10(char *a1, int a2)
{
  char *v2; // eax
  char *v3; // eax
  int v4; // eax

  v2 = strtok(a1, (const char *)&byte_587000[276704]);
  *(_BYTE *)a2 = atoi(v2);
  v3 = strtok(0, (const char *)&byte_587000[276708]);
  v4 = sub_4E0A00(v3);
  *(_DWORD *)(a2 + 4) = v4;
  return v4 != 18;
}

//----- (00536E50) --------------------------------------------------------
int __cdecl sub_536E50(char *a1, _BYTE *a2)
{
  char *v2; // eax

  v2 = strtok(a1, (const char *)&byte_587000[276712]);
  *a2 = atoi(v2);
  return 1;
}

//----- (00536E80) --------------------------------------------------------
int __cdecl sub_536E80(char *a1, int *a2)
{
  char *v2; // eax
  char *v3; // eax

  v2 = strtok(a1, (const char *)&byte_587000[276716]);
  *a2 = atoi(v2);
  v3 = strtok(a1, (const char *)&byte_587000[276720]);
  a2[1] = atoi(v3);
  return 1;
}

//----- (00536EC0) --------------------------------------------------------
int __cdecl sub_536EC0(_DWORD *a1, int a2, char *a3)
{
  char *v3; // ebx
  const char *v4; // eax
  int v5; // ebp
  unsigned __int8 *v6; // edi
  int v7; // ebp
  int result; // eax
  int (__cdecl *v9)(char *, int); // esi
  char *v10; // [esp+1Ch] [ebp+Ch]

  v3 = strtok(a3, (const char *)&byte_587000[276724]);
  v10 = strtok(0, (const char *)&byte_5D4594[2488588]);
  v4 = *(const char **)&byte_587000[274872];
  v5 = 0;
  if ( *(_DWORD *)&byte_587000[274872] )
  {
    v6 = &byte_587000[274872];
    do
    {
      if ( !strcmp(v4, v3) )
        break;
      v4 = (const char *)*((_DWORD *)v6 + 4);
      v6 += 16;
      ++v5;
    }
    while ( v4 );
  }
  v7 = 16 * v5;
  if ( !*(_DWORD *)&byte_587000[v7 + 274872] )
    return 0;
  a1[35] = *(_DWORD *)&byte_587000[v7 + 274876];
  a1[37] = *(_DWORD *)&byte_587000[v7 + 274880];
  if ( !*(_DWORD *)&byte_587000[v7 + 274880] )
    goto LABEL_14;
  result = (int)nox_calloc(1u, *(_DWORD *)&byte_587000[v7 + 274880]);
  a1[36] = result;
  if ( !result )
    return result;
  v9 = *(int (__cdecl **)(char *, int))&byte_587000[v7 + 274884];
  if ( v9 )
    result = v9(v10, result);
  else
LABEL_14:
    result = 1;
  return result;
}

//----- (00536FB0) --------------------------------------------------------
BOOL __cdecl sub_536FB0(int a1, int a2, char a3)
{
  BOOL result; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax

  if ( !*(_DWORD *)&byte_5D4594[2488592] )
  {
    *(_DWORD *)&byte_5D4594[2488592] = sub_4E3AA0((CHAR *)&byte_587000[276736]);
    *(_DWORD *)&byte_5D4594[2488596] = sub_4E3AA0((CHAR *)&byte_587000[276744]);
    *(_DWORD *)&byte_5D4594[2488600] = sub_4E3AA0((CHAR *)&byte_587000[276752]);
  }
  if ( sub_4FF350(a1, 2) )
    return 0;
  if ( a3 & 1 || !sub_4FF350(a2, 0) )
    goto LABEL_10;
  if ( sub_40A5C0(4096) )
  {
    v4 = *(unsigned __int16 *)(a1 + 4);
    if ( (unsigned __int16)v4 == *(_DWORD *)&byte_5D4594[2488596] || v4 == *(_DWORD *)&byte_5D4594[2488600] )
      goto LABEL_10;
  }
  else if ( sub_4FF350(a1, 21) )
  {
    goto LABEL_10;
  }
  if ( *(unsigned __int16 *)(a1 + 4) != *(_DWORD *)&byte_5D4594[2488592]
    || (v6 = *(_DWORD *)(a1 + 508)) == 0
    || !sub_4FF350(v6, 21) )
  {
    if ( *(float *)&byte_587000[276732] >= fabs(*(float *)(a2 + 80))
      && *(float *)&byte_587000[276732] >= fabs(*(float *)(a2 + 84)) )
    {
      return 0;
    }
  }
LABEL_10:
  result = 1;
  if ( *(_BYTE *)(a1 + 8) & 2 )
  {
    v5 = *(_DWORD *)(a1 + 12);
    if ( v5 & 0x2000 )
    {
      if ( sub_4FC250(a2, 4) )
        result = 0;
    }
  }
  return result;
}

//----- (005370E0) --------------------------------------------------------
int __cdecl sub_5370E0(int a1, int a2, char a3)
{
  int result; // eax

  result = sub_536FB0(a1, a2, a3);
  if ( result )
    result = sub_537110(a1, a2);
  return result;
}

//----- (00537110) --------------------------------------------------------
int __cdecl sub_537110(int a1, int a2)
{
  int v2; // eax
  int v3; // esi
  int v4; // eax
  int result; // eax
  float4 a1a; // [esp+4h] [ebp-2Ch]
  int a3[7]; // [esp+14h] [ebp-1Ch]

  v2 = *(_DWORD *)(a1 + 56);
  a3[4] = *(_DWORD *)(a1 + 60);
  a3[3] = v2;
  if ( *(_BYTE *)(a2 + 8) < 0 && *(_BYTE *)(a2 + 12) & 4 )
  {
    v3 = *(_DWORD *)(a2 + 748);
    *(float *)&a3[5] = (double)(*(_DWORD *)&byte_587000[8 * *(_DWORD *)(v3 + 12) + 196184] / 2) + *(float *)(a2 + 56);
    *(float *)&a3[6] = (double)(*(_DWORD *)&byte_587000[8 * *(_DWORD *)(v3 + 12) + 196188] / 2) + *(float *)(a2 + 60);
  }
  else
  {
    v4 = *(_DWORD *)(a2 + 60);
    a3[5] = *(_DWORD *)(a2 + 56);
    a3[6] = v4;
  }
  if ( *(float *)&a3[3] >= (double)*(float *)&a3[5] )
  {
    a1a.field_8 = *(float *)&a3[3];
    LODWORD(a1a.field_0) = a3[5];
  }
  else
  {
    a1a.field_0 = *(float *)&a3[3];
    LODWORD(a1a.field_8) = a3[5];
  }
  if ( *(float *)&a3[4] >= (double)*(float *)&a3[6] )
  {
    a1a.field_C = *(float *)&a3[4];
    LODWORD(a1a.field_4) = a3[6];
  }
  else
  {
    a1a.field_4 = *(float *)&a3[4];
    LODWORD(a1a.field_C) = a3[6];
  }
  a3[2] = a2;
  a3[0] = 1;
  a3[1] = a1;
  sub_517C10(&a1a, sub_537230, (int)a3);
  if ( a3[0] )
    result = sub_535250((float4 *)&a3[3], 0, 0, 9);
  else
    result = 0;
  return result;
}

//----- (00537230) --------------------------------------------------------
void __cdecl sub_537230(float *a1, int arg4)
{
  int v2; // ecx
  int v3; // eax
  double v4; // st7
  int v5; // eax
  double v6; // st6
  double v7; // st7
  double v8; // st7
  double v9; // st7
  double v10; // st7
  float v11; // [esp+14h] [ebp-2Ch]
  float v12; // [esp+18h] [ebp-28h]
  float v13; // [esp+1Ch] [ebp-24h]
  float v14; // [esp+20h] [ebp-20h]
  float v15; // [esp+24h] [ebp-1Ch]
  float2 a3; // [esp+28h] [ebp-18h]
  float4 a2; // [esp+30h] [ebp-10h]

  if ( a1 != *(float **)(arg4 + 4) && a1 != *(float **)(arg4 + 8) && (_DWORD)a1[4] & 0x10000 )
  {
    if ( (signed char)*((_BYTE *)a1 + 8) >= 0 )
    {
      v5 = *((_DWORD *)a1 + 43);
      if ( v5 == 2 )
      {
        if ( sub_57C8A0((float4 *)(arg4 + 12), (float2 *)a1 + 7, &a3) )
        {
          v6 = a3.field_4 - a1[15];
          if ( v6 * v6 + (a3.field_0 - a1[14]) * (a3.field_0 - a1[14]) <= a1[45] )
            *(_DWORD *)arg4 = 0;
        }
      }
      else if ( v5 == 3 )
      {
        v14 = a1[48] + a1[14];
        v7 = a1[49] + a1[15];
        a2.field_0 = v14;
        v15 = v7;
        v8 = a1[50] + a1[14];
        a2.field_4 = v15;
        v12 = v8;
        v9 = a1[51] + a1[15];
        a2.field_8 = v12;
        v13 = v9;
        v10 = a1[52] + a1[14];
        a2.field_C = v13;
        v11 = a1[53] + a1[15];
        a3.field_0 = a1[54] + a1[14];
        a3.field_4 = a1[55] + a1[15];
        if ( sub_427980((float4 *)(arg4 + 12), &a2) )
          goto LABEL_20;
        a2.field_0 = v14;
        a2.field_4 = v15;
        a2.field_8 = v10;
        a2.field_C = v11;
        if ( sub_427980((float4 *)(arg4 + 12), &a2) )
          goto LABEL_20;
        a2.field_0 = a3.field_0;
        a2.field_4 = a3.field_4;
        a2.field_8 = v10;
        a2.field_C = v11;
        if ( sub_427980((float4 *)(arg4 + 12), &a2)
          || (a2.field_0 = a3.field_0,
              a2.field_4 = a3.field_4,
              a2.field_8 = v12,
              a2.field_C = v13,
              sub_427980((float4 *)(arg4 + 12), &a2)) )
        {
LABEL_20:
          *(_DWORD *)arg4 = 0;
        }
      }
    }
    else
    {
      v2 = *((_DWORD *)a1 + 187);
      if ( !((_BYTE)a1[3] & 4) )
      {
        v3 = 8 * *(_DWORD *)(v2 + 12);
        v4 = (double)*(int *)&byte_587000[v3 + 196184] * 0.125;
        a3.field_4 = (double)*(int *)&byte_587000[v3 + 196188] * 0.125;
        a2.field_0 = a1[14] - v4;
        a2.field_4 = a1[15] - a3.field_4;
        a2.field_8 = (double)*(int *)&byte_587000[8 * *(_DWORD *)(v2 + 12) + 196184] + a2.field_0 + v4;
        a2.field_C = (double)*(int *)&byte_587000[8 * *(_DWORD *)(v2 + 12) + 196188] + a2.field_4 + a3.field_4;
        if ( sub_427980((float4 *)(arg4 + 12), &a2) )
          *(_DWORD *)arg4 = 0;
      }
    }
  }
}

//----- (005374B0) --------------------------------------------------------
int __cdecl sub_5374B0(float4 *a1)
{
  return sub_535250(a1, 0, 0, 9);
}

//----- (005374D0) --------------------------------------------------------
void __cdecl sub_5374D0(_DWORD *a1)
{
  int v1; // esi

  if ( a1 )
  {
    v1 = a1[187];
    if ( v1 )
    {
      if ( *(_DWORD *)(v1 + 136) )
      {
        *(_DWORD *)(v1 + 132) = 0;
        sub_4FC300(a1, 3);
        sub_4E5CC0(*(_DWORD *)(v1 + 136));
        *(_DWORD *)(v1 + 136) = 0;
      }
    }
  }
}

//----- (00537520) --------------------------------------------------------
_DWORD *__cdecl sub_537520(_DWORD *a1)
{
  sub_5374D0(a1);
  return sub_501960(998, (int)a1, 0, 0);
}

//----- (00537540) --------------------------------------------------------
void __cdecl sub_537540(int a1)
{
  _DWORD *i; // esi

  if ( a1 )
  {
    for ( i = (_DWORD *)sub_4DA7C0(); i; i = (_DWORD *)sub_4DA7F0((int)i) )
    {
      if ( *(_DWORD *)(i[187] + 132) == a1 )
        sub_537520(i);
    }
  }
}

//----- (00537580) --------------------------------------------------------
int __cdecl sub_537580(int a1)
{
  return *(_BYTE *)(a1 + 464) & 1;
}

//----- (00537590) --------------------------------------------------------
BOOL sub_537590()
{
  return *(_DWORD *)&byte_5D4594[2488604] == 0;
}

//----- (005375A0) --------------------------------------------------------
void __cdecl sub_5375A0(int a1)
{
  int v1; // eax
  int v2; // ecx
  char v3; // al

  if ( *(_BYTE *)(a1 + 464) & 1 )
  {
    v1 = *(_DWORD *)&byte_5D4594[2488604];
    v2 = 0;
    if ( *(_DWORD *)&byte_5D4594[2488604] )
    {
      while ( v1 != a1 )
      {
        v2 = v1;
        v1 = *(_DWORD *)(v1 + 460);
        if ( !v1 )
          return;
      }
      if ( v1 )
      {
        if ( v2 )
          *(_DWORD *)(v2 + 460) = *(_DWORD *)(a1 + 460);
        else
          *(_DWORD *)&byte_5D4594[2488604] = *(_DWORD *)(a1 + 460);
        if ( a1 == *(_DWORD *)&byte_5D4594[2488608] )
          *(_DWORD *)&byte_5D4594[2488608] = v2;
        v3 = *(_BYTE *)(a1 + 464);
        *(_DWORD *)(a1 + 460) = -1;
        *(_BYTE *)(a1 + 464) = v3 & 0xFE;
      }
    }
  }
}

//----- (00537610) --------------------------------------------------------
char __cdecl sub_537610(int a1)
{
  int v1; // eax
  int v2; // edx
  int v3; // edi
  void (__cdecl *v4)(int, int); // ecx
  int v5; // ecx

  v1 = *(_DWORD *)(a1 + 744);
  if ( v1 || (v1 = *(_DWORD *)(a1 + 696)) != 0 && !(*(_BYTE *)(a1 + 16) & 0x40) )
  {
    if ( (v2 = *(_DWORD *)(a1 + 8), !(v2 & 0x400000)) && !(*(_BYTE *)(a1 + 16) & 8)
      || (v3 = sub_4E3AA0((CHAR *)&byte_587000[276764]),
          v1 = sub_4E3AA0((CHAR *)&byte_587000[276772]),
          v2 = *(_DWORD *)(a1 + 8),
          v2 & 0xE080)
      || (v4 = *(void (__cdecl **)(int, int))(a1 + 696), v4 == sub_4EADF0)
      || (char *)v4 == (char *)sub_4EBD40
      || (v5 = *(unsigned __int16 *)(a1 + 4), (unsigned __int16)v5 == v3)
      || v5 == v1 )
    {
      if ( *(_BYTE *)(a1 + 16) & 4 )
      {
        if ( v2 & 0x2008 )
          sub_50B500();
        nullsub_30(a1);
        LOBYTE(v1) = *(_BYTE *)(a1 + 464);
        if ( !(v1 & 1) )
        {
          if ( *(_DWORD *)&byte_5D4594[2488608] )
            *(_DWORD *)(*(_DWORD *)&byte_5D4594[2488608] + 460) = a1;
          else
            *(_DWORD *)&byte_5D4594[2488604] = a1;
          *(_DWORD *)&byte_5D4594[2488608] = a1;
          LOBYTE(v1) = *(_BYTE *)(a1 + 464) | 1;
          *(_DWORD *)(a1 + 460) = 0;
          *(_BYTE *)(a1 + 464) = v1;
        }
      }
    }
  }
  return v1;
}
// 5485F0: using guessed type void __cdecl nullsub_30(_DWORD);

//----- (00537700) --------------------------------------------------------
int sub_537700()
{
  int result; // eax
  _DWORD *v1; // ecx

  result = *(_DWORD *)&byte_5D4594[2488604];
  v1 = (_DWORD *)(*(_DWORD *)&byte_5D4594[2488604] + 460);
  *(_DWORD *)&byte_5D4594[2488604] = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2488604] + 460);
  if ( !*(_DWORD *)&byte_5D4594[2488604] )
    *(_DWORD *)&byte_5D4594[2488608] = 0;
  *v1 = -1;
  *(_BYTE *)(result + 464) &= 0xFEu;
  return result;
}

//----- (00537740) --------------------------------------------------------
int sub_537740()
{
  return *(_DWORD *)&byte_5D4594[2488604];
}

//----- (00537750) --------------------------------------------------------
int __cdecl sub_537750(int a1)
{
  int result; // eax

  result = a1;
  if ( a1 )
    result = *(_DWORD *)(a1 + 460);
  return result;
}

//----- (00537760) --------------------------------------------------------
unsigned int sub_537760()
{
  return *(_DWORD *)&byte_5D4594[2488620] != 0 ? (unsigned int)&byte_5D4594[2488612] : 0;
}

//----- (00537770) --------------------------------------------------------
char __cdecl sub_537770(int a1)
{
  int v1; // eax
  int v3; // [esp+0h] [ebp-Ch]
  float2 v4; // [esp+4h] [ebp-8h]

  LOBYTE(v1) = byte_5D4594[2488624];
  if ( !*(_DWORD *)&byte_5D4594[2488624] )
  {
    *(_DWORD *)&byte_5D4594[2488624] = sub_4E3AA0((CHAR *)&byte_587000[276788]);
    *(_DWORD *)&byte_5D4594[2488628] = sub_4E3AA0((CHAR *)&byte_587000[276800]);
    v1 = sub_4E3AA0((CHAR *)&byte_587000[276812]);
    *(_DWORD *)&byte_5D4594[2488632] = v1;
  }
  if ( !(*(_BYTE *)(a1 + 16) & 0x60) )
  {
    *(_DWORD *)&byte_5D4594[2488620] = 0;
    LOBYTE(v1) = sub_537850(a1, &v3, &v4);
    if ( (_BYTE)v1 )
    {
      if ( !v3
        || (v1 = *(unsigned __int16 *)(v3 + 4), (unsigned __int16)v1 != *(_DWORD *)&byte_5D4594[2488624])
        && v1 != *(_DWORD *)&byte_5D4594[2488628]
        && v1 != *(_DWORD *)&byte_5D4594[2488632] )
      {
        (*(void (__cdecl **)(int, int, float2 *))(a1 + 696))(a1, v3, &v4);
        LOBYTE(v1) = v3;
        *(_DWORD *)&byte_5D4594[2488620] = 0;
        if ( v3 )
        {
          v4.field_0 = -v4.field_0;
          v4.field_4 = -v4.field_4;
          LOBYTE(v1) = (*(int (__cdecl **)(int, int, float2 *))(v3 + 696))(v3, a1, &v4);
        }
      }
    }
  }
  return v1;
}

//----- (00537850) --------------------------------------------------------
char __cdecl sub_537850(int a1, int *a2, float2 *a3)
{
  int v3; // esi
  int v4; // ebx
  double v5; // st7
  double v6; // st7
  int v7; // edx
  float v8; // eax
  int v9; // eax
  float v10; // eax
  float v11; // ecx
  float v12; // edx
  bool v13; // al
  int v14; // edx
  int v15; // edi
  float v16; // ecx
  double v17; // st7
  int v18; // ebp
  double v19; // st7
  double v20; // st6
  double v21; // st7
  double v22; // st6
  double v23; // st5
  float v25; // edx
  float v26; // [esp+1Ch] [ebp-44h]
  float2 v27; // [esp+20h] [ebp-40h]
  float2 v28; // [esp+28h] [ebp-38h]
  int v29[2]; // [esp+30h] [ebp-30h]
  float2 a2a; // [esp+38h] [ebp-28h]
  float2 v31; // [esp+40h] [ebp-20h]
  int2 a3a; // [esp+48h] [ebp-18h]
  float4 a1a; // [esp+50h] [ebp-10h]
  int v34; // [esp+64h] [ebp+4h]
  int v35; // [esp+64h] [ebp+4h]

  v3 = a1;
  v4 = 0;
  *(float *)&v34 = *(float *)(a1 + 64) - *(float *)(a1 + 56);
  v5 = *(float *)(v3 + 68) - *(float *)(v3 + 60);
  v26 = v5;
  v6 = v5 * v26 + *(float *)&v34 * *(float *)&v34;
  if ( v6 <= 36.0 )
  {
    v7 = *(_DWORD *)(v3 + 56);
    v8 = *(float *)(v3 + 64);
    v28.field_4 = *(float *)(v3 + 68);
    v29[0] = v7;
    v28.field_0 = v8;
    v29[1] = *(_DWORD *)(v3 + 60);
    v9 = sub_54E810(v3, &v28, (int)v29);
    if ( !v9 )
      goto LABEL_4;
    goto LABEL_3;
  }
  v15 = sub_419B10(sqrt(v6 * 0.027777778)) + 1;
  v16 = *(float *)(v3 + 60);
  v17 = (double)v15;
  v29[0] = *(_DWORD *)(v3 + 56);
  v18 = 0;
  *(float *)&v29[1] = v16;
  LODWORD(v28.field_0) = v29[0];
  v28.field_4 = v16;
  *(float *)&v35 = *(float *)&v34 / v17;
  v27.field_0 = v26 / v17;
  if ( v15 > 0 )
  {
    while ( 1 )
    {
      v28.field_0 = v28.field_0 + *(float *)&v35;
      v28.field_4 = v28.field_4 + v27.field_0;
      v9 = sub_54E810(v3, &v28, (int)v29);
      if ( v9 )
        break;
      ++v18;
      *(float2 *)v29 = v28;
      if ( v18 >= v15 )
        goto LABEL_4;
    }
LABEL_3:
    v4 = v9;
    v27.field_0 = *(float *)v29 - *(float *)(v9 + 56);
    v27.field_4 = *(float *)&v29[1] - *(float *)(v9 + 60);
  }
LABEL_4:
  v10 = *(float *)(v3 + 60);
  v11 = *(float *)(v3 + 64);
  a1a.field_0 = *(float *)(v3 + 56);
  v12 = *(float *)(v3 + 68);
  a1a.field_4 = v10;
  a1a.field_8 = v11;
  a1a.field_C = v12;
  if ( sub_535250(&a1a, &a2a, &a3a, 5) )
  {
    v13 = 0;
  }
  else
  {
    *(int2 *)&byte_5D4594[2488612] = a3a;
    *(float2 *)&a1a.field_8 = a2a;
    *(_DWORD *)&byte_5D4594[2488620] = 1;
    v13 = sub_57CDB0(&a3a, &a1a.field_0, &v31) != 0;
    v14 = *(_DWORD *)(v3 + 60);
    *(_DWORD *)(v3 + 64) = *(_DWORD *)(v3 + 56);
    *(_DWORD *)(v3 + 68) = v14;
  }
  if ( v4 )
  {
    if ( !v13 )
    {
      *a3 = v27;
      *a2 = v4;
      return 1;
    }
    v19 = *(float *)(v3 + 56) - *(float *)(v4 + 56);
    v20 = *(float *)(v3 + 60) - *(float *)(v4 + 60);
    v21 = v20 * v20 + v19 * v19;
    v22 = *(float *)(v3 + 56) - a2a.field_0;
    v23 = *(float *)(v3 + 60) - a2a.field_4;
    if ( v21 < v23 * v23 + v22 * v22 )
    {
      *a3 = v27;
      *a2 = v4;
      return 1;
    }
    goto LABEL_17;
  }
  if ( v13 )
  {
LABEL_17:
    v25 = v31.field_4;
    a3->field_0 = v31.field_0;
    a3->field_4 = v25;
    *a2 = 0;
    return 1;
  }
  return 0;
}
// 537A87: variable 'v24' is possibly undefined

//----- (00537AF0) --------------------------------------------------------
_DWORD *__cdecl sub_537AF0(int *a1, int a2)
{
  _DWORD *result; // eax
  _DWORD *v3; // esi
  int v4; // eax
  int v5; // [esp-18h] [ebp-18h]
  int v6; // [esp-18h] [ebp-18h]
  int v7; // [esp-18h] [ebp-18h]

  if ( !*(_DWORD *)&byte_5D4594[2488636] )
    sub_537BD0();
  if ( a2 )
  {
    if ( a2 == 1 )
    {
      v6 = *(_DWORD *)&byte_587000[8 * sub_415FA0(0, 0) + 276836];
      result = sub_4E3450(v6);
    }
    else
    {
      result = (_DWORD *)(a2 - 2);
      if ( a2 != 2 )
        return result;
      v5 = *(_DWORD *)&byte_587000[8 * sub_415FA0(0, 0) + 276844];
      result = sub_4E3450(v5);
    }
  }
  else
  {
    v7 = *(_DWORD *)&byte_587000[8 * sub_415FA0(0, 0) + 276828];
    result = sub_4E3450(v7);
  }
  v3 = result;
  if ( result )
  {
    sub_4DAA50((int)result, 0, *(float *)a1, *((float *)a1 + 1));
    if ( sub_40A5C0(4096) )
      v4 = sub_415FA0(5, 8);
    else
      v4 = sub_415FA0(10, 20);
    result = (_DWORD *)sub_511660(v3, *(_DWORD *)&byte_5D4594[2649704] * v4);
  }
  return result;
}

//----- (00537BD0) --------------------------------------------------------
int sub_537BD0()
{
  int result; // eax

  *(_DWORD *)&byte_587000[276828] = sub_4E3AA0(*(CHAR **)&byte_587000[276824]);
  *(_DWORD *)&byte_587000[276836] = sub_4E3AA0(*(CHAR **)&byte_587000[276832]);
  result = sub_4E3AA0(*(CHAR **)&byte_587000[276840]);
  *(_DWORD *)&byte_587000[276844] = result;
  *(_DWORD *)&byte_5D4594[2488636] = 1;
  return result;
}

//----- (00537C10) --------------------------------------------------------
char __cdecl sub_537C10(int a1, int a2)
{
  float2 *v2; // ebp
  char result; // al
  int v4; // edi
  int v5; // esi
  int v6; // ecx
  char v7; // al
  int *v8; // ebx
  int v9; // eax
  float v10; // [esp+0h] [ebp-54h]
  int v11; // [esp+18h] [ebp-3Ch]
  float4 a1a; // [esp+1Ch] [ebp-38h]
  int v13[10]; // [esp+2Ch] [ebp-28h]
  int a3; // [esp+58h] [ebp+4h]

  v2 = (float2 *)a1;
  result = *(_BYTE *)(a1 + 16);
  v4 = *(_DWORD *)(a1 + 692);
  v11 = *(_DWORD *)(a1 + 692);
  if ( !(result & 0x20) )
  {
    v5 = sub_4EC580(a1);
    sub_4E5CC0(a1);
    if ( v5 )
    {
      if ( *(_BYTE *)(v5 + 8) & 4 )
      {
        v6 = *(_DWORD *)(v5 + 748);
        if ( *(_BYTE *)(*(_DWORD *)(v6 + 276) + 2251) == 1 )
        {
          v7 = *(_BYTE *)(v6 + 244);
          if ( v7 )
            *(_BYTE *)(v6 + 244) = v7 - 1;
        }
      }
    }
    if ( a2 )
    {
      v8 = (int *)(v4 + 24);
      *(_DWORD *)(v4 + 24) = a2;
    }
    else
    {
      v13[0] = 15;
      v13[1] = 1;
      v13[2] = 0;
      v13[3] = 6;
      v13[4] = 0;
      v13[5] = -1;
      v13[6] = 0;
      v13[7] = -1;
      v13[8] = 0x8000;
      v8 = (int *)(v4 + 24);
      v10 = sub_419D40(&byte_587000[277100]);
      *(_DWORD *)(v4 + 24) = sub_4E6EA0(a1, v10, (int)v13);
    }
    a3 = 0;
    if ( *(_BYTE *)(v4 + 20) )
    {
      do
      {
        if ( (!sub_424A50(*(_DWORD *)v4, 1) || a2) && !sub_4FD0E0(v5, *(_DWORD *)v4) )
        {
          if ( *(_BYTE *)(v5 + 8) & 4 )
          {
            v9 = sub_4FE7B0(*(_DWORD *)v4, v5);
            sub_4FD400(*(_DWORD *)v4, v5, (_DWORD *)v5, (int)v2, v8, v9);
          }
          else
          {
            sub_4FD400(*(_DWORD *)v4, v5, (_DWORD *)v5, (int)v2, v8, 2);
          }
        }
        v4 += 4;
        ++a3;
      }
      while ( a3 < *(unsigned __int8 *)(v11 + 20) );
    }
    sub_522FF0(129, v2 + 7);
    sub_501A30(40, v2 + 7, 0, 0);
    a1a.field_0 = v2[7].field_0 - 100.0;
    a1a.field_4 = v2[7].field_4 - 100.0;
    a1a.field_8 = v2[7].field_0 + 100.0;
    a1a.field_C = v2[7].field_4 + 100.0;
    sub_517C10(&a1a, sub_537DD0, (int)v2);
  }
  return result;
}

//----- (00537DD0) --------------------------------------------------------
void __cdecl sub_537DD0(float *a1, int a2)
{
  int v2; // eax
  float v3; // edx
  float v4; // ecx
  float v5; // edx
  float4 v6; // [esp+8h] [ebp-10h]

  if ( a1 != (float *)a2 && !((_BYTE)a1[4] & 0x20) )
  {
    v2 = *(_DWORD *)&byte_5D4594[2488640];
    if ( !*(_DWORD *)&byte_5D4594[2488640] )
    {
      v2 = sub_4E3AA0((CHAR *)&byte_587000[277112]);
      *(_DWORD *)&byte_5D4594[2488640] = v2;
    }
    if ( *((unsigned __int16 *)a1 + 2) == v2 )
    {
      v3 = *(float *)(a2 + 56);
      v4 = a1[14];
      v6.field_4 = *(float *)(a2 + 60);
      v6.field_0 = v3;
      v5 = a1[15];
      v6.field_8 = v4;
      v6.field_C = v5;
      if ( sub_535250(&v6, 0, 0, 5) == 1 )
      {
        *((_DWORD *)a1 + 186) = sub_538280;
        sub_4DA8D0((int)a1);
      }
    }
  }
}

//----- (00537E60) --------------------------------------------------------
int __cdecl sub_537E60(int a1, int a2, int a3, int a4)
{
  int v4; // eax
  float4 a1a; // [esp+4h] [ebp-10h]

  a1a.field_0 = *(float *)(a4 + 56) - 300.0;
  a1a.field_4 = *(float *)(a4 + 60) - 300.0;
  a1a.field_8 = *(float *)(a4 + 56) + 300.0;
  a1a.field_C = *(float *)(a4 + 60) + 300.0;
  v4 = sub_424800(a1, 0);
  sub_501960(v4, a3, 0, 0);
  while ( 1 )
  {
    *(_DWORD *)&byte_5D4594[2488644] = 0;
    sub_517C10(&a1a, sub_537F00, a4);
    if ( !*(_DWORD *)&byte_5D4594[2488644] )
      break;
    sub_537C10(*(int *)&byte_5D4594[2488644], 0);
  }
  return 1;
}

//----- (00537F00) --------------------------------------------------------
void __cdecl sub_537F00(float *a1, int a2)
{
  int v2; // eax
  int v3; // ebx
  float v4; // edx
  float v5; // ecx
  float v6; // edx
  float4 v7; // [esp+0h] [ebp-10h]

  v2 = *(_DWORD *)&byte_5D4594[2488640];
  if ( !*(_DWORD *)&byte_5D4594[2488640] )
  {
    v2 = sub_4E3AA0((CHAR *)&byte_587000[277120]);
    *(_DWORD *)&byte_5D4594[2488640] = v2;
  }
  if ( *((unsigned __int16 *)a1 + 2) == v2 && !((_BYTE)a1[4] & 0x20) )
  {
    v3 = sub_4EC580(a2);
    if ( sub_4EC4F0((int)a1, v3) || !*((_DWORD *)a1 + 127) && !(*(_BYTE *)(v3 + 8) & 4) )
    {
      v4 = *(float *)(a2 + 56);
      v5 = a1[14];
      v7.field_4 = *(float *)(a2 + 60);
      v7.field_0 = v4;
      v6 = a1[15];
      v7.field_8 = v5;
      v7.field_C = v6;
      if ( sub_535250(&v7, 0, 0, 5) == 1 )
        *(_DWORD *)&byte_5D4594[2488644] = a1;
    }
  }
}

//----- (00537FA0) --------------------------------------------------------
int __cdecl sub_537FA0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // edi
  int v6; // esi
  _DWORD *v8; // eax
  int v9; // ebx
  int v10; // ebp
  int v11; // ecx
  BYTE v12; // eax
  int v13; // ebx
  _DWORD *v14; // eax
  int *v15; // edi
  int v16; // edx
  int v17; // edx
  int v18; // eax
  int v19; // [esp-Ch] [ebp-2Ch]
  float v20; // [esp+0h] [ebp-20h]
  int v21; // [esp+14h] [ebp-Ch]
  float2 v22; // [esp+18h] [ebp-8h]
  float v23; // [esp+24h] [ebp+4h]
  int *v24; // [esp+24h] [ebp+4h]

  v5 = a3;
  if ( *(_BYTE *)(a3 + 8) & 4 )
  {
    v6 = *(_DWORD *)(a3 + 748);
    v20 = sub_419D40(&byte_587000[277128]);
    if ( *(unsigned __int8 *)(v6 + 244) >= sub_419A70(v20) )
    {
      a3 = 5;
LABEL_6:
      sub_4DA0F0(*(unsigned __int8 *)(*(_DWORD *)(v6 + 276) + 2064), 0, &a3);
      return 0;
    }
    if ( !*(_BYTE *)(v6 + 212) )
    {
      a3 = 7;
      goto LABEL_6;
    }
    v8 = sub_4E3810((CHAR *)&byte_587000[277144]);
    v9 = (int)v8;
    v21 = (int)v8;
    if ( v8 )
    {
      v10 = v8[173];
      if ( *(_BYTE *)(*(_DWORD *)(v6 + 276) + 2251) != 2 )
      {
        v13 = a4;
        sub_4DAA50((int)v8, v5, *(float *)(a4 + 56), *(float *)(a4 + 60));
        v19 = sub_424800(a1, 0);
        sub_501960(v19, v13, 0, 0);
LABEL_23:
        a4 = 0;
        v22.field_0 = 0.0;
        if ( *(_BYTE *)(v6 + 212) )
        {
          v24 = (int *)v10;
          v15 = (int *)(v6 + 192);
          do
          {
            if ( sub_424B70(*v15) )
            {
              v16 = a4;
              *v24 = *v15;
              a4 = v16 + 1;
              ++v24;
            }
            v17 = *(unsigned __int8 *)(v6 + 212);
            ++v15;
            ++LODWORD(v22.field_0);
          }
          while ( SLODWORD(v22.field_0) < v17 );
        }
        *(_BYTE *)(v10 + 20) = a4;
        v18 = a5;
        *(_DWORD *)(v10 + 28) = *(_DWORD *)(a5 + 4);
        *(_DWORD *)(v10 + 32) = *(_DWORD *)(v18 + 8);
        *(_DWORD *)(v10 + 24) = 0;
        *(_BYTE *)(v6 + 212) = 0;
        *(_WORD *)(v21 + 126) = *(_WORD *)(v13 + 124);
        *(_WORD *)(v21 + 124) = *(_WORD *)(v13 + 124);
        if ( *(_BYTE *)(*(_DWORD *)(v6 + 276) + 2251) == 1 )
          ++*(_BYTE *)(v6 + 244);
        return 1;
      }
      v23 = (double)sub_538250(v5);
      if ( sub_419D40(&byte_587000[277152]) <= v23 )
      {
        v11 = *(_DWORD *)(v6 + 276);
        a4 = 5;
        sub_4DA0F0(*(unsigned __int8 *)(v11 + 2064), 0, &a4);
        sub_4E5CC0(v9);
        return 0;
      }
      v12 = sub_500D70(v5, 5);
      if ( v12 )
      {
        if ( !*(_DWORD *)&byte_5D4594[2488648] )
          *(_DWORD *)&byte_5D4594[2488648] = sub_4E3AA0((CHAR *)&byte_587000[277168]);
        v13 = a4;
        sub_4ED970(50.0, (float2 *)(a4 + 56), &v22);
        if ( v5 )
          v14 = sub_5016C0(*(int *)&byte_5D4594[2488648], (int *)&v22, v5, *(_BYTE *)(v5 + 124));
        else
          v14 = sub_5016C0(*(int *)&byte_5D4594[2488648], (int *)&v22, 0, 0);
        if ( v14 )
          sub_4F3070((int)v14, v21, 1);
        sub_501960(367, v13, 0, 0);
        goto LABEL_23;
      }
      sub_4E5CC0(v9);
    }
    return 0;
  }
  return 1;
}
// 5380C1: variable 'v12' is possibly undefined

//----- (00538250) --------------------------------------------------------
int __cdecl sub_538250(int a1)
{
  int result; // eax
  int i; // ecx

  result = 0;
  for ( i = *(_DWORD *)(a1 + 516); i; i = *(_DWORD *)(i + 512) )
  {
    if ( *(_BYTE *)(i + 8) & 2 )
    {
      if ( *(_DWORD *)(i + 12) & 0x2000 )
        ++result;
    }
  }
  return result;
}

//----- (00538280) --------------------------------------------------------
char __cdecl sub_538280(int a1)
{
  return sub_537C10(a1, 0);
}

//----- (00538290) --------------------------------------------------------
int __cdecl sub_538290(int a1, int a2, int a3, int a4)
{
  int result; // eax
  int v5; // esi
  int v6; // ebp
  int *v7; // esi
  int v8; // eax
  void (__cdecl *v9)(int, int, int, int, int); // ecx
  int v10; // [esp+10h] [ebp+4h]

  result = a3;
  if ( a3 )
  {
    v5 = *(_DWORD *)(a3 + 692);
    v6 = a1;
    if ( sub_417DA0(1) || !a2 || !(*(_BYTE *)(a2 + 8) & 6) || (result = sub_5330C0(a2, a1)) != 0 )
    {
      result = sub_4FF350(a1, 23);
      if ( !result )
      {
        result = sub_4FF350(a1, 27);
        if ( !result )
        {
          v7 = (int *)(v5 + 8);
          v10 = 2;
          do
          {
            v8 = *v7;
            if ( *v7 )
            {
              v9 = *(void (__cdecl **)(int, int, int, int, int))(v8 + 52);
              if ( v9 )
                v9(v8, a3, a2, v6, a4);
            }
            ++v7;
            result = --v10;
          }
          while ( v10 );
        }
      }
    }
  }
  return result;
}

//----- (00538330) --------------------------------------------------------
int __cdecl sub_538330(int a1, int a2)
{
  int v2; // ebp
  int v3; // eax
  int v4; // ecx
  int v5; // eax
  int v6; // eax
  int v8; // eax
  int v9; // eax
  int v12; // eax
  float a3; // [esp+0h] [ebp-34h]
  float v15; // [esp+Ch] [ebp-28h]
  float v16; // [esp+Ch] [ebp-28h]
  float v17; // [esp+Ch] [ebp-28h]
  float v18; // [esp+Ch] [ebp-28h]
  float v19; // [esp+Ch] [ebp-28h]
  int v20; // [esp+10h] [ebp-24h]
  int v21; // [esp+20h] [ebp-14h]
  int4 a1a; // [esp+24h] [ebp-10h]
  float v23; // [esp+38h] [ebp+4h]

  v2 = a1;
  v21 = 0;
  if ( !a1 || !a2 )
    return 0;
  *(_DWORD *)&byte_5D4594[2488656] = 0;
  *(_DWORD *)&byte_5D4594[2488660] = 0;
  v3 = *(_DWORD *)(a2 + 28);
  if ( v3 && (v4 = *(_DWORD *)(v3 + 12), BYTE1(v4) & 0x40) )
  {
    sub_518040(a2 + 16, *(float *)(a2 + 8), sub_538510, a2);
    v21 = 25;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2488660] = 0;
    *(_DWORD *)&byte_5D4594[2488652] = *(_DWORD *)(a2 + 8);
    sub_518040(a1 + 56, *(float *)(a2 + 8), sub_5386A0, a1);
    if ( *(_DWORD *)&byte_5D4594[2488660] )
      sub_538510(*(int *)&byte_5D4594[2488660], a2);
  }
  v23 = (double)v21;
  v15 = *(float *)(a2 + 16) - *(float *)(a2 + 8) - v23;
  v5 = sub_419A70(v15);
  v16 = *(float *)(a2 + 20) - *(float *)(a2 + 8) - v23;
  a1a.field_0 = v5 / 23;
  v6 = sub_419A70(v16);
  v17 = *(float *)(a2 + 8) + *(float *)(a2 + 16) + v23;
  a1a.field_4 = v6 / 23;
  v8 = sub_419A70(v17);
  v18 = *(float *)(a2 + 20) + *(float *)(a2 + 8) + v23;
  a1a.field_8 = v8 / 23;
  v9 = sub_419A70(v18);
  v12 = *(_DWORD *)(a2 + 28);
  a1a.field_C = v9 / 23;
  if ( !v12 )
    v12 = v2;
  a3 = v23 + *(float *)(a2 + 8);
  sub_534FC0(&a1a, a2 + 16, a3, (__int64)(*(float *)a2 + 0.5), *(unsigned __int8 *)(a2 + 4), v12);
  if ( *(_DWORD *)(a2 + 28) )
  {
    if ( *(_DWORD *)&byte_5D4594[2488656] )
    {
      v20 = *(unsigned __int8 *)(a2 + 4);
      v19 = sub_419D40(&byte_587000[277176]) * *(float *)a2;
      sub_4E1560(
        *(_DWORD *)(a2 + 28),
        *(_DWORD *)(a2 + 12),
        *(int *)&byte_5D4594[2488660],
        *(int *)&byte_5D4594[2488660],
        v19,
        v20);
    }
  }
  return *(_DWORD *)&byte_5D4594[2488656];
}

//----- (00538510) --------------------------------------------------------
void __cdecl sub_538510(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  float v5; // ecx
  float v6; // edx
  float v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // esi
  char v11; // al
  float4 v12; // [esp+Ch] [ebp-10h]

  if ( a1 )
  {
    if ( a2 )
    {
      v2 = *(_DWORD *)(a2 + 12);
      if ( v2 )
      {
        if ( a1 != v2 )
        {
          if ( (unsigned __int8)sub_4E6E50((float2 *)(v2 + 56), *(__int16 *)(v2 + 124), (float2 *)(a1 + 56)) & *(_BYTE *)(a2 + 32) )
          {
            v3 = *(_DWORD *)(a1 + 16);
            if ( !(v3 & 0x8040) && (*(_DWORD *)(a2 + 24) || !(v3 & 8)) )
            {
              if ( *(_WORD *)(a1 + 24) != 0x4000 )
                *(_DWORD *)&byte_5D4594[2488656] = 1;
              v4 = *(_DWORD *)(a2 + 12);
              v12.field_0 = *(float *)(v4 + 56);
              v5 = *(float *)(a1 + 60);
              v6 = *(float *)(v4 + 60);
              v7 = *(float *)(a1 + 56);
              v12.field_4 = v6;
              v12.field_8 = v7;
              v12.field_C = v5;
              if ( sub_535250(&v12, 0, 0, 5) )
              {
                sub_538290(a1, *(_DWORD *)(a2 + 12), *(_DWORD *)(a2 + 28), a2);
                (*(void (__cdecl **)(int, _DWORD, _DWORD, _DWORD, _DWORD))(a1 + 716))(
                  a1,
                  *(_DWORD *)(a2 + 12),
                  *(_DWORD *)(a2 + 28),
                  (__int64)(*(float *)a2 + 0.5),
                  *(unsigned __int8 *)(a2 + 4));
                if ( sub_40A5C0(2048) )
                {
                  if ( *(_BYTE *)(*(_DWORD *)(a2 + 12) + 8) & 4 )
                  {
                    if ( !(*(_BYTE *)(a1 + 8) & 2) )
                    {
                      v8 = *(_DWORD *)(a1 + 556);
                      if ( v8 )
                      {
                        if ( *(_WORD *)(v8 + 4) )
                        {
                          v9 = *(_DWORD *)(a1 + 16);
                          if ( (v9 & 0x8000) == 0 && !(v9 & 0x20) )
                            sub_522FF0(139, (float2 *)(a1 + 56));
                        }
                      }
                    }
                  }
                }
                if ( !*(_DWORD *)(a2 + 28) )
                {
                  v10 = *(_DWORD *)(a2 + 12);
                  if ( *(_BYTE *)(v10 + 8) & 4 )
                    v11 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(v10 + 748) + 276) + 8);
                  else
                    v11 = *(_BYTE *)(*(_DWORD *)(v10 + 748) + 2068);
                  if ( v11 == 25 )
                    sub_52DF80(v10 + 56, a1, 20.0);
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (005386A0) --------------------------------------------------------
void __cdecl sub_5386A0(int a3, int a2)
{
  int v2; // eax
  int v3; // eax
  double v4; // st7
  double v5; // st7
  float *v6; // eax
  double v7; // st7
  float2 a4; // [esp+8h] [ebp-8h]

  if ( a2 != a3 )
  {
    if ( a2 )
    {
      if ( a3 )
      {
        v2 = *(_DWORD *)(a3 + 16);
        if ( !(v2 & 0x8049)
          && (*(_BYTE *)(a3 + 8) & 6 || !(v2 & 0x10) || (v2 & 0x80u) != 0)
          && (sub_5330C0(a2, a3) || !(*(_BYTE *)(a3 + 8) & 6)) )
        {
          v3 = *(_DWORD *)(a3 + 16);
          if ( (v3 & 0x8000) == 0 )
          {
            if ( sub_5370E0(a2, a3, 1) )
            {
              if ( *(float *)&byte_5D4594[2488652] > 0.0 )
              {
                a4.field_0 = *(float *)(a3 + 56) - *(float *)(a2 + 56);
                v4 = *(float *)(a3 + 60) - *(float *)(a2 + 60);
                a4.field_4 = v4;
                v5 = sqrt(v4 * a4.field_4 + a4.field_0 * a4.field_0);
                if ( v5 != 0.0 )
                {
                  v6 = (float *)&byte_587000[8 * *(__int16 *)(a2 + 124) + 194136];
                  if ( a4.field_4 / v5 * v6[1] + a4.field_0 / v5 * *v6 > 0.5 )
                  {
                    if ( *(_DWORD *)(a3 + 172) == 2 )
                    {
                      v5 = v5 - *(float *)(a3 + 176);
                    }
                    else if ( *(_DWORD *)(a3 + 172) == 3 )
                    {
                      v7 = sub_54A990((float2 *)(a2 + 56), *(float *)&byte_5D4594[2488652], a3, &a4);
                      if ( v7 < 0.0 )
                        return;
                      v5 = *(float *)&byte_5D4594[2488652] - v7;
                    }
                    if ( v5 < 0.0 )
                      v5 = 0.0;
                    if ( (v5 < *(float *)&byte_5D4594[2488652]
                       || *(_DWORD *)&byte_5D4594[2488660]
                       && !(*(_BYTE *)(*(_DWORD *)&byte_5D4594[2488660] + 8) & 2)
                       && (*(_BYTE *)(a3 + 8) & 2) == 2)
                      && (!*(_DWORD *)&byte_5D4594[2488660] || !(*(_BYTE *)(*(_DWORD *)&byte_5D4594[2488660] + 8) & 2)) )
                    {
                      *(float *)&byte_5D4594[2488652] = v5;
                      *(_DWORD *)&byte_5D4594[2488660] = a3;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (00538840) --------------------------------------------------------
int __cdecl sub_538840(int a1, int a2, int a3)
{
  int v3; // edi
  int *v4; // esi
  int v5; // eax
  void (__cdecl *v6)(int, int, int, _DWORD, int); // ecx
  int result; // eax
  int v8; // [esp+14h] [ebp+4h]

  v3 = a1;
  v8 = 4;
  v4 = *(int **)(v3 + 692);
  do
  {
    v5 = *v4;
    if ( *v4 )
    {
      v6 = *(void (__cdecl **)(int, int, int, _DWORD, int))(v5 + 40);
      if ( v6 )
        v6(v5, v3, a2, 0, a3);
    }
    ++v4;
    result = --v8;
  }
  while ( v8 );
  return result;
}

//----- (00538890) --------------------------------------------------------
int __cdecl sub_538890(int a1)
{
  _DWORD *v1; // eax
  int v2; // edi
  int v3; // ebx
  double v4; // st7
  int v5; // eax
  int result; // eax
  __int16 v7; // si
  float v8; // [esp+0h] [ebp-18h]
  float v9; // [esp+4h] [ebp-14h]

  if ( !a1 )
    return 0;
  v1 = sub_4E3810((CHAR *)&byte_587000[277200]);
  v2 = (int)v1;
  if ( !v1 )
    return 0;
  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(float *)(a1 + 176) + 1.0;
  *(_DWORD *)(v1[175] + 4) = a1;
  v5 = 8 * *(__int16 *)(a1 + 124);
  v9 = v4 * *(float *)&byte_587000[v5 + 194140] + *(float *)(a1 + 60);
  v8 = v4 * *(float *)&byte_587000[v5 + 194136] + *(float *)(a1 + 56);
  sub_4DAA50(v2, a1, v8, v9);
  result = 1;
  *(float *)(v2 + 80) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136] * *(float *)(v2 + 544);
  *(float *)(v2 + 84) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194140] * *(float *)(v2 + 544);
  v7 = *(_WORD *)(a1 + 124);
  *(_WORD *)(v2 + 124) = v7;
  *(_WORD *)(v2 + 126) = v7;
  *(_DWORD *)(v3 + 136) = v2;
  *(_DWORD *)(v3 + 140) = 0;
  return result;
}

//----- (00538960) --------------------------------------------------------
BOOL __cdecl sub_538960(int a1)
{
  float *v1; // edi
  int v2; // eax
  int v3; // eax
  int v4; // ebp
  int v5; // ebx
  char v6; // dl
  float v7; // edx
  float v8; // eax
  char v9; // al
  double v10; // st7
  int v11; // eax
  int v12; // edx
  double v13; // st7
  __int16 v14; // ax
  int v15; // ecx
  int v16; // edx
  double v17; // st7
  int v18; // eax
  int v19; // eax
  char v20; // cl
  int v21; // ecx
  double v22; // st7
  double v23; // st7
  int v24; // edi
  int v25; // ebx
  int v26; // edx
  double v27; // st7
  double v28; // st7
  double v29; // st7
  int v30; // eax
  float v31; // edx
  double v32; // st6
  _DWORD *v33; // eax
  int v34; // edi
  int v35; // ebx
  __int16 v36; // ax
  double v37; // st7
  int v38; // eax
  float v39; // edx
  char *v40; // ebx
  double v41; // st6
  _DWORD *v42; // eax
  int v43; // edi
  __int16 v44; // ax
  char v45; // al
  int v46; // edx
  double v47; // st7
  double v48; // st7
  int v49; // edx
  double v50; // st7
  double v51; // st7
  int v52; // edx
  double v53; // st7
  double v54; // st7
  int v55; // eax
  int v56; // eax
  int v57; // edx
  double v58; // st7
  double v59; // st7
  int v60; // edx
  double v61; // st7
  double v62; // st7
  _DWORD *v63; // edi
  int v64; // eax
  char v65; // bl
  unsigned __int8 v66; // bl
  _DWORD *v67; // edi
  int v68; // eax
  bool v69; // cc
  int v70; // eax
  int v71; // ecx
  unsigned __int8 v72; // al
  int v73; // ecx
  float v75; // [esp+0h] [ebp-C0h]
  __int16 v76; // [esp+17h] [ebp-A9h]
  int v77; // [esp+1Ch] [ebp-A4h]
  int v78; // [esp+20h] [ebp-A0h]
  int v79; // [esp+24h] [ebp-9Ch]
  int v80; // [esp+28h] [ebp-98h]
  int v81; // [esp+2Ch] [ebp-94h]
  char v82[36]; // [esp+30h] [ebp-90h]
  float4 v83;
  int v86; // [esp+64h] [ebp-5Ch]
  char v87[88]; // [esp+68h] [ebp-58h]

  v1 = 0;
  v2 = *(_DWORD *)(a1 + 8);
  if ( v2 & 4 )
  {
    v79 = *(_DWORD *)(a1 + 748);
    v3 = *(_DWORD *)(v79 + 276);
    v4 = *(_DWORD *)(v79 + 104);
    v5 = *(_DWORD *)(v3 + 4);
    v6 = *(_BYTE *)(v3 + 8);
    LOBYTE(v76) = *(_BYTE *)(v79 + 236);
  }
  else
  {
    if ( !(v2 & 2) || !(*(_BYTE *)(a1 + 12) & 0x10) )
      return 0;
    v79 = *(_DWORD *)(a1 + 748);
    v5 = *(_DWORD *)(v79 + 2056);
    v4 = *(_DWORD *)(v79 + 2064);
    v6 = *(_BYTE *)(v79 + 2068);
    LOBYTE(v76) = *(_BYTE *)(v79 + 481);
  }
  LOBYTE(v80) = v6;
  if ( v4 )
  {
    v1 = (float *)sub_413250(*(unsigned __int16 *)(v4 + 4));
    if ( !v1 )
      return 0;
    *(_DWORD *)(v4 + 56) = *(_DWORD *)(a1 + 56);
    *(_DWORD *)(v4 + 60) = *(_DWORD *)(a1 + 60);
    *(_DWORD *)(v4 + 72) = *(_DWORD *)(a1 + 56);
    *(_DWORD *)(v4 + 76) = *(_DWORD *)(a1 + 60);
  }
  else if ( !v6 )
  {
    LOBYTE(v80) = sub_415FA0(23, 24);
    if ( !(*(_BYTE *)(a1 + 8) & 4) )
      goto LABEL_171;
    if ( !*(_BYTE *)(*(_DWORD *)(v79 + 276) + 2251) && sub_415FA0(0, 100) >= 75 )
      LOBYTE(v80) = 25;
    if ( *(_BYTE *)(a1 + 8) & 4 )
      *(_BYTE *)(*(_DWORD *)(v79 + 276) + 8) = v80;
    else
LABEL_171:
      *(_BYTE *)(v79 + 2068) = v80;
  }
  *(_DWORD *)&v82[28] = v4;
  v81 = sub_4F9FD0(a1);
  if ( sub_4FC250(a1, 2) && sub_4FC3E0(a1, 2) )
  {
    sub_4F9F90(46, &v77, &v78);
    HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
    if ( v76 == 770 )
    {
      v7 = *(float *)(a1 + 56);
      v8 = *(float *)(a1 + 60);
      LODWORD(v83.field_0) = a1;
      v83.field_4 = v7;
      v83.field_8 = v8;
      sub_4D9110((float *)(a1 + 56), 15);
      sub_517F90((float2 *)(a1 + 56), 300.0, sub_539B90, a1);
      sub_52BBB0(13, a1, a1, a1);
    }
    if ( HIBYTE(v76) >= v77 )
      sub_4FC440(a1, 2);
    goto LABEL_159;
  }
  if ( sub_4FC250(a1, 1) )
  {
    if ( !sub_4FF350(a1, 25) && !sub_4FF350(a1, 5) )
    {
      sub_4F9F90(45, &v77, &v78);
      v9 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
      v10 = *(float *)(a1 + 548) * 6.0;
      *(float *)(a1 + 544) = v10;
      HIBYTE(v76) = v9;
      v11 = 8 * *(__int16 *)(a1 + 124);
      v12 = v77 - 1;
      *(float *)(a1 + 88) = v10 * *(float *)&byte_587000[v11 + 194136] + *(float *)(a1 + 88);
      *(float *)(a1 + 92) = v10 * *(float *)&byte_587000[v11 + 194140] + *(float *)(a1 + 92);
      if ( HIBYTE(v76) >= v12 )
        HIBYTE(v76) = 0;
      goto LABEL_159;
    }
    return 0;
  }
  if ( !v4 )
  {
    sub_4F9F90((unsigned __int8)v80, &v77, &v78);
    if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
      *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
    HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
    if ( HIBYTE(v76) < v77 )
      goto LABEL_159;
    if ( (unsigned __int8)v80 >= 0x17u )
    {
      if ( (unsigned __int8)v80 <= 0x18u )
      {
        v13 = 0.039999999;
        v14 = 5;
        goto LABEL_39;
      }
      if ( (_BYTE)v80 == 25 )
      {
        v13 = 0.039999999;
        v14 = 10;
LABEL_39:
        v15 = *(_DWORD *)(a1 + 56);
        v16 = *(_DWORD *)(a1 + 60);
        *(float *)&v87[64] = v13;
        *(_WORD *)&v87[72] = v14;
        *(_DWORD *)&v82[16] = v15;
        *(_DWORD *)&v82[20] = v16;
        *(_WORD *)&v87[60] = 0;
        *(float *)v82 = sub_4EF1E0(v81, (int)v87);
        v17 = *(float *)(a1 + 176) + 20.0;
        v82[4] = 10;
        *(_DWORD *)&v82[12] = a1;
        *(_DWORD *)&v82[24] = 0;
        *(float *)&v82[8] = v17;
        v82[32] = 1;
        *(_DWORD *)&v82[28] = 0;
        v18 = sub_538330(a1, (int)v82);
LABEL_56:
        if ( !v18 )
          sub_501960(879, a1, 0, 0);
        goto LABEL_159;
      }
    }
    v13 = 0.0;
    v14 = 0;
    goto LABEL_39;
  }
  if ( v5 & 0x47F8000 )
  {
    v19 = *(_DWORD *)(v4 + 736);
    v86 = *(_DWORD *)(v4 + 736);
    if ( (v5 & 0x8000) != 0 || (v20 = *(_BYTE *)(v19 + 96), v80 = 31, v20 & 2) )
      v80 = 29;
    sub_4F9F90(v80, &v77, &v78);
    if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
    {
      if ( v80 == 29 )
        *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
      else
        *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000];
    }
    HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
    if ( HIBYTE(v76) >= v77 )
    {
      if ( v5 & 0x47F0000 )
        *(_DWORD *)(v86 + 96) &= 0xFFFFFFFD;
      goto LABEL_159;
    }
    if ( v80 != 29 || HIBYTE(v76) != v77 / 2 || HIBYTE(v76) <= (unsigned __int8)v76 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 )
      {
        if ( v80 != 29 && v76 == 256 )
        {
          v24 = *(_DWORD *)(v4 + 736);
          sub_53F8E0(a1, v4);
          if ( !*(_BYTE *)(v24 + 108) )
          {
            if ( *(_BYTE *)(v24 + 109) )
              sub_53A030(a1, v4);
          }
        }
      }
      goto LABEL_159;
    }
    v21 = *(_DWORD *)(a1 + 60);
    *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
    *(_DWORD *)&v82[20] = v21;
    *(float *)v82 = sub_4EF1E0(v81, (int)v1);
    v22 = *(float *)(a1 + 176);
    v82[4] = 0;
    *(_DWORD *)&v82[12] = a1;
    v23 = v22 + v1[17];
    *(_DWORD *)&v82[24] = 0;
    v82[32] = 1;
    *(float *)&v82[8] = v23;
    sub_538840(v4, a1, (int)v82);
    v18 = sub_538330(a1, (int)v82);
    goto LABEL_56;
  }
  if ( v5 & 0x7800000 )
  {
    v25 = ((v5 & 0x3800000) != 0) + 31;
    sub_4F9F90(v25, &v77, &v78);
    if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
      *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
    HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
    if ( v25 != 32 || HIBYTE(v76) != v77 / 2 || HIBYTE(v76) <= (unsigned __int8)v76 )
      goto LABEL_159;
    v26 = *(_DWORD *)(a1 + 60);
    *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
    *(_DWORD *)&v82[20] = v26;
    *(float *)v82 = sub_4EF1E0(v81, (int)v1);
    v27 = *(float *)(a1 + 176);
    v82[4] = 0;
    *(_DWORD *)&v82[12] = a1;
    v28 = v27 + v1[17];
    *(_DWORD *)&v82[24] = 0;
    v82[32] = 1;
    *(float *)&v82[8] = v28;
    sub_538840(v4, a1, (int)v82);
    v18 = sub_538330(a1, (int)v82);
    goto LABEL_56;
  }
  if ( !(v5 & 0x40) )
  {
    if ( (v5 & 0x80u) == 0 )
    {
      if ( v5 & 0x200 )
      {
        sub_4F9F90(28, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v46 = *(_DWORD *)(a1 + 60);
          *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
          *(_DWORD *)&v82[20] = v46;
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v47 = *(float *)(a1 + 176);
          v82[4] = 0;
          *(_DWORD *)&v82[12] = a1;
          v48 = v47 + v1[17];
          *(_DWORD *)&v82[24] = 0;
          v82[32] = 1;
          *(float *)&v82[8] = v48;
          sub_538840(v4, a1, (int)v82);
          if ( !sub_538330(a1, (int)v82) )
            sub_501960(880, a1, 0, 0);
        }
      }
      else if ( v5 & 0x100 )
      {
        sub_4F9F90(27, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v49 = *(_DWORD *)(a1 + 60);
          *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
          *(_DWORD *)&v82[20] = v49;
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v50 = *(float *)(a1 + 176);
          v82[4] = 0;
          *(_DWORD *)&v82[12] = a1;
          v51 = v50 + v1[17];
          *(_DWORD *)&v82[24] = 0;
          v82[32] = 1;
          *(float *)&v82[8] = v51;
          sub_538840(v4, a1, (int)v82);
          if ( !sub_538330(a1, (int)v82) )
            sub_501960(881, a1, 0, 0);
        }
      }
      else if ( v5 & 0x400 )
      {
        sub_4F9F90(37, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v52 = *(_DWORD *)(a1 + 60);
          *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
          *(_DWORD *)&v82[20] = v52;
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v53 = *(float *)(a1 + 176);
          v82[4] = 0;
          *(_DWORD *)&v82[12] = a1;
          v54 = v53 + v1[17];
          *(_DWORD *)&v82[24] = 0;
          v82[32] = 1;
          *(float *)&v82[8] = v54;
          sub_538840(v4, a1, (int)v82);
          if ( !sub_538330(a1, (int)v82) )
            sub_501960(881, a1, 0, 0);
        }
      }
      else if ( v5 & 0x4000 )
      {
        sub_4F9F90(39, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v55 = 8 * *(__int16 *)(a1 + 124);
          *(float *)&v82[16] = *(float *)&byte_587000[v55 + 194136] * 35.0 + *(float *)(a1 + 56);
          *(float *)&v82[20] = *(float *)&byte_587000[v55 + 194140] * 35.0 + *(float *)(a1 + 60);
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v82[4] = 2;
          *(_DWORD *)&v82[12] = a1;
          *(float *)&v82[8] = v1[17];
          *(_DWORD *)&v82[24] = 1;
          v82[32] = 1;
          sub_538840(v4, a1, (int)v82);
          sub_538330(a1, (int)v82);
          v75 = (double)v81 * 0.1;
          v56 = sub_419A70(v75);
          sub_4D9110((float *)(a1 + 56), v56);
          sub_501960(882, a1, 0, 0);
        }
      }
      else if ( v5 & 0x800 )
      {
        sub_4F9F90(26, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v57 = *(_DWORD *)(a1 + 60);
          *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
          *(_DWORD *)&v82[20] = v57;
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v58 = *(float *)(a1 + 176);
          v82[4] = 2;
          *(_DWORD *)&v82[12] = a1;
          v59 = v58 + v1[17];
          *(_DWORD *)&v82[24] = 1;
          v82[32] = 1;
          *(float *)&v82[8] = v59;
          sub_538840(v4, a1, (int)v82);
          if ( !sub_538330(a1, (int)v82) )
            sub_501960(884, a1, 0, 0);
        }
      }
      else if ( v5 & 0x3000 )
      {
        sub_4F9F90(35, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
          *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        if ( HIBYTE(v76) == v77 / 2 && HIBYTE(v76) > (unsigned __int8)v76 )
        {
          v60 = *(_DWORD *)(a1 + 60);
          *(_DWORD *)&v82[16] = *(_DWORD *)(a1 + 56);
          *(_DWORD *)&v82[20] = v60;
          *(float *)v82 = sub_4EF1E0(v81, (int)v1);
          v61 = *(float *)(a1 + 176);
          v82[4] = 0;
          *(_DWORD *)&v82[12] = a1;
          v62 = v61 + v1[17];
          *(_DWORD *)&v82[24] = 1;
          v82[32] = 1;
          *(float *)&v82[8] = v62;
          sub_538840(v4, a1, (int)v82);
          if ( !sub_538330(a1, (int)v82) )
            sub_501960(883, a1, 0, 0);
        }
      }
      else if ( v5 & 4 )
      {
        sub_4F9F90(33, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 )
        {
          v63 = (_DWORD *)v79;
          if ( !*(_DWORD *)v79 )
          {
            v64 = sub_4E0960(v4);
            *v63 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1) - v64;
          }
        }
        v65 = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        v66 = sub_4E0960(v4) + v65;
        HIBYTE(v76) = v66;
        if ( v66 >= v77 - 1 && v66 > (unsigned __int8)v76 )
        {
          sub_539BD0(a1, v4);
          HIBYTE(v76) = v77;
        }
      }
      else if ( v5 & 8 )
      {
        sub_4F9F90(34, &v77, &v78);
        if ( *(_BYTE *)(a1 + 8) & 4 )
        {
          v67 = (_DWORD *)v79;
          if ( !*(_DWORD *)v79 )
          {
            v68 = sub_4E0960(v4);
            *v67 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1) - v68;
          }
        }
        HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
        v69 = (int)HIBYTE(v76) < 1;
        if ( HIBYTE(v76) == 1 )
        {
          if ( !(_BYTE)v76 )
            sub_539BD0(a1, v4);
          v69 = 0;
        }
        if ( !v69 )
          HIBYTE(v76) += sub_4E0960(v4);
      }
      goto LABEL_159;
    }
    sub_4F9F90(44, &v77, &v78);
    if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
      *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
    HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
    if ( HIBYTE(v76) != v77 / 2 || HIBYTE(v76) <= (unsigned __int8)v76 )
      goto LABEL_159;
    v37 = *(float *)(a1 + 176) + 4.0;
    v38 = 8 * *(__int16 *)(a1 + 124);
    v39 = *(float *)(a1 + 60);
    v40 = *(char **)(v4 + 736);
    v41 = v37 * *(float *)&byte_587000[v38 + 194136] + *(float *)(a1 + 56);
    v83.field_0 = *(float *)(a1 + 56);
    v83.field_4 = v39;
    v83.field_8 = v41;
    v83.field_C = v37 * *(float *)&byte_587000[v38 + 194140] + *(float *)(a1 + 60);
    if ( sub_535250(&v83, 0, 0, 4) )
    {
      v42 = sub_4E3810((CHAR *)&byte_587000[277332]);
      v43 = (int)v42;
      if ( v42 )
      {
        *(_DWORD *)(v42[175] + 4) = a1;
        sub_4DAA50((int)v42, a1, v83.field_8, v83.field_C);
        sub_4E4990(v43, *(int **)(v4 + 692));
        *(float *)(v43 + 80) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136] * *(float *)(v43 + 544);
        *(float *)(v43 + 84) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194140] * *(float *)(v43 + 544);
        v44 = *(_WORD *)(a1 + 124);
        *(_WORD *)(v43 + 124) = v44;
        *(_WORD *)(v43 + 126) = v44;
        sub_501960(891, a1, 0, 0);
        if ( !v40[2] )
        {
          v45 = v40[1] - 1;
          v40[1] = v45;
          if ( v45 )
          {
            if ( *(_BYTE *)(a1 + 8) & 4 )
              sub_4D82B0(*(unsigned __int8 *)(*(_DWORD *)(v79 + 276) + 2064), (_DWORD *)v4, v45, *v40);
          }
          else
          {
            sub_4ED0C0(a1, (int *)v4);
            sub_4E5CC0(v4);
            sub_539FB0((_DWORD *)a1);
          }
        }
        goto LABEL_159;
      }
      return 0;
    }
LABEL_94:
    sub_501960(323, a1, 0, 0);
    goto LABEL_159;
  }
  sub_4F9F90(44, &v77, &v78);
  if ( *(_BYTE *)(a1 + 8) & 4 && !*(_DWORD *)v79 )
    *(_DWORD *)v79 = *(_DWORD *)&byte_5D4594[2598000] + v77 * (v78 + 1);
  HIBYTE(v76) = (*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) / (unsigned int)(v78 + 1);
  if ( HIBYTE(v76) != v77 / 2 || HIBYTE(v76) <= (unsigned __int8)v76 )
    goto LABEL_159;
  v29 = *(float *)(a1 + 176) + 4.0;
  v30 = 8 * *(__int16 *)(a1 + 124);
  v31 = *(float *)(a1 + 60);
  v32 = v29 * *(float *)&byte_587000[v30 + 194136] + *(float *)(a1 + 56);
  v83.field_0 = *(float *)(a1 + 56);
  v83.field_4 = v31;
  v83.field_8 = v32;
  v83.field_C = v29 * *(float *)&byte_587000[v30 + 194140] + *(float *)(a1 + 60);
  if ( !sub_535250(&v83, 0, 0, 5) )
    goto LABEL_94;
  v33 = sub_4E3810((CHAR *)&byte_587000[277308]);
  v34 = (int)v33;
  if ( !v33 )
    return 0;
  v35 = v33[187];
  sub_4ED0C0(a1, (int *)v4);
  sub_4DAA50(v34, a1, v83.field_8, v83.field_C);
  sub_4F3070(v34, v4, 1);
  sub_4E4990(v34, *(int **)(v4 + 692));
  *(float *)(v34 + 80) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136] * *(float *)(v34 + 544);
  *(float *)(v34 + 84) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194140] * *(float *)(v34 + 544);
  v36 = *(_WORD *)(a1 + 124);
  *(_WORD *)(v34 + 124) = v36;
  *(_WORD *)(v34 + 126) = v36;
  *(_BYTE *)(v35 + 4) = 4;
  *(_DWORD *)(v35 + 16) = *(_DWORD *)(a1 + 56);
  *(_DWORD *)(v35 + 20) = *(_DWORD *)(a1 + 60);
  *(_BYTE *)(v35 + 24) = 2;
  sub_501960(891, a1, 0, 0);
LABEL_159:
  v70 = *(_DWORD *)(a1 + 8);
  if ( v70 & 4 )
  {
    v71 = v79;
    v72 = HIBYTE(v76);
    *(_BYTE *)(v79 + 236) = HIBYTE(v76);
    if ( HIBYTE(v76) >= v77 )
      *(_BYTE *)(v71 + 236) = v77 - 1;
  }
  else if ( v70 & 2 && *(_BYTE *)(a1 + 12) & 0x10 )
  {
    v73 = v79;
    *(_BYTE *)(v79 + 481) = HIBYTE(v76);
    v72 = HIBYTE(v76);
    if ( HIBYTE(v76) >= v77 )
      *(_BYTE *)(v73 + 481) = v77 - 1;
  }
  else
  {
    v72 = HIBYTE(v76);
  }
  return v72 < v77;
}
// 539AF2: variable 'v76' is possibly undefined

//----- (00539B90) --------------------------------------------------------
__int16 __cdecl sub_539B90(int a1, int a2)
{
  __int16 result; // ax

  result = a2;
  if ( a2 )
  {
    result = a1;
    if ( a1 )
    {
      if ( *(_BYTE *)(a1 + 8) & 2 && *(_DWORD *)(a1 + 12) & 0x20000 && !(*(_DWORD *)(a1 + 16) & 0x8020) )
        result = sub_4FF380(a1, 5, 90, 3);
    }
  }
  return result;
}

//----- (00539BD0) --------------------------------------------------------
int __cdecl sub_539BD0(int a1, int a2)
{
  int v2; // eax
  _BYTE *v3; // edi
  char *v4; // ebx
  _DWORD *v6; // esi
  int v7; // eax
  int v8; // eax

  v2 = sub_415820(a2);
  v3 = *(_BYTE **)(a2 + 736);
  v4 = (char *)v2;
  if ( !*v3 )
  {
    v6 = *(_DWORD **)(a1 + 504);
    if ( v6 )
    {
      while ( 1 )
      {
        v7 = v6[4];
        if ( v7 & 0x100 )
        {
          if ( sub_415820((int)v6) == 2 )
          {
            v8 = v6[184];
            if ( *(_BYTE *)(v8 + 1) || *(_BYTE *)(v8 + 2) == 1 )
              break;
          }
        }
        v6 = (_DWORD *)v6[124];
        if ( !v6 )
          goto LABEL_14;
      }
      sub_539D80(a1, (int)v6, a2, v4);
      return 1;
    }
LABEL_14:
    if ( sub_40A5C0(4096) && v4 == (char *)4 )
      sub_539D80(a1, 0, a2, (char *)4);
    if ( !(*(_BYTE *)(a1 + 8) & 4) )
      return 0;
    if ( sub_539FF0((_DWORD *)a1) == 1 )
    {
      sub_4DA2C0(a1, (const char *)&byte_587000[277380], 0);
      *v3 = 0;
    }
    else
    {
      if ( sub_40A5C0(4096) && v4 == (char *)4 )
        goto LABEL_25;
      sub_4DA2C0(a1, (const char *)&byte_587000[277404], 0);
    }
    if ( v4 != (char *)4 )
    {
      if ( v4 == (char *)8 )
        sub_501960(888, a1, 0, 0);
      goto LABEL_29;
    }
LABEL_25:
    if ( !sub_40A5C0(4096) )
      sub_501960(887, a1, 0, 0);
LABEL_29:
    sub_4FA020((_DWORD *)a1, 13);
    return 0;
  }
  sub_4DA2C0(a1, (const char *)&byte_587000[277352], 0);
  if ( v4 == (char *)4 )
  {
    if ( !sub_40A5C0(4096) )
    {
      sub_501960(887, a1, 0, 0);
      --*v3;
      return 0;
    }
  }
  else if ( v4 == (char *)8 )
  {
    sub_501960(888, a1, 0, 0);
  }
  --*v3;
  return 0;
}

//----- (00539D80) --------------------------------------------------------
_DWORD *__cdecl sub_539D80(int a1, int a2, int a3, char *a4)
{
  double v4; // st7
  char *v5; // ebx
  int v6; // eax
  double v7; // st6
  double v8; // st7
  float v9; // eax
  _DWORD *result; // eax
  _DWORD *v11; // eax
  int v12; // edi
  __int16 v13; // ax
  int v14; // edi
  char v15; // al
  char v16; // cl
  float v17; // [esp+Ch] [ebp-18h]
  float v18; // [esp+10h] [ebp-14h]
  float4 v19; // [esp+14h] [ebp-10h]

  v4 = *(float *)(a1 + 176) + 4.0;
  if ( a2 )
    v5 = *(char **)(a2 + 736);
  else
    v5 = a4;
  v6 = 8 * *(__int16 *)(a1 + 124);
  v7 = v4 * *(float *)&byte_587000[v6 + 194136];
  v19.field_4 = *(float *)(a1 + 60);
  v17 = v7 + *(float *)(a1 + 56);
  v8 = v4 * *(float *)&byte_587000[v6 + 194140];
  v9 = *(float *)(a1 + 56);
  v19.field_8 = v17;
  v19.field_0 = v9;
  v18 = v8 + *(float *)(a1 + 60);
  v19.field_C = v18;
  result = (_DWORD *)sub_535250(&v19, 0, 0, 5);
  if ( result )
  {
    if ( a2 )
    {
      if ( a4 == (char *)4 )
        v11 = sub_4E3810((CHAR *)&byte_587000[277440]);
      else
        v11 = sub_4E3810((CHAR *)&byte_587000[277452]);
    }
    else
    {
      v11 = sub_4E3810((CHAR *)&byte_587000[277424]);
    }
    v12 = (int)v11;
    if ( v11 )
    {
      *(_DWORD *)(v11[175] + 4) = a1;
      sub_4DAA50((int)v11, a1, v17, v18);
      if ( a2 )
        sub_4E4990(v12, *(int **)(a2 + 692));
      sub_539F40(a1, a3, v12);
      *(float *)(v12 + 80) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194136] * *(float *)(v12 + 544);
      *(float *)(v12 + 84) = *(float *)&byte_587000[8 * *(__int16 *)(a1 + 124) + 194140] * *(float *)(v12 + 544);
      v13 = *(_WORD *)(a1 + 124);
      *(_WORD *)(v12 + 124) = v13;
      *(_WORD *)(v12 + 126) = v13;
    }
    if ( a2 )
    {
      if ( !v5[2] )
      {
        if ( *(_BYTE *)(a1 + 8) & 4 )
        {
          v14 = *(_DWORD *)(a1 + 748);
          v15 = v5[1] - 1;
          v16 = *v5;
          v5[1] = v15;
          sub_4D82B0(*(unsigned __int8 *)(*(_DWORD *)(v14 + 276) + 2064), (_DWORD *)a2, v15, v16);
          if ( !v5[1] )
            sub_4E5CC0(a2);
        }
      }
    }
    if ( a4 == (char *)4 )
      result = sub_501960(885, a1, 0, 0);
    else
      result = sub_501960(886, a1, 0, 0);
  }
  return result;
}

//----- (00539F40) --------------------------------------------------------
int __cdecl sub_539F40(int a1, int a2, int a3)
{
  int v3; // ebx
  int v4; // edi
  int *v5; // esi
  int v6; // eax
  int (__cdecl *v7)(int, int, int, int, int); // ecx
  int result; // eax
  int v9; // [esp+18h] [ebp+8h]
  int v10; // [esp+1Ch] [ebp+Ch]

  v3 = a3;
  v4 = a2;
  v10 = *(_DWORD *)(a3 + 692);
  v9 = 2;
  v5 = (int *)(*(_DWORD *)(v4 + 692) + 8);
  do
  {
    v6 = *v5;
    if ( *v5 )
    {
      if ( *(char (__cdecl **)(int, int, int, int))(v6 + 52) == sub_4E0640 )
      {
        *(_DWORD *)(v10 + 12) = v6;
      }
      else
      {
        v7 = *(int (__cdecl **)(int, int, int, int, int))(v6 + 40);
        if ( v7 == sub_4E09B0 )
          v7(v6, v4, a1, 0, v3);
      }
    }
    ++v5;
    result = --v9;
  }
  while ( v9 );
  return result;
}

//----- (00539FB0) --------------------------------------------------------
int __cdecl sub_539FB0(_DWORD *a1)
{
  int v1; // esi

  v1 = a1[126];
  if ( !v1 )
    return 0;
  while ( sub_415820(v1) != 128 )
  {
    v1 = *(_DWORD *)(v1 + 496);
    if ( !v1 )
      return 0;
  }
  return sub_53A420(a1, v1, 1, 1);
}

//----- (00539FF0) --------------------------------------------------------
int __cdecl sub_539FF0(_DWORD *a1)
{
  int v1; // esi

  v1 = a1[126];
  if ( !v1 )
    return 0;
  while ( sub_415820(v1) != 2 )
  {
    v1 = *(_DWORD *)(v1 + 496);
    if ( !v1 )
      return 0;
  }
  return sub_53A420(a1, v1, 1, 1);
}

//----- (0053A030) --------------------------------------------------------
int __cdecl sub_53A030(int a1, int a2)
{
  int v2; // ebp
  int result; // eax
  int v4; // eax
  int v5; // ecx

  v2 = *(_DWORD *)(a1 + 748);
  if ( !(*(_DWORD *)(a2 + 8) & 0x1001000) )
    return 0;
  v4 = *(_DWORD *)(a2 + 16);
  if ( !(v4 & 0x100) )
    return 0;
  result = *(_DWORD *)(a1 + 504);
  if ( !result )
    return 0;
  while ( result != a2 )
  {
    result = *(_DWORD *)(result + 496);
    if ( !result )
      return result;
  }
  *(_BYTE *)(v2 + 2068) = 0;
  v5 = *(_DWORD *)(a2 + 16);
  BYTE1(v5) &= 0xFEu;
  *(_DWORD *)(a2 + 16) = v5;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    sub_4E4B20(a1, a2, 0);
  if ( *(_BYTE *)(a2 + 12) & 0xC )
    sub_53A0F0(a1, 1, 1);
  if ( !(*(_BYTE *)(a2 + 12) & 2) )
    *(_DWORD *)(v2 + 2064) = 0;
  sub_4F3030(a2, a1);
  sub_4FEB60(a1, a2);
  return 1;
}

//----- (0053A0F0) --------------------------------------------------------
void __cdecl sub_53A0F0(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // eax

  v3 = *(_DWORD *)(a1 + 504);
  if ( v3 )
  {
    while ( 1 )
    {
      v4 = *(_DWORD *)(v3 + 16);
      if ( v4 & 0x100 )
      {
        if ( sub_415820(v3) == 2 )
          break;
      }
      v3 = *(_DWORD *)(v3 + 496);
      if ( !v3 )
        return;
    }
    sub_53A140((_DWORD *)a1, v3, a2, a3);
  }
}

//----- (0053A140) --------------------------------------------------------
int __cdecl sub_53A140(_DWORD *a1, int a2, int a3, int a4)
{
  _DWORD *v4; // edi
  int v5; // eax
  _DWORD *v6; // ebx
  int v7; // ecx
  int v8; // eax
  int v10; // esi
  _DWORD *v11; // eax
  int v12; // edx
  int v13; // eax
  int v14; // ebx
  int v15; // ebx
  int v16; // ebp
  int v17; // ebp
  _DWORD *v18; // eax
  int v19; // [esp+14h] [ebp+8h]

  v4 = (_DWORD *)a2;
  v5 = sub_415820(a2);
  v6 = a1;
  v7 = v5;
  v19 = v5;
  v8 = a1[2];
  if ( v8 & 2 )
    return sub_53A030((int)a1, (int)v4);
  if ( !(v8 & 4) || !(v4[2] & 0x1001000) )
    return 0;
  v10 = a1[187];
  if ( *(_BYTE *)(v10 + 88) == 1 )
  {
    sub_4FA020(a1, 13);
    v7 = v19;
  }
  v11 = *(_DWORD **)(v10 + 104);
  if ( !v11 || v11 != v4 && v7 != 2 )
    return 0;
  if ( v7 & 0xC )
    sub_53A0F0((int)a1, a3, a4);
  sub_4FEB60((int)a1, (int)v4);
  if ( v19 == 2 )
  {
    v12 = v4[4];
    BYTE1(v12) &= 0xFEu;
    v4[4] = v12;
    *(_DWORD *)(*(_DWORD *)(v10 + 276) + 4) &= 0xFFFFFFFD;
    if ( a3 )
      sub_4D8590(*(unsigned __int8 *)(*(_DWORD *)(v10 + 276) + 2064), v4);
    if ( a4 )
      sub_4D84C0(255, (int)v4);
  }
  else
  {
    v13 = *(_DWORD *)(v10 + 104);
    v14 = *(_DWORD *)(v13 + 16);
    BYTE1(v14) &= 0xFEu;
    *(_DWORD *)(v13 + 16) = v14;
    v15 = *(_DWORD *)(v10 + 276);
    *(_DWORD *)(v15 + 4) &= ~sub_415820(*(_DWORD *)(v10 + 104));
    if ( a3 )
      sub_4D8590(*(unsigned __int8 *)(*(_DWORD *)(v10 + 276) + 2064), *(_DWORD **)(v10 + 104));
    if ( a4 )
      sub_4D84C0(255, (int)v4);
    v6 = a1;
    *(_DWORD *)(v10 + 104) = 0;
  }
  sub_4F3030((int)v4, (int)v6);
  sub_980523((int)v6);
  v16 = v6[187];
  if ( !*(_DWORD *)(v16 + 108) || !(sub_415820(*(_DWORD *)(v16 + 108)) & 0x7FFE40C) )
  {
    v17 = *(_DWORD *)(*(_DWORD *)(v16 + 276) + 2500);
    if ( v17 && (unsigned __int8)*(_DWORD *)(v17 + 16) == 16 )
    {
      sub_4F2F70((int)v6, v17);
    }
    else
    {
      v18 = sub_9805EB((int)v6);
      if ( v18 )
        sub_4F2F70((int)v6, (int)v18);
    }
  }
  return 1;
}

//----- (0053A2C0) --------------------------------------------------------
int __cdecl sub_53A2C0(int a1, int a2)
{
  int v2; // ebp
  int result; // eax
  int v4; // eax
  int v5; // ecx
  int v6; // eax
  int v7; // edx
  int v8; // ecx

  v2 = *(_DWORD *)(a1 + 748);
  if ( !(*(_DWORD *)(a2 + 8) & 0x1001000) )
    return 0;
  v4 = *(_DWORD *)(a2 + 16);
  if ( v4 & 0x100 )
    return 0;
  result = *(_DWORD *)(a1 + 504);
  if ( !result )
    return 0;
  while ( result != a2 )
  {
    result = *(_DWORD *)(result + 496);
    if ( !result )
      return result;
  }
  *(_BYTE *)(v2 + 2068) = 0;
  if ( !(*(_BYTE *)(a2 + 12) & 0xC) )
    sub_53A0F0(a1, 1, 1);
  v5 = *(_DWORD *)(a2 + 12);
  if ( !(v5 & 2) )
  {
    v6 = *(_DWORD *)(a1 + 504);
    if ( v6 )
    {
      while ( 1 )
      {
        v7 = *(_DWORD *)(v6 + 16);
        if ( v7 & 0x100 )
        {
          if ( *(_DWORD *)(v6 + 8) & 0x1001000 && (!(v5 & 0xC) || !(*(_BYTE *)(v6 + 12) & 2)) )
            break;
        }
        v6 = *(_DWORD *)(v6 + 496);
        if ( !v6 )
          goto LABEL_22;
      }
      sub_53A030(a1, v6);
    }
  }
LABEL_22:
  v8 = *(_DWORD *)(a2 + 16);
  BYTE1(v8) |= 1u;
  *(_DWORD *)(a2 + 16) = v8;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    sub_4E4B20(a1, a2, 1);
  if ( !(*(_BYTE *)(a2 + 12) & 2) )
    *(_DWORD *)(v2 + 2064) = a2;
  sub_4F2FF0(a2, a1);
  if ( sub_415820(a2) & 0x7FFE40C )
    sub_53A3D0((_DWORD *)a1);
  return 1;
}

//----- (0053A3D0) --------------------------------------------------------
void __cdecl sub_53A3D0(_DWORD *a1)
{
  _DWORD *i; // esi
  int v2; // eax

  if ( a1 )
  {
    for ( i = (_DWORD *)a1[126]; i; i = (_DWORD *)i[124] )
    {
      if ( i[2] & 0x2000000 )
      {
        v2 = i[4];
        if ( v2 & 0x100 )
        {
          if ( sub_415C70((int)i) & 0x3000000 )
            sub_53E430(a1, (int)i, 1, 1);
        }
      }
    }
  }
}

//----- (0053A420) --------------------------------------------------------
int __cdecl sub_53A420(_DWORD *a1, int a2, int a3, int a4)
{
  int v4; // ebx
  int v5; // eax
  int v6; // eax
  int result; // eax
  int v8; // ebp
  int v9; // eax
  int v10; // eax
  int v11; // edx
  int v12; // eax

  v4 = sub_415820(a2);
  if ( !(*(_DWORD *)(a2 + 8) & 0x1001000) )
    return 0;
  v5 = *(_DWORD *)(a2 + 16);
  if ( v5 & 0x100 )
    return 0;
  v6 = a1[2];
  if ( v6 & 2 )
    return sub_53A2C0((int)a1, a2);
  if ( !(v6 & 4) )
    return 0;
  v8 = a1[187];
  if ( sub_4FC3E0((int)a1, 2) || sub_4FC3E0((int)a1, 1) )
    return 0;
  if ( !sub_57B3D0(a2, *(_BYTE *)(*(_DWORD *)(v8 + 276) + 2251)) )
  {
    sub_4DA2C0((int)a1, (const char *)&byte_587000[277464], 0);
    goto LABEL_10;
  }
  LOBYTE(v9) = sub_4F3180((int)a1, a2);
  if ( !v9 )
  {
    sub_4DA2C0((int)a1, (const char *)&byte_587000[277496], 0);
    if ( a4 )
      sub_501960(925, (int)a1, 2, a1[9]);
    return 0;
  }
  result = a1[126];
  if ( !result )
    return 0;
  while ( result != a2 )
  {
    result = *(_DWORD *)(result + 496);
    if ( !result )
      return result;
  }
  if ( *(_BYTE *)(v8 + 88) == 1 )
    sub_4FA020(a1, 13);
  if ( v4 == 2 )
  {
    if ( !(*(_BYTE *)(*(_DWORD *)(v8 + 276) + 4) & 0xC) && !sub_53A680((int)a1) )
    {
      sub_4DA2C0((int)a1, (const char *)&byte_587000[277532], 0);
LABEL_10:
      if ( a4 )
        sub_501960(925, (int)a1, 2, a1[9]);
      return 0;
    }
    sub_53A0F0((int)a1, 1, 1);
  }
  v10 = *(_DWORD *)(v8 + 104);
  if ( v10 && v4 != 2 && !sub_53A140(a1, v10, 1, 1) )
    return 0;
  v11 = *(_DWORD *)(a2 + 16);
  BYTE1(v11) |= 1u;
  *(_DWORD *)(a2 + 16) = v11;
  *(_DWORD *)(*(_DWORD *)(v8 + 276) + 4) |= v4;
  sub_4D8540(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (_DWORD *)a2, a3);
  if ( v4 != 2 )
    *(_DWORD *)(v8 + 104) = a2;
  v12 = *(_DWORD *)(a2 + 8);
  if ( v12 & 0x1000 && *(_DWORD *)(a2 + 12) & 0x47F0000 )
  {
    sub_4D82B0(
      *(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064),
      (_DWORD *)a2,
      *(_BYTE *)(*(_DWORD *)(a2 + 736) + 108),
      *(_BYTE *)(*(_DWORD *)(a2 + 736) + 109));
  }
  else if ( v12 & 0x1000000 )
  {
    if ( v4 & 0x82 )
    {
      sub_4D82B0(
        *(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064),
        (_DWORD *)a2,
        *(_BYTE *)(*(_DWORD *)(a2 + 736) + 1),
        **(_BYTE **)(a2 + 736));
    }
    else if ( v4 & 0xC )
    {
      **(_BYTE **)(a2 + 736) = 0;
    }
  }
  sub_4F2FF0(a2, (int)a1);
  if ( v4 & 0x7FFE40C )
    sub_53A3D0(a1);
  return 1;
}
// 53A4E9: variable 'v9' is possibly undefined

//----- (0053A680) --------------------------------------------------------
int __cdecl sub_53A680(int a1)
{
  int v1; // esi

  v1 = *(_DWORD *)(a1 + 504);
  if ( !v1 )
    return 0;
  while ( !(sub_415820(v1) & 0xC) )
  {
    v1 = *(_DWORD *)(v1 + 496);
    if ( !v1 )
      return 0;
  }
  return sub_53A420((_DWORD *)a1, v1, 1, 1);
}

//----- (0053A6C0) --------------------------------------------------------
void __cdecl sub_53A6C0(int a1, int a2)
{
  int v2; // edx
  __int16 v3; // ax

  if ( a1 && a2 )
  {
    v2 = *(_DWORD *)(a2 + 8);
    if ( v2 & 0x1000 )
    {
      sub_501960(830, a1, 0, 0);
    }
    else
    {
      v3 = *(_WORD *)(a2 + 24);
      if ( v3 & 0x10 )
      {
        sub_501960(842, a1, 0, 0);
      }
      else if ( v3 & 8 )
      {
        sub_501960(844, a1, 0, 0);
      }
    }
  }
}

//----- (0053A720) --------------------------------------------------------
int __cdecl sub_53A720(int a1, int a2, int a3, int a4)
{
  _DWORD *v4; // esi
  int v5; // ebp
  int v6; // ebx
  int v8; // eax
  int v9; // ebp
  int v10; // eax
  int v11; // eax
  float v12; // [esp+0h] [ebp-14h]
  int v13; // [esp+18h] [ebp+4h]

  v4 = (_DWORD *)a1;
  v5 = 0;
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    if ( sub_40A5C0(4096) )
    {
      if ( *(_DWORD *)(a2 + 12) & 0x200000 )
      {
        v12 = sub_419D40(&byte_587000[277556]);
        v6 = sub_419A70(v12);
        if ( sub_4E7D30(a1, *(unsigned __int16 *)(a2 + 4)) >= v6 )
        {
          sub_4DA2C0(a1, (const char *)&byte_587000[277580], 0);
          sub_501960(925, a1, 0, 0);
          return 0;
        }
      }
    }
  }
  if ( !sub_40A5C0(2048) && !sub_40A5C0(4096) && sub_409F40(2) )
  {
    if ( !(*(_BYTE *)(a2 + 12) & 0x82) && sub_4E7EC0(a1, a2) )
      v5 = 1;
    if ( *(_BYTE *)(a2 + 12) & 0x40 )
    {
      v8 = *(_DWORD *)(a1 + 516);
      if ( v8 )
      {
        while ( !(*(_DWORD *)(v8 + 8) & 0x1000000) || !(*(_BYTE *)(v8 + 12) & 0x40) )
        {
          v8 = *(_DWORD *)(v8 + 512);
          if ( !v8 )
            goto LABEL_18;
        }
        goto LABEL_19;
      }
    }
LABEL_18:
    if ( v5 == 1 )
    {
LABEL_19:
      if ( *(_BYTE *)(a1 + 8) & 4 )
      {
        sub_4DA2C0(a1, (const char *)&byte_587000[277604], 0);
        sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
      }
      return 0;
    }
  }
  if ( !sub_40A5C0(2048)
    && !sub_40A5C0(4096)
    && *(_BYTE *)(a1 + 8) & 4
    && !sub_57B3D0(a2, *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2251)) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[277644], 0);
    sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
    return 0;
  }
  if ( sub_4F31E0(a1, a2, a3) != 1 )
    return 0;
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v9 = 0;
    v13 = *(_DWORD *)(a1 + 748);
    if ( !*(_DWORD *)(v13 + 104) && !sub_419E60((int)v4) && sub_415820(a2) != 2 )
      v9 = sub_53A420(v4, a2, a4, 0);
    if ( !sub_419E60((int)v4) && sub_415820(a2) == 2 )
    {
      v10 = *(_DWORD *)(*(_DWORD *)(v13 + 276) + 4);
      if ( v10 & 0xC )
      {
        if ( !(v10 & 2) )
          v9 = sub_53A420(v4, a2, a4, 0);
      }
    }
    if ( !v9 )
    {
      v11 = *(_DWORD *)(a2 + 8);
      if ( v11 & 0x1000 && *(_DWORD *)(a2 + 12) & 0x47F0000 )
      {
        sub_4D82B0(
          *(unsigned __int8 *)(*(_DWORD *)(v13 + 276) + 2064),
          (_DWORD *)a2,
          *(_BYTE *)(*(_DWORD *)(a2 + 736) + 108),
          *(_BYTE *)(*(_DWORD *)(a2 + 736) + 109));
      }
      else if ( v11 & 0x1000000 && *(_BYTE *)(a2 + 12) & 0x82 )
      {
        sub_4D82B0(
          *(unsigned __int8 *)(*(_DWORD *)(v13 + 276) + 2064),
          (_DWORD *)a2,
          *(_BYTE *)(*(_DWORD *)(a2 + 736) + 1),
          **(_BYTE **)(a2 + 736));
      }
    }
  }
  sub_53A6C0((int)v4, a2);
  sub_5116F0(a2);
  return 1;
}

//----- (0053A9C0) --------------------------------------------------------
int __cdecl sub_53A9C0(int a1, int a2, int a3, int a4)
{
  int v4; // edi
  int v5; // eax

  v4 = sub_53A720(a1, a2, a3, a4);
  if ( v4 == 1 && *(_BYTE *)(a1 + 8) & 4 && !sub_419E60(a1) )
  {
    v5 = *(_DWORD *)(a2 + 12);
    if ( 0x800000 & v5 )
    {
      sub_4DA2C0(a1, (const char *)&byte_587000[277676], 0);
      sub_501960(914, a1, 0, 0);
    }
    else if ( v5 & 0x1000000 )
    {
      sub_4DA2C0(a1, (const char *)&byte_587000[277708], 0);
      sub_501960(915, a1, 0, 0);
    }
    else if ( v5 & 0x2000000 )
    {
      sub_4DA2C0(a1, (const char *)&byte_587000[277740], 0);
      sub_501960(916, a1, 0, 0);
    }
    else if ( v5 & 0x4000000 )
    {
      sub_4DA2C0(a1, (const char *)&byte_587000[277776], 0);
      sub_501960(917, a1, 0, 0);
    }
    sub_57AF30(a1, 1);
    sub_4F2F70((_DWORD *)a1, a2);
  }
  return v4;
}

//----- (0053AAB0) --------------------------------------------------------
_DWORD *__cdecl sub_53AAB0(int a1)
{
  _DWORD *result; // eax
  int v2; // ecx
  __int16 v3; // cx

  result = (_DWORD *)a1;
  if ( a1 )
  {
    v2 = *(_DWORD *)(a1 + 8);
    if ( v2 & 0x1000 )
    {
      result = sub_501960(831, a1, 0, 0);
    }
    else
    {
      v3 = *(_WORD *)(a1 + 24);
      if ( v3 & 0x10 )
      {
        result = sub_501960(843, a1, 0, 0);
      }
      else if ( v3 & 8 )
      {
        result = sub_501960(845, a1, 0, 0);
      }
    }
  }
  return result;
}

//----- (0053AB10) --------------------------------------------------------
int __cdecl sub_53AB10(int a1, _DWORD *a2, int *a3)
{
  if ( sub_4ED290(a1, (int)a2, (float2 *)a3) != 1 )
    return 0;
  sub_53AAB0((int)a2);
  if ( !sub_40A5C0(2048) && !sub_40A5C0(4096) )
  {
    if ( sub_409F40(2) )
      sub_511660(a2, 25 * *(_DWORD *)&byte_5D4594[2649704]);
  }
  return 1;
}

//----- (0053AB90) --------------------------------------------------------
void __cdecl sub_53AB90(int a1, int a2)
{
  int v2; // esi
  int v3; // eax

  if ( a1 )
  {
    v2 = *(_DWORD *)(a1 + 748);
    if ( a2 )
    {
      if ( !sub_57B3D0(a2, *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251)) || (LOBYTE(v3) = sub_4F3180(a1, a2), !v3) )
        sub_4D9670(*(unsigned __int8 *)(*(_DWORD *)(v2 + 276) + 2064), 0, 1);
    }
    *(_DWORD *)(v2 + 108) = a2;
  }
}
// 53ABD1: variable 'v3' is possibly undefined

//----- (0053AC10) --------------------------------------------------------
void __cdecl sub_53AC10(int a1)
{
  void (__cdecl *v1)(int, _DWORD, _DWORD); // eax

  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128)) > 0x28 )
  {
    v1 = *(void (__cdecl **)(int, _DWORD, _DWORD))(a1 + 696);
    if ( v1 )
      v1(a1, 0, 0);
    sub_4E5CC0(a1);
  }
}

//----- (0053AC50) --------------------------------------------------------
char __cdecl sub_53AC50(int a1)
{
  _DWORD *v1; // edi
  int v2; // ecx
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // edi

  v1 = *(_DWORD **)(a1 + 748);
  v2 = v1[2];
  v3 = v1[1];
  if ( v2 == v3 )
  {
    if ( v1[3] != v3 )
    {
      v4 = *(_DWORD *)(a1 + 12);
      if ( v4 & 4 )
      {
        if ( *(_BYTE *)(a1 + 24) & 8 )
          sub_501960(245, a1, 0, 0);
        else
          sub_501960(241, a1, 0, 0);
      }
      else if ( v4 & 1 )
      {
        sub_501960(247, a1, 0, 0);
      }
      else if ( v4 & 0x1000 )
      {
        sub_501960(1014, a1, 0, 0);
      }
      else
      {
        sub_501960(237, a1, 0, 0);
      }
      goto LABEL_24;
    }
    if ( v2 == v3 )
      goto LABEL_24;
  }
  if ( v1[3] == v3 )
  {
    v5 = *(_DWORD *)(a1 + 12);
    if ( v5 & 4 )
    {
      if ( *(_BYTE *)(a1 + 24) & 8 )
        sub_501960(246, a1, 0, 0);
      else
        sub_501960(243, a1, 0, 0);
    }
    else if ( v5 & 1 )
    {
      sub_501960(248, a1, 0, 0);
    }
    else if ( v5 & 0x1000 )
    {
      sub_501960(1015, a1, 0, 0);
    }
    else
    {
      sub_501960(239, a1, 0, 0);
    }
    sub_4DA920((_DWORD *)a1);
  }
LABEL_24:
  v6 = v1[3];
  if ( v1[2] != v6 )
  {
    sub_4E44F0(a1);
    v6 = v1[3];
    v1[2] = v6;
  }
  if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
  {
    if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v1[11]) > *(int *)&byte_5D4594[2649704] >> 1 )
    {
      v7 = v1[1];
      if ( v6 != v7 )
      {
        if ( v6 - v7 + (v6 - v7 < 0 ? 0x20 : 0) >= 16 )
          sub_548860(a1, 2);
        else
          sub_548860(a1, -2);
        LOBYTE(v6) = sub_537610(a1);
      }
    }
  }
  return v6;
}

//----- (0053ADC0) --------------------------------------------------------
void __cdecl sub_53ADC0(int a1)
{
  int v1; // eax
  int v2; // ecx

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 4);
  if ( v2 <= 0 )
  {
    sub_4E5CC0(a1);
  }
  else
  {
    *(_DWORD *)(v1 + 4) = v2 - 1;
    if ( *(_DWORD *)(v1 + 12) == 4 )
      *(_DWORD *)(a1 + 112) = 1065353216;
    else
      *(_DWORD *)(a1 + 112) = 1064514355;
  }
}

//----- (0053AE00) --------------------------------------------------------
char __cdecl sub_53AE00(int a1)
{
  _BYTE *v1; // esi
  int v2; // eax
  bool v3; // zf

  v1 = *(_BYTE **)(a1 + 748);
  if ( v1[1] )
  {
    LOBYTE(v2) = v1[1] - 1;
    if ( v1[1] == 1 )
    {
      LOBYTE(v2) = *v1 - 1;
      v3 = *v1 == 1;
      *v1 = v2;
      if ( v3 )
      {
        LOWORD(v2) = sub_415FA0(0, 255);
        *(_WORD *)(a1 + 126) = v2;
        v1[1] = 0;
        *v1 = 2;
        v1[2] = 0;
      }
    }
  }
  else
  {
    v2 = 8 * *(__int16 *)(a1 + 124);
    *(float *)(a1 + 88) = *(float *)&byte_587000[v2 + 194136] * 4.0;
    *(float *)(a1 + 92) = *(float *)&byte_587000[v2 + 194140] * 4.0;
    LOBYTE(v2) = *v1 - 1;
    v3 = *v1 == 1;
    *v1 = v2;
    if ( v3 )
    {
      LOBYTE(v2) = v1[2] + 1;
      v1[2] = v2;
      if ( (_BYTE)v2 == 4 )
      {
        v1[2] = 0;
        v1[1] = 1;
        LOBYTE(v2) = sub_415FA0(5, 60);
        *v1 = v2;
      }
      else
      {
        *v1 = 2;
      }
    }
  }
  return v2;
}

//----- (0053AEC0) --------------------------------------------------------
float *__cdecl sub_53AEC0(int a1)
{
  float *v1; // esi
  int v2; // eax
  int v3; // ebx
  double v4; // st7
  double v5; // st7
  int v6; // edi
  float *result; // eax
  float v8; // [esp+0h] [ebp-38h]
  float v9; // [esp+4h] [ebp-34h]
  float v10; // [esp+10h] [ebp-28h]
  float v11; // [esp+14h] [ebp-24h]
  float v12; // [esp+1Ch] [ebp-1Ch]
  float v13; // [esp+1Ch] [ebp-1Ch]
  float v14; // [esp+2Ch] [ebp-Ch]
  float v15; // [esp+30h] [ebp-8h]
  int v16; // [esp+34h] [ebp-4h]
  float v17; // [esp+34h] [ebp-4h]
  int v18; // [esp+3Ch] [ebp+4h]
  float v19; // [esp+3Ch] [ebp+4h]
  float v20; // [esp+3Ch] [ebp+4h]

  v1 = (float *)a1;
  v2 = 8 * *(__int16 *)(a1 + 124);
  v3 = 0;
  v4 = *(float *)&byte_587000[v2 + 194136] * *(float *)(a1 + 544);
  v18 = 0;
  v1[22] = v4 * 0.25 + v1[22];
  v1[23] = *(float *)&byte_587000[v2 + 194140] * v1[136] * 0.25 + v1[23];
  v14 = (v1[14] - v1[18]) * 0.25;
  v15 = (v1[15] - v1[19]) * 0.25;
  do
  {
    v5 = (double)v18;
    v19 = v5;
    v12 = v5 * v14 + v1[18];
    v16 = sub_419A70(v12);
    v13 = v19 * v15 + v1[19];
    v6 = 2;
    v20 = (double)sub_419A70(v13);
    v17 = (double)v16;
    do
    {
      v11 = sub_416030(-2.0, 2.0);
      v10 = sub_416030(-2.0, 2.0);
      v9 = sub_416030(-4.0, 4.0) + v20;
      v8 = sub_416030(-4.0, 4.0) + v17;
      result = sub_54FD80(v8, v9, 1, 6, v10, v11, 0.0, (int)v1);
      --v6;
    }
    while ( v6 );
    v18 = ++v3;
  }
  while ( v3 < 4 );
  return result;
}

//----- (0053B030) --------------------------------------------------------
void __cdecl sub_53B030(int a1)
{
  sub_52E040(a1 + 56, **(float **)(a1 + 748), 0, *(float *)(*(_DWORD *)(a1 + 748) + 8), 0, 0, 0);
}

//----- (0053B060) --------------------------------------------------------
char __cdecl sub_53B060(_DWORD *a1)
{
  unsigned int *v1; // esi
  unsigned int v2; // eax

  v1 = (unsigned int *)a1[187];
  if ( !(a1[4] & 0x1000000) )
  {
    v2 = *v1;
    LOBYTE(v2) = *v1 & 0xF6;
    *v1 = v2;
    return v2;
  }
  if ( !(*(_BYTE *)v1 & 8) )
  {
    *((_BYTE *)v1 + 8) = 0;
    a1[34] = *(_DWORD *)&byte_5D4594[2598000];
    sub_4E4880((int)a1, 0);
  }
  if ( *((_BYTE *)v1 + 8) )
  {
    if ( *((_BYTE *)v1 + 8) != 1 )
    {
      if ( *((_BYTE *)v1 + 8) == 3 && *(_DWORD *)&byte_5D4594[2598000] > a1[34] && !(*(_BYTE *)v1 & 1) )
        *((_BYTE *)v1 + 8) = 1;
      goto LABEL_18;
    }
    if ( *(_DWORD *)&byte_5D4594[2598000] > a1[34] && *(_BYTE *)v1 & 1 )
    {
      sub_501960(v1[10], (int)a1, 0, 0);
      sub_4E4880((int)a1, 0);
      sub_502490((int *)v1 + 7, 0, (int)a1);
      *((_BYTE *)v1 + 8) = (*v1 & 2) != 0 ? 5 : 0;
LABEL_17:
      a1[34] = *(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)&byte_5D4594[2649704];
      goto LABEL_18;
    }
  }
  else if ( *(_DWORD *)&byte_5D4594[2598000] > a1[34] && *(_BYTE *)v1 & 1 )
  {
    sub_501960(v1[9], (int)a1, 0, 0);
    sub_4E4880((int)a1, 1);
    sub_502490((int *)v1 + 5, v1[1], (int)a1);
    *((_BYTE *)v1 + 8) = 3;
    goto LABEL_17;
  }
LABEL_18:
  v2 = *v1;
  if ( *v1 & 1 )
    LOBYTE(v2) = v2 | 4;
  else
    LOBYTE(v2) = v2 & 0xFB;
  *v1 = v2;
  *v1 = v2 & 0xFFFFFFFE | 8;
  return v2;
}

//----- (0053B1B0) --------------------------------------------------------
char __cdecl sub_53B1B0(int a1)
{
  int *v1; // esi
  int v2; // eax
  int v3; // ebx
  int v4; // eax

  v1 = *(int **)(a1 + 748);
  if ( !*(_DWORD *)&byte_5D4594[2488680] )
  {
    *(_DWORD *)&byte_5D4594[2488680] = sub_4E3AA0((CHAR *)&byte_587000[278100]);
    *(_DWORD *)&byte_5D4594[2488676] = sub_4E3AA0((CHAR *)&byte_587000[278108]);
  }
  v2 = *(unsigned __int16 *)(a1 + 4);
  if ( (unsigned __int16)v2 == *(_DWORD *)&byte_5D4594[2488680] || v2 == *(_DWORD *)&byte_5D4594[2488676] )
    v3 = 0;
  else
    v3 = *(_DWORD *)&byte_5D4594[2649704];
  if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
  {
    if ( !(*(_BYTE *)v1 & 8) )
    {
      *((_BYTE *)v1 + 8) = 0;
      *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
      sub_4E4880(a1, 0);
    }
    if ( *((_BYTE *)v1 + 8) )
    {
      if ( *((_BYTE *)v1 + 8) == 1 && *(_DWORD *)&byte_5D4594[2598000] > *(int *)(a1 + 136) && !(*(_BYTE *)v1 & 1) )
      {
        sub_501960(v1[10], a1, 0, 0);
        sub_4E4880(a1, 0);
        sub_502490(v1 + 7, 0, a1);
        *((_BYTE *)v1 + 8) = (*v1 & 2) != 0 ? 5 : 0;
      }
    }
    else if ( *(_BYTE *)v1 & 1 )
    {
      sub_501960(v1[9], a1, 0, 0);
      sub_4E4880(a1, 1);
      sub_502490(v1 + 5, v1[1], a1);
      *((_BYTE *)v1 + 8) = 1;
      *(_DWORD *)(a1 + 136) = v3 + *(_DWORD *)&byte_5D4594[2598000];
    }
    v4 = *v1;
    if ( *v1 & 1 )
      LOBYTE(v4) = v4 | 4;
    else
      LOBYTE(v4) = v4 & 0xFB;
    *v1 = v4;
    LOBYTE(v4) = v4 & 0xFE | 8;
    *v1 = v4;
  }
  else
  {
    v4 = *v1;
    LOBYTE(v4) = *v1 & 0xF6;
    *v1 = v4;
  }
  return v4;
}

//----- (0053B300) --------------------------------------------------------
char __cdecl sub_53B300(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 16);
  if ( v1 & 0x1000000 )
    LOBYTE(v1) = v1 & 0xBF;
  else
    LOBYTE(v1) = v1 | 0x40;
  *(_DWORD *)(a1 + 16) = v1;
  return v1;
}

//----- (0053B320) --------------------------------------------------------
char __cdecl sub_53B320(_DWORD *a1)
{
  int v1; // eax

  v1 = a1[4];
  if ( v1 & 0x1000000 )
  {
    if ( a1[174] && v1 & 0x40 )
    {
      LOBYTE(v1) = v1 & 0xBF;
      a1[4] = v1;
      LOBYTE(v1) = sub_537610((int)a1);
    }
    else
    {
      LOBYTE(v1) = v1 & 0xBF;
      a1[4] = v1;
    }
  }
  else
  {
    if ( !a1[33] )
    {
      sub_4E44F0((int)a1);
      a1[33] = 1;
    }
    v1 = a1[4];
    LOBYTE(v1) = v1 | 0x40;
    a1[4] = v1;
  }
  return v1;
}

//----- (0053B380) --------------------------------------------------------
char __cdecl sub_53B380(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // edi

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 4);
  if ( v2 )
  {
    sub_537610(a1);
    v3 = *(_DWORD *)(*(_DWORD *)(v1 + 4) + 748);
    if ( *(_BYTE *)(v3 + 12) == 1 )
    {
      if ( *(_DWORD *)(v3 + 16) <= 32 )
        sub_517F90((float2 *)(a1 + 56), 64.0, sub_53B410, a1);
      if ( *(_BYTE *)(v1 + 12) != *(_BYTE *)(v3 + 12) )
        sub_53B490(a1, 0);
    }
    else if ( *(_BYTE *)(v3 + 12) == 3 && *(_BYTE *)(v1 + 12) != *(_BYTE *)(v3 + 12) )
    {
      sub_53B490(a1, 1);
      LOBYTE(v2) = *(_BYTE *)(v3 + 12);
      *(_BYTE *)(v1 + 12) = v2;
      return v2;
    }
    LOBYTE(v2) = *(_BYTE *)(v3 + 12);
    *(_BYTE *)(v1 + 12) = v2;
  }
  return v2;
}

//----- (0053B410) --------------------------------------------------------
void __cdecl sub_53B410(int a1, int a2)
{
  int v2; // edi
  int v3; // ebx
  float v4; // [esp+0h] [ebp-10h]
  float v5; // [esp+0h] [ebp-10h]

  if ( sub_57B850((float2 *)(a2 + 56), (float *)(a2 + 172), (float2 *)(a1 + 56)) )
  {
    v2 = *(_DWORD *)(a2 + 748);
    v3 = *(_DWORD *)(*(_DWORD *)(v2 + 4) + 748);
    v4 = *(float *)(a1 + 104) + 64.0 - (double)*(int *)(v3 + 16);
    if ( sub_419A10(v4) < 10.0 )
    {
      sub_4E7010(a1, (float2 *)(*(_DWORD *)(v2 + 4) + 56));
      v5 = (double)*(int *)(v3 + 16);
      sub_4E46F0(a1, v5);
    }
  }
}

//----- (0053B490) --------------------------------------------------------
_DWORD *__cdecl sub_53B490(int a1, int a2)
{
  _DWORD *result; // eax
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  if ( a2 )
  {
    result = (_DWORD *)a1;
    v3 = *(unsigned __int16 *)(a1 + 24);
    if ( (unsigned __int16)v3 == 8 )
    {
      result = sub_501960(257, a1, 0, 0);
    }
    else if ( v3 == 16 )
    {
      v4 = *(_DWORD *)(a1 + 12);
      if ( v4 & 0x20 )
      {
        result = sub_501960(253, a1, 0, 0);
      }
      else if ( v4 & 0x40 )
      {
        result = sub_501960(259, a1, 0, 0);
      }
      else
      {
        result = sub_501960(251, a1, 0, 0);
      }
    }
    else if ( v3 == 32 )
    {
      if ( *(_BYTE *)(a1 + 12) & 2 )
        result = sub_501960(255, a1, 0, 0);
      else
        result = sub_501960(249, a1, 0, 0);
    }
  }
  else
  {
    result = (_DWORD *)a1;
    v5 = *(unsigned __int16 *)(a1 + 24);
    if ( (unsigned __int16)v5 == 8 )
    {
      result = sub_501960(258, a1, 0, 0);
    }
    else if ( v5 == 16 )
    {
      v6 = *(_DWORD *)(a1 + 12);
      if ( v6 & 0x20 )
      {
        result = sub_501960(254, a1, 0, 0);
      }
      else if ( v6 & 0x40 )
      {
        result = sub_501960(260, a1, 0, 0);
      }
      else
      {
        result = sub_501960(252, a1, 0, 0);
      }
    }
    else if ( v5 == 32 )
    {
      if ( *(_BYTE *)(a1 + 12) & 2 )
        result = sub_501960(256, a1, 0, 0);
      else
        result = sub_501960(250, a1, 0, 0);
    }
  }
  return result;
}

//----- (0053B5D0) --------------------------------------------------------
void __cdecl sub_53B5D0(_DWORD *a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // eax
  int v4; // eax

  v1 = a1[187];
  switch ( *(unsigned __int8 *)(v1 + 12) )
  {
    case 0u:
      if ( a1[4] & 0x1000000 )
      {
        if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - a1[34]) > *(int *)&byte_5D4594[2649704] )
        {
          *(_BYTE *)(v1 + 12) = 3;
          sub_53B490((int)a1, 1);
        }
      }
      break;
    case 1u:
      v2 = *(_DWORD *)(v1 + 16);
      if ( v2 > 0 )
      {
        *(_DWORD *)(v1 + 16) = v2 - 2;
      }
      else
      {
        *(_BYTE *)(v1 + 12) = 0;
        a1[34] = *(_DWORD *)&byte_5D4594[2598000];
      }
      sub_4E44F0((int)a1);
      if ( *(_DWORD *)(v1 + 4) )
        sub_4E44F0(*(_DWORD *)(v1 + 4));
      if ( (double)*(int *)(v1 + 16) <= 20.0 )
      {
        v3 = a1[4];
        LOBYTE(v3) = v3 | 0x10;
        a1[4] = v3;
      }
      break;
    case 2u:
      if ( a1[4] & 0x1000000
        && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - a1[34]) > *(int *)&byte_5D4594[2649704] )
      {
        *(_BYTE *)(v1 + 12) = 1;
        sub_53B490((int)a1, 0);
      }
      break;
    case 3u:
      *(_DWORD *)(v1 + 16) += 2;
      sub_4E44F0((int)a1);
      if ( *(_DWORD *)(v1 + 4) )
        sub_4E44F0(*(_DWORD *)(v1 + 4));
      if ( (double)*(int *)(v1 + 16) >= 20.0 )
      {
        v4 = a1[4];
        LOBYTE(v4) = v4 & 0xEF;
        a1[4] = v4;
      }
      if ( (double)*(int *)(v1 + 16) >= 32.0 )
        sub_517F90((float2 *)a1 + 7, 64.0, sub_53B750, (int)a1);
      if ( *(_DWORD *)(v1 + 16) >= 64 )
      {
        *(_DWORD *)(v1 + 16) = 64;
        *(_BYTE *)(v1 + 12) = 2;
        a1[34] = *(_DWORD *)&byte_5D4594[2598000];
      }
      break;
    default:
      return;
  }
}

//----- (0053B750) --------------------------------------------------------
void __cdecl sub_53B750(int a1, int a2)
{
  int v2; // ebx
  int v3; // edi
  int v4; // eax
  double v5; // st7
  float v6; // [esp+0h] [ebp-10h]
  float v7; // [esp+0h] [ebp-10h]

  if ( sub_57B850((float2 *)(a2 + 56), (float *)(a2 + 172), (float2 *)(a1 + 56)) )
  {
    v2 = *(_DWORD *)(a2 + 748);
    v3 = *(_DWORD *)(v2 + 4);
    if ( v3 )
    {
      v6 = *(float *)(a1 + 104) - (double)*(int *)(v2 + 16);
      if ( sub_419A10(v6) < 10.0 )
      {
        v4 = *(_DWORD *)(a1 + 172);
        if ( v4 == 3 )
        {
          if ( *(float *)(v3 + 184) < (double)*(float *)(a1 + 184)
            || *(float *)(v3 + 188) < (double)*(float *)(a1 + 188) )
          {
LABEL_12:
            *(_DWORD *)(a1 + 16) &= 0xFFEFFFFF;
            sub_4E46F0(a1, 0.0);
            return;
          }
        }
        else if ( v4 == 2 )
        {
          v5 = *(float *)(a1 + 176) + *(float *)(a1 + 176);
          if ( v5 > *(float *)(v3 + 184) || v5 > *(float *)(v3 + 188) )
            goto LABEL_12;
        }
        sub_4E7010(a1, (float2 *)(*(_DWORD *)(v2 + 4) + 56));
        v7 = (double)(int)(*(_DWORD *)(v2 + 16) - 64);
        sub_4E46F0(a1, v7);
        return;
      }
    }
  }
}

//----- (0053B860) --------------------------------------------------------
void __cdecl sub_53B860(int a1)
{
  float *v1; // edx
  double v2; // st7
  double v3; // st6
  int v4; // edx
  __int16 v5; // ax
  bool v6; // sf
  float v7; // [esp+8h] [ebp-4h]

  v1 = *(float **)(a1 + 748);
  v2 = *(float *)(*(_DWORD *)v1 + 56) - v1[1];
  v3 = *(float *)(*(_DWORD *)v1 + 60) - v1[2];
  v7 = v3;
  if ( v3 * v7 + v2 * v2 <= 160000.0 )
  {
    *(float *)(a1 + 64) = *(float *)(*(_DWORD *)v1 + 56) - v2;
    *(float *)(a1 + 68) = *(float *)(*(_DWORD *)v1 + 60) - v7;
    v4 = *(_DWORD *)v1;
    v5 = *(_WORD *)(v4 + 124) + 128;
    v6 = (__int16)(*(_WORD *)(v4 + 124) - 128) < 0;
    *(_WORD *)(a1 + 126) = v5;
      while ( *(_WORD *)(a1 + 126) >= 256 )
        *(_WORD *)(a1 + 126) -= 256;
  }
  else
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053B8F0) --------------------------------------------------------
void __cdecl sub_53B8F0(int a1)
{
  void (__cdecl *v1)(int); // ecx

  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128)) > **(_DWORD **)(a1 + 748) )
  {
    v1 = *(void (__cdecl **)(int))(a1 + 724);
    *(_DWORD *)(a1 + 16) |= 0x8000u;
    if ( v1 )
      v1(a1);
    else
      sub_4E5CC0(a1);
  }
}

//----- (0053B940) --------------------------------------------------------
void __cdecl sub_53B940(int a1)
{
  int v1; // edi
  int *v2; // esi
  double v3; // st7
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // esi
  double v10; // st7
  double v11; // st7
  double v12; // st6
  double v13; // st7
  double v14; // st6
  float v15; // [esp+4h] [ebp-10h]
  int v16; // [esp+4h] [ebp-10h]
  float v17; // [esp+10h] [ebp-4h]
  float v18; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = *(int **)(a1 + 748);
  if ( v2[1] )
    v3 = sub_419D40(&byte_587000[278124]);
  else
    v3 = sub_419D40(&byte_587000[278148]);
  v15 = v3;
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) <= (unsigned int)sub_419A70(v15) )
  {
    if ( *v2 && *(_BYTE *)(*v2 + 16) & 0x20 )
      *v2 = 0;
    v4 = v2[2];
    if ( v4 && *(_BYTE *)(v4 + 16) & 0x20 )
      v2[2] = 0;
    v5 = v2[1];
    if ( v5 )
    {
      v6 = *(_DWORD *)(v5 + 16);
      if ( v6 & 0x20 || (v6 & 0x8000) != 0 )
        v2[1] = 0;
    }
    if ( !v2[1] )
    {
      v7 = *(_DWORD *)(a1 + 136);
      if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v7) > *(int *)&byte_5D4594[2649704] >> 2
        || v7 == *(_DWORD *)(a1 + 128) )
      {
        v16 = *v2;
        v8 = sub_424A70(v2[3]);
        v2[1] = sub_540610(0, a1, v8, 600.0, 0, v16);
        *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
      }
    }
    v9 = v2[1];
    if ( v9 )
    {
      v18 = *(float *)(v9 + 56) - *(float *)(a1 + 56);
      v10 = *(float *)(v9 + 60) - *(float *)(v1 + 60);
      v17 = v10;
      v11 = sub_419AF0(sqrt(v10 * v17 + v18 * v18) + *(double *)&byte_581450[10176]);
      v12 = v18 * *(float *)(v1 + 544);
      *(_DWORD *)(v1 + 112) = 1063675494;
      *(float *)(v1 + 88) = v12 / v11;
      *(float *)(v1 + 92) = v17 * *(float *)(v1 + 544) / v11;
    }
    else
    {
      v13 = sub_419AF0(
              sqrt(*(float *)(a1 + 80) * *(float *)(a1 + 80) + *(float *)(a1 + 84) * *(float *)(a1 + 84))
            + *(double *)&byte_581450[10176]);
      v14 = *(float *)(a1 + 544) * *(float *)(a1 + 80);
      *(_DWORD *)(a1 + 112) = 1063675494;
      *(float *)(a1 + 88) = v14 / v13;
      *(float *)(a1 + 92) = *(float *)(a1 + 544) * *(float *)(a1 + 84) / v13;
    }
  }
  else
  {
    sub_522FF0(150, (float2 *)(a1 + 56));
    sub_4E71F0(a1);
  }
}

//----- (0053BB00) --------------------------------------------------------
void __cdecl sub_53BB00(int a1)
{
  int v1; // ecx
  int v2; // esi
  int v3; // edi
  unsigned int v4; // eax
  int v5; // edx
  int v6; // eax
  double v7; // st7
  double v8; // st6
  double v9; // st5
  long double v10; // st7
  long double v11; // st7
  float v12; // [esp+0h] [ebp-30h]
  float v13; // [esp+4h] [ebp-2Ch]
  int v14; // [esp+Ch] [ebp-24h]
  float v15; // [esp+10h] [ebp-20h]
  float v16; // [esp+14h] [ebp-1Ch]
  float v17; // [esp+2Ch] [ebp-4h]
  int v18; // [esp+34h] [ebp+4h]

  v1 = *(_DWORD *)&byte_5D4594[2598000];
  v2 = a1;
  v3 = *(_DWORD *)(a1 + 748);
  v4 = *(_DWORD *)&byte_5D4594[2649704];
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) <= (unsigned int)(5 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    v5 = *(_DWORD *)(v3 + 4);
    if ( v5 && *(_BYTE *)(v5 + 16) & 0x20 )
    {
      *(_DWORD *)(v3 + 4) = 0;
      v1 = *(_DWORD *)&byte_5D4594[2598000];
      v4 = *(_DWORD *)&byte_5D4594[2649704];
    }
    if ( !*(_DWORD *)(v3 + 4) && v1 - *(_DWORD *)(a1 + 136) > v4 >> 2 )
    {
      *(_DWORD *)&byte_5D4594[2488668] = 0;
      *(_DWORD *)&byte_5D4594[2488672] = 1287568416;
      sub_518170(a1 + 56, 600.0, sub_53BD10, a1);
      *(_DWORD *)(v3 + 4) = *(_DWORD *)&byte_5D4594[2488668];
      *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
    }
    v6 = *(_DWORD *)(v3 + 4);
    if ( v6 )
    {
      v7 = *(float *)(v6 + 56) - *(float *)(a1 + 56);
      v8 = *(float *)(v6 + 60) - *(float *)(a1 + 60);
      v9 = v7;
      v10 = sqrt(v8 * v8 + v7 * v7) + 0.1;
      *(float *)(a1 + 88) = v9 * *(float *)(a1 + 544) / v10;
      *(float *)(a1 + 92) = v8 * *(float *)(a1 + 544) / v10;
      if ( v10 < 10.0 )
      {
        sub_501960(20, a1, 0, 0);
        sub_4E5CC0(a1);
        sub_4E5CC0(*(_DWORD *)(v3 + 4));
      }
    }
    else
    {
      v11 = sqrt(*(float *)(a1 + 80) * *(float *)(a1 + 80) + *(float *)(a1 + 84) * *(float *)(a1 + 84)) + 0.1;
      *(float *)(a1 + 88) = *(float *)(a1 + 544) * *(float *)(a1 + 80) / v11;
      *(float *)(a1 + 92) = *(float *)(a1 + 544) * *(float *)(a1 + 84) / v11;
    }
    v17 = *(float *)(a1 + 56);
    v18 = *(int *)(a1 + 60);
    v16 = sub_416030(-2.0, 2.0);
    v15 = sub_416030(-2.0, 2.0);
    v14 = sub_415FA0(15, 30);
    v13 = sub_416030(-4.0, 4.0) + *(float *)&v18;
    v12 = sub_416030(-4.0, 4.0) + v17;
    sub_54FD80(v12, v13, 3, v14, v15, v16, 0.0, v2);
  }
  else
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053BD10) --------------------------------------------------------
void __cdecl sub_53BD10(int a1, int a2)
{
  double v2; // st7
  double v3; // st6
  double v4; // st5

  if ( !(*(_BYTE *)(a1 + 16) & 0x20)
    && (!(*(_BYTE *)(a1 + 8) & 1) || *(_BYTE *)(a1 + 12) & 2)
    && a2 != a1
    && (!*(_DWORD *)(a2 + 508) || !sub_4EC4F0(a1, *(_DWORD *)(a2 + 508))) )
  {
    if ( sub_5370E0(a2, a1, 0) )
    {
      v2 = *(float *)(a2 + 56) - *(float *)(a1 + 56);
      v3 = *(float *)(a2 + 60) - *(float *)(a1 + 60);
      v4 = v3 * v3 + v2 * v2;
      if ( v4 < *(float *)&byte_5D4594[2488672] )
      {
        *(float *)&byte_5D4594[2488672] = v4;
        *(_DWORD *)&byte_5D4594[2488668] = a1;
      }
    }
  }
}

//----- (0053BDA0) --------------------------------------------------------
int __cdecl sub_53BDA0(int a1)
{
  int *v1; // edi
  int v2; // ecx
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // edi
  __int16 v7; // cx
  __int16 v8; // ax
  int result; // eax
  double v10; // st7

  v1 = *(int **)(a1 + 748);
  v2 = *v1;
  if ( *(_BYTE *)(*v1 + 16) & 0x20
    || *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    return (*(int (__cdecl **)(int, _DWORD, _DWORD))(a1 + 696))(a1, 0, 0);
  }
  v3 = v1[1];
  if ( v3 )
  {
    v4 = *(_DWORD *)(v3 + 16);
    if ( v4 & 0x20 || (v4 & 0x8000) != 0 )
      v1[1] = 0;
  }
  if ( !v1[1] && !(byte_5D4594[2598000] & 7) )
  {
    v5 = sub_540610(0, a1, 32, 600.0, 0, v2);
    v1[1] = v5;
    if ( v5 == *(_DWORD *)(a1 + 508) )
      v1[1] = 0;
  }
  v6 = v1[1];
  if ( v6 )
  {
    v7 = *(_WORD *)(a1 + 126);
    if ( (*(float *)(v6 + 60) - *(float *)(a1 + 60)) * *(float *)&byte_587000[8 * v7 + 194136]
       - (*(float *)(v6 + 56) - *(float *)(a1 + 56)) * *(float *)&byte_587000[8 * v7 + 194140] >= 0.0 )
    {
      *(_WORD *)(a1 + 126) = v7 + 42;
      if ( (__int16)(v7 + 42) >= 256 )
      {
        do
          *(_WORD *)(a1 + 126) -= 256;
        while ( *(_WORD *)(a1 + 126) >= 256 );
      }
    }
    else
    {
      v8 = v7 - 42;
      *(_WORD *)(a1 + 126) = v7 - 42;
      if ( (__int16)(v7 - 42) < 0 )
      {
        do
          v8 += 256;
        while ( v8 < 0 );
        *(_WORD *)(a1 + 126) = v8;
      }
    }
  }
  result = 8 * *(__int16 *)(a1 + 126);
  *(float *)(a1 + 88) = *(float *)&byte_587000[result + 194136] * *(float *)(a1 + 544);
  v10 = *(float *)&byte_587000[result + 194140] * *(float *)(a1 + 544);
  *(_DWORD *)(a1 + 112) = 1061997773;
  *(float *)(a1 + 92) = v10;
  return result;
}

//----- (0053BEF0) --------------------------------------------------------
int __cdecl sub_53BEF0(int a1)
{
  unsigned __int8 *v1; // esi
  unsigned __int8 v2; // al
  unsigned __int8 v3; // al
  int result; // eax
  int v5; // eax
  _BYTE *v6; // eax
  float4 a1a; // [esp+Ch] [ebp-10h]

  v1 = *(unsigned __int8 **)(a1 + 748);
  if ( *v1 )
  {
    if ( *v1 <= 2u )
    {
      v2 = v1[9];
      if ( v2 == v1[8] )
      {
        ++v1[20];
        sub_4E44F0(a1);
        if ( v1[20] == 9 )
        {
          v3 = v1[8];
          v1[20] = 1;
          v1[8] = v3 + 1;
        }
        v1[9] = 0;
      }
      else
      {
        v1[9] = v2 + 1;
      }
    }
  }
  else
  {
    if ( v1[20] )
      sub_4E44F0(a1);
    v1[20] = 0;
  }
  result = *v1;
  if ( *v1 )
  {
    v5 = result - 1;
    if ( v5 )
    {
      result = v5 - 1;
      if ( !result && v1[8] >= 4u )
      {
        v1[20] = 0;
        *v1 = 0;
        *((_DWORD *)v1 + 1) = 0;
        return result;
      }
    }
    else
    {
      result = v1[8];
      if ( (_BYTE)result )
      {
        if ( (_BYTE)result == 4 )
        {
          *v1 = 0;
          *((_DWORD *)v1 + 1) = 0;
          return result;
        }
      }
      else if ( v1[20] == 8 )
      {
        result = *((_DWORD *)v1 + 3);
        if ( result )
        {
          a1a.field_0 = *(float *)(a1 + 56) - *(float *)(a1 + 176);
          a1a.field_4 = *(float *)(a1 + 60) - *(float *)(a1 + 176);
          a1a.field_8 = *(float *)(a1 + 56) + *(float *)(a1 + 176);
          a1a.field_C = *(float *)(a1 + 60) + *(float *)(a1 + 176);
          sub_517C10(&a1a, sub_53C060, result + 56);
          *((_DWORD *)v1 + 1) = 0;
          return result;
        }
      }
    }
  }
  else if ( *((_DWORD *)v1 + 1) )
  {
    result = *((_DWORD *)v1 + 3);
    if ( result )
    {
      if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
      {
        v6 = *(_BYTE **)(result + 748);
        *v1 = 1;
        v1[8] = 0;
        v1[9] = 0;
        *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
        *v6 = 2;
        v6[8] = 0;
        v6[9] = 0;
        result = *(_DWORD *)&byte_5D4594[2598000];
        *(_DWORD *)(*((_DWORD *)v1 + 3) + 136) = *(_DWORD *)&byte_5D4594[2598000];
      }
    }
  }
  *((_DWORD *)v1 + 1) = 0;
  return result;
}

//----- (0053C060) --------------------------------------------------------
void __cdecl sub_53C060(float *a1, int a2)
{
  if ( !((_DWORD)a1[2] & 0x420000) )
  {
    sub_522FF0(137, (float2 *)a1 + 7);
    sub_501960(147, (int)a1, 0, 0);
    sub_4E7190(a1, (float *)a2);
    sub_522FF0(137, (float2 *)a1 + 7);
    sub_501960(147, (int)a1, 0, 0);
  }
}

//----- (0053C0C0) --------------------------------------------------------
int __cdecl sub_53C0C0(int a1)
{
  int result; // eax
  int v2; // esi
  int v3; // ecx
  float4 a1a; // [esp+8h] [ebp-10h]

  result = a1;
  v2 = *(_DWORD *)(a1 + 748);
  if ( *(_DWORD *)(v2 + 4) )
  {
    v3 = *(_DWORD *)(v2 + 12);
    if ( v3 )
    {
      if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
      {
        a1a.field_0 = *(float *)(a1 + 56) - *(float *)(a1 + 176);
        a1a.field_4 = *(float *)(a1 + 60) - *(float *)(a1 + 176);
        a1a.field_8 = *(float *)(a1 + 176) + *(float *)(a1 + 56);
        a1a.field_C = *(float *)(a1 + 60) + *(float *)(a1 + 176);
        sub_517C10(&a1a, sub_53C140, v3 + 56);
      }
    }
  }
  *(_DWORD *)(v2 + 4) = 0;
  return result;
}

//----- (0053C140) --------------------------------------------------------
void __cdecl sub_53C140(float *a1, int a2)
{
  if ( !((_DWORD)a1[2] & 0x420000) )
    sub_4E7190(a1, (float *)a2);
}

//----- (0053C160) --------------------------------------------------------
void __cdecl sub_53C160(int a3)
{
  double v1; // st7
  float v2; // eax
  float v3; // edx
  double v4; // st7
  float v5; // ecx
  double v6; // st7
  float v7; // eax
  int2 a2; // [esp+4h] [ebp-18h]
  float4 a1; // [esp+Ch] [ebp-10h]

  if ( *(_DWORD *)(a3 + 16) & 0x1000000 )
  {
    sub_509E20(*(__int16 *)(a3 + 124), &a2);
    if ( a2.field_0 >= 0 )
    {
      if ( a2.field_4 < 0 )
      {
        v4 = *(float *)(a3 + 60) - 400.0;
        v5 = *(float *)(a3 + 60);
        a1.field_0 = *(float *)(a3 + 56);
        a1.field_C = v5;
        a1.field_4 = v4;
        a1.field_8 = *(float *)(a3 + 56) + 400.0;
        goto LABEL_10;
      }
      v6 = *(float *)(a3 + 56) + 400.0;
      v7 = *(float *)(a3 + 60);
      a1.field_0 = *(float *)(a3 + 56);
      a1.field_4 = v7;
      a1.field_8 = v6;
    }
    else
    {
      a1.field_0 = *(float *)(a3 + 56) - 400.0;
      if ( a2.field_4 < 0 )
      {
        v1 = *(float *)(a3 + 60) - 400.0;
        v2 = *(float *)(a3 + 60);
        a1.field_8 = *(float *)(a3 + 56);
        a1.field_C = v2;
        a1.field_4 = v1;
LABEL_10:
        sub_517ED0(&a1, sub_53C240, a3);
        return;
      }
      v3 = *(float *)(a3 + 56);
      a1.field_4 = *(float *)(a3 + 60);
      a1.field_8 = v3;
    }
    a1.field_C = *(float *)(a3 + 60) + 400.0;
    goto LABEL_10;
  }
}

//----- (0053C240) --------------------------------------------------------
void __cdecl sub_53C240(float *a1, int arg4)
{
  float *v2; // esi
  int v3; // edi
  double v4; // st7
  long double v5; // st7
  double v6; // st7
  double v7; // st7
  double v8; // st7
  double v9; // st7
  float v10; // [esp+8h] [ebp-10h]
  float v11; // [esp+Ch] [ebp-Ch]
  int2 a2; // [esp+10h] [ebp-8h]
  float v13; // [esp+1Ch] [ebp+4h]
  float v14; // [esp+1Ch] [ebp+4h]
  float v15; // [esp+20h] [ebp+8h]
  float v16; // [esp+20h] [ebp+8h]

  v2 = a1;
  if ( !((_BYTE)a1[4] & 0x20) && !((_DWORD)a1[2] & 0x400000) )
  {
    v3 = arg4;
    v15 = a1[14] - *(float *)(arg4 + 56);
    v4 = a1[15] - *(float *)(v3 + 60);
    v13 = v4;
    v5 = sqrt(v4 * v13 + v15 * v15) + 0.1;
    v11 = v5;
    if ( v5 < 400.0 )
    {
      sub_509E20(*(__int16 *)(v3 + 124), &a2);
      v6 = v15;
      if ( v15 >= 0.0 )
        v10 = v15;
      else
        v10 = -v6;
      if ( v13 >= 0.0 )
        v16 = v13;
      else
        v16 = -v13;
      switch ( a2.field_4 + a2.field_0 + 2 * a2.field_4 + 4 )
      {
        case 0:
          if ( v6 < 0.0 )
            goto LABEL_12;
          break;
        case 1:
          if ( v13 < 0.0 )
            goto LABEL_29;
          break;
        case 2:
          if ( v6 > 0.0 )
          {
LABEL_12:
            if ( v13 < 0.0 )
              goto LABEL_25;
          }
          break;
        case 3:
          if ( v6 < 0.0 )
            goto LABEL_21;
          break;
        case 5:
          if ( v6 > 0.0 )
          {
LABEL_21:
            if ( v16 / v10 <= 0.26789999 )
              goto LABEL_35;
          }
          break;
        case 6:
          if ( v6 < 0.0 && v13 > 0.0 )
          {
LABEL_25:
            v7 = v16 / v10;
            if ( v7 >= 0.57730001 && v7 <= 0.1732 )
              goto LABEL_35;
          }
          break;
        case 7:
          if ( v13 > 0.0 )
          {
LABEL_29:
            if ( v16 / v10 <= 0.3732 )
              goto LABEL_35;
          }
          break;
        case 8:
          if ( v6 > 0.0 && v13 > 0.0 )
          {
            v8 = v16 / v10;
            if ( v8 >= 0.57730001 && v8 <= 0.1732 )
              goto LABEL_35;
          }
          break;
        default:
LABEL_35:
          if ( sub_5370E0(v3, (int)v2, 0) )
          {
            v14 = (400.0 - v11) * (400.0 - v11) * (400.0 - v11) * 0.0000005;
            v9 = v14 / sub_4E4A70((int)v2);
            v2[22] = v9 * *(float *)&byte_587000[8 * *(__int16 *)(v3 + 124) + 194136] + v2[22];
            v2[23] = v9 * *(float *)&byte_587000[8 * *(__int16 *)(v3 + 124) + 194140] + v2[23];
          }
          break;
      }
    }
  }
}

//----- (0053C520) --------------------------------------------------------
int __cdecl sub_53C520(int a1, int a2)
{
  int v2; // ecx
  int v3; // eax
  int v4; // eax
  int v5; // edx

  v2 = *(_DWORD *)(a1 + 736);
  if ( !v2 )
    return 0;
  v3 = *(_DWORD *)(v2 + 112);
  if ( v3 >= 100 )
    return 0;
  v4 = a2 + v3;
  *(_DWORD *)(v2 + 112) = v4 < 100 ? v4 : 100;
  v5 = *(_DWORD *)(v2 + 112) * *(unsigned __int8 *)(v2 + 109) / 100;
  if ( v5 == *(unsigned __int8 *)(v2 + 108) )
    return 0;
  *(_BYTE *)(v2 + 108) = v5;
  return 1;
}

//----- (0053C580) --------------------------------------------------------
signed int __cdecl sub_53C580(int a1)
{
  int v1; // edi
  signed int *v2; // esi
  int v3; // ebp
  int v4; // eax
  int v5; // esi
  double v6; // st7
  double v7; // st6
  int v8; // ebp
  _DWORD *v9; // eax
  int v10; // ecx
  int v11; // ebx
  __int16 v12; // bx
  char v13; // al
  __int16 v14; // ax
  int v15; // eax
  unsigned __int16 v16; // ax
  int v17; // edx
  signed int result; // eax
  float v19; // [esp+0h] [ebp-20h]
  float v20; // [esp+4h] [ebp-1Ch]
  int v21; // [esp+14h] [ebp-Ch]
  int v22; // [esp+18h] [ebp-8h]
  signed int v23; // [esp+1Ch] [ebp-4h]
  signed int *v24; // [esp+24h] [ebp+4h]

  v1 = a1;
  v23 = 1;
  v2 = *(signed int **)(a1 + 748);
  v24 = *(signed int **)(a1 + 748);
  v3 = sub_4DA7C0();
  v21 = v3;
  if ( !v3 )
    goto LABEL_50;
  while ( 1 )
  {
    v4 = *(_DWORD *)(v3 + 16);
    if ( (v4 & 0x8000) != 0 )
      goto LABEL_47;
    v5 = *(_DWORD *)(v3 + 748);
    if ( sub_419130(v1 + 48) )
    {
      if ( !sub_419150(v1 + 48, v3 + 48) )
        goto LABEL_47;
    }
    v6 = *(float *)(v1 + 56) - *(float *)(v3 + 56);
    v7 = *(float *)(v1 + 60) - *(float *)(v3 + 60);
    v22 = 0;
    if ( v7 * v7 + v6 * v6 >= 2500.0 || !sub_537110(v1, v3) )
      goto LABEL_47;
    v23 = 0;
    if ( *v24 >= 1 )
    {
      v8 = sub_53C940(*(_DWORD **)(v5 + 104));
      if ( !sub_40A5C0(0x2000) || sub_40A5C0(4096) )
      {
        if ( !v8 )
        {
LABEL_24:
          v3 = v21;
          goto LABEL_25;
        }
      }
      else
      {
        v8 = 1;
      }
      v9 = *(_DWORD **)(v5 + 104);
      if ( v9 )
      {
        v10 = v9[2];
        if ( v10 & 0x1000 )
        {
          if ( v9[3] & 0x47F0000 )
          {
            v11 = v9[184];
            if ( *(int *)(v11 + 112) < 100 )
            {
              if ( sub_40A5C0(4096) )
              {
                if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] >> 1)) )
                  sub_501960(230, v1, 0, 0);
              }
              else
              {
                v22 = 1;
                --*v24;
              }
              if ( sub_53C520(*(_DWORD *)(v5 + 104), v8) )
                sub_4D82B0(
                  *(unsigned __int8 *)(*(_DWORD *)(v5 + 276) + 2064),
                  *(_DWORD **)(v5 + 104),
                  *(_BYTE *)(v11 + 108),
                  *(_BYTE *)(v11 + 109));
            }
          }
        }
      }
      goto LABEL_24;
    }
LABEL_25:
    if ( (int)*v24 < 1 || *(_WORD *)(v5 + 4) >= *(_WORD *)(v5 + 8) || (int)*v24 <= 0 )
      goto LABEL_42;
    v12 = 1;
    if ( sub_40A5C0(4096) )
    {
      v13 = *(_BYTE *)(*(_DWORD *)(v5 + 276) + 2251);
      if ( v13 )
      {
        if ( v13 == 1 )
        {
          v14 = sub_419A70(*(float *)&byte_587000[312820]);
        }
        else
        {
          if ( v13 != 2 )
            goto LABEL_36;
          v14 = sub_419A70(*(float *)&byte_587000[312804]);
        }
      }
      else
      {
        v14 = sub_419A70(*(float *)&byte_587000[312788]);
      }
      v12 = v14;
    }
LABEL_36:
    v15 = *(_DWORD *)(v5 + 276);
    *(_WORD *)(v5 + 4) += v12;
    sub_56F9E0(*(_DWORD *)(v15 + 4596), v12);
    v16 = *(_WORD *)(v5 + 8);
    if ( *(_WORD *)(v5 + 4) > v16 )
    {
      v17 = *(_DWORD *)(v5 + 276);
      *(_WORD *)(v5 + 4) = v16;
      sub_56F870(*(_DWORD *)(v17 + 4596), v16);
    }
    if ( sub_40A5C0(4096) )
    {
      if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] >> 1)) )
        sub_501960(230, v1, 0, 0);
LABEL_42:
      if ( !v22 )
        goto LABEL_47;
      goto LABEL_43;
    }
    --*v24;
LABEL_43:
    if ( !(*v24 % 8) )
    {
      v19 = (double)(80 * *v24 / 50);
      nullsub_35(v1, LODWORD(v19));
      sub_4E44F0(v1);
    }
    if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 136)) > *(int *)&byte_5D4594[2649704] >> 1 )
    {
      sub_501960(230, v1, 0, 0);
      *(_DWORD *)(v1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
    }
LABEL_47:
    v21 = sub_4DA7F0(v3);
    if ( !v21 )
      break;
    v3 = v21;
  }
  result = v23;
  if ( v23 )
  {
    v2 = v24;
LABEL_50:
    result = *(_DWORD *)&byte_5D4594[2598000] / (*(_DWORD *)&byte_5D4594[2649704] >> 1);
    if ( !(*(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] >> 1)) )
    {
      result = *v2;
      if ( (int)*v2 < 50 )
      {
        if ( !(result % 8) )
        {
          v20 = (double)(80 * result / 50);
          nullsub_35(v1, LODWORD(v20));
          result = sub_4E44F0(v1);
        }
        ++*v2;
      }
    }
  }
  return result;
}
// 4E4770: using guessed type void __cdecl nullsub_35(_DWORD, _DWORD);

//----- (0053C940) --------------------------------------------------------
int __cdecl sub_53C940(_DWORD *a1)
{
  int v1; // ecx
  int result; // eax
  int v3; // edx
  int *i; // ecx
  int v5; // eax
  float v6; // [esp+0h] [ebp-4h]

  if ( !a1 )
    return 0;
  v1 = a1[2];
  if ( v1 & 0x1000 && a1[3] & 0x4000000 )
  {
    v6 = sub_419D40(&byte_587000[278412]);
    result = sub_419A70(v6);
  }
  else
  {
    v3 = 2;
    for ( i = (int *)(a1[173] + 8); ; ++i )
    {
      v5 = *i;
      if ( *i )
      {
        if ( *(int (**)())(v5 + 40) == nullsub_36 )
          break;
      }
      if ( ++v3 >= 4 )
        return 0;
    }
    result = *(_DWORD *)(v5 + 48);
  }
  return result;
}
// 4E09D0: using guessed type void nullsub_36();

//----- (0053C9A0) --------------------------------------------------------
void __cdecl sub_53C9A0(float *a1)
{
  float *v1; // ebx
  int v2; // ecx
  int v3; // edx
  float *v4; // esi
  float v5; // ecx
  int v6; // ebp
  int v7; // edi
  int v8; // eax
  _DWORD *v9; // eax
  _DWORD *v10; // edi
  int v11; // eax
  float4 v12; // [esp+4h] [ebp-10h]
  float v13; // [esp+18h] [ebp+4h]

  v1 = a1;
  v2 = *((_DWORD *)a1 + 34);
  v3 = *((_DWORD *)a1 + 32);
  if ( v2 == v3 )
  {
    *((_DWORD *)a1 + 34) = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(1, 5);
  }
  else if ( v2 == *(_DWORD *)&byte_5D4594[2598000] )
  {
    if ( !*(_DWORD *)&byte_5D4594[2488684] )
    {
      *(_DWORD *)&byte_5D4594[2488684] = sub_4E3AA0((CHAR *)&byte_587000[278488]);
      *(_DWORD *)&byte_5D4594[2488688] = sub_4E3AA0((CHAR *)&byte_587000[278500]);
    }
    v4 = a1 + 14;
    sub_4E25B0((int)(a1 + 14), 100.0, 30.0, 30, 7, (int)a1, 0);
    sub_52E040((int)(a1 + 14), 100.0, 1106247680, 60.0, (int)a1, 0, 0);
    v5 = a1[15];
    v12.field_0 = a1[14];
    v12.field_4 = v5;
    v6 = 4;
    do
    {
      v7 = sub_415FA0(0, 1);
      v13 = sub_416030(0.0, 15.0) + 10.0;
      v8 = sub_415FA0(0, 255);
      v12.field_8 = v13 * *(float *)&byte_587000[8 * v8 + 194136] + *v4;
      v12.field_C = v13 * *(float *)&byte_587000[8 * v8 + 194140] + v1[15];
      if ( sub_535250(&v12, 0, 0, 1) )
      {
        v9 = sub_4E3450(*(_DWORD *)&byte_5D4594[4 * v7 + 2488684]);
        v10 = v9;
        if ( v9 )
        {
          sub_4DAA50((int)v9, 0, v12.field_8, v12.field_C);
          v11 = sub_415FA0(5, 20);
          sub_511660(v10, *(_DWORD *)&byte_5D4594[2649704] * v11);
        }
      }
      --v6;
    }
    while ( v6 );
  }
  else if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v3) >= *(int *)&byte_5D4594[2649704] )
  {
    sub_4E5CC0((int)a1);
  }
}

//----- (0053CB60) --------------------------------------------------------
void __cdecl sub_53CB60(int a1)
{
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128)) >= *(int *)&byte_5D4594[2649704] )
    sub_4E5CC0(a1);
}

//----- (0053CB90) --------------------------------------------------------
void __cdecl sub_53CB90(int a1)
{
  unsigned int v1; // eax
  float4 a1a; // [esp+4h] [ebp-10h]

  v1 = *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128);
  if ( v1 == 8 )
  {
    *(_DWORD *)&byte_5D4594[2488664] = 0;
    a1a.field_0 = *(float *)(a1 + 56) - 40.0;
    a1a.field_4 = *(float *)(a1 + 60) - 40.0;
    a1a.field_8 = *(float *)(a1 + 56) + 40.0;
    a1a.field_C = *(float *)(a1 + 60) + 40.0;
    sub_517C10(&a1a, sub_53CC30, a1 + 56);
    if ( *(_DWORD *)&byte_5D4594[2488664] )
      sub_501960(283, a1, 0, 0);
  }
  else if ( v1 >= 0x1E )
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053CC30) --------------------------------------------------------
void __cdecl sub_53CC30(float *a1, int a2)
{
  int v2; // eax
  double v3; // st7
  double v4; // st6

  v2 = *((_DWORD *)a1 + 2);
  if ( v2 & 0x2000 )
  {
    v3 = *(float *)a2 - a1[14];
    v4 = *(float *)(a2 + 4) - a1[15];
    if ( sqrt(v4 * v4 + v3 * v3) - a1[44] <= 40.0 )
    {
      sub_4E5CC0((int)a1);
      *(_DWORD *)&byte_5D4594[2488664] = 1;
    }
  }
}

//----- (0053CC90) --------------------------------------------------------
void __cdecl sub_53CC90(int a1)
{
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128)) > 2 )
    sub_4E5CC0(a1);
}

//----- (0053CCB0) --------------------------------------------------------
void __cdecl sub_53CCB0(int a1)
{
  int v1; // edx
  int v2; // esi

  v1 = *(_DWORD *)(a1 + 136);
  v2 = *(_DWORD *)(a1 + 128);
  if ( v1 == v2 )
  {
    *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000] + 3;
  }
  else if ( v1 == *(_DWORD *)&byte_5D4594[2598000] )
  {
    sub_4E25B0(a1 + 56, 15.0, 15.0, 1, 1, a1, 0);
  }
  else if ( *(_DWORD *)&byte_5D4594[2598000] - v2 >= (unsigned int)(2 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053CD20) --------------------------------------------------------
void __cdecl sub_53CD20(int a1)
{
  _DWORD *v1; // ebx
  int v2; // eax
  unsigned int v3; // edx
  unsigned int v4; // eax
  int v5; // ecx
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  float *v11; // edi
  int v12; // eax
  float v13; // edx
  int v14; // eax
  double v15; // st7
  float v16; // edx
  float v17; // ecx
  float v18; // edx
  int v19; // eax
  double v20; // st7
  float v21; // [esp+0h] [ebp-28h]
  float2 a2; // [esp+10h] [ebp-18h]
  float4 a1a; // [esp+18h] [ebp-10h]

  v1 = *(_DWORD **)(a1 + 748);
  if ( *(_DWORD *)&byte_5D4594[2488696] )
  {
    v3 = *(_DWORD *)&byte_5D4594[2649704];
  }
  else
  {
    v21 = sub_419D40(&byte_587000[278704]);
    v2 = sub_419A70(v21);
    v3 = *(_DWORD *)&byte_5D4594[2649704];
    *(_DWORD *)&byte_5D4594[2488696] = *(_DWORD *)&byte_5D4594[2649704] * v2;
  }
  v4 = v1[5];
  v5 = *(_DWORD *)&byte_5D4594[2598000];
  if ( *(_DWORD *)&byte_5D4594[2598000] > v4 && v4 )
  {
    sub_4E5CC0(a1);
    return;
  }
  v6 = v1[1];
  if ( v6 )
  {
    v7 = *(_DWORD *)(v6 + 16);
    if ( v7 & 0x20 || (v7 & 0x8000) != 0 )
    {
      v1[1] = 0;
      v3 = *(_DWORD *)&byte_5D4594[2649704];
      v5 = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
  if ( *(_DWORD *)(a1 + 16) & 0x1000000 )
  {
    if ( v5 - *(_DWORD *)(a1 + 136) > v3 >> 2 )
    {
      v8 = sub_533570(a1);
      v1[1] = v8;
      if ( v8 == *(_DWORD *)(a1 + 508) )
        v1[1] = 0;
      *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
  else
  {
    v1[1] = 0;
  }
  v9 = *(_DWORD *)(a1 + 508);
  if ( v9 && (*(_BYTE *)(v9 + 8) & 4) == 4 && (*(_BYTE *)(v9 + 16) & 2) == 2 )
    v1[1] = 0;
  v10 = v1[1];
  if ( !v10 )
  {
    v11 = (float *)(a1 + 56);
    sub_518170(a1 + 56, *(float *)&byte_587000[277804], sub_53D010, a1);
    v12 = *(_DWORD *)(a1 + 508);
    if ( v12 )
    {
      v13 = *(float *)(a1 + 60);
      a1a.field_0 = *v11;
      a1a.field_4 = v13;
      a1a.field_8 = *(float *)(v12 + 56);
      a1a.field_C = *(float *)(v12 + 60);
      if ( !sub_535250(&a1a, 0, 0, 9) )
        goto LABEL_29;
      v14 = *(_DWORD *)(a1 + 508);
      a2.field_0 = *(float *)(v14 + 56) - *v11;
      v15 = *(float *)(v14 + 60);
    }
    else
    {
      v16 = *v11;
      v17 = *(float *)(a1 + 156);
      a1a.field_4 = *(float *)(a1 + 60);
      a1a.field_0 = v16;
      v18 = *(float *)(a1 + 160);
      a1a.field_8 = v17;
      a1a.field_C = v18;
      if ( !sub_535250(&a1a, 0, 0, 9) )
        goto LABEL_29;
      a2.field_0 = *(float *)(a1 + 156) - *v11;
      v15 = *(float *)(a1 + 160);
    }
    a2.field_4 = v15 - *(float *)(a1 + 60);
    sub_53CF90(a1, &a2, 25);
    goto LABEL_29;
  }
  a2.field_0 = *(float *)(v10 + 56) - *(float *)(a1 + 56);
  a2.field_4 = *(float *)(v1[1] + 60) - *(float *)(a1 + 60);
  sub_53CF90(a1, &a2, 32);
LABEL_29:
  v19 = 8 * *(__int16 *)(a1 + 126);
  *(float *)(a1 + 88) = *(float *)&byte_587000[v19 + 194136] * *(float *)(a1 + 544);
  v20 = *(float *)&byte_587000[v19 + 194140] * *(float *)(a1 + 544);
  *(_DWORD *)(a1 + 112) = 1063675494;
  *(float *)(a1 + 92) = v20;
  if ( byte_5D4594[2598000] & 8 && *(_DWORD *)(a1 + 508) )
  {
    if ( sub_537110(a1, *(_DWORD *)(a1 + 508)) == 1 )
      v1[6] = *(_DWORD *)&byte_5D4594[2598000];
    if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v1[6]) > *(int *)&byte_5D4594[2488696] )
    {
      sub_4FD050((_DWORD *)a1, *(_DWORD *)(a1 + 508));
      v1[6] = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
}

//----- (0053CF90) --------------------------------------------------------
__int16 __cdecl sub_53CF90(int a1, float2 *a2, __int16 a3)
{
  __int16 v3; // dx
  __int16 result; // ax

  v3 = *(_WORD *)(a1 + 126);
  if ( *(float *)&byte_587000[8 * v3 + 194136] * a2->field_4 - *(float *)&byte_587000[8 * v3 + 194140] * a2->field_0 >= 0.0 )
  {
    result = v3 + a3;
    *(_WORD *)(a1 + 126) = v3 + a3;
    if ( (__int16)(v3 + a3) >= 256 )
    {
      result = -256;
      do
        *(_WORD *)(a1 + 126) -= 256;
      while ( *(_WORD *)(a1 + 126) >= 256 );
    }
  }
  else
  {
    result = v3 - a3;
    *(_WORD *)(a1 + 126) = v3 - a3;
    if ( (__int16)(v3 - a3) < 0 )
    {
      do
        result += 256;
      while ( result < 0 );
      *(_WORD *)(a1 + 126) = result;
    }
  }
  return result;
}

//----- (0053D010) --------------------------------------------------------
__int16 __cdecl sub_53D010(int a1, int a2)
{
  int v2; // eax
  float2 a2a; // [esp+0h] [ebp-8h]

  v2 = *(_DWORD *)&byte_5D4594[2488692];
  if ( !*(_DWORD *)&byte_5D4594[2488692] )
  {
    v2 = sub_4E3AA0((CHAR *)&byte_587000[278724]);
    *(_DWORD *)&byte_5D4594[2488692] = v2;
  }
  if ( *(unsigned __int16 *)(a1 + 4) == v2 )
  {
    LOWORD(v2) = a2;
    if ( a1 != a2 && *(_DWORD *)(a2 + 508) == *(_DWORD *)(a1 + 508) )
    {
      a2a.field_0 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
      a2a.field_4 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
      LOWORD(v2) = sub_53CF90(a2, &a2a, 16);
    }
  }
  return v2;
}

//----- (0053D080) --------------------------------------------------------
void __cdecl sub_53D080(int a1)
{
  int v1; // esi
  int v2; // ebx
  int v3; // eax
  float v4; // [esp+0h] [ebp-1Ch]
  float v5; // [esp+8h] [ebp-14h]
  float v6; // [esp+18h] [ebp-4h]
  float v7; // [esp+20h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128);
  if ( *(_DWORD *)&byte_5D4594[2598000] % (*(_DWORD *)&byte_5D4594[2649704] / 3u) )
  {
    *(_DWORD *)&byte_5D4594[2488700] = 0;
    v4 = sub_419D40(&byte_587000[278732]);
    sub_518170(a1 + 56, v4, sub_53D170, a1);
    if ( *(_DWORD *)&byte_5D4594[2488700] == 1 )
    {
      sub_537AF0((int *)(a1 + 56), 1);
      sub_4E5CC0(a1);
    }
  }
  if ( v2 > 10 )
  {
    v6 = sub_419D40(&byte_587000[278756]);
    v7 = sub_419D40(&byte_587000[278776]);
    v5 = sub_419D40(&byte_587000[278796]);
    v3 = sub_419A70(v5);
    sub_4E25B0(v1 + 56, v6, v7, v3, 2, v1, 0);
  }
  if ( v2 > 4 * *(_DWORD *)&byte_5D4594[2649704] )
    sub_4E5CC0(v1);
}

//----- (0053D170) --------------------------------------------------------
void __cdecl sub_53D170(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  int v4; // eax
  float v5; // edx
  float v6; // [esp-14h] [ebp-24h]
  int4 a1a; // [esp+0h] [ebp-10h]

  v2 = *(_DWORD *)&byte_5D4594[2488704];
  if ( !*(_DWORD *)&byte_5D4594[2488704] )
  {
    v2 = sub_4E3AA0((CHAR *)&byte_587000[278820]);
    *(_DWORD *)&byte_5D4594[2488704] = v2;
  }
  if ( a1 != a2 && *(unsigned __int16 *)(a1 + 4) == v2 && sub_537110(a2, a1) )
  {
    *(_DWORD *)&byte_5D4594[2488700] = 1;
    if ( !(*(_BYTE *)(a1 + 16) & 0x20) )
    {
      a1a.field_0 = sub_419A70(*(float *)(a2 + 56));
      v3 = sub_419A70(*(float *)(a2 + 60));
      v6 = *(float *)(a1 + 56);
      a1a.field_4 = v3;
      v4 = sub_419A70(v6);
      v5 = *(float *)(a1 + 60);
      a1a.field_8 = v4;
      a1a.field_C = sub_419A70(v5);
      sub_523790(&a1a, 10);
      sub_537AF0((int *)(a1 + 56), 1);
      sub_4E5CC0(a1);
    }
  }
}

//----- (0053D220) --------------------------------------------------------
void __cdecl sub_53D220(int a1)
{
  int v1; // esi

  v1 = *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128);
  if ( v1 > 10 )
    sub_4E25B0(a1 + 56, 25.0, 0.0, 20, 2, a1, 0);
  if ( v1 > 2 * *(_DWORD *)&byte_5D4594[2649704] )
    sub_4E5CC0(a1);
}

//----- (0053D270) --------------------------------------------------------
void __cdecl sub_53D270(int a1)
{
  int v1; // eax
  int v2; // ecx
  float2 v3; // [esp+4h] [ebp-8h]

  v1 = *(_DWORD *)(a1 + 508);
  if ( v1 )
  {
    if ( *(_BYTE *)(v1 + 8) & 4 )
    {
      v2 = *(_DWORD *)(v1 + 748);
      if ( *(_BYTE *)(v1 + 16) & 0x20
        || *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) > (unsigned int)(300
                                                                                   * *(_DWORD *)&byte_5D4594[2649704]) )
      {
        sub_4E5CC0(a1);
        sub_4FF5B0(*(_DWORD *)(a1 + 508), 1);
      }
      else
      {
        v3.field_0 = (double)*(int *)(*(_DWORD *)(v2 + 276) + 2284);
        v3.field_4 = (double)*(int *)(*(_DWORD *)(v2 + 276) + 2288);
        if ( sub_517590(v3.field_0, v3.field_4) )
          sub_4E7010(a1, &v3);
      }
    }
  }
  else
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053D330) --------------------------------------------------------
void __cdecl sub_53D330(int a1)
{
  int v1; // eax
  int v2; // ecx
  int v3; // eax
  int v4; // [esp-Ch] [ebp-20h]
  float4 v5; // [esp+4h] [ebp-10h]

  v1 = *(_DWORD *)(a1 + 508);
  v2 = *(_DWORD *)(v1 + 748);
  if ( *(_DWORD *)(v1 + 16) & 0x8020
    || *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) > (unsigned int)(20 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    v4 = *(_DWORD *)(a1 + 508);
    v3 = sub_424800(127, 2);
    sub_501960(v3, v4, 0, 0);
    sub_4E5CC0(a1);
    sub_4FF5B0(*(_DWORD *)(a1 + 508), 24);
  }
  else
  {
    v5.field_8 = (double)*(int *)(*(_DWORD *)(v2 + 276) + 2284);
    v5.field_C = (double)*(int *)(*(_DWORD *)(v2 + 276) + 2288);
    v5.field_0 = *(float *)(v1 + 56);
    v5.field_4 = *(float *)(v1 + 60);
    if ( sub_535250(&v5, 0, 0, 5) )
      sub_4E7010(a1, (float2 *)&v5.field_8);
  }
}

//----- (0053D400) --------------------------------------------------------
void __cdecl sub_53D400(int a1)
{
  double v1; // st7
  double v2; // st7
  double v3; // st7
  float2 a2; // [esp+4h] [ebp-8h]

  if ( *(float *)(a1 + 104) <= 0.0 && (int)*(_DWORD *)(a1 + 16) >= 0 )
  {
    sub_501960(48, a1, 0, 0);
    sub_537AF0((int *)(a1 + 56), 2);
    v1 = *(float *)(a1 + 176) + *(float *)(a1 + 56);
    *(_DWORD *)(a1 + 16) |= 0x80000000;
    a2.field_4 = *(float *)(a1 + 60);
    a2.field_0 = v1;
    sub_522FF0(138, &a2);
    v2 = *(float *)(a1 + 56) - *(float *)(a1 + 176);
    a2.field_4 = *(float *)(a1 + 60);
    a2.field_0 = v2;
    sub_522FF0(138, &a2);
    v3 = *(float *)(a1 + 176) + *(float *)(a1 + 60);
    a2.field_0 = *(float *)(a1 + 56);
    a2.field_4 = v3;
    sub_522FF0(138, &a2);
    sub_4D9110((float *)(a1 + 56), 30);
  }
  if ( *(float *)(a1 + 104) >= 200.0 && *(int *)(a1 + 16) < 0 )
    sub_4E5CC0(a1);
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128) > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) )
    sub_4E5CC0(a1);
}

//----- (0053D510) --------------------------------------------------------
void __cdecl sub_53D510(int a1)
{
  float v1; // ecx
  float v2; // eax
  float v3; // ecx
  float4 v4; // [esp+4h] [ebp-10h]

  if ( *(_DWORD *)&byte_5D4594[2598000] >= *(int *)(a1 + 136)
    || (v1 = *(float *)(a1 + 156),
        v2 = *(float *)(a1 + 56),
        v4.field_4 = *(float *)(a1 + 160),
        v4.field_0 = v1,
        v3 = *(float *)(a1 + 60),
        v4.field_8 = v2,
        v4.field_C = v3,
        !sub_535250(&v4, 0, 0, 65))
    || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 128)) > 3
    && *(float *)(a1 + 72) == *(float *)(a1 + 56)
    && *(float *)(a1 + 76) == *(float *)(a1 + 60) )
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053D5A0) --------------------------------------------------------
void __cdecl sub_53D5A0(float *a2)
{
  _DWORD *v1; // ebx
  int v2; // edi
  double v3; // st7
  double v4; // st7
  float v5; // edx
  double v6; // st6
  double v7; // st7
  _DWORD *v8; // eax
  int v9; // edi
  float a3; // [esp+8h] [ebp-18h]
  float a4; // [esp+Ch] [ebp-14h]
  float4 a1; // [esp+10h] [ebp-10h]

  if ( *(_DWORD *)&byte_5D4594[2598000] - *((_DWORD *)a2 + 32) < (unsigned int)(5 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    if ( *((_DWORD *)a2 + 34) <= *(int *)&byte_5D4594[2598000] )
    {
      v1 = (_DWORD *)*((_DWORD *)a2 + 187);
      v2 = sub_415FA0(0, 255);
      v3 = sub_416030(4.0, 12.0);
      v4 = v3 * v3;
      v5 = a2[15];
      a1.field_0 = a2[14];
      v6 = v4 * *(float *)&byte_587000[8 * v2 + 194136];
      a1.field_4 = v5;
      a3 = v6 + a2[14];
      v7 = v4 * *(float *)&byte_587000[8 * v2 + 194140];
      a1.field_8 = a3;
      a4 = v7 + a2[15];
      a1.field_C = a4;
      if ( (unsigned __int8)sub_5374B0(&a1) )
      {
        v8 = sub_4E3810((CHAR *)&byte_587000[278928]);
        v9 = (int)v8;
        if ( v8 )
        {
          *(_DWORD *)v8[187] = *v1;
          sub_4DAA50((int)v8, (int)a2, a3, a4);
          *(_DWORD *)(v9 + 20) |= 0x20u;
          sub_4E46F0(v9, 255.0);
          *(_DWORD *)(v9 + 108) = -1056964608;
        }
      }
      *((_DWORD *)a2 + 34) = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(4, 8);
    }
  }
  else
  {
    sub_4E5CC0((int)a2);
  }
}

//----- (0053D6E0) --------------------------------------------------------
void __cdecl sub_53D6E0(int a6)
{
  int *v1; // ebx
  float *v2; // edi
  _DWORD *v3; // eax
  int v4; // eax
  float v5; // [esp+4h] [ebp-20h]
  float v6; // [esp+8h] [ebp-1Ch]
  float v7; // [esp+Ch] [ebp-18h]
  float v8; // [esp+10h] [ebp-14h]
  int4 a1; // [esp+14h] [ebp-10h]

  if ( *(float *)(a6 + 104) <= 0.0 )
  {
    v1 = *(int **)(a6 + 748);
    sub_501960(87, a6, 0, 0);
    v2 = (float *)(a6 + 56);
    sub_537AF0((int *)(a6 + 56), 2);
    sub_4D9110((float *)(a6 + 56), 10);
    v3 = sub_4E3810((CHAR *)&byte_587000[278984]);
    if ( v3 )
      sub_4DAA50((int)v3, 0, *v2, *(float *)(a6 + 60));
    v4 = sub_4EC580(a6);
    sub_4E25B0(a6 + 56, 80.0, 30.0, *v1, 7, v4, 0);
    v5 = *v2 - 80.0;
    v6 = *(float *)(a6 + 60) - 80.0;
    v7 = *v2 + 80.0;
    v8 = *(float *)(a6 + 60) + 80.0;
    a1.field_0 = sub_419A70(v5) / 23;
    a1.field_4 = sub_419A70(v6) / 23;
    a1.field_8 = sub_419A70(v7) / 23;
    a1.field_C = sub_419A70(v8) / 23;
    sub_534FC0(&a1, a6 + 56, 80.0, *v1, 7, a6);
    sub_4E5CC0(a6);
  }
}

//----- (0053D850) --------------------------------------------------------
void __cdecl sub_53D850(int a1)
{
  _DWORD *v1; // esi

  v1 = *(_DWORD **)(a1 + 748);
  if ( *(_DWORD *)(a1 + 136) < *(int *)&byte_5D4594[2598000] )
  {
    sub_517F90((float2 *)(a1 + 56), 75.0, sub_53D8C0, a1);
    *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(5, 10);
  }
  if ( *v1 )
    --*v1;
  if ( !*v1 )
    sub_4E5CC0(a1);
}

//----- (0053D8C0) --------------------------------------------------------
void __cdecl sub_53D8C0(int a1, int a2)
{
  float v2; // edx
  float v3; // eax
  float v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // [esp-8h] [ebp-20h]
  float4 v8; // [esp+8h] [ebp-10h]

  if ( *(_BYTE *)(a1 + 8) & 6 )
  {
    v2 = *(float *)(a1 + 56);
    v3 = *(float *)(a2 + 56);
    v8.field_4 = *(float *)(a2 + 60);
    v8.field_0 = v3;
    v4 = *(float *)(a1 + 60);
    v8.field_8 = v2;
    v8.field_C = v4;
    if ( sub_535250(&v8, 0, 0, 5) )
    {
      v7 = sub_415FA0(3, 10);
      v5 = sub_4EC580(a2);
      (*(void (__cdecl **)(int, int, int, int, int))(a1 + 716))(a1, v5, a2, v7, 5);
      v6 = sub_4EC580(a2);
      if ( sub_5330C0(v6, a1) )
        sub_4EE7E0(a1, 1, 1);
    }
  }
}

//----- (0053D960) --------------------------------------------------------
void __cdecl sub_53D960(int a1)
{
  _DWORD *v1; // esi

  v1 = *(_DWORD **)(a1 + 748);
  if ( *(_DWORD *)(a1 + 136) < *(int *)&byte_5D4594[2598000] )
  {
    sub_517F90((float2 *)(a1 + 56), 35.0, sub_53D9D0, a1);
    *(_DWORD *)(a1 + 136) = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(5, 10);
  }
  if ( *v1 )
    --*v1;
  if ( !*v1 )
    sub_4E5CC0(a1);
}

//----- (0053D9D0) --------------------------------------------------------
void __cdecl sub_53D9D0(int a1, int a2)
{
  float v2; // edx
  float v3; // eax
  float v4; // eax
  int v5; // eax
  int v6; // eax
  float4 v7; // [esp+8h] [ebp-10h]

  if ( *(_BYTE *)(a1 + 8) & 6 )
  {
    v2 = *(float *)(a1 + 56);
    v3 = *(float *)(a2 + 56);
    v7.field_4 = *(float *)(a2 + 60);
    v7.field_0 = v3;
    v4 = *(float *)(a1 + 60);
    v7.field_8 = v2;
    v7.field_C = v4;
    if ( sub_535250(&v7, 0, 0, 5) )
    {
      v5 = sub_4EC580(a2);
      (*(void (__cdecl **)(int, int, int, _DWORD, int))(a1 + 716))(a1, v5, a2, 0, 5);
      v6 = sub_4EC580(a2);
      if ( sub_5330C0(v6, a1) )
        sub_4EE7E0(a1, 1, 1);
    }
  }
}

//----- (0053DA60) --------------------------------------------------------
void __cdecl sub_53DA60(int *a1)
{
  int v1; // eax
  int v2; // eax
  _DWORD *v3; // eax

  v1 = *(_DWORD *)&byte_5D4594[2598000];
  if ( (unsigned int)a1[34] < *(int *)&byte_5D4594[2598000] )
  {
    v2 = *(_DWORD *)&byte_5D4594[2488708];
    if ( !*(_DWORD *)&byte_5D4594[2488708] )
    {
      v2 = sub_4E3AA0((CHAR *)&byte_587000[279144]);
      *(_DWORD *)&byte_5D4594[2488708] = v2;
    }
    v3 = sub_4E3450(v2);
    if ( v3 )
      sub_4DAA50((int)v3, a1[127], *((float *)a1 + 14), *((float *)a1 + 15));
    a1[34] = *(_DWORD *)&byte_5D4594[2598000] + sub_415FA0(1, 5);
    v1 = *(_DWORD *)&byte_5D4594[2598000];
  }
  if ( v1 - a1[32] > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) )
    sub_4E5CC0((int)a1);
}

//----- (0053DB00) --------------------------------------------------------
void __cdecl sub_53DB00(int a1)
{
  if ( *(_DWORD *)(a1 + 128) > *(int *)&byte_5D4594[2598000]
    || *(_DWORD *)(a1 + 136) < *(int *)&byte_5D4594[2598000] )
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053DB30) --------------------------------------------------------
int *__cdecl sub_53DB30(_DWORD *a1)
{
  int *result; // eax

  result = (int *)a1[5];
  if ( (unsigned __int8)result & 2 )
  {
    result = (int *)a1[4];
    if ( SBYTE1(result) < 0 )
    {
      sub_4E4780((int)a1, 2);
      sub_4E4800((int)a1, (int *)4);
      result = (int *)a1[4];
      LOBYTE(result) = (unsigned __int8)result | 0x40;
      a1[34] = *(_DWORD *)&byte_5D4594[2598000] + 2 * *(_DWORD *)&byte_5D4594[2649704];
      a1[4] = result;
    }
  }
  else if ( (unsigned __int8)result & 4 )
  {
    result = *(int **)&byte_5D4594[2598000];
    if ( *(_DWORD *)&byte_5D4594[2598000] > a1[34] )
    {
      sub_4E4780((int)a1, 4);
      result = sub_4E4800((int)a1, (int *)8);
    }
  }
  else if ( (unsigned __int8)result & 8 )
  {
    result = sub_4DA920(a1);
  }
  return result;
}

//----- (0053DBB0) --------------------------------------------------------
int *__cdecl sub_53DBB0(_DWORD *a1)
{
  int *result; // eax

  result = (int *)a1[5];
  if ( (unsigned __int8)result & 2 )
  {
    result = (int *)a1[4];
    if ( SBYTE1(result) < 0 )
    {
      sub_4E4780((int)a1, 2);
      sub_4E4800((int)a1, (int *)4);
      result = *(int **)&byte_5D4594[2598000];
      a1[34] = *(_DWORD *)&byte_5D4594[2598000] + 2 * *(_DWORD *)&byte_5D4594[2649704];
    }
  }
  else if ( (unsigned __int8)result & 4 )
  {
    result = *(int **)&byte_5D4594[2598000];
    if ( *(_DWORD *)&byte_5D4594[2598000] > a1[34] )
    {
      sub_4E4780((int)a1, 4);
      result = sub_4E4800((int)a1, (int *)8);
    }
  }
  else if ( (unsigned __int8)result & 8 )
  {
    result = sub_4DA920(a1);
  }
  return result;
}

//----- (0053DC30) --------------------------------------------------------
void __cdecl sub_53DC30(_DWORD *a1)
{
  int v1; // eax
  int v2; // eax

  switch ( a1[5] )
  {
    case 2:
      v1 = a1[4];
      if ( (v1 & 0x8000) != 0 )
      {
        sub_4E4780((int)a1, 2);
        sub_4E4800((int)a1, (int *)4);
        a1[34] = *(_DWORD *)&byte_5D4594[2598000] + 2 * *(_DWORD *)&byte_5D4594[2649704];
        v2 = a1[4];
        LOBYTE(v2) = v2 | 0x40;
        a1[4] = v2;
      }
      break;
    case 4:
      if ( *(_DWORD *)&byte_5D4594[2598000] > a1[34] )
      {
        sub_4E4780((int)a1, 4);
        sub_4E4800((int)a1, (int *)8);
      }
      break;
    case 8:
      sub_4DA920(a1);
      sub_4E5CC0((int)a1);
      break;
  }
}

//----- (0053DCC0) --------------------------------------------------------
void __cdecl sub_53DCC0(int a1)
{
  int v1; // edi
  int v2; // esi
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  double v8; // st7
  double v9; // st6
  float v10; // [esp+Ch] [ebp-4h]
  float v11; // [esp+14h] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  v3 = sub_4E7980(a1);
  if ( !v3 || *(_BYTE *)(v3 + 16) & 0x20 )
  {
    sub_4E5CC0(a1);
    return;
  }
  v4 = *(_DWORD *)(v2 + 12);
  if ( v4 && *(_BYTE *)(v4 + 16) & 0x20 )
    *(_DWORD *)(v2 + 12) = 0;
  v5 = *(_DWORD *)(a1 + 508);
  if ( !v5 || *(_BYTE *)(v5 + 16) & 0x20 )
  {
    *(_BYTE *)(v2 + 24) = 1;
    *(_DWORD *)(v2 + 8) = 0;
  }
  else
  {
    *(_DWORD *)(v2 + 16) = *(_DWORD *)(v5 + 56);
    *(_DWORD *)(v2 + 20) = *(_DWORD *)(v5 + 60);
    if ( !sub_537110(a1, *(_DWORD *)(a1 + 508)) )
    {
      *(_DWORD *)(v2 + 8) = 0;
LABEL_12:
      if ( !*(_BYTE *)(v2 + 24) )
      {
        v6 = *(_DWORD *)(v2 + 8);
        if ( v6 && ((v7 = *(_DWORD *)(v6 + 16), v7 & 0x20) || (v7 & 0x8000) != 0) )
        {
          *(_DWORD *)(v2 + 8) = 0;
          *(_BYTE *)(v2 + 24) = 1;
        }
        else
        {
          v8 = *(float *)(v2 + 16) - *(float *)(a1 + 56);
          v9 = *(float *)(v2 + 20) - *(float *)(a1 + 60);
          v11 = v9;
          v10 = sqrt(v9 * v11 + v8 * v8) + *(double *)&byte_581450[10176];
          *(float *)(v1 + 80) = v8 * *(float *)(v1 + 544) / v10;
          *(float *)(v1 + 84) = v11 * *(float *)(v1 + 544) / v10;
        }
      }
      goto LABEL_19;
    }
    if ( !*(_BYTE *)(v2 + 24) )
    {
      *(_DWORD *)(v2 + 8) = *(_DWORD *)(a1 + 508);
      goto LABEL_12;
    }
  }
LABEL_19:
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 128) > (unsigned int)(5 * *(_DWORD *)&byte_5D4594[2649704]) )
  {
    *(_BYTE *)(v2 + 24) = 1;
    *(_DWORD *)(v2 + 8) = 0;
  }
}

//----- (0053DDF0) --------------------------------------------------------
int __cdecl sub_53DDF0(int a1)
{
  int v1; // esi
  int v2; // edi
  int result; // eax
  int v4; // eax
  int v5; // edx
  char v6; // [esp-18h] [ebp-24h]
  unsigned __int8 v7; // [esp+8h] [ebp-4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  result = *(_DWORD *)(v2 + 8);
  if ( result )
  {
    v4 = sub_4ECBD0(a1);
    v5 = *(_DWORD *)(v2 + 8);
    a1 = v4;
    v7 = *(_BYTE *)(v1 + 52);
    result = 3 * *(_DWORD *)&byte_5D4594[2649704];
    if ( *(_DWORD *)&byte_5D4594[2598000] - v5 > (unsigned int)(30 * *(_DWORD *)&byte_5D4594[2649704]) )
    {
      sub_501960(305, v1, 0, 0);
      v6 = a1;
      *(_DWORD *)(v2 + 8) = 0;
      sub_4E82C0(v7, 0, v6, 0);
      sub_4E7010(v1, (float2 *)v2);
      result = sub_4DA180(8, &a1);
    }
  }
  return result;
}

//----- (0053DE80) --------------------------------------------------------
int *__cdecl sub_53DE80(_DWORD *a1)
{
  int v1; // edi
  int *result; // eax

  v1 = a1[175];
  if ( a1[4] & 0x1000000 )
  {
    result = (int *)a1[5];
    if ( (unsigned __int8)result & 2 )
    {
      sub_4E4780((int)a1, 2);
      result = sub_4E4800((int)a1, (int *)8);
    }
    else if ( (unsigned __int8)result & 4 )
    {
      result = *(int **)(v1 + 16);
      if ( *(_DWORD *)&byte_5D4594[2598000] >= (unsigned int)result )
      {
        sub_4E4780((int)a1, 4);
        result = sub_4E4800((int)a1, (int *)8);
      }
    }
    else
    {
      *(_DWORD *)(v1 + 24) = 0;
    }
  }
  else
  {
    result = *(int **)(v1 + 16);
    if ( result )
    {
      if ( *(_DWORD *)&byte_5D4594[2598000] >= (unsigned int)result )
      {
        sub_4E4670((int)a1, 1);
        sub_4E4780((int)a1, 2);
        sub_4E4800((int)a1, (int *)4);
        *(_DWORD *)(v1 + 16) += 5 * *(_DWORD *)&byte_5D4594[2649704];
        result = sub_501960(874, (int)a1, 0, 0);
      }
    }
  }
  return result;
}

//----- (0053DF40) --------------------------------------------------------
void __cdecl sub_53DF40(int a3)
{
  int v1; // edi
  unsigned __int64 v2; // rax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  double v6; // st7
  double v7; // st7
  double v8; // st7
  double v9; // st6
  int v10; // eax
  float4 v11; // [esp+8h] [ebp-10h]

  v1 = *(_DWORD *)(a3 + 748);
  *(_DWORD *)(a3 + 112) = 1008981770;
  if ( *(_DWORD *)v1 && *(_BYTE *)(*(_DWORD *)v1 + 16) & 0x20 )
  {
    sub_4EB9B0(a3, 0);
    sub_419570(a3 + 48, *(_DWORD *)(a3 + 36));
    sub_4E8290(1, 0);
  }
  v2 = sub_416BB0() - *(_QWORD *)(v1 + 8);
  v11.field_4 = *((float *)&v2 + 1);
  if ( v2 <= 0x4E20 )
  {
    v3 = *(_DWORD *)(a3 + 508);
    if ( v3 )
    {
      if ( v3 != *(_DWORD *)v1
        || (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 16)) <= *(int *)(v1 + 20) )
      {
        *(_DWORD *)(a3 + 16) |= 0x40u;
        *(_QWORD *)(v1 + 8) = sub_416BB0();
        v5 = *(_DWORD *)(a3 + 508);
        if ( *(_DWORD *)(v5 + 16) & 0x8020 )
        {
          sub_4EC300(a3);
          sub_4EB9B0(a3, 0);
          sub_419570(a3 + 48, *(_DWORD *)(a3 + 36));
          sub_4E8290(1, 0);
        }
        else
        {
          v6 = *(float *)(v5 + 176) + *(float *)(a3 + 176);
          v11.field_0 = *(float *)(v5 + 56);
          v11.field_4 = *(float *)(v5 + 60);
          v7 = v6 + 10.0;
          v11.field_8 = v7 * *(float *)&byte_587000[8 * *(__int16 *)(v5 + 124) + 194136] + *(float *)(v5 + 56);
          v11.field_C = v7 * *(float *)&byte_587000[8 * *(__int16 *)(v5 + 124) + 194140] + *(float *)(v5 + 60);
          if ( sub_535250(&v11, 0, 0, 5) )
            sub_4E7010(a3, (float2 *)&v11.field_8);
        }
      }
      else
      {
        *(_DWORD *)(a3 + 16) &= 0xFFFFFFBF;
        *(_DWORD *)(a3 + 520) = 0;
        v4 = *(__int16 *)(*(_DWORD *)(a3 + 508) + 124) + sub_415FA0(-32, 32);
        if ( v4 < 0 )
          v4 += (unsigned int)(255 - v4) >> 8 << 8;
        if ( v4 >= 256 )
          v4 += -256 * ((unsigned int)v4 >> 8);
        v11.field_0 = *(float *)(a3 + 56) - *(float *)&byte_587000[8 * v4 + 194136] * 20.0;
        v11.field_4 = *(float *)(a3 + 60) - *(float *)&byte_587000[8 * v4 + 194140] * 20.0;
        sub_52DF80((int)&v11, a3, 30.0);
        sub_4EC300(a3);
        sub_4E8290(1, 0);
        sub_501960(926, a3, 0, 0);
      }
    }
    else
    {
      v8 = *(float *)(a3 + 84);
      v9 = *(float *)(a3 + 80);
      v10 = *(_DWORD *)(a3 + 16);
      LOBYTE(v10) = v10 & 0xBF;
      *(_DWORD *)(a3 + 16) = v10;
      if ( *(float *)(v1 + 24) > sqrt(v9 * v9 + v8 * v8) )
        *(_DWORD *)v1 = 0;
    }
  }
  else
  {
    sub_417F50(a3);
  }
}

//----- (0053E190) --------------------------------------------------------
void __cdecl sub_53E190(int a1)
{
  int v1; // eax

  v1 = **(_DWORD **)(a1 + 700);
  if ( v1 && *(_BYTE *)(v1 + 88) & 1 )
  {
    sub_4E5CC0(a1);
  }
  else if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a1 + 136)) > 0x46 )
  {
    sub_4E5CC0(a1);
  }
}

//----- (0053E1D0) --------------------------------------------------------
void __cdecl sub_53E1D0(int a1)
{
  _DWORD *v1; // ecx
  int v2; // eax
  int v3; // eax
  double v4; // st7
  double v5; // st7
  float4 v6; // [esp+4h] [ebp-10h]

  v1 = *(_DWORD **)(a1 + 748);
  v2 = v1[1];
  if ( !v2 || *(_DWORD *)(v2 + 16) & 0x8020 )
  {
    if ( *v1 && *(_BYTE *)(*v1 + 16) & 0x20 )
      *v1 = 0;
    v3 = *(_DWORD *)(a1 + 508);
    if ( v3 )
    {
      if ( *(_DWORD *)(v3 + 16) & 0x8020 )
      {
        sub_4EC300(a1);
      }
      else
      {
        v4 = *(float *)(v3 + 176) + *(float *)(a1 + 176);
        v6.field_0 = *(float *)(v3 + 56);
        v6.field_4 = *(float *)(v3 + 60);
        v5 = v4 + 10.0;
        v6.field_8 = v5 * *(float *)&byte_587000[8 * *(__int16 *)(v3 + 124) + 194136] + *(float *)(v3 + 56);
        v6.field_C = v5 * *(float *)&byte_587000[8 * *(__int16 *)(v3 + 124) + 194140] + *(float *)(v3 + 60);
        if ( sub_535250(&v6, 0, 0, 5) )
          sub_4E7010(a1, (float2 *)&v6.field_8);
      }
    }
  }
  else
  {
    sub_4F3400(v2, a1, 1);
  }
}

//----- (0053E2B0) --------------------------------------------------------
char __cdecl sub_53E2B0(int a1)
{
  int v1; // eax

  v1 = *(_DWORD *)(a1 + 16);
  if ( !(v1 & 0x1000000) )
  {
    LOBYTE(v1) = v1 | 0x40;
    *(_DWORD *)(a1 + 744) = 0;
    *(_DWORD *)(a1 + 16) = v1;
  }
  return v1;
}

//----- (0053E2D0) --------------------------------------------------------
BOOL __cdecl sub_53E2D0(int a1)
{
  BOOL result; // eax

  if ( *(_DWORD *)(a1 + 8) & 0x2000000 )
    result = (sub_415C70(a1) & 0xC0D) == 0;
  else
    result = 1;
  return result;
}

//----- (0053E300) --------------------------------------------------------
int __cdecl sub_53E300(_DWORD *a1)
{
  _DWORD *i; // esi
  int v2; // eax
  int result; // eax
  float v4; // [esp+8h] [ebp-4h]

  v4 = 0.0;
  for ( i = (_DWORD *)a1[126]; i; i = (_DWORD *)i[124] )
  {
    if ( i[2] & 0x2000000 )
    {
      v2 = i[4];
      if ( v2 & 0x100 )
        v4 = sub_415C00((int)i) + v4;
    }
  }
  if ( v4 > *(double *)&byte_581450[9512] )
    v4 = 1.0;
  result = a1[2];
  if ( result & 4 )
  {
    result = a1[187];
    *(float *)(result + 228) = v4;
  }
  else if ( result & 2 )
  {
    result = LODWORD(v4);
    *(float *)(a1[187] + 2072) = v4;
  }
  return result;
}

//----- (0053E3A0) --------------------------------------------------------
int __cdecl sub_53E3A0(int a1, int a2)
{
  int result; // eax
  int v3; // ecx

  if ( !(*(_DWORD *)(a2 + 8) & 0x2000000) )
    return 0;
  v3 = *(_DWORD *)(a2 + 16);
  if ( !(v3 & 0x100) )
    return 0;
  result = *(_DWORD *)(a1 + 504);
  if ( !result )
    return 0;
  while ( result != a2 )
  {
    result = *(_DWORD *)(result + 496);
    if ( !result )
      return result;
  }
  BYTE1(v3) &= 0xFEu;
  *(_DWORD *)(a2 + 16) = v3;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    sub_4E4B20(a1, a2, 0);
  *(_DWORD *)(a2 + 16) &= 0xEFFFFFFF;
  sub_53E300((_DWORD *)a1);
  sub_4F3030(a2, a1);
  return 1;
}

//----- (0053E430) --------------------------------------------------------
int __cdecl sub_53E430(_DWORD *a1, int a2, int a3, int a4)
{
  int v4; // ecx
  int v5; // eax
  int v7; // eax
  int v8; // ebp
  _DWORD *v9; // edi
  char v10; // al

  if ( !(*(_DWORD *)(a2 + 8) & 0x2000000) )
    return 0;
  v4 = *(_DWORD *)(a2 + 16);
  if ( !(v4 & 0x100) )
    return 0;
  v5 = a1[2];
  if ( v5 & 2 )
    return sub_53E3A0((int)a1, a2);
  if ( !(v5 & 4) )
    return 0;
  v7 = a1[126];
  v8 = a1[187];
  if ( !v7 )
    return 0;
  while ( v7 != a2 )
  {
    v7 = *(_DWORD *)(v7 + 496);
    if ( !v7 )
      return 0;
  }
  *(_DWORD *)(a2 + 16) = v4 & 0xEFFFFEFF;
  v9 = *(_DWORD **)(v8 + 276);
  *v9 &= ~sub_415C70(a2);
  if ( a3 )
    sub_4D8590(*(unsigned __int8 *)(*(_DWORD *)(v8 + 276) + 2064), (_DWORD *)a2);
  if ( a4 )
    sub_4D84C0(255, a2);
  sub_53E300(a1);
  sub_4F3030(a2, (int)a1);
  if ( *(_BYTE *)(a2 + 12) & 2 )
  {
    v10 = *(_BYTE *)(v8 + 88);
    if ( v10 == 15 || v10 == 16 || v10 == 17 )
      sub_4FA020(a1, 13);
  }
  return 1;
}

//----- (0053E520) --------------------------------------------------------
int __cdecl sub_53E520(int a1, _DWORD *a2)
{
  _DWORD *v3; // eax
  _DWORD *v4; // ecx

  if ( !(a2[2] & 0x2000000) )
    return 0;
  if ( a2[4] & 0x100 )
    return 0;
  v3 = *(_DWORD **)(a1 + 504);
  v4 = *(_DWORD **)(a1 + 504);
  if ( !v4 )
    return 0;
  while ( v4 != a2 )
  {
    v4 = (_DWORD *)v4[124];
    if ( !v4 )
      return 0;
  }
  if ( v3 )
  {
    while ( !(v3[2] & 0x2000000) || !(v3[4] & 0x100) || v3[3] != a2[3] )
    {
      v3 = (_DWORD *)v3[124];
      if ( !v3 )
        goto LABEL_18;
    }
    sub_53E3A0(a1, (int)v3);
  }
LABEL_18:
  a2[4] |= 0x100u;
  if ( *(_BYTE *)(a1 + 12) & 0x10 )
    sub_4E4B20(a1, (int)a2, 1);
  if ( !sub_53E2D0((int)a2) )
    a2[4] |= 0x10000000u;
  sub_53E300((_DWORD *)a1);
  sub_4F2FF0((int)a2, a1);
  if ( a2[3] & 2 )
    sub_53E600((_DWORD *)a1);
  return 1;
}

//----- (0053E600) --------------------------------------------------------
void __cdecl sub_53E600(_DWORD *a1)
{
  _DWORD *i; // esi
  int v2; // eax

  if ( a1 )
  {
    for ( i = (_DWORD *)a1[126]; i; i = (_DWORD *)i[124] )
    {
      v2 = i[4];
      if ( v2 & 0x100 && i[2] & 0x1001000 )
      {
        if ( sub_415820((int)i) & 0x7FFE40C )
          sub_53A140(a1, (int)i, 1, 1);
      }
    }
  }
}

//----- (0053E650) --------------------------------------------------------
int __cdecl sub_53E650(_DWORD *a1, int a2, int a3, int a4)
{
  int v4; // eax
  int v5; // eax
  int v7; // ebx
  _DWORD *v8; // ebp
  int v9; // eax
  int v10; // ecx
  _DWORD *v11; // ebp

  if ( !(*(_DWORD *)(a2 + 8) & 0x2000000) )
    return 0;
  v4 = *(_DWORD *)(a2 + 16);
  if ( v4 & 0x100 )
    return 0;
  v5 = a1[2];
  if ( v5 & 2 )
    return sub_53E520((int)a1, (_DWORD *)a2);
  if ( !(v5 & 4) )
    return 0;
  v7 = a1[187];
  v8 = sub_53E7B0((int)a1, a2);
  if ( !sub_57B3D0(a2, *(_BYTE *)(*(_DWORD *)(v7 + 276) + 2251)) )
  {
    sub_4DA2C0((int)a1, (const char *)&byte_587000[279252], 0);
    if ( a4 )
      sub_501960(925, (int)a1, 2, a1[9]);
    return 0;
  }
  LOBYTE(v9) = sub_4F3180((int)a1, a2);
  if ( !v9 )
  {
    sub_4DA2C0((int)a1, (const char *)&byte_587000[279280], 0);
    if ( a4 )
      sub_501960(925, (int)a1, 2, a1[9]);
    return 0;
  }
  if ( v8 )
    sub_53E430(a1, (int)v8, 1, 1);
  v10 = *(_DWORD *)(a2 + 16);
  BYTE1(v10) |= 1u;
  *(_DWORD *)(a2 + 16) = v10;
  v11 = *(_DWORD **)(v7 + 276);
  *v11 |= sub_415C70(a2);
  sub_4D8540(*(unsigned __int8 *)(*(_DWORD *)(v7 + 276) + 2064), (_DWORD *)a2, a3);
  if ( !sub_53E2D0(a2) )
    *(_DWORD *)(a2 + 16) |= 0x10000000u;
  sub_53E300(a1);
  sub_4F2FF0(a2, (int)a1);
  if ( *(_BYTE *)(a2 + 12) & 2 )
    sub_53E600(a1);
  return 1;
}
// 53E6E7: variable 'v9' is possibly undefined

//----- (0053E7B0) --------------------------------------------------------
_DWORD *__cdecl sub_53E7B0(int a1, int a2)
{
  _DWORD *result; // eax

  result = *(_DWORD **)(a1 + 504);
  if ( !result )
    return 0;
  while ( !(result[4] & 0x100) || !(result[2] & 0x2000000) || result[3] != *(_DWORD *)(a2 + 12) )
  {
    result = (_DWORD *)result[124];
    if ( !result )
      return 0;
  }
  return result;
}

//----- (0053E7F0) --------------------------------------------------------
int __cdecl sub_53E7F0(int a1, int a2, int a3, int a4)
{
  _DWORD *v5; // eax
  int v6; // ebp
  _DWORD *v7; // esi
  int v8; // eax
  _DWORD *v9; // ecx
  int i; // eax
  int v11; // eax
  _DWORD *v12; // ecx
  int v13; // eax
  int m; // eax
  __int16 v15; // ax
  int v16; // eax
  int j; // eax
  _DWORD *v18; // ecx
  int k; // eax
  int l; // eax

  if ( !*(_DWORD *)&byte_5D4594[2488712] )
  {
    *(_DWORD *)&byte_5D4594[2488712] = sub_4E3AA0((CHAR *)&byte_587000[279312]);
    *(_DWORD *)&byte_5D4594[2488716] = sub_4E3AA0((CHAR *)&byte_587000[279328]);
    *(_DWORD *)&byte_5D4594[2488720] = sub_4E3AA0((CHAR *)&byte_587000[279340]);
    *(_DWORD *)&byte_5D4594[2488724] = sub_4E3AA0((CHAR *)&byte_587000[279356]);
  }
  if ( !sub_40A5C0(2048) && !sub_40A5C0(4096) && sub_409F40(2) && sub_4E7EC0(a1, a2) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[279368], 0);
LABEL_13:
    sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
    return 0;
  }
  if ( !sub_40A5C0(2048)
    && !sub_40A5C0(4096)
    && *(_BYTE *)(a1 + 8) & 4
    && !sub_57B3D0(a2, *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2251)) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[279404], 0);
    goto LABEL_13;
  }
  if ( sub_4F31E0(a1, a2, a3) != 1 )
    return 0;
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v5 = sub_53E7B0(a1, a2);
    v6 = *(_DWORD *)(a1 + 748);
    v7 = v5;
    v8 = sub_419E60(a1);
    if ( !v8 )
    {
      if ( v7 )
      {
        LOWORD(v8) = *((_WORD *)v7 + 2);
        if ( v8 != *(_DWORD *)&byte_5D4594[2488720]
          && v8 != *(_DWORD *)&byte_5D4594[2488724]
          && v8 != *(_DWORD *)&byte_5D4594[2488712]
          && v8 != *(_DWORD *)&byte_5D4594[2488716] )
        {
          goto LABEL_40;
        }
        if ( v8 == *(_DWORD *)&byte_5D4594[2488716] )
        {
          v9 = (_DWORD *)v7[173];
          for ( i = 0; i < 4; ++i )
          {
            if ( *v9 )
              break;
            ++v9;
          }
          if ( i == 4 )
            sub_53E650((_DWORD *)a1, a2, a4, 0);
          goto LABEL_40;
        }
      }
      if ( !(*(_BYTE *)(a2 + 12) & 2) )
        goto LABEL_70;
      if ( !v7 )
      {
        v11 = *(_DWORD *)(v6 + 104);
        if ( !v11 || !(*(_DWORD *)(v11 + 12) & 0x7FFE40C) )
          sub_53E650((_DWORD *)a1, a2, a4, 0);
        goto LABEL_40;
      }
      v12 = (_DWORD *)v7[173];
      v13 = *((unsigned __int16 *)v7 + 2);
      if ( (unsigned __int16)v13 != *(_DWORD *)&byte_5D4594[2488720] )
      {
        if ( v13 == *(_DWORD *)&byte_5D4594[2488724] )
        {
          v16 = *(unsigned __int16 *)(a2 + 4);
          if ( (unsigned __int16)v16 == *(_DWORD *)&byte_5D4594[2488720] )
          {
            for ( j = 0; j < 4; ++j )
            {
              if ( *v12 )
                break;
              ++v12;
            }
            if ( j == 4 )
            {
              v18 = *(_DWORD **)(a2 + 692);
              for ( k = 0; k < 4; ++k )
              {
                if ( *v18 )
                  break;
                ++v18;
              }
              if ( k != 4 )
                sub_53E650((_DWORD *)a1, a2, a4, 0);
            }
          }
          else if ( v16 == *(_DWORD *)&byte_5D4594[2488724] )
          {
            for ( l = 0; l < 4; ++l )
            {
              if ( *v12 )
                break;
              ++v12;
            }
            if ( l == 4 )
              sub_53E650((_DWORD *)a1, a2, a4, 0);
          }
        }
        goto LABEL_40;
      }
      for ( m = 0; m < 4; ++m )
      {
        if ( *v12 )
          break;
        ++v12;
      }
      if ( m == 4 )
LABEL_70:
        sub_53E650((_DWORD *)a1, a2, a4, 0);
    }
  }
LABEL_40:
  v15 = *(_WORD *)(a2 + 24);
  if ( v15 & 0x10 )
  {
    sub_501960(804, a1, 0, 0);
  }
  else if ( v15 & 8 )
  {
    sub_501960(810, a1, 0, 0);
  }
  else if ( v15 & 4 )
  {
    sub_501960(807, a1, 0, 0);
  }
  else if ( v15 & 2 )
  {
    if ( *(_BYTE *)(a2 + 12) & 0x20 )
      sub_501960(816, a1, 0, 0);
    else
      sub_501960(813, a1, 0, 0);
  }
  sub_5116F0(a2);
  return 1;
}

//----- (0053EAE0) --------------------------------------------------------
_DWORD *__cdecl sub_53EAE0(int a1)
{
  _DWORD *result; // eax
  __int16 v2; // cx

  result = (_DWORD *)a1;
  if ( a1 )
  {
    v2 = *(_WORD *)(a1 + 24);
    if ( v2 & 0x10 )
    {
      result = sub_501960(805, a1, 0, 0);
    }
    else if ( v2 & 8 )
    {
      result = sub_501960(811, a1, 0, 0);
    }
    else if ( v2 & 4 )
    {
      result = sub_501960(808, a1, 0, 0);
    }
    else if ( v2 & 2 )
    {
      if ( *(_BYTE *)(a1 + 12) & 0x20 )
        result = sub_501960(817, a1, 0, 0);
      else
        result = sub_501960(814, a1, 0, 0);
    }
  }
  return result;
}

//----- (0053EB70) --------------------------------------------------------
int __cdecl sub_53EB70(int a1, _DWORD *a2, int *a3)
{
  if ( sub_4ED290(a1, (int)a2, (float2 *)a3) != 1 )
    return 0;
  sub_53EAE0((int)a2);
  if ( !sub_40A5C0(2048) && !sub_40A5C0(4096) )
  {
    if ( sub_409F40(2) )
      sub_511660(a2, 25 * *(_DWORD *)&byte_5D4594[2649704]);
  }
  return 1;
}

//----- (0053EBF0) --------------------------------------------------------
int __cdecl sub_53EBF0(int a1)
{
  unsigned __int8 *i; // eax
  int v2; // edx

  if ( !a1 )
    return 0;
  if ( !*(_DWORD *)&byte_5D4594[2488728] )
    sub_53EC40();
  if ( !*(_DWORD *)&byte_587000[279432] )
    return 0;
  for ( i = &byte_587000[279432]; *((_DWORD *)i + 1) != *(unsigned __int16 *)(a1 + 4); i += 12 )
  {
    v2 = *((_DWORD *)i + 3);
    if ( !v2 )
      return 0;
  }
  return 1;
}

//----- (0053EC40) --------------------------------------------------------
CHAR *sub_53EC40()
{
  CHAR *result; // eax
  unsigned __int8 *v1; // esi

  result = *(CHAR **)&byte_587000[279432];
  if ( *(_DWORD *)&byte_587000[279432] )
  {
    v1 = &byte_587000[279432];
    do
    {
      *((_DWORD *)v1 + 1) = sub_4E3AA0(result);
      result = (CHAR *)*((_DWORD *)v1 + 3);
      v1 += 12;
    }
    while ( result );
    *(_DWORD *)&byte_5D4594[2488728] = 1;
  }
  else
  {
    *(_DWORD *)&byte_5D4594[2488728] = 1;
  }
  return result;
}

//----- (0053EC80) --------------------------------------------------------
BOOL __cdecl sub_53EC80(int a1, int a2)
{
  int v2; // edx
  unsigned __int8 *i; // eax
  int v4; // esi

  if ( !a1 )
    return 0;
  if ( !*(_DWORD *)&byte_5D4594[2488728] )
    sub_53EC40();
  v2 = 0;
  if ( !*(_DWORD *)&byte_587000[279432] )
    return 0;
  for ( i = &byte_587000[279432]; *((_DWORD *)i + 1) != *(unsigned __int16 *)(a1 + 4); i += 12 )
  {
    v4 = *((_DWORD *)i + 3);
    ++v2;
    if ( !v4 )
      return 0;
  }
  return (a2 & *(_DWORD *)&byte_587000[12 * v2 + 279440]) != 0;
}

//----- (0053ECE0) --------------------------------------------------------
int __cdecl sub_53ECE0(int a1, int a2)
{
  int v2; // eax

  if ( *(_BYTE *)(a1 + 540) )
  {
    sub_4EE9D0(a1);
    sub_4DA2C0(a1, (const char *)&byte_587000[280008], 0);
    v2 = sub_424800(14, 1);
    sub_501960(v2, a1, 0, 0);
  }
  else
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280028], 0);
  }
  sub_4FF380(a1, 3, 300, 5);
  sub_4E5CC0(a2);
  return 1;
}

//----- (0053ED60) --------------------------------------------------------
int __cdecl sub_53ED60(int a1, int a2)
{
  sub_4FF380(a1, **(_DWORD **)(a2 + 736), *(_DWORD *)(*(_DWORD *)(a2 + 736) + 4), 5);
  sub_4E5CC0(a2);
  return 1;
}

//----- (0053ED90) --------------------------------------------------------
int __cdecl sub_53ED90(int a1, _DWORD *a2)
{
  int *v2; // ecx
  int v3; // eax
  int v4; // eax
  int v6[3]; // [esp+4h] [ebp-Ch]

  v6[0] = a1;
  v2 = (int *)a2[184];
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a1 + 748);
    *(float *)&v6[1] = (double)*(int *)(*(_DWORD *)(v3 + 276) + 2284);
    *(float *)&v6[2] = (double)*(int *)(*(_DWORD *)(v3 + 276) + 2288);
  }
  else
  {
    v4 = *(_DWORD *)(a1 + 60);
    v6[1] = *(_DWORD *)(a1 + 56);
    v6[2] = v4;
  }
  sub_4FD400(*v2, (int)a2, a2, (int)a2, v6, 4);
  sub_4E5CC0((int)a2);
  return 1;
}

//----- (0053EE10) --------------------------------------------------------
int __cdecl sub_53EE10(int a1, int a2)
{
  _WORD *v2; // eax
  int v3; // eax

  if ( *(_BYTE *)(a2 + 8) & 0x10 )
  {
    if ( !(*(_BYTE *)(a2 + 12) & 8) )
    {
      v2 = *(_WORD **)(a1 + 556);
      if ( v2 )
      {
        if ( *v2 < v2[2] )
        {
          sub_4EE460(a1, **(_DWORD **)(a2 + 736));
          if ( *(_BYTE *)(a1 + 8) & 4 )
          {
            v3 = *(_DWORD *)(a2 + 12);
            if ( *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2252) )
            {
              if ( v3 & 1 )
              {
                sub_501960(324, a1, 0, 0);
              }
              else if ( v3 & 2 )
              {
                sub_501960(325, a1, 0, 0);
              }
              else if ( v3 & 4 )
              {
                sub_501960(326, a1, 0, 0);
              }
            }
            else if ( v3 & 1 )
            {
              sub_501960(314, a1, 0, 0);
            }
            else if ( v3 & 2 )
            {
              sub_501960(315, a1, 0, 0);
            }
            else if ( v3 & 4 )
            {
              sub_501960(316, a1, 0, 0);
            }
          }
          else
          {
            sub_501960(334, a1, 0, 0);
          }
          sub_4E5CC0(a2);
        }
      }
    }
  }
  return 1;
}

//----- (0053EF00) --------------------------------------------------------
int __cdecl sub_53EF00(int a1, int a2)
{
  int v2; // esi

  if ( !a1 || !a2 || !*(_DWORD *)(a1 + 556) )
    return 1;
  sub_4FF380(a1, 3, 5 * *(_WORD *)&byte_5D4594[2649704], 4);
  sub_4DA2C0(a1, (const char *)&byte_587000[280052], 0);
  v2 = sub_53EE10(a1, a2);
  if ( v2 )
    sub_4E5CC0(a2);
  return v2;
}

//----- (0053EF70) --------------------------------------------------------
int __cdecl sub_53EF70(int a1, int a2)
{
  int v2; // ebp
  int v3; // edi
  int result; // eax
  int v5; // edx
  _WORD *v6; // edx
  char v7; // al
  double v8; // st7
  int v9; // ecx
  char v10; // al
  double v11; // st7
  int v12; // eax
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx
  int v16; // eax
  int v17; // ecx
  int v18; // ecx
  int v19; // ecx
  int v20; // ecx
  int v21; // ecx
  int v22; // ecx
  float v23; // [esp+0h] [ebp-20h]
  float v24; // [esp+0h] [ebp-20h]
  int v25; // [esp+10h] [ebp-10h]
  int v26[3]; // [esp+14h] [ebp-Ch]

  v2 = a2;
  v3 = **(_DWORD **)(a2 + 736);
  result = 0;
  v25 = **(_DWORD **)(a2 + 736);
  if ( !(*(_DWORD *)(a1 + 8) & 4) || (v5 = *(_DWORD *)(a1 + 16), (v5 & 0x8000) == 0) )
  {
    if ( !(*(_BYTE *)(a2 + 12) & 0x10) || (v6 = *(_WORD **)(a1 + 556)) == 0 )
    {
LABEL_16:
      if ( !(*(_BYTE *)(v2 + 12) & 0x20)
        || !(*(_BYTE *)(a1 + 8) & 4)
        || (v9 = *(_DWORD *)(a1 + 748), *(_WORD *)(v9 + 4) >= *(_WORD *)(v9 + 8)) )
      {
LABEL_27:
        if ( *(_BYTE *)(v2 + 12) & 0x40 && *(_BYTE *)(a1 + 8) & 4 && *(_BYTE *)(a1 + 540) )
        {
          sub_4EE9D0(a1);
          v12 = sub_424800(14, 1);
          sub_501960(v12, a1, 0, 0);
          result = 1;
        }
        v13 = *(_DWORD *)(v2 + 12);
        if ( v13 & 0x100 )
        {
          sub_4FF380(a1, 9, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v14 = *(_DWORD *)(v2 + 12);
        if ( v14 & 0x200 )
        {
          sub_4FF380(a1, 0, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v15 = *(_DWORD *)(v2 + 12);
        if ( v15 & 0x400 )
        {
          v16 = *(_DWORD *)(a1 + 56);
          v17 = *(_DWORD *)(a1 + 60);
          v26[0] = a1;
          v26[1] = v16;
          v26[2] = v17;
          sub_4FD400(51, a1, (_DWORD *)a1, a1, v26, v3);
          result = 1;
        }
        v18 = *(_DWORD *)(v2 + 12);
        if ( v18 & 0x800 )
        {
          sub_4FF380(a1, 17, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v19 = *(_DWORD *)(v2 + 12);
        if ( v19 & 0x1000 )
        {
          sub_4FF380(a1, 20, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v20 = *(_DWORD *)(v2 + 12);
        if ( v20 & 0x2000 )
        {
          sub_4FF380(a1, 18, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v21 = *(_DWORD *)(v2 + 12);
        if ( v21 & 0x4000 )
        {
          sub_4FF380(a1, 23, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        v22 = *(_DWORD *)(v2 + 12);
        if ( (v22 & 0x8000) != 0 )
        {
          sub_4FF380(a1, 21, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
          result = 1;
        }
        if ( *(_DWORD *)(v2 + 12) & 0x10000 )
        {
          sub_4FF380(a1, 13, 120 * *(_WORD *)&byte_5D4594[2649704], 3);
        }
        else if ( !result )
        {
          return 1;
        }
        sub_4E5CC0(v2);
        return 1;
      }
      v10 = *(_BYTE *)(*(_DWORD *)(v9 + 276) + 2251);
      if ( v10 )
      {
        if ( v10 == 1 )
        {
          v11 = (double)v25 * *(float *)&byte_587000[312820];
        }
        else
        {
          if ( v10 != 2 )
          {
LABEL_26:
            sub_4EEB80(a1, v3);
            sub_501960(755, a1, 0, 0);
            result = 1;
            goto LABEL_27;
          }
          v11 = (double)v25 * *(float *)&byte_587000[312804];
        }
      }
      else
      {
        v11 = (double)v25 * *(float *)&byte_587000[312788];
      }
      v24 = v11;
      v3 = sub_419A70(v24);
      goto LABEL_26;
    }
    if ( *v6 >= v6[2] )
    {
LABEL_15:
      v2 = a2;
      goto LABEL_16;
    }
    if ( *(_DWORD *)(a1 + 8) & 4 )
    {
      v7 = *(_BYTE *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2251);
      switch ( v7 )
      {
        case 0:
          v8 = (double)v25 * *(float *)&byte_587000[312784];
LABEL_13:
          v23 = v8;
          v3 = sub_419A70(v23);
          v25 = v3;
          break;
        case 1:
          v8 = (double)v25 * *(float *)&byte_587000[312816];
          goto LABEL_13;
        case 2:
          v8 = (double)v25 * *(float *)&byte_587000[312800];
          goto LABEL_13;
      }
    }
    sub_4EE460(a1, v3);
    sub_501960(754, a1, 0, 0);
    result = 1;
    goto LABEL_15;
  }
  return result;
}

//----- (0053F290) --------------------------------------------------------
int __cdecl sub_53F290(int a1, _DWORD *a2)
{
  int v2; // esi
  int result; // eax
  double v4; // st7
  int v5; // eax
  double v6; // st6
  float v7; // edx
  double v8; // st7
  int v9; // eax
  _DWORD *v10; // eax
  int v11; // ebx
  unsigned __int8 v12; // al
  float4 v13; // [esp+Ch] [ebp-10h]

  v2 = a2[184];
  if ( !v2 )
    return 1;
  if ( !*(_DWORD *)(v2 + 84) )
    *(_DWORD *)(v2 + 84) = sub_4E3AA0((CHAR *)(v2 + 4));
  if ( !*(_BYTE *)(v2 + 109) || *(_BYTE *)(v2 + 108) )
  {
    if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v2 + 104) >= (unsigned int)(*(_DWORD *)(v2 + 100)
                                                                                  - sub_4E0960((int)a2)) )
    {
      v4 = *(float *)(a1 + 176) + 4.0;
      v5 = 8 * *(__int16 *)(a1 + 124);
      v6 = v4 * *(float *)&byte_587000[v5 + 194136];
      v7 = *(float *)(a1 + 60);
      v13.field_0 = *(float *)(a1 + 56);
      v13.field_4 = v7;
      v13.field_8 = v6 + *(float *)(a1 + 56);
      v8 = v4 * *(float *)&byte_587000[v5 + 194140] + *(float *)(a1 + 60);
      v13.field_8 = v13.field_8 + *(float *)(a1 + 80);
      v13.field_C = v8 + *(float *)(a1 + 84);
      if ( !sub_535250(&v13, 0, 0, 5) )
      {
        v13.field_8 = v13.field_0;
        v13.field_C = v13.field_4;
      }
      sub_53F480(a1, *(_DWORD *)(v2 + 84), (int *)&v13.field_8, (_DWORD *)*(__int16 *)(a1 + 124));
      if ( *(_BYTE *)(v2 + 96) & 1 )
      {
        v9 = *(__int16 *)(a1 + 124) + 8;
        if ( v9 >= 256 )
          v9 += -256 * ((unsigned int)v9 >> 8);
        sub_53F480(a1, *(_DWORD *)(v2 + 84), (int *)&v13.field_8, (_DWORD *)v9);
        v10 = (_DWORD *)(*(__int16 *)(a1 + 124) - 8);
        if ( (int)v10 < 0 )
          v10 += 64 * ((unsigned int)(255 - (_DWORD)v10) >> 8);
        sub_53F480(a1, *(_DWORD *)(v2 + 84), (int *)&v13.field_8, v10);
      }
      sub_501960(*(_DWORD *)(v2 + 88), a1, 0, 0);
      if ( *(_BYTE *)(v2 + 109) )
      {
        v11 = *(unsigned __int8 *)(v2 + 109);
        v12 = *(_BYTE *)(v2 + 108) - 1;
        *(_BYTE *)(v2 + 108) = v12;
        *(_DWORD *)(v2 + 112) = 100 * v12 / v11;
        if ( *(_BYTE *)(a1 + 8) & 4 )
          sub_4D82B0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064), a2, v12, v11);
      }
      *(_DWORD *)(v2 + 104) = *(_DWORD *)&byte_5D4594[2598000];
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    sub_501960(222, a1, 0, 0);
    result = 0;
  }
  return result;
}

//----- (0053F480) --------------------------------------------------------
_DWORD *__cdecl sub_53F480(int a1, int a2, int *a3, _DWORD *a4)
{
  _DWORD *result; // eax
  _DWORD *v5; // esi

  result = sub_4E3450(a2);
  v5 = result;
  if ( result )
  {
    sub_4DAA50((int)result, a1, *(float *)a3, *((float *)a3 + 1));
    result = a4;
    *((_WORD *)v5 + 62) = (_WORD)a4;
    *((_WORD *)v5 + 63) = (_WORD)a4;
    *((float *)v5 + 20) = *(float *)&byte_587000[8 * (_DWORD)a4 + 194136] * *((float *)v5 + 136);
    *((float *)v5 + 21) = *(float *)&byte_587000[8 * (_DWORD)a4 + 194140] * *((float *)v5 + 136);
    *((float *)v5 + 20) = *(float *)(a1 + 80) + *((float *)v5 + 20);
    *((float *)v5 + 21) = *(float *)(a1 + 84) + *((float *)v5 + 21);
  }
  return result;
}

//----- (0053F4F0) --------------------------------------------------------
int __cdecl sub_53F4F0(int a1, _DWORD *a2)
{
  int v2; // esi
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  int v7; // eax
  int v8; // eax
  unsigned __int8 v9; // al
  unsigned __int8 v10; // cl
  int v11[3]; // [esp+Ch] [ebp-Ch]

  v2 = a2[184];
  if ( !*(_DWORD *)&byte_5D4594[2488732] )
    *(_DWORD *)&byte_5D4594[2488732] = sub_4E3AA0((CHAR *)&byte_587000[280072]);
  if ( *(_BYTE *)(v2 + 109) && !*(_BYTE *)(v2 + 108) )
  {
    sub_501960(222, a1, 0, 0);
    return 0;
  }
  if ( *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v2 + 104) < (unsigned int)(*(_DWORD *)(v2 + 100)
                                                                               - 2 * sub_4E0960((int)a2)) )
    return 0;
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v4 = *(_DWORD *)(a1 + 748);
    *(float *)&v11[1] = (double)*(int *)(*(_DWORD *)(v4 + 276) + 2284);
    *(float *)&v11[2] = (double)*(int *)(*(_DWORD *)(v4 + 276) + 2288);
    v5 = *(_DWORD *)(v4 + 288);
    if ( v5 )
    {
      v11[0] = v5;
      goto LABEL_13;
    }
  }
  else
  {
    v6 = *(_DWORD *)(a1 + 60);
    v11[1] = *(_DWORD *)(a1 + 56);
    v11[2] = v6;
  }
  v11[0] = a1;
LABEL_13:
  v7 = *(_DWORD *)(v2 + 92);
  *(_DWORD *)(v2 + 96) |= 4u;
  if ( sub_4FD400(v7, a1, (_DWORD *)a1, a1, v11, 4) )
  {
    *(_DWORD *)(v2 + 104) = *(_DWORD *)&byte_5D4594[2598000];
    v8 = a2[2];
    if ( !(v8 & 0x1000) || !(a2[3] & 0x4040000) )
    {
      v9 = *(_BYTE *)(v2 + 109);
      if ( v9 )
      {
        v10 = *(_BYTE *)(v2 + 108) - 1;
        *(_BYTE *)(v2 + 108) = v10;
        *(_DWORD *)(v2 + 112) = 100 * v10 / v9;
        if ( *(_BYTE *)(a1 + 8) & 4 )
          sub_4D82B0(*(unsigned __int8 *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 2064), a2, v10, v9);
      }
    }
  }
  return 1;
}

//----- (0053F670) --------------------------------------------------------
int __cdecl sub_53F670(int a1, int a2)
{
  int v2; // esi
  int v3; // eax
  double v4; // st7
  float v6; // [esp+0h] [ebp-38h]
  float v7; // [esp+4h] [ebp-34h]
  float v8; // [esp+28h] [ebp-10h]
  float v9; // [esp+2Ch] [ebp-Ch]
  float v10; // [esp+30h] [ebp-8h]
  float v11; // [esp+34h] [ebp-4h]
  float v12; // [esp+3Ch] [ebp+4h]
  float v13; // [esp+3Ch] [ebp+4h]

  v2 = a1;
  v8 = 0.0;
  v3 = 8 * *(__int16 *)(a1 + 124);
  v11 = *(float *)&byte_587000[v3 + 194136] * *(float *)(a1 + 176) * 1.5;
  v10 = *(float *)&byte_587000[v3 + 194140] * *(float *)(a1 + 176) * 1.5;
  do
  {
    v12 = sub_416030(12.0, 25.0);
    v9 = sub_416030(-2.0, 2.0) + v12 * *(float *)&byte_587000[8 * *(__int16 *)(v2 + 124) + 194136];
    v13 = sub_416030(-2.0, 2.0) + v12 * *(float *)&byte_587000[8 * *(__int16 *)(v2 + 124) + 194140];
    v7 = v10 + *(float *)(v2 + 60);
    v6 = v11 + *(float *)(v2 + 56);
    sub_54FD80(v6, v7, 1, 20, v9, v13, 0.0, 0);
    v4 = v8 + 1.0;
    v8 = v4;
  }
  while ( v4 < 1.0 );
  if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(a2 + 136)) > *(int *)&byte_5D4594[2649704] )
  {
    sub_501960(9, v2, 0, 0);
    *(_DWORD *)(a2 + 136) = *(_DWORD *)&byte_5D4594[2598000];
  }
  return 0;
}

//----- (0053F7C0) --------------------------------------------------------
int __cdecl sub_53F7C0(int a1, int a2)
{
  int v2; // esi
  int v3; // ecx

  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v2 = *(_DWORD *)(a2 + 736);
    v3 = *(_DWORD *)(v2 + 256);
    if ( (*(_DWORD *)&byte_5D4594[2598000] - v3 > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) || !v3)
      && sub_537110(a1, a2) == 1 )
    {
      sub_4DA2C0(a1, (const char *)v2, 1);
      *(_DWORD *)(v2 + 256) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
  return 1;
}

//----- (0053F830) --------------------------------------------------------
int __cdecl sub_53F830(int a1, int a2)
{
  int v2; // esi
  int v3; // ebx
  int v4; // edi
  int v5; // ecx
  int v6; // eax
  int v7; // eax
  int v8; // edx

  v2 = a1;
  if ( *(_BYTE *)(a1 + 8) & 4 )
  {
    v3 = *(_DWORD *)(a1 + 748);
    v4 = *(_DWORD *)(a2 + 736);
    v5 = *(_DWORD *)(v4 + 256);
    if ( (*(_DWORD *)&byte_5D4594[2598000] - v5 > (unsigned int)(3 * *(_DWORD *)&byte_5D4594[2649704]) || !v5)
      && sub_537110(a1, a2) == 1 )
    {
      if ( sub_4D75E0() )
      {
        v6 = sub_4E3CC0();
        v7 = sub_4D74F0(v6);
        v8 = *(_DWORD *)(v3 + 276);
        a1 = v7;
        sub_4DA0F0(*(unsigned __int8 *)(v8 + 2064), 21, &a1);
      }
      else
      {
        sub_4DA2C0(v2, (const char *)&byte_587000[280204], 1);
      }
      *(_DWORD *)(v4 + 256) = *(_DWORD *)&byte_5D4594[2598000];
    }
  }
  return 1;
}

//----- (0053F8E0) --------------------------------------------------------
int __cdecl sub_53F8E0(int a1, int a2)
{
  int result; // eax

  if ( !a2 )
    return 1;
  if ( !*(_DWORD *)(a2 + 732) )
    return 1;
  result = sub_419E60(a1);
  if ( result != 1 )
    result = (*(int (__cdecl **)(int, int))(a2 + 732))(a1, a2);
  return result;
}

//----- (0053F930) --------------------------------------------------------
int __cdecl sub_53F930(int a1, int a2)
{
  int v2; // ebx
  int v3; // esi
  int result; // eax

  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v2 = *(_DWORD *)(a1 + 748);
  v3 = sub_427010(*(const char **)(a2 + 736));
  if ( sub_40A5C0(4096) && *(_BYTE *)(*(_DWORD *)(v2 + 276) + 2251) != 2 )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280228], 0);
    return 0;
  }
  if ( *(_DWORD *)(*(_DWORD *)(v2 + 276) + 4 * v3 + 4244) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280260], 0);
    result = 0;
  }
  else
  {
    sub_4FAE80(a1, v3, 1);
    sub_4E5CC0(a2);
    result = 1;
  }
  return result;
}

//----- (0053F9E0) --------------------------------------------------------
int __cdecl sub_53F9E0(int a1, int a2)
{
  unsigned __int8 *v2; // ebx
  int v3; // ebp
  int v4; // edi
  int v5; // ecx
  char v6; // al

  v2 = *(unsigned __int8 **)(a2 + 736);
  v3 = 0;
  v4 = *(_DWORD *)(a1 + 748);
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  v5 = *(_DWORD *)(v4 + 276);
  v6 = *(_BYTE *)(v5 + 2251);
  if ( v6 != 1 && v6 != 2 )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280288], 0);
LABEL_7:
    sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
    return 0;
  }
  if ( sub_57AEA0(*(unsigned __int8 *)(v5 + 2251), *v2) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280316], 0);
    goto LABEL_7;
  }
  if ( sub_40A5C0(6144) && !*(_DWORD *)(*(_DWORD *)(v4 + 276) + 4 * *v2 + 3696) )
    v3 = 1;
  if ( sub_4FB550(a1, *v2, 1, v3, 0) )
    sub_4E5CC0(a2);
  else
    sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
  return 1;
}

//----- (0053FAE0) --------------------------------------------------------
int __cdecl sub_53FAE0(int a1, int a2)
{
  unsigned __int8 *v2; // ebx
  int v3; // ebp
  int v4; // edi
  int result; // eax

  v2 = *(unsigned __int8 **)(a2 + 736);
  v3 = 0;
  v4 = *(_DWORD *)(a1 + 748);
  if ( !(*(_BYTE *)(a1 + 8) & 4) )
    return 0;
  if ( *(_BYTE *)(*(_DWORD *)(v4 + 276) + 2251) )
  {
    sub_4DA2C0(a1, (const char *)&byte_587000[280344], 0);
    sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
    result = 0;
  }
  else
  {
    if ( sub_40A5C0(6144) && !*(_DWORD *)(*(_DWORD *)(v4 + 276) + 4 * *v2 + 3696) )
      v3 = 1;
    if ( sub_4FB9C0(a1, *v2, v3) )
      sub_4E5CC0(a2);
    else
      sub_501960(925, a1, 2, *(_DWORD *)(a1 + 36));
    result = 1;
  }
  return result;
}

//----- (0053FBC0) --------------------------------------------------------
_DWORD *__cdecl sub_53FBC0(float *a1, int a2)
{
  int v2; // eax
  int v3; // ebx
  float *v4; // esi
  _DWORD *result; // eax
  _DWORD *v6; // edi
  int v7; // eax
  int v8; // eax
  float v9; // [esp+0h] [ebp-1Ch]
  float v10; // [esp+4h] [ebp-18h]
  int *v11; // [esp+24h] [ebp+8h]

  if ( !*(_DWORD *)&byte_5D4594[2488736] )
    sub_53FCA0();
  v2 = sub_509EA0(a2);
  v3 = 0;
  v4 = (float *)&byte_587000[88 * v2 + 280376];
  v11 = (int *)&byte_5D4594[44 * v2 + 2488740];
  do
  {
    result = sub_4E3450(*v11);
    v6 = result;
    if ( !result )
      break;
    if ( *(_DWORD *)&byte_5D4594[2650652] )
    {
      if ( sub_40A5C0(0x2000) )
      {
        v7 = v6[4];
        LOBYTE(v7) = v7 | 0x40;
        v6[4] = v7;
      }
    }
    v10 = v4[1] + a1[1];
    v9 = *v4 + *a1;
    sub_4DAA50((int)v6, 0, v9, v10);
    v8 = sub_415FA0(10, 20);
    result = (_DWORD *)sub_511660(v6, *(_DWORD *)&byte_5D4594[2649704] * v8);
    ++v3;
    v4 += 2;
    ++v11;
  }
  while ( v3 < 11 );
  return result;
}

//----- (0053FCA0) --------------------------------------------------------
void sub_53FCA0()
{
  int i; // ebx
  unsigned __int8 *v1; // edi
  char v2[32]; // [esp+Ch] [ebp-20h]

  for ( i = 0; i < 9; ++i )
  {
    switch ( i )
    {
      case 0:
        v1 = &byte_587000[281216];
        goto LABEL_11;
      case 1:
        v1 = &byte_587000[281220];
        goto LABEL_11;
      case 2:
        v1 = &byte_587000[281224];
        goto LABEL_11;
      case 3:
        v1 = &byte_587000[281228];
        goto LABEL_11;
      case 5:
        v1 = &byte_587000[281232];
        goto LABEL_11;
      case 6:
        v1 = &byte_587000[281236];
        goto LABEL_11;
      case 7:
        v1 = &byte_587000[281240];
        goto LABEL_11;
      case 8:
        v1 = &byte_587000[281244];
LABEL_11:
        nox_sprintf(v2, (const char *)&byte_587000[281248], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488740] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281264], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488744] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281280], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488748] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281296], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488752] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281320], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488756] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281344], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488760] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281368], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488764] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281392], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488768] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281416], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488772] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281440], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488776] = sub_4E3AA0(v2);
        nox_sprintf(v2, (const char *)&byte_587000[281464], v1);
        *(_DWORD *)&byte_5D4594[44 * i + 2488780] = sub_4E3AA0(v2);
        break;
      default:
        continue;
    }
  }
  *(_DWORD *)&byte_5D4594[2488736] = 1;
}

//----- (0053FEA0) --------------------------------------------------------
void sub_53FEA0()
{
  srand(0x22E0u);
}

//----- (0053FEB0) --------------------------------------------------------
void __cdecl sub_53FEB0(int a1)
{
  int v1; // edi

  v1 = 0;
  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
      v1 = *(_DWORD *)(a1 + 748);
    sub_4FEE90(a1);
    if ( sub_4FF350(a1, 3) )
      *(_WORD *)(a1 + 126) = (unsigned __int8)(*(_BYTE *)(a1 + 124) + 4 * sub_415FA0(-8, 8));
    if ( v1 )
      *(_BYTE *)(v1 + 236) = 0;
    sub_4FA020((_DWORD *)a1, 1);
    sub_4FF5B0(a1, 0);
    sub_4FF5B0(a1, 23);
    sub_4FEB10(67, a1);
    sub_4FC3C0(a1, 1, 1);
  }
}

//----- (0053FF40) --------------------------------------------------------
void __cdecl sub_53FF40(int a1)
{
  int v1; // eax

  if ( a1 )
  {
    if ( *(_BYTE *)(a1 + 8) & 4 )
    {
      v1 = *(_DWORD *)(a1 + 748);
      if ( v1 )
        *(_BYTE *)(v1 + 236) = 0;
    }
    sub_4FA020((_DWORD *)a1, 1);
    sub_4FE680(a1, 300.0);
    sub_517F90((float2 *)(a1 + 56), 300.0, sub_53FFB0, a1);
    sub_4FF5B0(a1, 0);
    sub_4FF5B0(a1, 23);
    sub_4FEB10(67, a1);
    sub_4FC3C0(a1, 2, 1);
  }
}

//----- (0053FFB0) --------------------------------------------------------
int __cdecl sub_53FFB0(_DWORD *a1, _DWORD *a2)
{
  int result; // eax
  int v3; // ecx
  int v4; // edx
  int v5[3]; // [esp+8h] [ebp-Ch]

  result = a1[2];
  if ( result & 6 && !(a1[4] & 0x8020) )
  {
    if ( result & 4 )
    {
      result = a1[187];
      if ( !result )
        return result;
      result = *(_DWORD *)(result + 276);
      if ( !result )
        return result;
      if ( !*(_BYTE *)(result + 2251) )
        return result;
      result = *(_DWORD *)(result + 3680) & 1;
      if ( (_BYTE)result == 1 )
        return result;
    }
    else if ( result & 2 && !(*(_BYTE *)(a1[187] + 1440) & 0x20) )
    {
      return result;
    }
    result = sub_419150((int)(a2 + 12), (int)(a1 + 12));
    if ( !result )
    {
      result = sub_537110((int)a1, (int)a2);
      if ( result )
      {
        v3 = a1[14];
        v4 = a1[15];
        v5[0] = (int)a1;
        v5[1] = v3;
        v5[2] = v4;
        result = sub_4FD400(55, (int)a2, a2, (int)a2, v5, 5);
      }
    }
  }
  return result;
}

//----- (00540070) --------------------------------------------------------
int __cdecl sub_540070(_DWORD *a1)
{
  int result; // eax
  int v2; // edi

  result = sub_4FA020(a1, 32);
  if ( a1 )
  {
    v2 = a1[187];
    result = sub_538890((int)a1);
    if ( v2 )
      *(_DWORD *)(v2 + 140) = 0;
  }
  return result;
}

//----- (005400B0) --------------------------------------------------------
void __cdecl sub_5400B0(_DWORD *a1, __int16 a2)
{
  int v2; // edi

  if ( a1 )
  {
    v2 = a1[187];
    if ( v2 )
    {
      if ( *(_BYTE *)(v2 + 88) == 5 )
        sub_4FA020(a1, 13);
      sub_4FF380((int)a1, 31, a2, *(_DWORD *)(*(_DWORD *)(v2 + 276) + 3712));
      sub_4FC3C0((int)a1, 4, 1);
      sub_5281D0();
    }
  }
}

//----- (00540110) --------------------------------------------------------
void __cdecl sub_540110(int a1, __int16 a2)
{
  if ( a1 )
  {
    sub_4FF380(a1, 21, a2, *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 276) + 3716));
    sub_4FC3C0(a1, 5, 1);
  }
}

//----- (00540150) --------------------------------------------------------
void sub_540150()
{
  srand(0x22E1u);
}

//----- (00540160) --------------------------------------------------------
int __cdecl sub_540160(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // ebp
  int v7; // edi
  int v8; // eax
  int result; // eax
  int v10; // ebx
  int v11; // edi
  float v12; // edx
  double v13; // st7
  double v14; // st6
  double v15; // st6
  float *v16; // esi
  int *v17; // ebx
  double v18; // st7
  int v19; // eax
  int v20; // eax
  int v21; // eax
  int v22; // eax
  float v23; // [esp+0h] [ebp-30h]
  float v24; // [esp+0h] [ebp-30h]
  float v25; // [esp+14h] [ebp-1Ch]
  float2 v26; // [esp+18h] [ebp-18h]
  float4 a1a; // [esp+20h] [ebp-10h]
  int v28; // [esp+40h] [ebp+10h]
  int v29; // [esp+48h] [ebp+18h]

  v6 = a4;
  v25 = *(float *)(a4 + 176) + 4.0;
  if ( !*(_DWORD *)&byte_5D4594[2489136] )
    *(_DWORD *)&byte_5D4594[2489136] = sub_4E3AA0((CHAR *)&byte_587000[281532]);
  v23 = sub_419D70(&byte_587000[281548], a6 - 1);
  v28 = sub_419A70(v23);
  v7 = sub_4E7C80(a3, *(int *)&byte_5D4594[2489136]);
  v24 = sub_419D70(&byte_587000[281568], a6 - 1);
  v8 = sub_419A70(v24);
  if ( v7 + v28 > v8 )
    v28 = v8 - v7;
  if ( v28 )
  {
    v10 = 0;
    v29 = 0;
    if ( v28 > 0 )
    {
      v11 = a3;
      do
      {
        switch ( v10 )
        {
          case 0:
            v11 = *(__int16 *)(v6 + 124);
            break;
          case 1:
            v11 = *(__int16 *)(v6 + 124) - 16;
            break;
          case 2:
            v11 = *(__int16 *)(v6 + 124) + 16;
            break;
          case 3:
            v11 = *(__int16 *)(v6 + 124) - 32;
            break;
          case 4:
            v11 = *(__int16 *)(v6 + 124) + 32;
            break;
          default:
            break;
        }
        if ( v11 < 0 )
          v11 += (unsigned int)(255 - v11) >> 8 << 8;
        if ( v11 >= 256 )
          v11 += -256 * ((unsigned int)v11 >> 8);
        v12 = *(float *)(v6 + 60);
        v13 = v25 * *(float *)&byte_587000[8 * v11 + 194136] + *(float *)(v6 + 56);
        v14 = v25 * *(float *)&byte_587000[8 * v11 + 194140];
        a1a.field_0 = *(float *)(v6 + 56);
        v15 = v14 + *(float *)(v6 + 60);
        a1a.field_4 = v12;
        a1a.field_C = v15;
        a1a.field_8 = v13 + *(float *)(v6 + 80);
        a1a.field_C = a1a.field_C + *(float *)(v6 + 84);
        if ( sub_535250(&a1a, 0, 0, 5) )
        {
          v16 = (float *)sub_4E3810((CHAR *)&byte_587000[281616]);
          if ( v16 )
          {
            v17 = (int *)*((_DWORD *)v16 + 187);
            sub_4DAA50((int)v16, a3, a1a.field_8, a1a.field_C);
            v18 = sub_416030(0.80000001, 1.2) * v16[136];
            v16[136] = v18;
            v19 = 8 * (__int16)v11;
            *((_WORD *)v16 + 63) = v11;
            *((_WORD *)v16 + 62) = v11;
            v16[20] = v18 * *(float *)&byte_587000[v19 + 194136] * 0.1;
            v16[21] = v18 * *(float *)&byte_587000[v19 + 194140] * 0.1;
            v16[20] = v16[20] + *(float *)(v6 + 80);
            v16[21] = v16[21] + *(float *)(v6 + 84);
            if ( *(_BYTE *)(v6 + 8) & 4 )
            {
              v20 = *(_DWORD *)(v6 + 748);
              v26.field_0 = (double)*(int *)(*(_DWORD *)(v20 + 276) + 2284);
              v26.field_4 = (double)*(int *)(*(_DWORD *)(v20 + 276) + 2288);
              v21 = sub_540610(&v26, (int)v16, 32, 600.0, 0, a3);
            }
            else
            {
              v21 = sub_540610(0, (int)v16, 32, 600.0, 0, a3);
            }
            v17[1] = v21;
            v17[3] = a1;
            *v17 = a3;
            v10 = v29;
          }
        }
        v29 = ++v10;
      }
      while ( v10 < v28 );
    }
    v22 = sub_424800(a1, 0);
    sub_501960(v22, v6, 0, 0);
    result = 1;
  }
  else
  {
    sub_4DA2C0(a3, (const char *)&byte_587000[281588], 0);
    result = 0;
  }
  return result;
}

//----- (00540440) --------------------------------------------------------
int __cdecl sub_540440(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v6; // ebx
  int v7; // eax
  int v8; // esi
  int v9; // eax
  int v10; // ebp
  float v11; // eax
  double v12; // st7
  _DWORD *v13; // esi
  int *v14; // edi
  int v15; // eax
  float4 v17; // [esp+Ch] [ebp-10h]
  float v18; // [esp+2Ch] [ebp+10h]
  int v19; // [esp+34h] [ebp+18h]

  v6 = a4;
  v7 = *(_DWORD *)&byte_5D4594[2489140];
  v18 = *(float *)(a4 + 176) + 4.0;
  if ( !*(_DWORD *)&byte_5D4594[2489140] )
  {
    v7 = sub_4E3AA0((CHAR *)&byte_587000[281680]);
    *(_DWORD *)&byte_5D4594[2489140] = v7;
  }
  v8 = sub_4E7C80(a3, v7);
  if ( v8 < (int)(__int64)sub_419D70(&byte_587000[281688], a6 - 1) )
  {
    v9 = (unsigned __int64)(__int64)sub_419D70(&byte_587000[281700], a6 - 1) - v8;
    if ( v9 > 0 )
    {
      v19 = v9;
      do
      {
        v10 = sub_415FA0(0, 255);
        v11 = *(float *)(v6 + 60);
        v12 = v18 * *(float *)&byte_587000[8 * v10 + 194136] + *(float *)(v6 + 56);
        v17.field_0 = *(float *)(v6 + 56);
        v17.field_4 = v11;
        v17.field_8 = v12;
        v17.field_C = v18 * *(float *)&byte_587000[8 * v10 + 194140] + *(float *)(v6 + 60);
        if ( sub_535250(&v17, 0, 0, 5) )
        {
          v13 = sub_4E3810((CHAR *)&byte_587000[281760]);
          if ( v13 )
          {
            v14 = (int *)v13[187];
            sub_4DAA50((int)v13, a3, v17.field_8, v17.field_C);
            *((_WORD *)v13 + 63) = v10;
            *((_WORD *)v13 + 62) = v10;
            v13[20] = 0;
            v13[21] = 0;
            v14[1] = sub_540610(0, (int)v13, 32, 600.0, 0, a3);
            *v14 = a3;
            v14[3] = a1;
            v13[39] = *(_DWORD *)(v6 + 56);
            v13[40] = *(_DWORD *)(v6 + 60);
            v14[5] = *(_DWORD *)&byte_5D4594[2598000] + *(_DWORD *)&byte_5D4594[2649704] * sub_415FA0(30, 90);
            v14[6] = *(_DWORD *)&byte_5D4594[2598000];
          }
        }
        --v19;
      }
      while ( v19 );
    }
    v15 = sub_424800(a1, 0);
    sub_501960(v15, v6, 0, 0);
  }
  return 1;
}

//----- (00540610) --------------------------------------------------------
int __cdecl sub_540610(float2 *a1, int a2, int a3, float a4, int a5, int a6)
{
  int v6; // ecx
  int v7; // esi
  float v9; // edx
  float v10; // ecx
  float v11; // edx
  float v12; // edx
  int v13; // ecx
  float v14; // eax
  float4 v15; // [esp+10h] [ebp-38h]
  float4 a1a; // [esp+20h] [ebp-28h]
  int a3a[6]; // [esp+30h] [ebp-18h]

  if ( a6 )
  {
    if ( *(_BYTE *)(a6 + 8) & 4 )
    {
      if ( a3 & 0x20 )
      {
        v6 = *(_DWORD *)(a6 + 748);
        v7 = *(_DWORD *)(v6 + 288);
        if ( v7 )
        {
          if ( sub_5330C0(a6, *(_DWORD *)(v6 + 288)) && (a5 == 1 || !a5 && a2 != v7) )
            return v7;
        }
      }
    }
  }
  *(_DWORD *)&byte_5D4594[2489144] = a5;
  *(_DWORD *)&byte_5D4594[2489152] = 0;
  *(_DWORD *)&byte_5D4594[2489148] = 1287568416;
  if ( a1 )
  {
    if ( a2 )
    {
      v9 = *(float *)(a2 + 56);
      v10 = a1->field_0;
      v15.field_4 = *(float *)(a2 + 60);
      v15.field_0 = v9;
      v11 = a1->field_4;
      v15.field_8 = v10;
      v15.field_C = v11;
      if ( sub_535250(&v15, 0, 0, 5) )
      {
        v12 = a1->field_4;
        a3a[3] = LODWORD(a1->field_0);
LABEL_18:
        *(float *)&a3a[4] = v12;
        goto LABEL_19;
      }
      v13 = *(_DWORD *)(a2 + 60);
      a3a[3] = *(_DWORD *)(a2 + 56);
      a3a[4] = v13;
    }
    else
    {
      v14 = a1->field_4;
      a3a[3] = LODWORD(a1->field_0);
      *(float *)&a3a[4] = v14;
    }
LABEL_19:
    a3a[1] = a2;
    a3a[0] = a3;
    *(float *)&a3a[2] = a4 * a4;
    a3a[5] = sub_4EC580(a2);
    a1a.field_0 = *(float *)&a3a[3] - a4;
    a1a.field_4 = *(float *)&a3a[4] - a4;
    a1a.field_8 = *(float *)&a3a[3] + a4;
    a1a.field_C = *(float *)&a3a[4] + a4;
    sub_517C10(&a1a, sub_540780, (int)a3a);
    return *(_DWORD *)&byte_5D4594[2489152];
  }
  if ( a2 )
  {
    v12 = *(float *)(a2 + 60);
    a3a[3] = *(_DWORD *)(a2 + 56);
    goto LABEL_18;
  }
  return 0;
}

//----- (00540780) --------------------------------------------------------
void __cdecl sub_540780(float *a1, int a2)
{
  float *v2; // esi
  int v3; // eax
  int v4; // ebx
  int v5; // eax
  double v6; // st7
  double v7; // st6
  int v8; // eax
  int v9; // edi
  float v10; // [esp+Ch] [ebp+4h]

  v2 = a1;
  if ( *(_DWORD *)&byte_5D4594[2489144] || *(float **)(a2 + 4) != a1 )
  {
    v3 = *((_DWORD *)a1 + 2);
    if ( v3 & 0x20006 )
    {
      if ( !(v3 & 2) || (v4 = *((_DWORD *)a1 + 3), (v4 & 0x8000) == 0) )
      {
        if ( (!(v3 & 4) || !(*(_BYTE *)(*(_DWORD *)(*((_DWORD *)a1 + 187) + 276) + 3680) & 1))
          && !((_DWORD)a1[4] & 0x8020) )
        {
          if ( !(v3 & 2) || (v5 = *((_DWORD *)a1 + 3), !(v5 & 0x4000)) )
          {
            sub_4EC580((int)a1);
            if ( !(*(_BYTE *)a2 & 0x20) || sub_5330C0(*(_DWORD *)(a2 + 4), (int)a1) )
            {
              v6 = *(float *)(a2 + 12) - a1[14];
              v7 = *(float *)(a2 + 16) - a1[15];
              v10 = v7 * v7 + v6 * v6;
              if ( v10 <= (double)*(float *)(a2 + 8) )
              {
                v8 = *(_DWORD *)(a2 + 4);
                if ( !v8 || sub_5370E0(v8, (int)v2, 0) )
                {
                  v9 = *(_DWORD *)(a2 + 20);
                  if ( (!v9 || sub_5370E0(v9, (int)v2, 0)) && v10 < (double)*(float *)&byte_5D4594[2489148] )
                  {
                    *(_DWORD *)&byte_5D4594[2489152] = v2;
                    *(float *)&byte_5D4594[2489148] = v7 * v7 + v6 * v6;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (005408A0) --------------------------------------------------------
BOOL __cdecl sub_5408A0(int a1)
{
  int v1; // ecx

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23));
  return v1 >= 18 && v1 <= 20;
}

//----- (005408D0) --------------------------------------------------------
int __cdecl sub_5408D0(int a1)
{
  int v1; // ebx
  int v2; // esi
  int *v3; // edi
  _DWORD *v4; // ebp
  int v5; // eax
  float v7; // [esp+0h] [ebp-240h]
  int v8; // [esp+18h] [ebp-228h]
  int v9[137]; // [esp+1Ch] [ebp-224h]

  v1 = *(_DWORD *)(a1 + 748);
  v8 = 0;
  if ( !(*(_DWORD *)(a1 + 16) & 0x1000000) )
    return 0;
  if ( !sub_534300(a1) )
    return 0;
  if ( *(_DWORD *)&byte_5D4594[2598000] < *(int *)(v1 + 1452) )
    return 0;
  if ( sub_5408A0(a1) )
    return 0;
  *(_DWORD *)&byte_5D4594[2489156] = 0;
  v7 = sub_419D40(&byte_587000[281816]) * 0.5;
  sub_518170(a1 + 56, v7, sub_540B60, a1);
  if ( !*(_DWORD *)&byte_5D4594[2489156] )
    return 0;
  v2 = 1;
  v3 = v9;
  v4 = (_DWORD *)(v1 + 1492);
  do
  {
    if ( *v4 & 0x8000000 )
    {
      if ( sub_424A50(v2, 16) )
      {
        *v3 = v2;
        ++v3;
        ++v8;
      }
    }
    ++v2;
    ++v4;
  }
  while ( v2 < 137 );
  if ( !v8 )
    return 0;
  v5 = sub_415FA0(0, v8 - 1);
  sub_540A30(a1, v9[v5], a1);
  *(_DWORD *)(v1 + 1452) = *(_DWORD *)&byte_5D4594[2598000]
                         + sub_415FA0(*(unsigned __int16 *)(v1 + 1448), *(unsigned __int16 *)(v1 + 1450));
  return 1;
}
// 5408D0: using guessed type int var_224[137];

//----- (00540A30) --------------------------------------------------------
int *__cdecl sub_540A30(int a1, int a2, int a3)
{
  int v3; // esi
  int *v4; // ebx
  int *result; // eax
  int *v6; // eax
  int *v7; // eax
  int *v8; // eax
  int v9; // edx
  int v10; // [esp-8h] [ebp-14h]
  int v11; // [esp+10h] [ebp+4h]

  v3 = a1;
  v10 = a1;
  v11 = *(_DWORD *)(a1 + 748);
  sub_50A260(v10, 61);
  if ( sub_424A50(a2, 2) )
  {
    v4 = sub_50A260(v3, 41);
    if ( v4 )
      v4[1] = *(_DWORD *)&byte_5D4594[2598000]
            + sub_415FA0(*(_DWORD *)&byte_5D4594[2649704] >> 1, 2 * *(_DWORD *)&byte_5D4594[2649704]);
    result = sub_50A260(v3, 20);
    if ( result )
      goto LABEL_7;
  }
  else
  {
    result = sub_50A260(v3, 18);
    if ( result )
    {
LABEL_7:
      result[1] = a2;
      result[3] = a3;
      goto LABEL_8;
    }
  }
LABEL_8:
  if ( a3 != v3 )
  {
    result = (int *)sub_50A090(v3, 24);
    if ( !result )
    {
      if ( !sub_424A50(a2, 4) )
      {
        v6 = sub_50A260(v3, 26);
        if ( v6 )
          v6[1] = a3;
        v7 = sub_50A260(v3, 47);
        if ( v7 )
          v7[1] = a3;
      }
      v8 = sub_50A260(v3, 49);
      if ( v8 )
      {
        v9 = *(_DWORD *)(*(_DWORD *)(v11 + 484) + 212);
        v8[3] = a3;
        v8[1] = v9;
      }
      sub_50A260(v3, 40);
      result = sub_50A260(v3, 7);
      if ( result )
      {
        result[1] = *(_DWORD *)(a3 + 56);
        result[2] = *(_DWORD *)(a3 + 60);
        result[3] = a3;
      }
    }
  }
  return result;
}

//----- (00540B60) --------------------------------------------------------
int __cdecl sub_540B60(int a1, int a2)
{
  int result; // eax

  result = a1;
  if ( *(_BYTE *)(a1 + 8) & 1 && *(_BYTE *)(a1 + 12) & 2 )
  {
    result = a2;
    if ( *(_DWORD *)(*(_DWORD *)(a1 + 748) + 4) == a2 )
      *(_DWORD *)&byte_5D4594[2489156] = 1;
  }
  return result;
}

//----- (00540B90) --------------------------------------------------------
int __cdecl sub_540B90(int a1)
{
  int v1; // edi
  int v2; // ebp
  int v3; // esi
  int *v4; // ebx
  _DWORD *v5; // ebp
  int v6; // esi
  int *v7; // ebx
  int v8; // ebp
  int v9; // eax
  int v11; // [esp+10h] [ebp-228h]
  int v12[137]; // [esp+14h] [ebp-224h]

  v1 = 0;
  v2 = *(_DWORD *)(a1 + 748);
  v11 = *(_DWORD *)(a1 + 748);
  if ( !(*(_DWORD *)(a1 + 16) & 0x1000000)
    || !sub_534300(a1)
    || *(_DWORD *)&byte_5D4594[2598000] < *(int *)(v2 + 1460)
    || sub_5408A0(a1) )
  {
    return 0;
  }
  v3 = 1;
  v4 = v12;
  v5 = (_DWORD *)(v2 + 1492);
  do
  {
    if ( *v5 & 0x10000000 )
    {
      if ( sub_424A50(v3, 16) )
      {
        *v4 = v3;
        ++v1;
        ++v4;
      }
    }
    ++v3;
    ++v5;
  }
  while ( v3 < 137 );
  if ( !v1 )
    return 0;
  v6 = 0;
  if ( v1 > 0 )
  {
    v7 = v12;
    while ( 1 )
    {
      v8 = a1;
      if ( sub_540CE0(a1, *v7) )
        return 0;
      ++v6;
      ++v7;
      if ( v6 >= v1 )
        goto LABEL_17;
    }
  }
  v8 = a1;
LABEL_17:
  v9 = sub_415FA0(0, v1 - 1);
  sub_540A30(v8, v12[v9], v8);
  *(_DWORD *)(v11 + 1460) = *(_DWORD *)&byte_5D4594[2598000]
                          + sub_415FA0(*(unsigned __int16 *)(v11 + 1456), *(unsigned __int16 *)(v11 + 1458));
  return 1;
}
// 540B90: using guessed type int var_224[137];

//----- (00540CE0) --------------------------------------------------------
BOOL __cdecl sub_540CE0(int a1, int a2)
{
  int i; // esi
  BOOL result; // eax

  for ( i = 0; i < 32; ++i )
  {
    if ( sub_424920(i) == a2 )
      break;
  }
  if ( i == 32 )
    result = 0;
  else
    result = sub_4FF350(a1, i);
  return result;
}

//----- (00540D20) --------------------------------------------------------
BOOL __cdecl sub_540D20(int a1)
{
  return a1 >= 75 && a1 <= 114;
}

//----- (00540D40) --------------------------------------------------------
int __cdecl sub_540D40(int a1)
{
  int v1; // esi

  v1 = sub_4FE930();
  if ( !v1 )
    return 0;
  while ( !sub_540D20(*(_DWORD *)(v1 + 4)) || *(_DWORD *)(v1 + 16) != a1 )
  {
    v1 = sub_4FE940(v1);
    if ( !v1 )
      return 0;
  }
  return 1;
}

//----- (00540D90) --------------------------------------------------------
int __cdecl sub_540D90(int a1, int a2)
{
  int v2; // ebp
  int v3; // ebx
  int v4; // esi
  int *v5; // edi
  _DWORD *v6; // ebx
  int v7; // esi
  int v8; // edi
  BYTE v9; // eax
  int v11; // [esp+10h] [ebp-22Ch]
  int v12; // [esp+14h] [ebp-228h]
  int v13[137]; // [esp+18h] [ebp-224h]

  v2 = 0;
  v3 = *(_DWORD *)(a1 + 748);
  v12 = *(_DWORD *)(a1 + 748);
  if ( *(_DWORD *)(a1 + 16) & 0x1000000
    && sub_534300(a1)
    && *(_DWORD *)&byte_5D4594[2598000] >= *(int *)(v3 + 1476)
    && !sub_5408A0(a1) )
  {
    v4 = 1;
    v5 = v13;
    v11 = 1;
    v6 = (_DWORD *)(v3 + 1492);
    do
    {
      if ( *v6 & 0x40000000 && sub_424A50(v4, 16) )
      {
        *v5 = v4;
        ++v2;
        ++v5;
        if ( !sub_540D20(v4) )
          v11 = 0;
      }
      ++v4;
      ++v6;
    }
    while ( v4 < 137 );
    if ( v2 )
    {
      while ( 1 )
      {
        while ( 1 )
        {
          v7 = sub_415FA0(0, v2 - 1);
          v8 = v13[v7];
          if ( sub_540D20(v13[v7]) )
            break;
LABEL_19:
          if ( v7 >= 0 )
          {
            sub_540A30(a1, v13[v7], a2);
            *(_DWORD *)(v12 + 1476) = *(_DWORD *)&byte_5D4594[2598000]
                                    + sub_415FA0(*(unsigned __int16 *)(v12 + 1472), *(unsigned __int16 *)(v12 + 1474));
            return 1;
          }
        }
        if ( sub_540D40(a1) )
        {
          if ( v11 )
            return 0;
        }
        else
        {
          v9 = sub_500D70(a1, v8 - 74);
          if ( v9 )
            goto LABEL_19;
          if ( v11 )
            return 0;
        }
      }
    }
  }
  return 0;
}
// 540E9A: variable 'v9' is possibly undefined
// 540D90: using guessed type int var_224[137];

//----- (00540F20) --------------------------------------------------------
int __cdecl sub_540F20(int a1, int a2)
{
  int v2; // edi
  int v3; // esi
  int *v4; // ebx
  _DWORD *v5; // ebp
  int v6; // eax
  int v8; // [esp+8h] [ebp-228h]
  int v9[137]; // [esp+Ch] [ebp-224h]

  v8 = 0;
  v2 = *(_DWORD *)(a1 + 748);
  if ( !(*(_DWORD *)(a1 + 16) & 0x1000000)
    || !sub_534300(a1)
    || *(_DWORD *)&byte_5D4594[2598000] < *(int *)(v2 + 1468)
    || sub_5408A0(a1) )
  {
    return 0;
  }
  v3 = 1;
  v4 = v9;
  v5 = (_DWORD *)(v2 + 1492);
  do
  {
    if ( *v5 & 0x20000000 )
    {
      if ( sub_424A50(v3, 16) )
      {
        *v4 = v3;
        ++v4;
        ++v8;
      }
    }
    ++v3;
    ++v5;
  }
  while ( v3 < 137 );
  if ( !v8 )
    return 0;
  v6 = sub_415FA0(0, v8 - 1);
  sub_540A30(a1, v9[v6], a2);
  *(_DWORD *)(v2 + 1468) = *(_DWORD *)&byte_5D4594[2598000]
                         + sub_415FA0(*(unsigned __int16 *)(v2 + 1464), *(unsigned __int16 *)(v2 + 1466));
  return 1;
}
// 540F20: using guessed type int var_224[137];

//----- (00541050) --------------------------------------------------------
int __cdecl sub_541050(int a1)
{
  int v1; // edi
  int v2; // ebp
  int v3; // esi
  int *v4; // ebx
  _DWORD *v5; // ebp
  int v6; // esi
  int *v7; // ebx
  int v8; // ebp
  int v9; // eax
  int v11; // [esp+10h] [ebp-228h]
  int v12[137]; // [esp+14h] [ebp-224h]

  v1 = 0;
  v2 = *(_DWORD *)(a1 + 748);
  v11 = *(_DWORD *)(a1 + 748);
  if ( !(*(_DWORD *)(a1 + 16) & 0x1000000)
    || !sub_534300(a1)
    || *(_DWORD *)&byte_5D4594[2598000] < *(int *)(v2 + 1484)
    || sub_5408A0(a1) )
  {
    return 0;
  }
  v3 = 1;
  v4 = v12;
  v5 = (_DWORD *)(v2 + 1492);
  do
  {
    if ( (int)*v5 < 0 )
    {
      if ( sub_424A50(v3, 16) )
      {
        *v4 = v3;
        ++v1;
        ++v4;
      }
    }
    ++v3;
    ++v5;
  }
  while ( v3 < 137 );
  if ( !v1 )
    return 0;
  v6 = 0;
  if ( v1 > 0 )
  {
    v7 = v12;
    while ( 1 )
    {
      v8 = a1;
      if ( sub_540CE0(a1, *v7) )
        return 0;
      ++v6;
      ++v7;
      if ( v6 >= v1 )
        goto LABEL_17;
    }
  }
  v8 = a1;
LABEL_17:
  v9 = sub_415FA0(0, v1 - 1);
  sub_540A30(v8, v12[v9], v8);
  *(_DWORD *)(v11 + 1484) = *(_DWORD *)&byte_5D4594[2598000]
                          + sub_415FA0(*(unsigned __int16 *)(v11 + 1480), *(unsigned __int16 *)(v11 + 1482));
  return 1;
}
// 541050: using guessed type int var_224[137];

//----- (005411A0) --------------------------------------------------------
int __cdecl sub_5411A0(int a3)
{
  int v1; // edi
  int v2; // edx
  _WORD *v3; // ecx
  unsigned __int16 v4; // ax
  BOOL v6; // eax
  double v7; // st7
  float4 a1; // [esp+8h] [ebp-10h]

  v1 = *(_DWORD *)(a3 + 748);
  if ( !(*(_DWORD *)(a3 + 16) & 0x1000000) || !sub_534300(a3) || byte_5D4594[2598000] & 0x1F || sub_5408A0(a3) )
    return 0;
  v2 = *(_DWORD *)(v1 + 1440);
  if ( v2 & 0x800 )
  {
    v3 = *(_WORD **)(a3 + 556);
    v4 = v3[2];
    if ( v4 )
    {
      if ( *v3 < (unsigned int)(v4 >> 1) )
      {
        sub_540A30(a3, 41, a3);
        return 0;
      }
    }
  }
  if ( !(v2 & 0x1000) )
    return 0;
  v6 = sub_40A5C0(4096);
  *(_DWORD *)&byte_5D4594[2489160] = 0;
  v7 = (double)(v6 ? 640 : 250);
  a1.field_0 = *(float *)(a3 + 56) - v7;
  a1.field_4 = *(float *)(a3 + 60) - v7;
  a1.field_8 = v7 + *(float *)(a3 + 56);
  a1.field_C = v7 + *(float *)(a3 + 60);
  sub_517C10(&a1, sub_5412A0, a3);
  if ( !*(_DWORD *)&byte_5D4594[2489160] )
    return 0;
  sub_540A30(a3, 41, *(int *)&byte_5D4594[2489160]);
  return 1;
}

//----- (005412A0) --------------------------------------------------------
void __cdecl sub_5412A0(float *a1, int a2)
{
  int v2; // eax

  if ( (float *)a2 != a1 && !sub_5330C0(a2, (int)a1) )
  {
    if ( *((_DWORD *)a1 + 139) )
    {
      v2 = *((_DWORD *)a1 + 4);
      if ( (v2 & 0x8000) == 0 )
      {
        if ( sub_5370E0(a2, (int)a1, 0) )
        {
          if ( **((_WORD **)a1 + 139) < (unsigned int)(*(_WORD *)(*((_DWORD *)a1 + 139) + 4) >> 1) )
            *(_DWORD *)&byte_5D4594[2489160] = a1;
        }
      }
    }
  }
}

//----- (00541300) --------------------------------------------------------
char __cdecl sub_541300(int a1, _DWORD *a2, int a3)
{
  int v3; // edi
  int v4; // eax

  v3 = a2[187];
  if ( *(_DWORD *)(v3 + 1440) & 0x20000 )
    sub_4FAAF0(a2);
  sub_533CC0((int)a2, (float *)(a3 + 4));
  sub_4FDD20(a1, a2, (int *)a3);
  v4 = *(_DWORD *)(v3 + 1440);
  if ( v4 & 0x20000 )
    LOBYTE(v4) = sub_4FAAC0(a2);
  return v4;
}

//----- (00541360) --------------------------------------------------------
char __cdecl sub_541360(_DWORD *a1)
{
  int v1; // esi
  char result; // al

  v1 = a1[187];
  if ( !*(_DWORD *)(v1 + 24 * *(char *)(v1 + 544) + 564) || (sub_5413B0(a1, 0), (result = *(_BYTE *)(v1 + 483)) != 0) )
    result = sub_50A160((int)a1);
  return result;
}

//----- (005413B0) --------------------------------------------------------
char __cdecl sub_5413B0(_DWORD *a1, int a2)
{
  int v2; // ecx
  int *v3; // edi
  int v4; // eax
  int v5; // eax
  int v6; // ecx
  int v8[3]; // [esp+8h] [ebp-Ch]

  v2 = a1[187];
  v3 = (int *)(v2 + 24 * (*(char *)(v2 + 544) + 23));
  LOBYTE(v4) = *(_BYTE *)(v2 + 482);
  if ( !(_BYTE)v4 )
  {
    LOBYTE(v4) = *(_BYTE *)(v2 + 481);
    if ( (unsigned __int8)v4 == *(_DWORD *)(*(_DWORD *)(v2 + 484) + 216) )
    {
      if ( a2 )
      {
        LOBYTE(v4) = a2 - 1;
        if ( a2 != 1 )
          return v4;
        v5 = v3[3];
        v6 = v3[4];
        v8[0] = 0;
        v8[1] = v5;
        v8[2] = v6;
      }
      else
      {
        v8[0] = v3[3];
        sub_541490((int)a1, (float *)v8[0], (float2 *)&v8[1]);
      }
      v4 = sub_4FF350((int)a1, 29);
      if ( !v4 )
        LOBYTE(v4) = sub_541300(v3[1], a1, (int)v8);
    }
    else if ( (_BYTE)v4 == 1 )
    {
      v4 = sub_424300((int)a1);
      if ( v4 )
        LOBYTE(v4) = (unsigned int)sub_501960(*(_DWORD *)(v4 + 56), (int)a1, 0, 0);
    }
  }
  return v4;
}

//----- (00541490) --------------------------------------------------------
void __cdecl sub_541490(int a1, float *a2, float2 *a3)
{
  double v3; // st7
  float v4; // [esp+4h] [ebp-14h]
  float v5; // [esp+1Ch] [ebp+4h]
  float v6; // [esp+1Ch] [ebp+4h]

  v5 = 1.0 - *(float *)(*(_DWORD *)(a1 + 748) + 1320);
  *a3 = *((float2 *)a2 + 7);
  v4 = v5 + 1.0;
  v3 = sub_416030(v5, v4);
  a3->field_0 = a3->field_0 - v3 * a2[20] * 6.0;
  a3->field_4 = a3->field_4 - v3 * a2[21] * 6.0;
  v6 = v5 * 0.80000001 + 0.2;
  a3->field_0 = sub_416030(-60.0, 60.0) * v6 + a3->field_0;
  a3->field_4 = sub_416030(-60.0, 60.0) * v6 + a3->field_4;
}

//----- (00541560) --------------------------------------------------------
char __cdecl sub_541560(_DWORD *a1)
{
  int v1; // edi
  char result; // al

  v1 = a1[187];
  sub_5413B0(a1, 1);
  result = *(_BYTE *)(v1 + 483);
  if ( result )
    result = sub_50A160((int)a1);
  return result;
}

//----- (00541590) --------------------------------------------------------
_DWORD *__cdecl sub_541590(int a1)
{
  return sub_4FEB10(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * *(char *)(*(_DWORD *)(a1 + 748) + 544) + 556), a1);
}

//----- (005415C0) --------------------------------------------------------
char __cdecl sub_5415C0(int a1)
{
  sub_4FEB10(*(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * *(char *)(*(_DWORD *)(a1 + 748) + 544) + 556), a1);
  return sub_50A160(a1);
}

//----- (005415F0) --------------------------------------------------------
char __cdecl sub_5415F0(_DWORD *a1)
{
  char result; // al

  if ( *(_DWORD *)(a1[187] + 24 * *(char *)(a1[187] + 544) + 564) )
    result = sub_5413B0(a1, 0);
  else
    result = sub_50A160((int)a1);
  return result;
}

//----- (00541630) --------------------------------------------------------
char __cdecl sub_541630(int a1, int a2)
{
  _DWORD *v2; // eax
  int v3; // ecx

  v2 = (_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * (*(char *)(*(_DWORD *)(a1 + 748) + 544) + 23));
  if ( *v2 == 20 )
  {
    v3 = v2[1];
    LOBYTE(v2) = a2;
    if ( v3 == a2 )
      LOBYTE(v2) = sub_50A160(a1);
  }
  return (char)v2;
}

//----- (00541670) --------------------------------------------------------
int __cdecl sub_541670(LPCSTR a1, LPCSTR lpExistingFileName, LPCSTR lpFileName)
{
  FILE *v3; // edi
  FILE *v4; // esi
  int result; // eax
  int v6; // ebp
  int v7; // ebp
  FILE *v8; // eax
  FILE *v9; // ebx

  if ( !a1 )
    return 0;
  if ( !lpExistingFileName )
    return 0;
  if ( !lpFileName )
    return 0;
  v3 = fopen(a1, (const char *)&byte_587000[282560]);
  if ( !v3 )
    return 0;
  v4 = fopen(lpExistingFileName, (const char *)&byte_587000[282564]);
  if ( !v4 )
  {
    fclose(v3);
    return 0;
  }
  fseek(v3, 0, 2);
  v6 = ftell(v3);
  fseek(v3, 0, 0);
  if ( v6 )
  {
    fseek(v4, 0, 2);
    v7 = ftell(v4);
    fseek(v4, 0, 0);
    if ( v7 )
    {
      v8 = fopen(lpFileName, (const char *)&byte_587000[282568]);
      v9 = v8;
      if ( v8 )
      {
        sub_5417C0(v3, v4, v8);
        fclose(v3);
        fclose(v4);
        fclose(v9);
        result = 1;
      }
      else
      {
        fclose(v3);
        fclose(v4);
        result = 0;
      }
    }
    else
    {
      fclose(v3);
      fclose(v4);
      DeleteFileA(lpFileName);
      MoveFileA(a1, lpFileName);
      result = 1;
    }
  }
  else
  {
    fclose(v3);
    fclose(v4);
    DeleteFileA(lpFileName);
    MoveFileA(lpExistingFileName, lpFileName);
    result = 1;
  }
  return result;
}

//----- (005417C0) --------------------------------------------------------
size_t __cdecl sub_5417C0(FILE *a1, FILE *a2, FILE *a3)
{
  unsigned int v3; // kr04_4
  unsigned int v4; // kr08_4
  char v6[1024]; // [esp+10h] [ebp-400h]

  *(_DWORD *)&byte_5D4594[2489420] = 0;
  *(_DWORD *)&byte_5D4594[2489424] = 0;
  *(_DWORD *)&byte_5D4594[2489428] = 0;
  strcpy(v6, "SCRIPT03");
  v3 = strlen(v6) + 1;
  fread(v6, v3 - 1, 1u, a1);
  fread(v6, v3 - 1, 1u, a2);
  fwrite(v6, v3 - 1, 1u, a3);
  sub_5418C0(a1, a2, a3);
  sub_541A50(a1, a2, a3);
  strcpy(v6, "DONE");
  v4 = strlen(v6) + 1;
  fread(v6, v4 - 1, 1u, a1);
  fread(v6, v4 - 1, 1u, a2);
  return fwrite(v6, v4 - 1, 1u, a3);
}

//----- (005418C0) --------------------------------------------------------
int __cdecl sub_5418C0(FILE *a1, FILE *a2, FILE *a3)
{
  int i; // ebx
  int result; // eax
  int j; // edi
  size_t v6; // [esp+10h] [ebp-1010h]
  int v7; // [esp+14h] [ebp-100Ch]
  int v8; // [esp+18h] [ebp-1008h]
  int v9; // [esp+1Ch] [ebp-1004h]
  char v10[4096]; // [esp+20h] [ebp-1000h]

  strcpy((char *)v10, "STRG");
  v6 = strlen((const char *)v10);
  fread(v10, v6, 1u, a1);
  fread(v10, v6, 1u, a2);
  fwrite(v10, v6, 1u, a3);
  fread(&v8, 4u, 1u, a1);
  fread(&v7, 4u, 1u, a2);
  *(_DWORD *)&byte_5D4594[2489424] = v8;
  v9 = v8 + v7;
  fwrite(&v9, 4u, 1u, a3);
  for ( i = 0; i < v8; ++i )
  {
    fread(&v6, 4u, 1u, a1);
    fread(v10, v6, 1u, a1);
    v10[v6] = 0;
    fwrite(&v6, 4u, 1u, a3);
    fwrite(v10, v6, 1u, a3);
  }
  result = v7;
  for ( j = 0; j < v7; ++j )
  {
    fread(&v6, 4u, 1u, a2);
    fread(v10, v6, 1u, a2);
    v10[v6] = 0;
    fwrite(&v6, 4u, 1u, a3);
    fwrite(v10, v6, 1u, a3);
    result = v7;
  }
  return result;
}

//----- (00541A50) --------------------------------------------------------
FILE *__cdecl sub_541A50(FILE *a1, FILE *a2, FILE *a3)
{
  unsigned int v3; // kr04_4
  FILE *result; // eax
  int i; // ebx
  int j; // edi
  size_t v7; // [esp+10h] [ebp-101Ch]
  char v8; // [esp+14h] [ebp-1018h]
  char v9; // [esp+18h] [ebp-1014h]
  int v10; // [esp+1Ch] [ebp-1010h]
  int v11; // [esp+20h] [ebp-100Ch]
  char v12; // [esp+24h] [ebp-1008h]
  int v13; // [esp+28h] [ebp-1004h]
  char v14[4096]; // [esp+2Ch] [ebp-1000h]

  strcpy((char *)v14, "CODE");
  v3 = strlen((const char *)v14) + 1;
  fread(v14, v3 - 1, 1u, a1);
  fread(v14, v3 - 1, 1u, a2);
  fwrite(v14, v3 - 1, 1u, a3);
  fread(&v11, 4u, 1u, a1);
  fread(&v10, 4u, 1u, a2);
  *(_DWORD *)&byte_5D4594[2489428] = v11;
  v13 = v10 + v11 - 2;
  fwrite(&v13, 4u, 1u, a3);
  result = sub_541E40(a1, a2, a3);
  for ( i = 0; i < v11 - 2; result = (FILE *)(v11 - 2) )
  {
    v7 = 4;
    fread(&v14, 4u, 1u, a1);
    fwrite(v14, v7, 1u, a3);
    fread(&v7, 4u, 1u, a1);
    fread(v14, v7, 1u, a1);
	v14[v7] = 0;
    fwrite(&v7, 4u, 1u, a3);
    fwrite(v14, v7, 1u, a3);
    fread(&v12, 4u, 1u, a1);
    fwrite(&v12, 4u, 1u, a3);
    fread(&v8, 4u, 1u, a1);
    fwrite(&v8, 4u, 1u, a3);
    sub_541D80(a1, a3);
    v7 = 4;
    fread(v14, 4u, 1u, a1);
    fwrite(v14, v7, 1u, a3);
    fread(&v9, 4u, 1u, a1);
    fwrite(&v9, 4u, 1u, a3);
    sub_542380(a1, a3, 0);
    ++i;
  }
  for ( j = 0; j < v10 - 2; result = (FILE *)(v10 - 2) )
  {
    v7 = 4;
    fread(v14, 4u, 1u, a2);
    fwrite(v14, v7, 1u, a3);
    fread(&v7, 4u, 1u, a2);
    fread(v14, v7, 1u, a2);
    v14[v7] = 0;
    fwrite(&v7, 4u, 1u, a3);
    fwrite(v14, v7, 1u, a3);
    fread(&v12, 4u, 1u, a2);
    fwrite(&v12, 4u, 1u, a3);
    fread(&v8, 4u, 1u, a2);
    fwrite(&v8, 4u, 1u, a3);
    sub_541D80(a2, a3);
    v7 = 4;
    fread(v14, 4u, 1u, a2);
    fwrite(v14, v7, 1u, a3);
    fread(&v9, 4u, 1u, a2);
    fwrite(&v9, 4u, 1u, a3);
    sub_542380(a2, a3, 1);
    ++j;
  }
  return result;
}

//----- (00541D80) --------------------------------------------------------
int __cdecl sub_541D80(FILE *a1, FILE *a2)
{
  int v2; // ebx
  int result; // eax
  int v4; // [esp+Ch] [ebp-100Ch]
  char v5; // [esp+10h] [ebp-1008h]
  char v6; // [esp+14h] [ebp-1004h]
  char v7; // [esp+18h] [ebp-1000h]
  char v8; // [esp+1Ch] [ebp-FFCh]

  fread(&v7, 4u, 1u, a1);
  v2 = 0;
  v8 = 0;
  fwrite(&v7, 4u, 1u, a2);
  fread(&v4, 4u, 1u, a1);
  fwrite(&v4, 4u, 1u, a2);
  fread(&v5, 4u, 1u, a1);
  fwrite(&v5, 4u, 1u, a2);
  result = v4;
  if ( v4 && v4 > 0 )
  {
    do
    {
      fread(&v6, 4u, 1u, a1);
      fwrite(&v6, 4u, 1u, a2);
      result = v4;
      ++v2;
    }
    while ( v2 < v4 );
  }
  return result;
}

//----- (00541E40) --------------------------------------------------------
FILE *__cdecl sub_541E40(FILE *a1, FILE *a2, FILE *a3)
{
  size_t v4; // [esp+10h] [ebp-1034h]
  char v5; // [esp+14h] [ebp-1030h]
  int i; // [esp+18h] [ebp-102Ch]
  int v7; // [esp+1Ch] [ebp-1028h]
  char v8; // [esp+20h] [ebp-1024h]
  char v9; // [esp+24h] [ebp-1020h]
  char v10; // [esp+28h] [ebp-101Ch]
  int v11; // [esp+2Ch] [ebp-1018h]
  int v12; // [esp+30h] [ebp-1014h]
  int v13; // [esp+34h] [ebp-1010h]
  int v14; // [esp+38h] [ebp-100Ch]
  char v15; // [esp+3Ch] [ebp-1008h]
  int v16; // [esp+40h] [ebp-1004h]
  char v17; // [esp+44h] [ebp-1000h]

  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, 4u, 1u, a2);
  fwrite(&v17, 4u, 1u, a3);
  fread(&v4, 4u, 1u, a1);
  fread(&v17, v4, 1u, a1);
  fread(&v4, 4u, 1u, a2);
  fread(&v17, v4, 1u, a2);
  fwrite(&v4, 4u, 1u, a3);
  fwrite(&v17, v4, 1u, a3);
  fread(&v9, 4u, 1u, a1);
  fread(&v9, 4u, 1u, a2);
  fwrite(&v9, 4u, 1u, a3);
  fread(&v8, 4u, 1u, a1);
  fread(&v8, 4u, 1u, a2);
  fwrite(&v8, 4u, 1u, a3);
  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, v4, 1u, a2);
  fwrite(&v17, v4, 1u, a3);
  fread(&v7, 4u, 1u, a1);
  fread(&v11, 4u, 1u, a2);
  v12 = v7 + v11;
  fwrite(&v12, 4u, 1u, a3);
  fread(&v10, 4u, 1u, a1);
  fread(&v10, 4u, 1u, a2);
  fwrite(&v10, 4u, 1u, a3);
  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, v4, 1u, a2);
  fwrite(&v17, v4, 1u, a3);
  fread(&v13, 4u, 1u, a1);
  fread(&v14, 4u, 1u, a2);
  fwrite(&v13, 4u, 1u, a3);
  fread(&v15, 4u, 1u, a1);
  fread(&v15, 4u, 1u, a2);
  fwrite(&v15, 4u, 1u, a3);
  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, v4, 1u, a2);
  fwrite(&v17, v4, 1u, a3);
  fread(&v4, 4u, 1u, a1);
  fread(&v17, v4, 1u, a1);
  fread(&v4, 4u, 1u, a2);
  fread(&v17, v4, 1u, a2);
  fwrite(&v4, 4u, 1u, a3);
  fwrite(&v17, v4, 1u, a3);
  fread(&v9, 4u, 1u, a1);
  fread(&v9, 4u, 1u, a2);
  fwrite(&v9, 4u, 1u, a3);
  fread(&v8, 4u, 1u, a1);
  fread(&v8, 4u, 1u, a2);
  fwrite(&v8, 4u, 1u, a3);
  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, v4, 1u, a2);
  fwrite(&v17, v4, 1u, a3);
  fread(&v7, 4u, 1u, a1);
  fread(&v11, 4u, 1u, a2);
  *(_DWORD *)&byte_5D4594[2489420] = v7;
  v12 = v11 + v7 - 4;
  fwrite(&v12, 4u, 1u, a3);
  fread(&v10, 4u, 1u, a1);
  fread(&v10, 4u, 1u, a2);
  fwrite(&v10, 4u, 1u, a3);
  for ( i = 0; i < v7; ++i )
  {
    fread(&v5, 4u, 1u, a1);
    fwrite(&v5, 4u, 1u, a3);
  }
  fread(&v5, 4u, 1u, a2);
  fread(&v5, 4u, 1u, a2);
  fread(&v5, 4u, 1u, a2);
  fread(&v5, 4u, 1u, a2);
  for ( i = 4; i < v11; ++i )
  {
    fread(&v5, 4u, 1u, a2);
    fwrite(&v5, 4u, 1u, a3);
  }
  v4 = 4;
  fread(&v17, 4u, 1u, a1);
  fread(&v17, v4, 1u, a2);
  fwrite(&v17, v4, 1u, a3);
  fread(&v13, 4u, 1u, a1);
  fread(&v14, 4u, 1u, a2);
  v16 = v14 + v13 - 4;
  fwrite(&v16, 4u, 1u, a3);
  sub_542380(a1, a3, 0);
  fseek(a3, -4, 1);
  return sub_542380(a2, a3, 1);
}

//----- (00542380) --------------------------------------------------------
FILE *__cdecl sub_542380(FILE *a1, FILE *a2, int a3)
{
  FILE *v3; // ebp
  FILE *v4; // esi
  FILE *result; // eax
  FILE *v6; // ebx
  int v7; // edi
  FILE *v8; // edi
  char v9; // bl
  char v10; // di
  char v11; // di
  char v12; // al
  FILE *v13; // edi
  int (*v14)(); // eax
  FILE *v15; // edi
  float v16; // [esp+14h] [ebp+4h]

  v3 = a1;
  v4 = a2;
  while ( 2 )
  {
    result = sub_542B70(v3);
    switch ( (unsigned int)result )
    {
      case 0u:
        v6 = sub_542B70(v3);
        v7 = sub_542B70(v3);
        if ( v6 && a3 && v7 >= 4 )
          v7 = v7 + *(_DWORD *)&byte_5D4594[2489420] - 4;
        sub_542BB0(0, v4);
        goto LABEL_8;
      case 1u:
        v6 = sub_542B70(v3);
        v7 = sub_542B70(v3);
        if ( v6 && a3 && v7 >= 4 )
          v7 = v7 + *(_DWORD *)&byte_5D4594[2489420] - 4;
        sub_542BB0(1, v4);
        goto LABEL_8;
      case 2u:
        v6 = sub_542B70(v3);
        v7 = sub_542B70(v3);
        if ( v6 && a3 && v7 >= 4 )
          v7 = v7 + *(_DWORD *)&byte_5D4594[2489420] - 4;
        sub_542BB0(2, v4);
LABEL_8:
        sub_542BB0((char)v6, v4);
        sub_542BB0(v7, v4);
        continue;
      case 3u:
        v8 = sub_542B70(v3);
        v9 = (unsigned int)sub_542B70(v3);
        if ( v8 && a3 )
          v9 += byte_5D4594[2489424];
        sub_542BB0(3, v4);
        sub_542BB0((char)v8, v4);
        sub_542BB0(v9, v4);
        continue;
      case 4u:
        v10 = (unsigned int)sub_542B70(v3);
        sub_542BB0(4, v4);
        sub_542BB0(v10, v4);
        continue;
      case 5u:
        v16 = sub_542B90(v3);
        sub_542BB0(5, v4);
        sub_542BD0(SLOBYTE(v16), v4);
        continue;
      case 6u:
        v11 = (unsigned int)sub_542B70(v3);
        if ( a3 )
          v11 += byte_5D4594[2489424];
        sub_542BB0(6, v4);
        sub_542BB0(v11, v4);
        continue;
      case 7u:
        sub_542BB0(7, v4);
        continue;
      case 8u:
        sub_542BB0(8, v4);
        continue;
      case 9u:
        sub_542BB0(9, v4);
        continue;
      case 0xAu:
        sub_542BB0(10, v4);
        continue;
      case 0xBu:
        sub_542BB0(11, v4);
        continue;
      case 0xCu:
        sub_542BB0(12, v4);
        continue;
      case 0xDu:
        sub_542BB0(13, v4);
        continue;
      case 0xEu:
        sub_542BB0(14, v4);
        continue;
      case 0xFu:
        sub_542BB0(15, v4);
        continue;
      case 0x10u:
        sub_542BB0(16, v4);
        continue;
      case 0x11u:
        sub_542BB0(17, v4);
        continue;
      case 0x12u:
        sub_542BB0(18, v4);
        continue;
      case 0x13u:
        sub_542BB0(19, v4);
        goto LABEL_44;
      case 0x14u:
        sub_542BB0(20, v4);
        goto LABEL_44;
      case 0x15u:
        sub_542BB0(21, v4);
LABEL_44:
        v12 = (unsigned int)sub_542B70(v3);
        sub_542BB0(v12, v4);
        continue;
      case 0x16u:
      case 0x18u:
        sub_542BB0((char)result, v4);
        continue;
      case 0x17u:
        sub_542BB0(23, v4);
        continue;
      case 0x19u:
        sub_542BB0(25, v4);
        continue;
      case 0x1Au:
        sub_542BB0(26, v4);
        continue;
      case 0x1Bu:
        sub_542BB0(27, v4);
        continue;
      case 0x1Cu:
        sub_542BB0(28, v4);
        continue;
      case 0x1Du:
        sub_542BB0(29, v4);
        continue;
      case 0x1Eu:
        sub_542BB0(30, v4);
        continue;
      case 0x1Fu:
        sub_542BB0(31, v4);
        continue;
      case 0x20u:
        sub_542BB0(32, v4);
        continue;
      case 0x21u:
        sub_542BB0(33, v4);
        continue;
      case 0x22u:
        sub_542BB0(34, v4);
        continue;
      case 0x23u:
        sub_542BB0(35, v4);
        continue;
      case 0x24u:
        sub_542BB0(36, v4);
        continue;
      case 0x25u:
        sub_542BB0(37, v4);
        continue;
      case 0x26u:
        sub_542BB0(38, v4);
        continue;
      case 0x27u:
        sub_542BB0(39, v4);
        continue;
      case 0x28u:
        sub_542BB0(40, v4);
        continue;
      case 0x29u:
        sub_542BB0(41, v4);
        continue;
      case 0x2Au:
        sub_542BB0(42, v4);
        continue;
      case 0x2Bu:
        sub_542BB0(43, v4);
        continue;
      case 0x2Cu:
        sub_542BB0(44, v4);
        continue;
      case 0x2Du:
        sub_542BB0(45, v4);
        continue;
      case 0x2Eu:
        sub_542BB0(46, v4);
        continue;
      case 0x2Fu:
        sub_542BB0(47, v4);
        continue;
      case 0x30u:
        sub_542BB0(48, v4);
        continue;
      case 0x31u:
        sub_542BB0(49, v4);
        continue;
      case 0x32u:
        sub_542BB0(50, v4);
        continue;
      case 0x33u:
        sub_542BB0(51, v4);
        continue;
      case 0x34u:
        sub_542BB0(52, v4);
        continue;
      case 0x35u:
        sub_542BB0(53, v4);
        continue;
      case 0x36u:
        sub_542BB0(54, v4);
        continue;
      case 0x37u:
        sub_542BB0(55, v4);
        continue;
      case 0x38u:
        sub_542BB0(56, v4);
        continue;
      case 0x39u:
        sub_542BB0(57, v4);
        continue;
      case 0x3Au:
        sub_542BB0(58, v4);
        continue;
      case 0x3Bu:
        sub_542BB0(59, v4);
        continue;
      case 0x3Cu:
        sub_542BB0(60, v4);
        continue;
      case 0x3Du:
        sub_542BB0(61, v4);
        continue;
      case 0x3Eu:
        sub_542BB0(62, v4);
        continue;
      case 0x3Fu:
        sub_542BB0(63, v4);
        continue;
      case 0x40u:
        sub_542BB0(64, v4);
        continue;
      case 0x41u:
        sub_542BB0(65, v4);
        continue;
      case 0x42u:
        sub_542BB0(66, v4);
        continue;
      case 0x43u:
        sub_542BB0(67, v4);
        continue;
      case 0x44u:
        sub_542BB0(68, v4);
        continue;
      case 0x45u:
        v13 = sub_542B70(v3);
        if ( a3 )
        {
          v14 = *(int (**)())&byte_587000[4 * (_DWORD)v13 + 245900];
          if ( v14 == sub_512320
            || v14 == sub_512350
            || v14 == sub_512DE0
            || v14 == sub_512E10
            || v14 == sub_516970
            || v14 == sub_514D90 )
          {
            fseek(v4, -4, 1);
            fread(&a2, 4u, 1u, v4);
            fseek(v4, -4, 1);
            a2 = (FILE *)((char *)a2 + *(_DWORD *)&byte_5D4594[2489428] - 2);
            fwrite(&a2, 4u, 1u, v4);
            if ( *(int (**)())&byte_587000[4 * (_DWORD)v13 + 245900] == sub_514D90 )
            {
              fseek(v4, -12, 1);
              fread(&a2, 4u, 1u, v4);
              fseek(v4, -4, 1);
              a2 = (FILE *)((char *)a2 + *(_DWORD *)&byte_5D4594[2489428] - 2);
              fwrite(&a2, 4u, 1u, v4);
              fseek(v4, 8, 1);
            }
          }
        }
        sub_542BB0(69, v4);
        sub_542BB0((char)v13, v4);
        continue;
      case 0x46u:
        v15 = sub_542B70(v3);
        if ( a3 )
          v15 = (FILE *)((char *)v15 + *(_DWORD *)&byte_5D4594[2489428] - 2);
        sub_542BB0(70, v4);
        sub_542BB0((char)v15, v4);
        continue;
      case 0x47u:
        sub_542BB0(71, v4);
        continue;
      case 0x48u:
        return (FILE *)sub_542BB0(72, v4);
      case 0x49u:
        sub_542BB0(73, v4);
        continue;
      default:
        return result;
    }
  }
}

//----- (00542B70) --------------------------------------------------------
FILE *__cdecl sub_542B70(FILE *a1)
{
  fread(&a1, 4u, 1u, a1);
  return a1;
}

//----- (00542B90) --------------------------------------------------------
double __cdecl sub_542B90(FILE *a1)
{
  fread(&a1, 4u, 1u, a1);
  return *(float *)&a1;
}

//----- (00542BB0) --------------------------------------------------------
size_t __cdecl sub_542BB0(char a1, FILE *a2)
{
  return fwrite(&a1, 4u, 1u, a2);
}

//----- (00542BD0) --------------------------------------------------------
size_t __cdecl sub_542BD0(char a1, FILE *a2)
{
  return fwrite(&a1, 4u, 1u, a2);
}

//----- (00542BF0) --------------------------------------------------------
char *__cdecl sub_542BF0(int a1, int a2, int a3)
{
  int **v3; // eax
  int *v4; // ebx
  char *v5; // esi
  char *v6; // edx
  const char *v7; // eax
  int v8; // esi
  char *v9; // eax
  CHAR *v10; // eax
  int (__cdecl *v11)(int *); // eax
  const char *v12; // edx
  char *v13; // eax
  const char *v14; // edx
  char *v15; // eax
  const char *v16; // edx
  const char *v17; // edx
  char *v18; // eax
  const char *v19; // edx
  char *v20; // eax
  const char *v21; // edx
  char *v22; // eax
  const char *v23; // edx
  char *v24; // eax
  const char *v25; // edx
  char *v26; // eax
  const char *v27; // edx
  char *v28; // eax
  const char *v29; // edx
  char *v30; // eax
  const char *v31; // edx
  char *v32; // eax
  const char *v33; // edx
  const char *v34; // edx
  const char *v35; // eax
  char *v36; // eax
  const char *v37; // eax
  char *v38; // eax
  const char *v39; // eax
  char *v40; // eax
  const char *v41; // eax
  char *result; // eax
  char *i; // ebx
  char *v44; // [esp-14h] [ebp-28h]
  char *v45; // [esp-14h] [ebp-28h]
  char *v46; // [esp-14h] [ebp-28h]
  char *v47; // [esp-14h] [ebp-28h]
  int v48; // [esp+10h] [ebp-4h]

  v3 = (int **)sub_5049D0();
  v48 = (int)v3;
  if ( v3 )
  {
    while ( 1 )
    {
      v4 = *v3;
      if ( ((*v3)[4] & 0x80000000) == 0x80000000 )
      {
        if ( *v4 )
        {
          v5 = sub_543620(*v4, a1);
          v6 = (char *)realloc((LPVOID)*v4, strlen(v5) + 1);
          *v4 = (int)v6;
          strcpy(v6, v5);
        }
        v7 = (const char *)sub_508CB0(v4, 14);
        if ( v7 )
        {
          v8 = a3;
          if ( strlen(v7) )
          {
            v9 = sub_5435C0((int)v7, a1, a2, a3);
            sub_509120(v4, 14, v9);
          }
        }
        else
        {
          v8 = a3;
        }
        v10 = (CHAR *)sub_4E39D0((int)v4);
        v11 = *(int (__cdecl **)(int *))(sub_4E3B60(v10) + 212);
        if ( (char *)v11 == (char *)sub_4F4E50 )
        {
          v12 = (const char *)sub_508CB0(v4, 1);
          if ( strlen(v12) )
          {
            v13 = sub_5435C0((int)v12, a1, a2, v8);
            sub_509120(v4, 1, v13);
          }
          v14 = (const char *)sub_508CB0(v4, 2);
          if ( strlen(v14) )
          {
            v15 = sub_5435C0((int)v14, a1, a2, v8);
            sub_509120(v4, 2, v15);
          }
          v16 = (const char *)sub_508CB0(v4, 0);
          if ( strlen(v16) )
          {
            v44 = sub_5435C0((int)v16, a1, a2, v8);
            sub_509120(v4, 0, v44);
          }
        }
        else if ( (char *)v11 == (char *)sub_528DB0 )
        {
          v17 = (const char *)sub_508CB0(v4, 3);
          if ( strlen(v17) )
          {
            v18 = sub_5435C0((int)v17, a1, a2, v8);
            sub_509120(v4, 3, v18);
          }
          v19 = (const char *)sub_508CB0(v4, 5);
          if ( strlen(v19) )
          {
            v20 = sub_5435C0((int)v19, a1, a2, v8);
            sub_509120(v4, 5, v20);
          }
          v21 = (const char *)sub_508CB0(v4, 4);
          if ( strlen(v21) )
          {
            v22 = sub_5435C0((int)v21, a1, a2, v8);
            sub_509120(v4, 4, v22);
          }
          v23 = (const char *)sub_508CB0(v4, 6);
          if ( strlen(v23) )
          {
            v24 = sub_5435C0((int)v23, a1, a2, v8);
            sub_509120(v4, 6, v24);
          }
          v25 = (const char *)sub_508CB0(v4, 7);
          if ( strlen(v25) )
          {
            v26 = sub_5435C0((int)v25, a1, a2, v8);
            sub_509120(v4, 7, v26);
          }
          v27 = (const char *)sub_508CB0(v4, 8);
          if ( strlen(v27) )
          {
            v28 = sub_5435C0((int)v27, a1, a2, v8);
            sub_509120(v4, 8, v28);
          }
          v29 = (const char *)sub_508CB0(v4, 9);
          if ( strlen(v29) )
          {
            v30 = sub_5435C0((int)v29, a1, a2, v8);
            sub_509120(v4, 9, v30);
          }
          v31 = (const char *)sub_508CB0(v4, 10);
          if ( strlen(v31) )
          {
            v32 = sub_5435C0((int)v31, a1, a2, v8);
            sub_509120(v4, 10, v32);
          }
          v33 = (const char *)sub_508CB0(v4, 11);
          if ( strlen(v33) )
          {
            v45 = sub_5435C0((int)v33, a1, a2, v8);
            sub_509120(v4, 11, v45);
          }
        }
        else if ( (char *)v11 == (char *)sub_4F51D0 )
        {
          v34 = (const char *)sub_508CB0(v4, 12);
          if ( strlen(v34) )
          {
            v46 = sub_5435C0((int)v34, a1, a2, v8);
            sub_509120(v4, 12, v46);
          }
        }
        else if ( v11 == sub_4F7130 )
        {
          v35 = (const char *)sub_508CB0(v4, 15);
          if ( v35 && strlen(v35) )
          {
            v36 = sub_5435C0((int)v35, a1, a2, v8);
            sub_509120(v4, 15, v36);
          }
          v37 = (const char *)sub_508CB0(v4, 16);
          if ( v37 && strlen(v37) )
          {
            v38 = sub_5435C0((int)v37, a1, a2, v8);
            sub_509120(v4, 16, v38);
          }
          v39 = (const char *)sub_508CB0(v4, 18);
          if ( v39 && strlen(v39) )
          {
            v40 = sub_5435C0((int)v39, a1, a2, v8);
            sub_509120(v4, 18, v40);
          }
          v41 = (const char *)sub_508CB0(v4, 17);
          if ( v41 && strlen(v41) )
          {
            v47 = sub_5435C0((int)v41, a1, a2, v8);
            sub_509120(v4, 17, v47);
          }
        }
        v4[4] &= 0x7FFFFFFFu;
        v3 = (int **)v48;
      }
      v48 = sub_5049E0((int)v3);
      if ( !v48 )
        break;
      v3 = (int **)v48;
    }
  }
  result = (char *)sub_579860();
  for ( i = result; result; i = result )
  {
    if ( *((int *)i + 120) < 0 )
    {
      if ( (int)strlen(i + 16) > 0 )
        strcpy(i + 16, sub_543620((int)(i + 16), a1));
      *((_DWORD *)i + 120) &= 0x7FFFFFFFu;
    }
    result = (char *)sub_579870((int)i);
  }
  return result;
}

//----- (00543110) --------------------------------------------------------
FILE *__cdecl sub_543110(LPCSTR lpExistingFileName, int2 *a2)
{
  int v2; // edx
  int v3; // eax
  char *v4; // edi
  FILE *result; // eax
  FILE *v6; // ebx
  FILE *v7; // ebp
  unsigned int v8; // kr08_4
  int i; // esi
  int v10; // esi
  int v11; // edi
  size_t v12; // [esp+10h] [ebp-101Ch]
  int v13; // [esp+14h] [ebp-1018h]
  int v14; // [esp+18h] [ebp-1014h]
  int v15; // [esp+1Ch] [ebp-1010h]
  int j; // [esp+20h] [ebp-100Ch]
  char v17; // [esp+24h] [ebp-1008h]
  char v18; // [esp+28h] [ebp-1004h]
  char v19[2048]; // [esp+2Ch] [ebp-1000h]
  char NewFileName[2048]; // [esp+82Ch] [ebp-800h]

  sub_542BF0(*(int *)&byte_5D4594[3835312], a2->field_0, a2->field_4);
  v2 = *(_DWORD *)&byte_587000[282612];
  strcpy(NewFileName, (const char *)&byte_5D4594[3841580]);
  v3 = *(_DWORD *)&byte_587000[282616];
  v4 = &NewFileName[strlen(NewFileName)];
  *(_DWORD *)v4 = *(_DWORD *)&byte_587000[282608];
  *((_DWORD *)v4 + 1) = v2;
  *((_DWORD *)v4 + 2) = v3;
  CopyFileA(lpExistingFileName, NewFileName, 0);
  result = fopen(NewFileName, (const char *)&byte_587000[282620]);
  v6 = result;
  if ( result )
  {
    v7 = fopen(lpExistingFileName, (const char *)&byte_587000[282624]);
    if ( v7 )
    {
      strcpy((char *)v19, "SCRIPT03");
      v8 = strlen((const char *)v19) + 1;
      fread(v19, v8 - 1, 1u, v6);
      fwrite(v19, v8 - 1, 1u, v7);
      strcpy((char *)v19, "STRG");
      v12 = strlen((const char *)v19);
      fread(v19, v12, 1u, v6);
      fwrite(v19, v12, 1u, v7);
      fread(&v14, 4u, 1u, v6);
      fwrite(&v14, 4u, 1u, v7);
      for ( i = 0; i < v14; ++i )
      {
        fread(&v12, 4u, 1u, v6);
        fread(v19, v12, 1u, v6);
		v19[v12] = 0;
        fwrite(&v12, 4u, 1u, v7);
        fwrite(v19, v12, 1u, v7);
      }
      strcpy((char *)v19, "CODE");
      v12 = strlen((const char *)v19);
      fread(v19, v12, 1u, v6);
      fwrite(v19, v12, 1u, v7);
      fread(&v15, 4u, 1u, v6);
      fwrite(&v15, 4u, 1u, v7);
      v10 = 0;
      for ( j = 0; v10 < v15; j = v10 )
      {
        v12 = 4;
        fread(v19, 4u, 1u, v6);
        fwrite(v19, v12, 1u, v7);
        fread(&v12, 4u, 1u, v6);
        fread(v19, v12, 1u, v6);
		v19[v12] = 0;
        if ( v10 > 1 )
        {
          sub_5435C0((int)&v19, *(int *)&byte_5D4594[3835312], a2->field_0, a2->field_4);
          strcpy((char *)&v19, (const char *)&byte_5D4594[2489164]);
          v10 = j;
          v12 = strlen((const char *)&v19);
        }
        fwrite(&v12, 4u, 1u, v7);
        fwrite(v19, v12, 1u, v7);
        fread(&v18, 4u, 1u, v6);
        fwrite(&v18, 4u, 1u, v7);
        fread(&v17, 4u, 1u, v6);
        fwrite(&v17, 4u, 1u, v7);
        sub_541D80(v6, v7);
        v12 = 4;
        fread(v19, 4u, 1u, v6);
        fwrite(v19, v12, 1u, v7);
        v11 = ftell(v7);
        fread(&v13, 4u, 1u, v6);
        fwrite(&v13, 4u, 1u, v7);
        sub_542380(v6, v7, 0);
        v13 = -4 - v11 + ftell(v7);
        fseek(v7, v11, 0);
        fwrite(&v13, 4u, 1u, v7);
        fseek(v7, v13, 1);
        ++v10;
      }
      strcpy((char *)&v19, "DONE");
      v12 = strlen((const char *)&v19);
      fread(v19, v12, 1u, v6);
      fwrite(v19, v12, 1u, v7);
      fclose(v6);
      fclose(v7);
      result = (FILE *)DeleteFileA(NewFileName);
    }
    else
    {
      result = (FILE *)fclose(v6);
    }
  }
  return result;
}
// 543110: using guessed type CHAR NewFileName[2048];

//----- (005435C0) --------------------------------------------------------
char *__cdecl sub_5435C0(int a1, int a2, int a3, int a4)
{
  nox_sprintf((char *)&byte_5D4594[2489164], (const char *)&byte_587000[282664], a1, a2, a3, a4);
  strlen((const char *)&byte_5D4594[2489164]);
  strcpy((char *)&byte_5D4594[2489164], "ERROR_NAME_TOO_LONG!");
  return (char *)&byte_5D4594[2489164];
}

//----- (00543620) --------------------------------------------------------
char *__cdecl sub_543620(int a1, int a2)
{
  nox_sprintf((char *)&byte_5D4594[2489164], (const char *)&byte_587000[282704], a1, a2);
  strlen((const char *)&byte_5D4594[2489164]);
  strcpy((char *)&byte_5D4594[2489164], "ERROR_NAME_TOO_LONG!");
  return (char *)&byte_5D4594[2489164];
}

//----- (00543680) --------------------------------------------------------
int __cdecl sub_543680(float *a1)
{
  int result; // eax
  float2 a2; // [esp+0h] [ebp-30h]
  int2 v3; // [esp+8h] [ebp-28h]
  int v4[8]; // [esp+10h] [ebp-20h]

  if ( *(_DWORD *)&byte_5D4594[3835356] == 255 )
    return 1;
  result = sub_4D3D90((float2 *)a1, &a2);
  if ( result )
  {
    v4[0] = *(_DWORD *)&byte_5D4594[3835340];
    *(_DWORD *)&byte_5D4594[3835352] = 1;
    v4[1] = *(_DWORD *)&byte_5D4594[3835348];
    v4[6] = *(_DWORD *)&byte_5D4594[3835356];
    v4[7] = *(_DWORD *)&byte_5D4594[3835360];
    v3.field_0 = (__int64)a2.field_0;
    v3.field_4 = (__int64)a2.field_4;
    result = sub_5437E0(&v3.field_0, (int)v4, 46);
    *(_DWORD *)&byte_5D4594[3835352] = 0;
  }
  return result;
}

//----- (00543720) --------------------------------------------------------
void __cdecl sub_543720(int a1, int a2, int a3, int a4)
{
  int result; // eax
  int v5; // ecx

  if ( *(_DWORD *)&byte_5D4594[2489432] >= 500 )
  {
    *(_DWORD *)&byte_5D4594[3807168] = 1;
  }
  else
  {
    result = 16 * *(_DWORD *)&byte_5D4594[2489432];
    v5 = *(_DWORD *)&byte_5D4594[2489432] + 1;
    *(_DWORD *)&byte_5D4594[result + 3807180] = a1;
    *(_DWORD *)&byte_5D4594[result + 3807184] = a2;
    *(_DWORD *)&byte_5D4594[result + 3807188] = a3;
    *(_DWORD *)&byte_5D4594[result + 3807192] = a4;
    *(_DWORD *)&byte_5D4594[2489432] = v5;
  }
}

//----- (00543770) --------------------------------------------------------
int __cdecl sub_543770(_DWORD *a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  int v4; // eax

  if ( *(int *)&byte_5D4594[2489432] <= 0 )
    return 0;
  v4 = *(_DWORD *)&byte_5D4594[2489432] - 1;
  *(_DWORD *)&byte_5D4594[2489432] = v4;
  *a1 = *(_DWORD *)&byte_5D4594[16 * v4 + 3807180];
  *a2 = *(_DWORD *)&byte_5D4594[16 * *(_DWORD *)&byte_5D4594[2489432] + 3807184];
  *a3 = *(_DWORD *)&byte_5D4594[16 * *(_DWORD *)&byte_5D4594[2489432] + 3807188];
  *a4 = *(_DWORD *)&byte_5D4594[16 * *(_DWORD *)&byte_5D4594[2489432] + 3807192];
  return 1;
}

//----- (005437E0) --------------------------------------------------------
BOOL __cdecl sub_5437E0(int *a1, int a2, int a3)
{
  double v3; // st7
  double v4; // st6
  int v5; // ebx
  double v6; // st6
  int v7; // edi
  int v8; // esi
  int v9; // edx
  int v10; // ecx
  int v11; // esi
  int v12; // edx
  int v13; // ebx
  int v14; // ecx
  int v15; // edx
  int v16; // ebx
  unsigned __int8 *v17; // edi
  int v18; // edx
  int v19; // eax
  int *v20; // ecx
  int v21; // edi
  int v23; // [esp+Ch] [ebp-8h]
  float v24; // [esp+10h] [ebp-4h]

  v3 = (double)*a1 + 11.5;
  v4 = (double)a1[1];
  v5 = (__int64)(v3 * 0.021739131);
  v23 = (__int64)(v3 * 0.021739131);
  v6 = v4 + 11.5;
  v24 = v6;
  v7 = (__int64)(v6 * 0.021739131);
  a1 = (int *)(__int64)(v6 * 0.021739131);
  v8 = (int)(__int64)v3 % 46;
  *(_DWORD *)&byte_5D4594[3821628] = 0;
  v9 = (__int64)v24 % 46;
  *(_DWORD *)&byte_5D4594[2487248] = 0;
  if ( v5 <= 0 || v5 >= 127 || v7 <= 0 || v7 >= 127 )
  {
    v11 = a3;
  }
  else if ( v8 <= v9 )
  {
    if ( a3 - v8 <= v9 )
    {
      v15 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v5);
      v11 = *(_DWORD *)(v15 + 44 * v7 + 24);
      sub_51DD50(v5, v7, 2, *(_DWORD *)(v15 + 44 * v7 + 24));
    }
    else
    {
      v13 = v5 - 1;
      v14 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v13);
      v11 = *(_DWORD *)(v14 + 44 * v7 + 4);
      sub_51DD50(v13, v7, 1, *(_DWORD *)(v14 + 44 * v7 + 4));
    }
  }
  else if ( a3 - v8 <= v9 )
  {
    v12 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v5);
    v11 = *(_DWORD *)(v12 + 44 * v7 + 4);
    sub_51DD50(v5, v7, 1, *(_DWORD *)(v12 + 44 * v7 + 4));
  }
  else
  {
    v10 = *(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * v5);
    v11 = *(_DWORD *)(v10 + 44 * v7 - 20);
    sub_51DD50(v5, v7 - 1, 2, *(_DWORD *)(v10 + 44 * v7 - 20));
  }
  v16 = 0;
  if ( *(_DWORD *)&byte_5D4594[2487248] > 0 )
  {
    v17 = &byte_5D4594[3815632];
    do
    {
      v18 = *((_DWORD *)v17 + 1);
      v19 = *((_DWORD *)v17 - 1);
      v20 = *(int **)v17;
      v23 = *((_DWORD *)v17 - 1);
      a1 = v20;
      a3 = v18;
      if ( v18 & 2 )
      {
        sub_51DD50(v19, (int)v20, 1, v11);
        sub_51DD50(v23, (int)a1 + 1, 1, v11);
        sub_51DD50(v23 - 1, (int)a1, 1, v11);
        sub_51DD50(v23 - 1, (int)a1 + 1, 1, v11);
      }
      else if ( v18 & 1 )
      {
        sub_51DD50(v19 + 1, (int)v20, 2, v11);
        sub_51DD50(v23 + 1, (int)a1 - 1, 2, v11);
        sub_51DD50(v23, (int)a1, 2, v11);
        sub_51DD50(v23, (int)a1 - 1, 2, v11);
      }
      ++v16;
      v17 += 12;
    }
    while ( v16 < *(int *)&byte_5D4594[2487248] );
  }
  if ( sub_51DE30(&v23, &a1, &a3) )
  {
    v21 = a2;
    do
    {
      if ( a3 & 2 )
      {
        sub_543BC0(v23, (int)a1, 1, v11, v21, 1);
        sub_543BC0(v23, (int)a1 + 1, 1, v11, v21, 4);
        sub_543BC0(v23 - 1, (int)a1, 1, v11, v21, 3);
        sub_543BC0(v23 - 1, (int)a1 + 1, 1, v11, v21, 6);
        sub_543BC0(v23, (int)a1 - 1, 2, v11, v21, 0);
        sub_543BC0(v23 + 1, (int)a1, 2, v11, v21, 2);
        sub_543BC0(v23 - 1, (int)a1, 2, v11, v21, 5);
        sub_543BC0(v23, (int)a1 + 1, 2, v11, v21, 7);
      }
      else if ( a3 & 1 )
      {
        sub_543BC0(v23 + 1, (int)a1, 2, v11, v21, 4);
        sub_543BC0(v23 + 1, (int)a1 - 1, 2, v11, v21, 1);
        sub_543BC0(v23, (int)a1, 2, v11, v21, 6);
        sub_543BC0(v23, (int)a1 - 1, 2, v11, v21, 3);
        sub_543BC0(v23, (int)a1 - 1, 1, v11, v21, 0);
        sub_543BC0(v23 + 1, (int)a1, 1, v11, v21, 2);
        sub_543BC0(v23 - 1, (int)a1, 1, v11, v21, 5);
        sub_543BC0(v23, (int)a1 + 1, 1, v11, v21, 7);
      }
    }
    while ( sub_51DE30(&v23, &a1, &a3) );
  }
  return *(_DWORD *)&byte_5D4594[3821628] == 0;
}

//----- (00543BC0) --------------------------------------------------------
void __cdecl sub_543BC0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int v7; // ebx

  if ( a1 > 0 && a1 < 127 )
  {
    if ( a2 > 0 && a2 < 127 )
    {
      v7 = a3;
      if ( (!(a3 & 1) || a2 != 1) && (!(a3 & 2) || a1 != 1) )
      {
        if ( a3 & 2 )
        {
          if ( a4 == *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * a1) + 44 * a2 + 24) )
            return;
          v7 = a3;
        }
        if ( !(a3 & 1) || a4 != *(_DWORD *)(*(_DWORD *)(*(_DWORD *)&byte_5D4594[2650668] + 4 * a1) + 44 * a2 + 4) )
        {
          if ( a5 )
          {
            *(_DWORD *)(a5 + 28) = a6;
            sub_51DA70(a1, a2, a5, v7, 1);
          }
        }
      }
    }
  }
}

//----- (00543C50) --------------------------------------------------------
int __cdecl sub_543C50(_DWORD *a1, int a2, int a3, int a4, int a5, int a6)
{
  _DWORD *v6; // edi
  _DWORD *v7; // esi
  _DWORD **v8; // eax
  int result; // eax
  _DWORD **v10; // eax
  int v11; // ebx
  int v12; // eax
  _DWORD *v13; // ebx
  _DWORD **v14; // edi
  _DWORD *j; // ebp
  _DWORD *v16; // esi
  int v17; // eax
  int v18; // eax
  _DWORD *v19; // esi
  int v20; // eax
  int i; // ecx
  int v22; // [esp+24h] [ebp+14h]

  if ( a2 == 255 || a4 == 255 )
  {
    v19 = a1;
    v20 = a1[4];
    if ( v20 )
    {
      for ( i = *(_DWORD *)(v20 + 16); i; i = *(_DWORD *)(i + 16) )
      {
        v19 = (_DWORD *)v20;
        v20 = i;
      }
      sub_4221E0(v20);
      v19[4] = 0;
    }
    return 1;
  }
  v6 = a1;
  if ( *a1 == 255 )
    return 1;
  v7 = a1;
  if ( a6 )
  {
    v10 = (_DWORD **)(a1 + 4);
    v11 = 0;
    if ( !a1[4] )
      goto LABEL_45;
    do
    {
      v7 = *v10;
      if ( **v10 == a2 && v7[1] == a3 && v7[2] == a4 && sub_543E60((int)v7, a5) )
        v11 = 1;
      v10 = (_DWORD **)(v7 + 4);
    }
    while ( v7[4] );
    if ( !v11 )
    {
LABEL_45:
      v12 = sub_543EB0(a4, a5);
      v7[4] = sub_422160(a2, a3, a4, v12);
      return 1;
    }
    while ( 1 )
    {
      v13 = v6;
      v22 = 0;
      if ( !v6[4] )
        break;
      do
      {
        v13 = (_DWORD *)v13[4];
        if ( *v13 == a2 && v13[1] == a3 && v13[2] == a4 )
        {
          v14 = (_DWORD **)(v13 + 4);
          for ( j = v13; j[4]; v14 = (_DWORD **)(j + 4) )
          {
            v16 = *v14;
            if ( **v14 == a2
              && v16[1] == a3
              && (v17 = v16[2], v17 == a4)
              && (v18 = sub_411490(v17, v16[3]), sub_543E60((int)v13, v18)) )
            {
              v22 = 1;
              *v14 = (_DWORD *)v16[4];
              sub_4221E0((int)v16);
            }
            else
            {
              j = v16;
            }
          }
          v6 = a1;
        }
      }
      while ( v13[4] );
      if ( !v22 )
        return 1;
    }
    return 1;
  }
  v8 = (_DWORD **)(a1 + 4);
  if ( a1[4] )
  {
    while ( 1 )
    {
      v7 = *v8;
      if ( **v8 == a2 && v7[1] == a3 && v7[2] == a4 && v7[3] == a5 )
        break;
      v8 = (_DWORD **)(v7 + 4);
      if ( !v7[4] )
        goto LABEL_11;
    }
    result = 0;
  }
  else
  {
LABEL_11:
    v7[4] = sub_422160(a2, a3, a4, a5);
    result = 1;
  }
  return result;
}

//----- (00543E60) --------------------------------------------------------
int __cdecl sub_543E60(int a1, int a2)
{
  int v2; // ecx
  int v4; // eax

  v2 = a2 + 12 * sub_411490(*(_DWORD *)(a1 + 8), *(_DWORD *)(a1 + 12));
  if ( *(_DWORD *)&byte_587000[4 * v2 + 282736] == 255 )
    return 0;
  v4 = sub_543EB0(*(_DWORD *)(a1 + 8), *(_DWORD *)&byte_587000[4 * v2 + 282736]);
  if ( v4 != *(_DWORD *)(a1 + 12) )
    *(_DWORD *)(a1 + 12) = v4;
  return 1;
}

//----- (00543EB0) --------------------------------------------------------
int __cdecl sub_543EB0(int a1, int a2)
{
  int v2; // esi
  int v3; // edi
  int result; // eax

  v2 = byte_5D4594[60 * a1 + 2678400];
  v3 = byte_5D4594[60 * a1 + 2678401];
  if ( v2 == 3 && v3 == byte_5D4594[60 * a1 + 2678400] )
    return a2;
  result = a2;
  if ( a2 )
  {
    switch ( a2 )
    {
      case 1:
        result = sub_415FA0(1, v2 - 2);
        break;
      case 2:
        result = v2 - 1;
        break;
      case 3:
        result = v2 + 2 * sub_415FA0(0, v3 - 3);
        break;
      case 4:
        result = v2 + 2 * sub_415FA0(0, v3 - 3) + 1;
        break;
      case 5:
        result = v2 + 2 * v3 - 4;
        break;
      case 6:
        result = sub_415FA0(1, v2 - 2) + v2 + 2 * v3 - 4;
        break;
      case 7:
        result = 2 * (v2 + v3) - 5;
        break;
      default:
        result = a2 + 2 * (v2 + v3) - 12;
        break;
    }
  }
  return result;
}

//----- (00543FB0) --------------------------------------------------------
int __cdecl sub_543FB0(const char *a1)
{
  int v1; // ebp
  const char *i; // edi

  if ( !a1 )
    return -1;
  v1 = 0;
  if ( *(int *)&byte_5D4594[251572] <= 0 )
    return -1;
  for ( i = (const char *)&byte_5D4594[2678348]; strcmp(i, a1); i += 60 )
  {
    if ( ++v1 >= *(int *)&byte_5D4594[251572] )
      return -1;
  }
  return v1;
}

//----- (00544020) --------------------------------------------------------
int __cdecl sub_544020(char *a1)
{
  int v1; // eax
  int result; // eax

  *(_DWORD *)&byte_5D4594[2489436] = 0;
  if ( _strcmpi((const char *)&byte_587000[283552], a1) )
  {
    v1 = sub_543FB0(a1);
    result = sub_544070(v1);
  }
  else
  {
    *(_DWORD *)&byte_5D4594[3835356] = 255;
    result = 1;
  }
  return result;
}

//----- (00544070) --------------------------------------------------------
int __cdecl sub_544070(int a1)
{
  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[251572] )
    return 0;
  *(_DWORD *)&byte_5D4594[3835356] = a1;
  *(_DWORD *)&byte_5D4594[2489436] = 1;
  return 1;
}

//----- (005440A0) --------------------------------------------------------
int __cdecl sub_5440A0(int a1)
{
  if ( !*(_DWORD *)&byte_5D4594[2489436] )
    return 1;
  if ( *(int *)&byte_5D4594[3835356] == -1 || a1 < 0 || a1 >= *(unsigned __int16 *)&byte_5D4594[60 * a1 + 2678392] )
    return 0;
  *(_DWORD *)&byte_5D4594[3835360] = a1;
  return 1;
}

//----- (005440F0) --------------------------------------------------------
int __cdecl sub_5440F0(int a1, signed int a2)
{
  int v2; // ebp
  int v3; // ebx
  int v4; // edi
  signed int v5; // eax
  int v6; // eax
  int result; // eax

  if ( a1 < 0 || a1 >= 12 || *(int *)&byte_5D4594[3835356] == -1 )
    return 0;
  v2 = *(_DWORD *)&byte_587000[4 * a1 + 283312];
  v3 = byte_5D4594[60 * *(_DWORD *)&byte_5D4594[3835356] + 2678401];
  v4 = byte_5D4594[60 * *(_DWORD *)&byte_5D4594[3835356] + 2678400];
  if ( v4 != 3 || v3 != byte_5D4594[60 * *(_DWORD *)&byte_5D4594[3835356] + 2678400] )
  {
    switch ( a1 )
    {
      case 0:
      case 3:
      case 4:
        v2 = v4 + v2 - 3;
        break;
      case 5:
      case 8:
      case 9:
      case 10:
      case 11:
        v2 = v2 + 2 * (v3 + v4 - 4) - 4;
        break;
      case 6:
      case 7:
        v2 = v4 + 2 * v3 - 6 + v2 - 3;
        break;
      default:
        break;
    }
  }
  v5 = a2;
  if ( a2 == -1 )
  {
    v6 = sub_544240(*(int *)&byte_5D4594[3835356]);
    if ( a1 && a1 != 2 && a1 != 4 && a1 != 6 )
      return sub_5440A0(v2);
    v5 = sub_526AC0(0, v6 - 1);
  }
  if ( !v5 )
    return sub_5440A0(v2);
  if ( a1 != 6 && a1 != 2 )
  {
    if ( (!a1 || a1 == 4) && v5 <= v3 - 3 )
      goto LABEL_24;
    return 0;
  }
  if ( v5 > v4 - 3 )
    return 0;
LABEL_24:
  switch ( a1 )
  {
    case 0:
    case 4:
      v2 += 2 * v5;
      return sub_5440A0(v2);
    case 2:
    case 6:
      result = sub_5440A0(v5 + v2);
      break;
    default:
      return sub_5440A0(v2);
  }
  return result;
}

//----- (00544240) --------------------------------------------------------
int __cdecl sub_544240(int a1)
{
  int result; // eax

  if ( a1 < 0 || a1 >= *(int *)&byte_5D4594[251572] )
    result = 0;
  else
    result = byte_5D4594[60 * a1 + 2678400] - 2;
  return result;
}

//----- (00544270) --------------------------------------------------------
int __cdecl sub_544270(const char *a1)
{
  int v1; // ebp
  const char *i; // edi

  v1 = 0;
  if ( *(int *)&byte_5D4594[251572] <= 0 )
    return -1;
  for ( i = (const char *)&byte_5D4594[2678348]; strcmp(i, a1); i += 60 )
  {
    if ( ++v1 >= *(int *)&byte_5D4594[251572] )
      return -1;
  }
  return v1;
}

//----- (005442D0) --------------------------------------------------------
int __cdecl sub_5442D0(float *a1)
{
  int result; // eax
  float2 a2; // [esp+0h] [ebp-8h]

  if ( !*(_DWORD *)&byte_5D4594[2489436] )
    return 1;
  result = sub_4D3D90((float2 *)a1, &a2);
  if ( result )
    result = sub_544310(&a2);
  return result;
}

//----- (00544310) --------------------------------------------------------
int __cdecl sub_544310(float2 *a1)
{
  double v1; // st7
  double v2; // st6
  int v3; // esi
  int v4; // edi
  int v5; // ebp
  int v6; // edx
  int result; // eax
  int v8[8]; // [esp+10h] [ebp-20h]
  float v9; // [esp+34h] [ebp+4h]

  *(_DWORD *)&byte_5D4594[3835352] = 1;
  v1 = a1->field_0 + 11.5;
  v8[1] = *(_DWORD *)&byte_5D4594[3835348];
  v8[0] = *(_DWORD *)&byte_5D4594[3835340];
  v8[2] = 0;
  LOBYTE(v8[5]) = 0;
  v8[3] = -1;
  v8[4] = -1;
  v8[6] = *(_DWORD *)&byte_5D4594[3835356];
  v8[7] = *(_DWORD *)&byte_5D4594[3835360];
  v2 = a1->field_4 + 11.5;
  v3 = (__int64)(v1 * 0.021739131);
  v9 = v2;
  v4 = (__int64)(v2 * 0.021739131);
  v5 = (int)(__int64)v1 % 46;
  v6 = (__int64)v9 % 46;
  if ( *(_DWORD *)&byte_5D4594[3835340] == 255 )
    result = sub_51D9C0(v3, v4, v5, v6, 0);
  else
    result = sub_51D9C0(v3, v4, v5, v6, (int)v8);
  *(_DWORD *)&byte_5D4594[3835352] = 0;
  return result;
}

//----- (005443F0) --------------------------------------------------------
char __cdecl sub_5443F0(int a1)
{
  int v1; // esi
  int v2; // edi
  int v4; // ebx
  double v5; // st7
  double v6; // st7
  double v7; // st6
  double v8; // st5
  double v9; // st6
  char v10; // al
  BOOL v11; // ebp
  int *v12; // ebx
  int *v13; // edi
  float v14; // [esp+Ch] [ebp+4h]

  v1 = a1;
  v2 = *(_DWORD *)(a1 + 748);
  if ( !sub_534320(a1) )
    return sub_50A160(a1);
  v4 = v2 + 24 * (*(char *)(v2 + 544) + 23);
  if ( sub_50A040(a1) == 3 )
  {
    v5 = *(float *)(v2 + 1316) * 3.0;
    v14 = v5;
    v6 = v5 + 30.0;
    v7 = *(float *)(v4 + 4) - *(float *)(v1 + 56);
    v8 = *(float *)(v4 + 8) - *(float *)(v1 + 60);
    v9 = v8 * v8 + v7 * v7;
    if ( v9 >= v14 * v14 )
    {
      if ( v9 > v6 * v6 )
        sub_534750(v1);
    }
    else
    {
      sub_534780(v1);
    }
  }
  if ( sub_50D5A0(v1) == 1 )
  {
    v10 = *(_BYTE *)(v2 + 284);
    v11 = v10 == 2
       || v10 == 1
       && *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v2 + 540) < (unsigned int)(5 * *(_DWORD *)&byte_5D4594[2649704]);
    if ( v10 == 1 )
      *(_DWORD *)(v2 + 540) = *(_DWORD *)&byte_5D4594[2598000];
    if ( !v10 && !sub_547F10() && !*(_DWORD *)(v4 + 12) )
    {
      sub_533CC0(v1, (float *)(v4 + 4));
      sub_50A160(v1);
    }
    if ( v11 )
    {
      v12 = sub_50A260(v1, 41);
      if ( v12 )
        v12[1] = *(_DWORD *)&byte_5D4594[2598000]
               + sub_415FA0(2 * *(_DWORD *)&byte_5D4594[2649704], 4 * *(_DWORD *)&byte_5D4594[2649704]);
      sub_50A260(v1, 29);
      *(_DWORD *)(v2 + 1440) |= 0x200000u;
    }
    if ( *(_BYTE *)(v2 + 284) )
    {
      v13 = sub_50A260(v1, 1);
      if ( v13 )
        v13[1] = *(_DWORD *)&byte_5D4594[2598000]
               + sub_415FA0(*(_DWORD *)&byte_5D4594[2649704] >> 1, *(int *)&byte_5D4594[2649704]);
    }
  }
  return sub_534030(v1);
}

//----- (005445C0) --------------------------------------------------------
char __cdecl sub_5445C0(int *a1)
{
  int v1; // edi
  int v2; // eax
  int *v3; // eax
  int v4; // ecx

  v1 = a1[187];
  if ( !sub_5343C0((int)a1) && !sub_534390((int)a1) || (v2 = sub_545E60(a1)) == 0 )
  {
    if ( sub_534390((int)a1) )
    {
      if ( *(_DWORD *)(v1 + 1196) )
      {
        v3 = sub_50A260((int)a1, 15);
        if ( v3 )
        {
          v4 = *(_DWORD *)(v1 + 1196);
          v3[1] = *(_DWORD *)(v4 + 56);
          v3[2] = *(_DWORD *)(v4 + 60);
          v3[3] = *(_DWORD *)&byte_5D4594[2598000];
        }
      }
    }
    LOBYTE(v2) = sub_5443F0((int)a1);
  }
  return v2;
}

//----- (00544640) --------------------------------------------------------
void __cdecl sub_544640(int a1)
{
  float *v1; // esi
  int v2; // edi
  double v3; // st7
  double v4; // st6
  long double v5; // st6
  double v6; // st6
  float v7; // [esp+Ch] [ebp-4h]
  float v8; // [esp+14h] [ebp+4h]

  v1 = (float *)a1;
  v2 = *(_DWORD *)(a1 + 748);
  if ( sub_534320(a1) )
  {
    if ( !sub_4FF350(a1, 3) && !sub_4FF350(a1, 5) && !sub_4FF350(a1, 28) )
    {
      v3 = *(float *)(v2 + 24 * (*(char *)(v2 + 544) + 23) + 4) - *(float *)(a1 + 56);
      v4 = *(float *)(v2 + 24 * (*(char *)(v2 + 544) + 23) + 8) - *(float *)(a1 + 60);
      v7 = v4;
      v5 = sqrt(v4 * v7 + v3 * v3) + 0.000099999997;
      v8 = v5;
      if ( v5 >= 8.0 )
      {
        v6 = *(float *)(*(_DWORD *)(v2 + 484) + 96) * v1[136];
        v1[136] = v6;
        v1[22] = v6 * v3 / v8;
        v1[23] = v7 * v1[136] / v8;
      }
      else
      {
        sub_50A160((int)v1);
      }
    }
  }
  else
  {
    sub_50A160(a1);
  }
}

//----- (00544740) --------------------------------------------------------
int __cdecl sub_544740(int a1)
{
  return sub_534750(a1);
}

//----- (00544750) --------------------------------------------------------
int __cdecl sub_544750(int a1)
{
  return sub_534780(a1);
}

//----- (00544760) --------------------------------------------------------
char __cdecl sub_544760(int a1)
{
  int v1; // esi
  int v2; // eax
  int v3; // ebx
  int v4; // eax
  int v5; // eax
  double v6; // st7
  double v7; // st6
  int v8; // eax
  int v9; // eax
  int v10; // ebx
  int v11; // eax

  v1 = *(_DWORD *)(a1 + 748);
  if ( sub_534320(a1) )
  {
    v3 = v1 + 24 * (*(char *)(v1 + 544) + 23);
    v4 = *(_DWORD *)(v1 + 1196);
    if ( v4 )
    {
      *(_DWORD *)(v3 + 4) = *(_DWORD *)(v4 + 56);
      *(_DWORD *)(v3 + 8) = *(_DWORD *)(v4 + 60);
      v5 = *(_DWORD *)(v1 + 1196);
      v6 = *(float *)(v5 + 56) - *(float *)(a1 + 56);
      v7 = *(float *)(v5 + 60) - *(float *)(a1 + 60);
      if ( *(float *)(v1 + 1356) * *(float *)(v1 + 1356) > v7 * v7 + v6 * v6
        && (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 280)) > *(_DWORD *)&byte_5D4594[2649704] >> 1 )
      {
        *(_DWORD *)(v1 + 8) = 0;
      }
      if ( sub_534300(a1) && !sub_4FF350(a1, 29) && !sub_534400(a1) && !sub_534440(a1) )
      {
        v8 = sub_50A0D0(a1, 6) ? sub_541050(a1) : sub_540B90(a1);
        if ( !v8 && sub_5370E0(a1, *(_DWORD *)(v1 + 1196), 0) )
          sub_540F20(a1, *(_DWORD *)(v1 + 1196));
      }
    }
    v9 = *(_DWORD *)&byte_5D4594[2598000];
    if ( *(_DWORD *)(v1 + 8)
      && *(_DWORD *)&byte_5D4594[2598000] - *(_DWORD *)(v1 + 280) > (unsigned int)(2 * *(_DWORD *)&byte_5D4594[2649704]) )
    {
      *(_DWORD *)(v1 + 8) = 0;
      v9 = *(_DWORD *)&byte_5D4594[2598000];
    }
    if ( *(_DWORD *)(v1 + 8)
      || (unsigned int)(v9 - *(_DWORD *)(v1 + 280)) <= 0xA
      || (v10 = v3 + 4,
          v11 = sub_50CA00(v1 + 12, 32, a1, (float *)v10),
          *(_DWORD *)(v1 + 8) = v11,
          *(_DWORD *)(v1 + 280) = *(_DWORD *)&byte_5D4594[2598000],
          *(_DWORD *)(v1 + 268) = 0,
          v11 > 1) )
    {
      if ( sub_50D3B0((float *)a1) )
        *(_DWORD *)(v1 + 8) = 0;
      LOBYTE(v2) = sub_534030(a1);
    }
    else
    {
      *(_DWORD *)v10 = *(_DWORD *)(a1 + 56);
      v2 = *(_DWORD *)(a1 + 60);
      *(_DWORD *)(v10 + 4) = v2;
    }
  }
  else
  {
    LOBYTE(v2) = sub_50A160(a1);
  }
  return v2;
}

//----- (00544920) --------------------------------------------------------
int __cdecl sub_544920(int a1)
{
  return sub_534750(a1);
}

//----- (00544930) --------------------------------------------------------
int __cdecl sub_544930(int a1)
{
  return sub_534780(a1);
}

//----- (00544940) --------------------------------------------------------
int __cdecl sub_544940(int a1)
{
  return sub_534780(a1);
}

//----- (00544950) --------------------------------------------------------
char __cdecl sub_544950(int a1)
{
  return sub_5443F0(a1);
}

//----- (00544960) --------------------------------------------------------
char __cdecl sub_544960(int a1)
{
  unsigned int v1; // eax

  v1 = *(_DWORD *)(*(_DWORD *)(a1 + 748) + 24 * *(char *)(*(_DWORD *)(a1 + 748) + 544) + 556);
  if ( v1 <= *(int *)&byte_5D4594[2598000] )
    LOBYTE(v1) = sub_50A160(a1);
  return v1;
}

//----- (00544990) --------------------------------------------------------
char __cdecl sub_544990(int a1)
{
  int v1; // eax
  int v2; // esi
  int v3; // ecx
  char result; // al

  v1 = *(_DWORD *)(a1 + 748);
  v2 = *(_DWORD *)(v1 + 548);
  v3 = *(_DWORD *)(v1 + 24 * *(char *)(v1 + 544) + 556);
  result = byte_5D4594[2598000];
  if ( *(_DWORD *)&byte_5D4594[2598000] > (unsigned int)(v2 + v3) )
    result = sub_50A160(a1);
  return result;
}

//----- (005449D0) --------------------------------------------------------
int *__cdecl sub_5449D0(int a1)
{
  int *result; // eax

  *(_DWORD *)(*(_DWORD *)(a1 + 748) + 1304) = 1062501089;
  result = sub_50A260(a1, 10);
  if ( result )
  {
    result[1] = 0;
    *((_BYTE *)result + 12) = -128;
  }
  return result;
}

//----- (00544A00) --------------------------------------------------------
int __cdecl sub_544A00(int a1, float a2)
{
  *(_DWORD *)&byte_5D4594[2489452] = 0;
  *(_DWORD *)&byte_5D4594[2489444] = 1259902592;
  sub_517F90((float2 *)(a1 + 56), a2, sub_544A40, a1);
  return *(_DWORD *)&byte_5D4594[2489452];
}

//----- (00544A40) --------------------------------------------------------
void __cdecl sub_544A40(int a1, int a2)
{
  int v2; // eax
  int v3; // eax
  double v4; // st7
  double v5; // st6
  double v6; // st5

  if ( *(_BYTE *)(a1 + 8) & 0x10 )
  {
    v2 = *(_DWORD *)(a1 + 12);
    if ( !(v2 & 4) && ((v2 & 0x80u) == 0 || sub_5347F0(a2)) )
    {
      v3 = *(_DWORD *)(a1 + 12);
      if ( !(v3 & 8) || v3 & 0x10 && sub_40A5C0(0x2000) && *(_BYTE *)(a2 + 12) & 0x10 )
      {
        if ( sub_5370E0(a2, a1, 0) )
        {
          v4 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
          v5 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
          v6 = v5 * v5 + v4 * v4;
          if ( v6 < *(float *)&byte_5D4594[2489444] )
          {
            *(float *)&byte_5D4594[2489444] = v6;
            *(_DWORD *)&byte_5D4594[2489452] = a1;
          }
        }
      }
    }
  }
}

//----- (00544AE0) --------------------------------------------------------
int __cdecl sub_544AE0(int a1, float a2)
{
  *(_DWORD *)&byte_5D4594[2489440] = 0;
  *(_DWORD *)&byte_5D4594[2489448] = 1259902592;
  sub_517F90((float2 *)(a1 + 56), a2, sub_544B20, a1);
  return *(_DWORD *)&byte_5D4594[2489440];
}

//----- (00544B20) --------------------------------------------------------
void __cdecl sub_544B20(int a1, int a2)
{
  double v2; // st7
  double v3; // st6
  double v4; // st5

  if ( *(_DWORD *)(a1 + 8) & 0x1000000 && sub_57B3D0(a1, 0) && sub_5370E0(a2, a1, 0) )
  {
    v2 = *(float *)(a1 + 56) - *(float *)(a2 + 56);
    v3 = *(float *)(a1 + 60) - *(float *)(a2 + 60);
    v4 = v3 * v3 + v2 * v2;
    if ( v4 < *(float *)&byte_5D4594[2489448] )
    {
      *(float *)&byte_5D4594[2489448] = v4;
      *(_DWORD *)&byte_5D4594[2489440] = a1;
    }
  }
}

//----- (00544B90) --------------------------------------------------------
char __cdecl sub_544B90(int a1)
{
  int v1; // ecx
  int v2; // edi
  int v3; // ecx
  double v4; // st7
  double v5; // st6
  int v6; // edi

  v1 = *(_DWORD *)(a1 + 748);
  v2 = v1 + 24 * (*(char *)(v1 + 544) + 23);
  v3 = *(_DWORD *)(v1 + 24 * (*(char *)(v1 + 544) + 23) + 4);
  if ( v3 )
  {
    v4 = *(float *)(v3 + 56) - *(float *)(a1 + 56);
    v5 = *(float *)(v3 + 60) - *(float *)(a1 + 60);
    if ( v5 * v5 + v4 * v4 < 5625.0 )
    {
      if ( sub_5370E0(a1, v3, 0) )
      {
        sub_4F36F0(a1, *(_DWORD *)(v2 + 4), 1, 1);
        v6 = *(_DWORD *)(v2 + 4);
        if ( *(_BYTE *)(v6 + 12) & 0x10 )
          sub_53F8E0(a1, v6);
      }
    }
  }
  return sub_50A160(a1);
}

//----- (00544C40) --------------------------------------------------------
int (__cdecl *__cdecl sub_544C40(int a1))(int)
{
  int v1; // edi
  int v2; // eax
  int (__cdecl *result)(int); // eax

  v1 = *(_DWORD *)(a1 + 748);
  v2 = sub_424300(a1);
  if ( v2 )
    sub_501960(*(_DWORD *)(v2 + 60), a1, 0, 0);
  sub_502490((int *)(v1 + 1264), 0, a1);
  result = *(int (__cdecl **)(int))(*(_DWORD *)(v1 + 484) + 228);
  if ( result )
    result = (int (__cdecl *)(int))result(a1);
  return result;
}

//----- (00544CA0) --------------------------------------------------------
void __cdecl sub_544CA0(_DWORD *a1)
{
  int v1; // edi

  v1 = a1[187];
  if ( sub_534A40((int)a1) )
  {
    if ( *(_DWORD *)(v1 + 1440) & 0x80000 )
      sub_544CE0(a1);
  }
}

//----- (00544CE0) --------------------------------------------------------
void __cdecl sub_544CE0(_DWORD *a1)
{
  int v1; // eax
  int v2; // ecx
  int v3; // edi

  v1 = a1[127];
  if ( v1 && *(_BYTE *)(v1 + 8) & 4 )
  {
    v2 = a1[3];
    v3 = *(_DWORD *)(v1 + 748);
    LOBYTE(v2) = v2 & 0x7F;
    a1[3] = v2;
    sub_4D9200(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)a1);
    sub_417300(*(unsigned __int8 *)(*(_DWORD *)(v3 + 276) + 2064), (int)a1, 1);
  }
  sub_4EE500((int)a1);
  sub_537AF0(a1 + 14, 1);
  sub_4E5CC0((int)a1);
}

//----- (00544D60) --------------------------------------------------------
char __cdecl sub_544D60(int a1)
{
  char result; // al

  result = a1;
  if ( *(_BYTE *)(*(_DWORD *)(a1 + 748) + 483) )
    result = sub_50A160(a1);
  return result;
}

//----- (00544D80) --------------------------------------------------------
char __cdecl sub_544D80(_DWORD *a1)
{
  int v1; // ebx
  void (__cdecl *v2)(_DWORD *); // eax
  int v3; // edi
  int v4; // eax
  int v5; // eax
  bool v6; // zf
  float v8; // [esp+0h] [ebp-10h]
  float v9; // [esp+0h] [ebp-10h]

  v1 = a1[187];
  if ( a1[131] == 14 && a1[3] & 0x10000 )
    sub_544E60((int)a1);
  a1[21] = 0;
  a1[20] = 0;
  a1[23] = 0;
  a1[22] = 0;
  a1[25] = 0;
  a1[24] = 0;
  v2 = *(void (__cdecl **)(_DWORD *))(*(_DWORD *)(v1 + 484) + 232);
  if ( v2 )
    v2(a1);
  if ( sub_534A40((int)a1) )
  {
    v8 = sub_419D70(&byte_587000[283656], 0);
    v3 = sub_419A70(v8);
    v9 = sub_419D70(&byte_587000[283676], 1);
    v4 = sub_419A70(v9);
    *(_DWORD *)(v1 + 492) = sub_415FA0(v3, v4);
    v5 = a1[4];
    LOBYTE(v5) = v5 | 0x10;
    a1[4] = v5;
  }
  else
  {
    v6 = !sub_534A40((int)a1);
    v5 = a1[4];
    if ( v6 )
      LOBYTE(v5) = v5 | 0x18;
    else
      LOBYTE(v5) = v5 | 0x10;
    a1[4] = v5;
  }
  return v5;
}

//----- (00544E60) --------------------------------------------------------
char __cdecl sub_544E60(int a1)
{
  int v1; // eax
  _DWORD *v2; // eax
  _DWORD *v3; // esi
  __int16 v4; // di

  v1 = *(_DWORD *)&byte_5D4594[2489456];
  if ( !*(_DWORD *)&byte_5D4594[2489456] )
  {
    v1 = sub_4E3AA0((CHAR *)&byte_587000[283744]);
    *(_DWORD *)&byte_5D4594[2489456] = v1;
  }
  v2 = sub_4E3450(v1);
  v3 = v2;
  if ( v2 )
  {
    LOBYTE(v2) = sub_4DAA50((int)v2, 0, *(float *)(a1 + 56), *(float *)(a1 + 60));
    v4 = *(_WORD *)(a1 + 124);
    *((_WORD *)v3 + 63) = v4;
    *((_WORD *)v3 + 62) = v4;
  }
  return (char)v2;
}

//----- (00544EC0) --------------------------------------------------------
void __cdecl sub_544EC0(int a1)
{
  _DWORD *v1; // edi
  int v2; // eax

  v1 = *(_DWORD **)(a1 + 748);
  if ( sub_534A40(a1) )
  {
    v2 = v1[360];
    if ( v2 & 0x80000 )
    {
      sub_5231B0((float *)(a1 + 56), 100);
      sub_544CE0((_DWORD *)a1);
    }
    else if ( (unsigned int)(*(_DWORD *)&byte_5D4594[2598000] - v1[137]) > v1[123] && !(v2 & 0x100000) )
    {
      if ( v1[299] )
        sub_534AB0(a1);
    }
  }
  else
  {
    sub_4DA920((_DWORD *)a1);
    *(_DWORD *)(a1 + 744) = 0;
    sub_544F70(a1);
    if ( *(_BYTE *)(v1[121] + 92) & 1 )
      sub_4E5CC0(a1);
  }
}

//----- (00544F70) --------------------------------------------------------
int __cdecl sub_544F70(int a1)
{
  int v1; // ecx
  int result; // eax
  int v3; // edx
  _DWORD *v4; // edx
  unsigned __int8 v5; // dl
  int v6; // ecx
  _DWORD *v7; // esi

  v1 = 0;
  result = *(_DWORD *)(a1 + 748);
  v3 = *(_DWORD *)(result + 296);
  *(_BYTE *)(result + 2094) = 0;
  if ( v3 > 0 )
  {
    v4 = (_DWORD *)(result + 300);
    do
    {
      *v4 = 0;
      ++v1;
      ++v4;
    }
    while ( v1 < *(int *)(result + 296) );
  }
  v5 = *(_BYTE *)(result + 1129);
  v6 = 0;
  *(_DWORD *)(result + 296) = 0;
  *(_DWORD *)(result + 364) = 0;
  if ( v5 > 0u )
  {
    v7 = (_DWORD *)(result + 1132);
    do
    {
      *v7 = 0;
      ++v6;
      ++v7;
    }
    while ( v6 < *(unsigned __int8 *)(result + 1129) );
  }
  *(_BYTE *)(result + 1129) = 0;
  *(_DWORD *)(result + 1196) = 0;
  return result;
}

//----- (00544FF0) --------------------------------------------------------
unsigned __int8 *__cdecl sub_544FF0(int a1)
{
  int v1; // edi

  v1 = *(_DWORD *)(a1 + 748);
  sub_50A160(a1);
  return sub_502490((int *)(v1 + 1288), 0, a1);
}
